{"version":3,"file":"app.js","sources":["../../../../journey/src/js/lib/roadtrip/Route.js","../../../../journey/src/js/lib/roadtrip/utils/watchLinks.js","../../../../journey/src/js/lib/roadtrip/utils/isSameRoute.js","../../../../journey/src/js/lib/roadtrip/roadtrip.js","../../../../journey/src/js/lib/journey/EventEmitter.js","../../../../journey/src/js/lib/journey/utils/util.js","../../../../journey/src/js/lib/journey/handler/routeAbuseMonitor.js","../../../../journey/src/js/lib/journey/journey.js","../../../../../ractive/src/utils/is.js","../../../../../ractive/src/utils/log.js","../../../../../ractive/src/shared/registry.js","../../../../../ractive/src/shared/interpolate.js","../../../../../ractive/src/Ractive/static/interpolators.js","../../../../../ractive/src/utils/array.js","../../../../../ractive/src/global/TransitionManager.js","../../../../../ractive/src/global/runloop.js","../../../../../ractive/src/shared/keypaths.js","../../../../../ractive/src/global/capture.js","../../../../../ractive/src/shared/methodCallers.js","../../../../../ractive/src/utils/bind.js","../../../../../ractive/src/model/ModelBase.js","../../../../../ractive/src/shared/rebind.js","../../../../../ractive/src/shared/Ticker.js","../../../../../ractive/src/model/helpers/getPrefixer.js","../../../../../ractive/src/model/Model.js","../../../../../ractive/src/view/resolvers/resolveReference.js","../../../../../ractive/src/shared/getRactiveContext.js","../../../../../ractive/src/shared/set.js","../../../../../ractive/src/Ractive/prototype/shared/add.js","../../../../../ractive/src/Ractive/prototype/add.js","../../../../../ractive/src/Ractive/prototype/animate.js","../../../../../ractive/src/events/eventStack.js","../../../../../ractive/src/events/fireEvent.js","../../../../../ractive/src/shared/anchors.js","../../../../../ractive/src/Ractive/prototype/attachChild.js","../../../../../ractive/src/Ractive/prototype/detach.js","../../../../../ractive/src/Ractive/prototype/detachChild.js","../../../../../ractive/src/Ractive/prototype/find.js","../../../../../ractive/src/Ractive/prototype/findAll.js","../../../../../ractive/src/Ractive/prototype/findAllComponents.js","../../../../../ractive/src/Ractive/prototype/findComponent.js","../../../../../ractive/src/Ractive/prototype/findContainer.js","../../../../../ractive/src/Ractive/prototype/findParent.js","../../../../../ractive/src/shared/getNewIndices.js","../../../../../ractive/src/Ractive/prototype/update.js","../../../../../ractive/src/view/items/shared/findElement.js","../../../../../ractive/src/shared/Context.js","../../../../../ractive/src/Ractive/prototype/fire.js","../../../../../ractive/src/Ractive/prototype/get.js","../../../../../ractive/src/Ractive/static/getContext.js","../../../../../ractive/src/Ractive/prototype/getContext.js","../../../../../ractive/src/utils/dom.js","../../../../../ractive/src/Ractive/prototype/insert.js","../../../../../ractive/src/Ractive/prototype/link.js","../../../../../ractive/src/Ractive/prototype/observe/Observer.js","../../../../../ractive/src/Ractive/prototype/observe/Array.js","../../../../../ractive/src/Ractive/prototype/observe.js","../../../../../ractive/src/Ractive/prototype/observeOnce.js","../../../../../ractive/src/Ractive/prototype/off.js","../../../../../ractive/src/Ractive/prototype/on.js","../../../../../ractive/src/Ractive/prototype/once.js","../../../../../ractive/src/Ractive/prototype/readLink.js","../../../../../ractive/src/global/css.js","../../../../../ractive/src/utils/object.js","../../../../../ractive/src/Ractive/config/custom/css/transform.js","../../../../../ractive/src/utils/id.js","../../../../../ractive/src/Ractive/config/custom/data.js","../../../../../ractive/src/parse/utils/createFunction.js","../../../../../ractive/src/shared/getFunction.js","../../../../../ractive/src/parse/converters/mustache/readDelimiterChange.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/readRegexpLiteral.js","../../../../../ractive/src/utils/escapeRegExp.js","../../../../../ractive/src/utils/html.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/readBooleanLiteral.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/readTemplateStringLiteral.js","../../../../../ractive/src/parse/converters/expressions/shared/readKey.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePair.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePairs.js","../../../../../ractive/src/parse/converters/expressions/primary/readLiteral.js","../../../../../ractive/src/parse/converters/expressions/primary/readReference.js","../../../../../ractive/src/parse/converters/expressions/primary/readBracketedExpression.js","../../../../../ractive/src/parse/converters/expressions/shared/readRefinement.js","../../../../../ractive/src/parse/converters/expressions/readConditional.js","../../../../../ractive/src/parse/converters/readExpression.js","../../../../../ractive/src/parse/converters/expressions/shared/readExpressionList.js","../../../../../ractive/src/parse/converters/readExpressionOrReference.js","../../../../../ractive/src/parse/utils/flattenExpression.js","../../../../../ractive/src/parse/utils/refineExpression.js","../../../../../ractive/src/parse/converters/element/readAttribute.js","../../../../../ractive/src/parse/converters/readMustache.js","../../../../../ractive/src/parse/converters/mustache/readTriple.js","../../../../../ractive/src/parse/converters/mustache/readUnescaped.js","../../../../../ractive/src/parse/converters/mustache/readAliases.js","../../../../../ractive/src/parse/converters/mustache/readPartial.js","../../../../../ractive/src/parse/converters/mustache/readMustacheComment.js","../../../../../ractive/src/parse/converters/mustache/readInterpolator.js","../../../../../ractive/src/parse/converters/mustache/section/readClosing.js","../../../../../ractive/src/parse/converters/mustache/section/readElse.js","../../../../../ractive/src/parse/converters/mustache/section/readElseIf.js","../../../../../ractive/src/parse/converters/mustache/readSection.js","../../../../../ractive/src/parse/converters/readHtmlComment.js","../../../../../ractive/src/parse/utils/stripStandalones.js","../../../../../ractive/src/parse/utils/cleanup.js","../../../../../ractive/src/parse/converters/element/readClosingTag.js","../../../../../ractive/src/parse/converters/readElement.js","../../../../../ractive/src/parse/converters/readText.js","../../../../../ractive/src/parse/converters/readPartialDefinitionSection.js","../../../../../ractive/src/parse/converters/readTemplate.js","../../../../../ractive/src/parse/utils/insertExpressions.js","../../../../../ractive/src/parse/_parse.js","../../../../../ractive/src/Ractive/config/runtime-parser.js","../../../../../ractive/src/Ractive/config/custom/template.js","../../../../../ractive/src/Ractive/config/wrapPrototypeMethod.js","../../../../../ractive/src/Ractive/config/deprecate.js","../../../../../ractive/src/Ractive/config/config.js","../../../../../ractive/src/view/resolvers/resolve.js","../../../../../ractive/src/view/items/Alias.js","../../../../../ractive/src/view/helpers/specialAttrs.js","../../../../../ractive/src/view/items/element/attribute/getUpdateDelegate.js","../../../../../ractive/src/view/items/element/ConditionalAttribute.js","../../../../../ractive/src/view/items/element/Attribute.js","../../../../../ractive/src/view/items/element/BindingFlag.js","../../../../../ractive/src/model/specials/RactiveModel.js","../../../../../ractive/src/model/RootModel.js","../../../../../ractive/src/Ractive/helpers/getComputationSignature.js","../../../../../ractive/src/Ractive/construct.js","../../../../../ractive/src/Ractive/prototype/teardown.js","../../../../../ractive/src/view/items/Component.js","../../../../../ractive/src/view/items/shared/directiveArgs.js","../../../../../ractive/src/view/items/element/binding/handleDomEvent.js","../../../../../ractive/src/view/items/element/binding/getBindingGroup.js","../../../../../ractive/src/view/items/element/binding/CheckboxNameBinding.js","../../../../../ractive/src/view/items/element/binding/GenericBinding.js","../../../../../ractive/src/utils/getSelectedOptions.js","../../../../../ractive/src/view/items/element/binding/RadioBinding.js","../../../../../ractive/src/view/items/element/binding/RadioNameBinding.js","../../../../../ractive/src/view/items/element/binding/selectBinding.js","../../../../../ractive/src/view/items/Element.js","../../../../../ractive/src/view/items/element/specials/Form.js","../../../../../ractive/src/view/items/shared/progressiveText.js","../../../../../ractive/src/utils/parseJSON.js","../../../../../ractive/src/view/items/component/Mapping.js","../../../../../ractive/src/view/items/partial/getPartialTemplate.js","../../../../../ractive/src/view/items/Partial.js","../../../../../ractive/src/view/items/Section.js","../../../../../ractive/src/config/visibility.js","../../../../../ractive/src/view/items/element/transitions/resetStyle.js","../../../../../ractive/src/view/items/element/Transition.js","../../../../../ractive/src/view/items/triple/insertHtml.js","../../../../../ractive/src/view/items/component/getComponentConstructor.js","../../../../../ractive/src/view/items/createItem.js","../../../../../ractive/src/view/helpers/processItems.js","../../../../../ractive/src/view/Fragment.js","../../../../../ractive/src/events/HookQueue.js","../../../../../ractive/src/Ractive/initialise.js","../../../../../ractive/src/Ractive/render.js","../../../../../ractive/src/Ractive/prototype/render.js","../../../../../ractive/src/Ractive/prototype/reset.js","../../../../../ractive/src/Ractive/prototype/resetPartial.js","../../../../../ractive/src/Ractive/prototype/resetTemplate.js","../../../../../ractive/src/Ractive/prototype/set.js","../../../../../ractive/src/Ractive/prototype/subtract.js","../../../../../ractive/src/Ractive/prototype/toggle.js","../../../../../ractive/src/Ractive/prototype/toCSS.js","../../../../../ractive/src/Ractive/prototype/toHTML.js","../../../../../ractive/src/Ractive/prototype/toText.js","../../../../../ractive/src/Ractive/prototype/transition.js","../../../../../ractive/src/Ractive/prototype/unlink.js","../../../../../ractive/src/Ractive/prototype/unrender.js","../../../../../ractive/src/Ractive/prototype/updateModel.js","../../../../../ractive/src/extend/_extend.js","../../../../../ractive/src/Ractive/static/keypaths.js","../../../../../ractive/src/Ractive.js","../../../src/js/lib/fade.js","../../../src/js/app/views/basics/methods/methods.js","../../../src/js/app/views/basics/binding/binding.js","../../../src/js/lib/parsley.js","../../../src/js/app/views/forms/validate/validatingForm.js","../../../src/js/app/views/lifecycle/events/events.js","../../../src/js/app/views/ajax/basic/basicAjax.js","../../../src/js/app/views/ajax/upload/upload.js","../../../src/js/app/views/comp/basic/basicComp.js","../../../src/js/app/views/comp/multiple/multipleComp.js","../../../src/js/app/views/comp/pubsub/compPubSub.js","../../../src/js/app/panel/side-panel/sidePanel.js","../../../src/js/app/menu/menuSlider.js","../../../../journey/src/js/lib/roadtrip/utils/window.js","../../../../journey/src/js/lib/roadtrip/utils/watchHistory.js","../../../../journey/src/js/lib/roadtrip/utils/util.js","../../../../journey/src/js/lib/roadtrip/utils/config.js","../../../../journey/src/js/lib/roadtrip/utils/pathHelper.js","../../../../journey/src/js/lib/roadtrip/routes.js","../../../../journey/src/js/lib/roadtrip/utils/polyfill.js","../../../../journey/src/js/lib/journey/handler/eventer.js","../../../../journey/src/js/lib/journey/utils/mode.js","../../../../journey/src/js/lib/journey/utils/events.js","../../../../journey/src/js/lib/journey/utils/config.js","../../../../../ractive/src/Ractive/config/defaults.js","../../../../../ractive/src/Ractive/static/easing.js","../../../../../ractive/src/config/environment.js","../../../../../ractive/src/utils/noop.js","../../../../../ractive/src/config/errors.js","../../../../../ractive/src/model/specials/KeyModel.js","../../../../../ractive/src/model/specials/KeypathModel.js","../../../../../ractive/src/model/LinkModel.js","../../../../../ractive/src/model/specials/SharedModel.js","../../../../../ractive/src/events/Hook.js","../../../../../ractive/src/Ractive/prototype/shared/makeArrayMethod.js","../../../../../ractive/src/config/types.js","../../../../../ractive/src/config/namespaces.js","../../../../../ractive/src/Ractive/prototype/observe/Pattern.js","../../../../../ractive/src/Ractive/prototype/shared/trim.js","../../../../../ractive/src/Ractive/prototype/shared/notEmptyString.js","../../../../../ractive/src/Ractive/prototype/pop.js","../../../../../ractive/src/Ractive/prototype/push.js","../../../../../ractive/src/Ractive/config/custom/adapt.js","../../../../../ractive/src/utils/cleanCss.js","../../../../../ractive/src/Ractive/config/custom/css/css.js","../../../../../ractive/src/config/template.js","../../../../../ractive/src/parse/Parser.js","../../../../../ractive/src/parse/converters/expressions/readTypeof.js","../../../../../ractive/src/parse/converters/utils/getLowestIndex.js","../../../../../ractive/src/parse/converters/expressions/shared/errors.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/readStringLiteral.js","../../../../../ractive/src/parse/converters/expressions/shared/patterns.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/readObjectLiteral.js","../../../../../ractive/src/parse/converters/expressions/primary/literal/readArrayLiteral.js","../../../../../ractive/src/parse/converters/expressions/readPrimary.js","../../../../../ractive/src/parse/converters/expressions/readMemberOrInvocation.js","../../../../../ractive/src/parse/converters/expressions/readLogicalOr.js","../../../../../ractive/src/parse/converters/mustache/handlebarsBlockCodes.js","../../../../../ractive/src/parse/utils/trimWhitespace.js","../../../../../ractive/src/Ractive/config/registries.js","../../../../../ractive/src/view/items/shared/Item.js","../../../../../ractive/src/model/ComputationChild.js","../../../../../ractive/src/model/Computation.js","../../../../../ractive/src/view/resolvers/ExpressionProxy.js","../../../../../ractive/src/view/resolvers/ReferenceExpressionProxy.js","../../../../../ractive/src/utils/hyphenateCamel.js","../../../../../ractive/src/view/items/element/attribute/propertyNames.js","../../../../../ractive/src/view/items/element/Decorator.js","../../../../../ractive/src/view/items/Doctype.js","../../../../../ractive/src/view/items/element/binding/Binding.js","../../../../../ractive/src/view/items/element/binding/CheckboxBinding.js","../../../../../ractive/src/view/items/element/binding/ContentEditableBinding.js","../../../../../ractive/src/view/items/element/binding/FileBinding.js","../../../../../ractive/src/view/items/element/binding/MultipleSelectBinding.js","../../../../../ractive/src/view/items/element/binding/NumericBinding.js","../../../../../ractive/src/view/items/element/binding/SingleSelectBinding.js","../../../../../ractive/src/view/items/element/ElementEvents.js","../../../../../ractive/src/view/items/component/RactiveEvent.js","../../../../../ractive/src/view/items/shared/EventDirective.js","../../../../../ractive/src/view/items/shared/Mustache.js","../../../../../ractive/src/view/items/Interpolator.js","../../../../../ractive/src/view/items/element/specials/Input.js","../../../../../ractive/src/view/items/element/specials/Option.js","../../../../../ractive/src/view/RepeatedFragment.js","../../../../../ractive/src/view/items/element/specials/Select.js","../../../../../ractive/src/view/items/element/specials/Textarea.js","../../../../../ractive/src/view/items/Text.js","../../../../../ractive/src/utils/camelizeHyphenated.js","../../../../../ractive/src/view/items/element/transitions/prefix.js","../../../../../ractive/src/view/items/element/transitions/unprefix.js","../../../../../ractive/src/view/items/element/transitions/createTransitions.js","../../../../../ractive/src/view/items/element/transitions/hyphenate.js","../../../../../ractive/src/view/items/Triple.js","../../../../../ractive/src/Ractive/prototype/reverse.js","../../../../../ractive/src/Ractive/prototype/shift.js","../../../../../ractive/src/Ractive/prototype/sort.js","../../../../../ractive/src/Ractive/prototype/splice.js","../../../../../ractive/src/Ractive/prototype/unshift.js","../../../../../ractive/src/Ractive/prototype.js","../../../src/js/lib/prism.js","../../../src/js/app/views/home/home.js","../../../src/js/app/views/basics/controller/basic.js","../../../src/js/app/views/nav/session.js","../../../src/js/app/views/nav/nav.js","../../../src/js/app/views/nav/navTarget.js","../../../src/js/app/views/nav/navTargetParams.js","../../../src/js/app/views/notfound/notFound.js","../../../src/js/app/views/nav/redirect/redirect.js","../../../src/js/app/views/nav/redirect/redirectTarget.js","../../../src/js/app/views/forms/basic/basicForm.js","../../../src/js/app/views/partial/basic/basicPartial.js","../../../src/js/app/views/comp/pubsub/grid.js","../../../src/js/app/views/transition/basic/basicTransition.js","../../../src/js/lib/ractive-decorators-sortable.js","../../../src/js/app/views/decorator/sortable.js","../../../src/js/app/config/routes.js","../../../src/js/lib/pace.js","../../../src/js/app/menu/menu.js","../../../src/js/lib/bootstrap.js","../../../src/js/app/animationMonitor.js","../../../src/js/app/start.js"],"sourcesContent":["import roadtrip from './roadtrip.js';\nimport pathHelper from \"./utils/pathHelper.js\";\nimport watchHistory from \"./utils/watchHistory.js\";\n\n\nconst a = typeof document !== 'undefined' && document.createElement( 'a' );\nconst QUERYPAIR_REGEX = /^([\\w\\-]+)(?:=([^&]*))?$/;\nconst HANDLERS = [ 'beforeenter', 'enter', 'leave', 'update' ];\n\nlet isInitial = true;\n\nfunction RouteData( { route, pathname, params, query, hash, scrollX, scrollY } ) {\n\tthis.pathname = pathname;\n\tthis.params = params;\n\tthis.query = query;\n\tthis.hash = hash;\n\tthis.isInitial = isInitial;\n\tthis.scrollX = scrollX;\n\tthis.scrollY = scrollY;\n\n\tthis._route = route;\n\n\tisInitial = false;\n}\n\nRouteData.prototype = {\n\tmatches( href ) {\n\t\treturn this._route.matches( href );\n\t}\n};\n\nexport default function Route( path, options ) {\n\tpath = pathHelper.stripSlashOrHashPrefix(path);\t\n\n\tthis.path = path;\n\tthis.segments = path.split( '/' );\n\n\tif ( typeof options === 'function' ) {\n\t\toptions = {\n\t\t\tenter: options\n\t\t};\n\t}\n\n\tthis.updateable = typeof options.update === 'function';\n\n\tHANDLERS.forEach( handler => {\n\t\tthis[ handler ] = ( route, other, opts ) => {\n\t\t\tlet value;\n\n\t\t\tif ( options[ handler ] ) {\n\t\t\t\tvalue = options[ handler ]( route, other, opts );\n\t\t\t}\n\n\t\t\treturn roadtrip.Promise.resolve( value );\n\t\t};\n\t} );\n}\n\nRoute.prototype = {\n\tmatches( href ) {\n\t\ta.href = pathHelper.prefixWithSlash(href); // This works for the options useHash: false + contextPath: true\n\n\t\tconst pathname = a.pathname.slice( 1 );\n\t\tconst segments = pathname.split( '/' );\n\n\t\treturn segmentsMatch( segments, this.segments );\n\t},\n\n\texec( target ) {\n\t\ta.href = target.href;\n\n\t\tlet pathname = a.pathname;\n\t\tpathname = pathHelper.stripSlashOrHashPrefix(pathname);\n\t\tconst search = a.search.slice( 1 );\n\n\t\tconst segments = pathname.split( '/' );\n\n\t\tif ( segments.length !== this.segments.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst params = { };\n\n\t\tfor ( let i = 0; i < segments.length; i += 1 ) {\n\t\t\tconst segment = segments[i];\n\t\t\tconst toMatch = this.segments[i];\n\n\t\t\tif ( toMatch[0] === ':' ) {\n\t\t\t\tparams[ toMatch.slice( 1 ) ] = segment;\n\t\t\t} else if ( segment !== toMatch ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tconst query = { };\n\t\tconst queryPairs = search.split( '&' );\n\n\t\tfor ( let i = 0; i < queryPairs.length; i += 1 ) {\n\t\t\tconst match = QUERYPAIR_REGEX.exec( queryPairs[i] );\n\n\t\t\tif ( match ) {\n\t\t\t\tconst key = match[1];\n\t\t\t\tconst value = decodeURIComponent( match[2] );\n\n\t\t\t\tif ( query.hasOwnProperty( key ) ) {\n\t\t\t\t\tif ( typeof query[ key ] !== 'object' ) {\n\t\t\t\t\t\tquery[ key ] = [ query[ key ] ];\n\t\t\t\t\t}\n\n\t\t\t\t\tquery[ key ].push( value );\n\t\t\t\t} else {\n\t\t\t\t\tquery[ key ] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new RouteData( {\n\t\t\troute: this,\n\t\t\tpathname,\n\t\t\tparams,\n\t\t\tquery,\n\t\t\thash: a.hash.slice( 1 ),\n\t\t\tscrollX: target.scrollX,\n\t\t\tscrollY: target.scrollY\n\t\t} );\n\t}\n};\n\nfunction segmentsMatch( a, b ) {\n\tif ( a.length !== b.length )\n\t\treturn;\n\n\tlet i = a.length;\n\twhile ( i -- ) {\n\t\tif ( ( a[i] !== b[i] ) && ( b[i][0] !== ':' ) ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\n//\n//const skip = [ \"isInitial\", \"_route\", \"pathname\", \"params\", \"query\", \"hash\" ];\n//\n//RouteData.prototype.extend = function ( src ) {\n//\tfor ( var nextKey in src ) {\n//\t\tif ( src.hasOwnProperty( nextKey ) ) {\n//\n//\t\t\tif ( skip.indexOf( nextKey ) < 0 ) {\n//\t\t\t\tthis[nextKey] = src[nextKey];\n//\t\t\t}\n//\t\t}\n//\t}\n//\treturn this;\n//};\n\n\nRouteData.prototype.extend = function( target ) {\n\tvar output = Object( target );\n\n\tfor ( var i = 1; i < arguments.length; i++ ) {\n\t\tvar src = arguments[i];\n\t\tif ( src === undefined || src === null )\n\t\t\tcontinue;\n\t\tfor ( var nextKey in src ) {\n\t\t\tif ( src.hasOwnProperty( nextKey ) ) {\n\t\t\t\toutput[nextKey] = src[nextKey];\n\t\t\t}\n\t\t}\n\t}\n\treturn output;\n};","import window from './window.js';\nimport roadtrip from '../roadtrip.js';\nimport routes from '../routes.js';\nimport util from './util.js';\nimport watchHistory from './watchHistory.js';\nimport path from \"./pathHelper.js\";\nimport config from \"./config.js\";\n\n// Adapted from https://github.com/visionmedia/page.js\n// MIT license https://github.com/visionmedia/page.js#license\n\nexport default function watchLinks ( callback ) {\n\twindow.addEventListener( 'click', handler, false );\n\twindow.addEventListener( 'touchstart', handler, false );\n\n\tfunction handler ( event ) {\n\t\tif ( which( event ) !== 1 ) return;\n\t\tif ( event.metaKey || event.ctrlKey || event.shiftKey ) return;\n\t\tif ( event.defaultPrevented ) return;\n\n\t\t// ensure target is a link\n\t\tlet el = event.target;\n\t\twhile ( el && el.nodeName !== 'A' ) {\n\t\t\tel = el.parentNode;\n\t\t}\n\n\t\tif ( !el || el.nodeName !== 'A' ) return;\n\n\t\t// Ignore if tag has\n\t\t// 1. 'download' attribute\n\t\t// 2. rel='external' attribute\n\t\tif ( el.hasAttribute( 'download' ) || el.getAttribute( 'rel' ) === 'external' ) return;\n\n\t\t// ensure non-hash for the same path\n\n\t\t// Check for mailto: in the href\n\t\tif ( ~el.href.indexOf( 'mailto:' ) ) return;\n\n\t\t// check target\n\t\tif ( el.target ) return;\n\n\t\t// x-origin\n\t\tif ( !sameOrigin( el.href ) ) return;\n\n\t\tlet path;\n\n\t\tif (config.useHash) {\n\t\t\tpath = toHash(el);\n\n\t\t} else {\n\t\tpath = el.getAttribute('href');\n\t\t\n\t\t// below is original code which builds up path from the a.href property. Above we instead simply use the <a href> attribute\n\t\t//path = el.pathname + el.search + ( el.hash || '' );\n\t\t}\n\n\t\t// strip leading '/[drive letter]:' on NW.js on Windows\n\t\tif ( typeof process !== 'undefined' && path.match( /^\\/[a-zA-Z]:\\// ) ) {\n\t\t\tpath = path.replace( /^\\/[a-zA-Z]:\\//, '/' );\n\t\t}\n\n\t\t// same page\n\t\t//const orig = path;\n\n\t\t/*\n\t\tif ( config.base && orig === path ) {\n\t\t\treturn;\n\t\t}*/\n\n\t\tpath = util.stripBase(path, config.base);\n\n\t\t// no match? allow navigation\n\t\tlet matchFound = routes.some( route => route.matches( path ) );\n\n\t\tif ( matchFound ) {\n\t\t\tevent.preventDefault();\n\n\t\t\t//path = util.prefixWithBase(path, config.base);\n\t\t\tcallback( path );\n\t\t}\n\n\t\treturn;\n\t}\n}\n\nfunction toHash(link) {\n\tlet href = link.getAttribute('href');\n\thref = path.prefixWithHash(href);\n\treturn href;\n}\n\nfunction which ( event ) {\n\tevent = event || window.event;\n\treturn event.which === null ? event.button : event.which;\n}\n\nfunction sameOrigin ( href ) {\n\tlet origin = location.protocol + '//' + location.hostname;\n\tif ( location.port ) origin += ':' + location.port;\n\n\treturn ( href && ( href.indexOf( origin ) === 0 ) );\n}\n","export default function isSameRoute ( routeA, routeB, dataA, dataB ) {\n\tif ( routeA !== routeB ) {\n\t\treturn false;\n\t}\n\n\treturn (\n\t\tdataA.hash === dataB.hash &&\n\t\tdeepEqual( dataA.params, dataB.params ) &&\n\t\tdeepEqual( dataA.query, dataB.query )\n\t);\n}\n\nfunction deepEqual ( a, b ) {\n\tif ( a === null && b === null ) {\n\t\treturn true;\n\t}\n\n\tif ( isArray( a ) && isArray( b ) ) {\n\t\tlet i = a.length;\n\n\t\tif ( b.length !== i ) return false;\n\n\t\twhile ( i-- ) {\n\t\t\tif ( !deepEqual( a[i], b[i] ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\telse if ( typeof a === 'object' && typeof b === 'object' ) {\n\t\tconst aKeys = Object.keys( a );\n\t\tconst bKeys = Object.keys( b );\n\n\t\tlet i = aKeys.length;\n\n\t\tif ( bKeys.length !== i ) return false;\n\n\t\twhile ( i-- ) {\n\t\t\tconst key = aKeys[i];\n\n\t\t\tif ( !b.hasOwnProperty( key ) || !deepEqual( b[ key ], a[ key ] ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\treturn a === b;\n}\n\nconst toString = Object.prototype.toString;\n\nfunction isArray ( thing ) {\n\treturn toString.call( thing ) === '[object Array]';\n}\n","import Route from './Route.js';\nimport watchLinks from './utils/watchLinks.js';\nimport pathHelper from './utils/pathHelper.js';\nimport isSameRoute from './utils/isSameRoute.js';\nimport window from './utils/window.js';\nimport routes from './routes.js';\nimport watchHistory from './utils/watchHistory.js';\nimport util from './utils/util.js';\nimport config from './utils/config.js';\nimport './utils/polyfill.js';\n\n// Enables HTML5-History-API polyfill: https://github.com/devote/HTML5-History-API\nconst location = window && ( window.history.location || window.location );\n\nfunction noop () {}\n\nlet currentData = {};\nlet currentRoute = {\n\tenter: () => roadtrip.Promise.resolve(),\n\tleave: () => roadtrip.Promise.resolve()\n};\n\nlet _target;\nlet isTransitioning = false;\n\nconst scrollHistory = {};\nlet uniqueID = 1;\nlet currentID = uniqueID;\n\nconst roadtrip = {\n\tPromise,\n\n\tadd ( path, options ) {\n\t\troutes.push( new Route( path, options ) );\n\t\treturn roadtrip;\n\t},\n\n\tstart ( options = {} ) {\n\n\t\tutil.extend( config, options );\n\t\t\n\t\twatchHistory.start(config);\n\t\twatchHistory.setListener(historyListener);\n\n\t\tlet path = pathHelper.getInitialPath();\n\n\t\tlet matchFound = routes.some( route => route.matches( path ) );\n\t\tconst href = matchFound ?\n\t\t\tpath :\n\t\t\tconfig.fallback;\n\n\t\t\tconst internalOptions = {\n\t\t\t\treplaceState: true,\n\t\t\t\tscrollX: window.scrollX,\n\t\t\t\tscrollY: window.scrollY\n\t\t\t};\n\t\t\tconst otherOptions = {};\n\n\t\treturn roadtrip.goto( href, otherOptions, internalOptions);\n\t},\n\n\tgoto ( href, internalOptions = {}) {\n\t\tif (href == null) return roadtrip.Promise.resolve();\n\n\t\thref = pathHelper.getGotoPath(href);\n\n\t\tscrollHistory[ currentID ] = {\n\t\t\tx: window.scrollX,\n\t\t\ty: window.scrollY\n\t\t};\n\n\t\tlet target;\n\t\tconst promise = new roadtrip.Promise( ( fulfil, reject ) => {\n\t\t\ttarget = _target = {\n\t\t\t\thref,\n\t\t\t\tscrollX: internalOptions.scrollX || 0,\n\t\t\t\tscrollY: internalOptions.scrollY || 0,\n\t\t\t\tinternalOptions,\n\t\t\t\tfulfil,\n\t\t\t\treject\n\t\t\t};\n\t\t});\n\t\t\n\t\tpromise._locked = false;\n\t\t\n\t\t_target.promise = promise;\n\t\t\n\t\tif ( isTransitioning ) {\n\t\t\tpromise._locked = true;\n\t\t\treturn promise;\n\t\t}\n\n\t\t_goto( target );\n\n\t\tpromise._sameRoute = target._sameRoute;\n\t\treturn promise;\n\t},\n\n\tgetCurrentRoute () {\n\t\treturn currentData;\n\t}\n};\n\nif ( window ) {\n\twatchLinks( href => {\n\t\troadtrip.goto( href )\n\n\t\t\t.catch(e => {\n\t\t\t\tisTransitioning = false; \n\t\t\t} );\n\t});\n}\n\nfunction getNewData(target) {\n\tlet newData;\n\tlet newRoute;\n\n\tfor ( let i = 0; i < routes.length; i += 1 ) {\n\t\tconst route = routes[i];\n\t\tnewData = route.exec( target );\n\n\t\tif ( newData ) {\n\t\t\tnewRoute = route;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn {\n\t\tnewRoute: newRoute,\n\t\tnewData: newData\n\t};\n}\n\nfunction historyListener(options) {\n\n\t\tlet url = util.stripBase(options.url, config.base);\n\n\tconst internalOptions = {};\n\n\t\t_target = {\n\t\t\thref: url,\n\t\t\thashChange: options.hashChange, // so we know not to manipulate the history\n\t\t\tpopState: options.popState, // so we know not to manipulate the history\n\t\t\tfulfil: noop,\n\t\t\treject: noop,\n\t\t\tinternalOptions\n\t\t};\n\n\t\tif(options.popEvent != null) {\n\t\t\tconst scroll = scrollHistory[ options.popEvent.state.uid ] || {x: 0, y: 0};\n\t\t\t_target.scrollX = scroll.x;\n\t\t\t_target.scrollY = scroll.y;\n\n\t\t} else {\n\t\t\t_target.scrollX = 0;\n\t\t\t_target.scrollY = 0;\n\t\t}\n\n\t\t_goto( _target );\n\n\t\tif(options.popEvent != null) {\n\t\t\tcurrentID = options.popEvent.state.uid;\n\t\t}\n}\n\nfunction _goto ( target ) {\n\tlet newRoute;\n\tlet newData;\n\tlet forceReloadRoute = target.internalOptions.forceReload || false;\n\n\t//let targetHref = util.stripBase(target.href, config.base);\n\ttargetHref = pathHelper.prefixWithSlash(target.href);\n\ttarget.href = targetHref;\n\n\tvar result = getNewData(target);\n\n\tif (!result.newData) {\n\t\t// If we cannot find data, it is because the requested url isn't mapped to a route. Use fallback to render page. Keep url pointing to requested url for \n\t\t// debugging.\n\t\tlet tempHref = target.href;\n\t\ttarget.href = config.fallback;\n\t\tresult = getNewData(target);\n\t\ttarget.href = tempHref;\n\t}\n\n\tnewData = result.newData;\n\tnewRoute = result.newRoute;\n\n\ttarget._sameRoute = false;\n\tif ( !newRoute || (isSameRoute( newRoute, currentRoute, newData, currentData ) && !forceReloadRoute) ) {\n\t\ttarget.fulfil();\n\t\ttarget._sameRoute = true;\n\t\treturn;\n\t}\n\n\tscrollHistory[ currentID ] = {\n\t\tx: ( currentData.scrollX = window.scrollX ),\n\t\ty: ( currentData.scrollY = window.scrollY )\n\t};\n\n\tisTransitioning = true;\n\n\tlet promise;\n\tif ( !forceReloadRoute && ( newRoute === currentRoute ) && newRoute.updateable ) {\n\n\t\t// For updates, copy merge newData into currentData, in order to peserve custom data that was set during enter or beforeenter events\n\t\tnewData = newData.extend({}, currentData, newData);\n\n\t\tpromise = newRoute.update( newData );\n\t} else {\n\t\tpromise = roadtrip.Promise.all([\n\t\t\tcurrentRoute.leave( currentData, newData ),\n\t\t\tnewRoute.beforeenter( newData, currentData )\n\t\t]).then( () => newRoute.enter( newData, currentData ) );\n\t}\n\n\tpromise\n\t\t.then( () => {\n\t\t\tcurrentRoute = newRoute;\n\t\t\tcurrentData = newData;\n\n\t\t\tisTransitioning = false;\n\n\t\t\t// if the user navigated while the transition was taking\n\t\t\t// place, we need to do it all again\n\t\t\tif ( _target !== target ) {\n\t\t\t\t_goto( _target );\n\t\t\t\t_target.promise.then( target.fulfil, target.reject );\n\n\t\t\t} else {\n\t\t\t\ttarget.fulfil();\n\t\t\t}\n\t\t})\n\t\t.catch( e => {\n\t\t\tisTransitioning = false;\n\t\t\ttarget.reject(e);\n\t\t});\n\n\tif ( target.popState || target.hashChange ) return;\n\n\tconst { replaceState, invisible } = target.internalOptions;\n\tif ( invisible ) return;\n\t\n\tconst uid = replaceState ? currentID : ++uniqueID;\n\n\tlet targetHref = target.href;\n\n\tif (watchHistory.useOnHashChange) {\n\t\ttargetHref = pathHelper.prefixWithHash(targetHref);\n\t\ttarget.href = targetHref;\n\t\twatchHistory.setHash( targetHref, target.internalOptions );\n\n\t} else {\n\n\t\tif (config.useHash) {\n\t\t\ttargetHref = pathHelper.prefixWithHash(targetHref);\n\t\t\ttarget.href = targetHref;\n\n\t\t} else {\n\t\t\ttargetHref = pathHelper.prefixWithSlash(targetHref);\n\t\t\t// Add base path for pushstate, as we are routing to an absolute path '/' eg. /base/page1\n\t\t\ttargetHref = util.prefixWithBase(targetHref, config.base);\n\t\t\ttarget.href = targetHref;\n\t\t}\n\n\t\thistory[ target.internalOptions.replaceState ? 'replaceState' : 'pushState' ]( { uid }, '', target.href );\n\t}\n\n\tcurrentID = uid;\n\tscrollHistory[ currentID ] = {\n\t\tx: target.scrollX,\n\t\ty: target.scrollY\n\t};\n}\n\nexport default roadtrip;\n","/*!\n * EventEmitter v4.2.11 - git.io/ee\n * https://github.com/Olical/EventEmitter\n * Unlicense - http://unlicense.org/\n * Oliver Caldwell - http://oli.me.uk/\n * @preserve\n */\n\n    'use strict';\n\n    /**\n     * Class for managing events.\n     * Can be extended to provide event functionality in other classes.\n     *\n     * @class EventEmitter Manages event registering and emitting.\n     */\n    function EventEmitter() {}\n\t\n\n    // Shortcuts to improve speed and size\n    var proto = EventEmitter.prototype;\n\n    /**\n     * Finds the index of the listener for the event in its storage array.\n     *\n     * @param {Function[]} listeners Array of listeners to search through.\n     * @param {Function} listener Method to look for.\n     * @return {Number} Index of the specified listener, -1 if not found\n     * @api private\n     */\n    function indexOfListener(listeners, listener) {\n        var i = listeners.length;\n        while (i--) {\n            if (listeners[i].listener === listener) {\n                return i;\n            }\n        }\n\n        return -1;\n    }\n\n    /**\n     * Alias a method while keeping the context correct, to allow for overwriting of target method.\n     *\n     * @param {String} name The name of the target method.\n     * @return {Function} The aliased method\n     * @api private\n     */\n    function alias(name) {\n        return function aliasClosure() {\n            return this[name].apply(this, arguments);\n        };\n    }\n\n    /**\n     * Returns the listener array for the specified event.\n     * Will initialise the event object and listener arrays if required.\n     * Will return an object if you use a regex search. The object contains keys for each matched event. So /ba[rz]/ might return an object containing bar and baz. But only if you have either defined them with defineEvent or added some listeners to them.\n     * Each property in the object response is an array of listener functions.\n     *\n     * @param {String|RegExp} evt Name of the event to return the listeners from.\n     * @return {Function[]|Object} All listener functions for the event.\n     */\n    proto.getListeners = function getListeners(evt) {\n        var events = this._getEvents();\n        var response;\n        var key;\n\n        // Return a concatenated array of all matching events if\n        // the selector is a regular expression.\n        if (evt instanceof RegExp) {\n            response = {};\n            for (key in events) {\n                if (events.hasOwnProperty(key) && evt.test(key)) {\n                    response[key] = events[key];\n                }\n            }\n        }\n        else {\n            response = events[evt] || (events[evt] = []);\n        }\n\n        return response;\n    };\n\n    /**\n     * Takes a list of listener objects and flattens it into a list of listener functions.\n     *\n     * @param {Object[]} listeners Raw listener objects.\n     * @return {Function[]} Just the listener functions.\n     */\n    proto.flattenListeners = function flattenListeners(listeners) {\n        var flatListeners = [];\n        var i;\n\n        for (i = 0; i < listeners.length; i += 1) {\n            flatListeners.push(listeners[i].listener);\n        }\n\n        return flatListeners;\n    };\n\n    /**\n     * Fetches the requested listeners via getListeners but will always return the results inside an object. This is mainly for internal use but others may find it useful.\n     *\n     * @param {String|RegExp} evt Name of the event to return the listeners from.\n     * @return {Object} All listener functions for an event in an object.\n     */\n    proto.getListenersAsObject = function getListenersAsObject(evt) {\n        var listeners = this.getListeners(evt);\n        var response;\n\n        if (listeners instanceof Array) {\n            response = {};\n            response[evt] = listeners;\n        }\n\n        return response || listeners;\n    };\n\n    /**\n     * Adds a listener function to the specified event.\n     * The listener will not be added if it is a duplicate.\n     * If the listener returns true then it will be removed after it is called.\n     * If you pass a regular expression as the event name then the listener will be added to all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to attach the listener to.\n     * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.addListener = function addListener(evt, listener) {\n        var listeners = this.getListenersAsObject(evt);\n        var listenerIsWrapped = typeof listener === 'object';\n        var key;\n\n        for (key in listeners) {\n            if (listeners.hasOwnProperty(key) && indexOfListener(listeners[key], listener) === -1) {\n                listeners[key].push(listenerIsWrapped ? listener : {\n                    listener: listener,\n                    once: false\n                });\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of addListener\n     */\n    proto.on = alias('addListener');\n\n    /**\n     * Semi-alias of addListener. It will add a listener that will be\n     * automatically removed after its first execution.\n     *\n     * @param {String|RegExp} evt Name of the event to attach the listener to.\n     * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.addOnceListener = function addOnceListener(evt, listener) {\n        return this.addListener(evt, {\n            listener: listener,\n            once: true\n        });\n    };\n\n    /**\n     * Alias of addOnceListener.\n     */\n    proto.once = alias('addOnceListener');\n\n    /**\n     * Defines an event name. This is required if you want to use a regex to add a listener to multiple events at once. If you don't do this then how do you expect it to know what event to add to? Should it just add to every possible match for a regex? No. That is scary and bad.\n     * You need to tell it what event names should be matched by a regex.\n     *\n     * @param {String} evt Name of the event to create.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.defineEvent = function defineEvent(evt) {\n        this.getListeners(evt);\n        return this;\n    };\n\n    /**\n     * Uses defineEvent to define multiple events.\n     *\n     * @param {String[]} evts An array of event names to define.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.defineEvents = function defineEvents(evts) {\n        for (var i = 0; i < evts.length; i += 1) {\n            this.defineEvent(evts[i]);\n        }\n        return this;\n    };\n\n    /**\n     * Removes a listener function from the specified event.\n     * When passed a regular expression as the event name, it will remove the listener from all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to remove the listener from.\n     * @param {Function} listener Method to remove from the event.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.removeListener = function removeListener(evt, listener) {\n\t\tif (listener == null) {\n\t\t\treturn this.removeEvent(evt);\n\t\t}\n        var listeners = this.getListenersAsObject(evt);\n        var index;\n        var key;\n\n        for (key in listeners) {\n            if (listeners.hasOwnProperty(key)) {\n                index = indexOfListener(listeners[key], listener);\n\n                if (index !== -1) {\n                    listeners[key].splice(index, 1);\n                }\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of removeListener\n     */\n    proto.off = alias('removeListener');\n\n    /**\n     * Adds listeners in bulk using the manipulateListeners method.\n     * If you pass an object as the second argument you can add to multiple events at once. The object should contain key value pairs of events and listeners or listener arrays. You can also pass it an event name and an array of listeners to be added.\n     * You can also pass it a regular expression to add the array of listeners to all events that match it.\n     * Yeah, this function does quite a bit. That's probably a bad thing.\n     *\n     * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add to multiple events at once.\n     * @param {Function[]} [listeners] An optional array of listener functions to add.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.addListeners = function addListeners(evt, listeners) {\n        // Pass through to manipulateListeners\n        return this.manipulateListeners(false, evt, listeners);\n    };\n\n    /**\n     * Removes listeners in bulk using the manipulateListeners method.\n     * If you pass an object as the second argument you can remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\n     * You can also pass it an event name and an array of listeners to be removed.\n     * You can also pass it a regular expression to remove the listeners from all events that match it.\n     *\n     * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to remove from multiple events at once.\n     * @param {Function[]} [listeners] An optional array of listener functions to remove.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.removeListeners = function removeListeners(evt, listeners) {\n        // Pass through to manipulateListeners\n        return this.manipulateListeners(true, evt, listeners);\n    };\n\n    /**\n     * Edits listeners in bulk. The addListeners and removeListeners methods both use this to do their job. You should really use those instead, this is a little lower level.\n     * The first argument will determine if the listeners are removed (true) or added (false).\n     * If you pass an object as the second argument you can add/remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\n     * You can also pass it an event name and an array of listeners to be added/removed.\n     * You can also pass it a regular expression to manipulate the listeners of all events that match it.\n     *\n     * @param {Boolean} remove True if you want to remove listeners, false if you want to add.\n     * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add/remove from multiple events at once.\n     * @param {Function[]} [listeners] An optional array of listener functions to add/remove.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.manipulateListeners = function manipulateListeners(remove, evt, listeners) {\n        var i;\n        var value;\n        var single = remove ? this.removeListener : this.addListener;\n        var multiple = remove ? this.removeListeners : this.addListeners;\n\n        // If evt is an object then pass each of its properties to this method\n        if (typeof evt === 'object' && !(evt instanceof RegExp)) {\n            for (i in evt) {\n                if (evt.hasOwnProperty(i) && (value = evt[i])) {\n                    // Pass the single listener straight through to the singular method\n                    if (typeof value === 'function') {\n                        single.call(this, i, value);\n                    }\n                    else {\n                        // Otherwise pass back to the multiple function\n                        multiple.call(this, i, value);\n                    }\n                }\n            }\n        }\n        else {\n            // So evt must be a string\n            // And listeners must be an array of listeners\n            // Loop over it and pass each one to the multiple method\n            i = listeners.length;\n            while (i--) {\n                single.call(this, evt, listeners[i]);\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Removes all listeners from a specified event.\n     * If you do not specify an event then all listeners will be removed.\n     * That means every event will be emptied.\n     * You can also pass a regex to remove all events that match it.\n     *\n     * @param {String|RegExp} [evt] Optional name of the event to remove all listeners for. Will remove from every event if not passed.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.removeEvent = function removeEvent(evt) {\n        var type = typeof evt;\n        var events = this._getEvents();\n        var key;\n\n        // Remove different things depending on the state of evt\n        if (type === 'string') {\n            // Remove all listeners for the specified event\n            delete events[evt];\n        }\n        else if (evt instanceof RegExp) {\n            // Remove all events matching the regex.\n            for (key in events) {\n                if (events.hasOwnProperty(key) && evt.test(key)) {\n                    delete events[key];\n                }\n            }\n        }\n        else {\n            // Remove all listeners in all events\n            delete this._events;\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of removeEvent.\n     *\n     * Added to mirror the node API.\n     */\n    proto.removeAllListeners = alias('removeEvent');\n\n    /**\n     * Emits an event of your choice.\n     * When emitted, every listener attached to that event will be executed.\n     * If you pass the optional argument array then those arguments will be passed to every listener upon execution.\n     * Because it uses `apply`, your array of arguments will be passed as if you wrote them out separately.\n     * So they will not arrive within the array on the other side, they will be separate.\n     * You can also pass a regular expression to emit to all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\n     * @param {Array} [args] Optional array of arguments to be passed to each listener.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.emitEvent = function emitEvent(that, evt, args) {\n\t\t// NOTE: customized this method\n        var listenersMap = this.getListenersAsObject(evt);\n        var listeners;\n        var listener;\n        var i;\n        var key;\n        var response;\n\n        for (key in listenersMap) {\n            if (listenersMap.hasOwnProperty(key)) {\n                listeners = listenersMap[key].slice(0);\n                i = listeners.length;\n\n                while (i--) {\n                    // If the listener returns true then it shall be removed from the event\n                    // The function is executed either with a basic call or an apply if there is an args array\n                    listener = listeners[i];\n\n                    if (listener.once === true) {\n                        this.removeListener(evt, listener.listener);\n                    }\n\n                    response = listener.listener.apply(that, args || []);\n\n                    if (response === this._getOnceReturnValue()) {\n                        this.removeListener(evt, listener.listener);\n                    }\n                }\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of emitEvent\n     */\n    proto.trigger = alias('emitEvent');\n\n    /**\n     * Subtly different from emitEvent in that it will pass its arguments on to the listeners, as opposed to taking a single array of arguments to pass on.\n     * As with emitEvent, you can pass a regex in place of the event name to emit to all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\n     * @param {...*} Optional additional arguments to be passed to each listener.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.emit = function emit(that, evt) {\n\t\t// NOTE: customized this method\n        var args = Array.prototype.slice.call(arguments, 2);\n        return this.emitEvent(that, evt, args);\n    };\n\n    /**\n     * Sets the current value to check against when executing listeners. If a\n     * listeners return value matches the one set here then it will be removed\n     * after execution. This value defaults to true.\n     *\n     * @param {*} value The new value to check for when executing listeners.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.setOnceReturnValue = function setOnceReturnValue(value) {\n        this._onceReturnValue = value;\n        return this;\n    };\n\n    /**\n     * Fetches the current value to check against when executing listeners. If\n     * the listeners return value matches this one then it should be removed\n     * automatically. It will return true by default.\n     *\n     * @return {*|Boolean} The current value to check for or the default, true.\n     * @api private\n     */\n    proto._getOnceReturnValue = function _getOnceReturnValue() {\n        if (this.hasOwnProperty('_onceReturnValue')) {\n            return this._onceReturnValue;\n        }\n        else {\n            return true;\n        }\n    };\n\n    /**\n     * Fetches the events object and creates one if required.\n     *\n     * @return {Object} The events storage object.\n     * @api private\n     */\n    proto._getEvents = function _getEvents() {\n        return this._events || (this._events = {});\n    };\n\n    if (typeof module === 'object' && module.exports) {\n        module.exports = EventEmitter;\n    }\n    \n\nexport default EventEmitter;\n\n","import mode from \"./mode\";\nvar rbracket = /\\[\\]$/;\nvar r20 = /%20/g;\nvar utils = {\n\n\tisFunction: function ( val ) {\n\t\treturn typeof val === 'function';\n\t},\n\n\tfadeIn: function ( el ) {\n\t\tel.style.opacity = 0;\n\t\tvar last = + new Date( );\n\t\tvar tick = function ( ) {\n\t\t\tel.style.opacity = + el.style.opacity + ( new Date( ) - last ) / 400;\n\t\t\tlast = + new Date( );\n\t\t\tif ( + el.style.opacity < 1 ) {\n\t\t\t\t( window.requestAnimationFrame && requestAnimationFrame( tick ) ) || setTimeout( tick, 16 )\n\t\t\t}\n\t\t};\n\t\ttick( );\n\t},\n\n\tfadeOut: function ( el ) {\n\t\tel.style.opacity = 0;\n\t\tvar last = + new Date( );\n\t\tvar tick = function ( ) {\n\t\t\tel.style.opacity = + el.style.opacity + ( new Date( ) - last ) / 400;\n\t\t\tlast = + new Date( );\n\t\t\tif ( + el.style.opacity < 1 ) {\n\t\t\t\t( window.requestAnimationFrame && requestAnimationFrame( tick ) ) || setTimeout( tick, 16 )\n\t\t\t}\n\t\t};\n\t\ttick( );\n\t},\n\n\t// Serialize an array of form elements or a set of key/values into a query string\n\tparam: function ( a, traditional ) {\n\t\tvar prefix,\n\t\t\t\ts = [ ],\n\t\t\t\tadd = function ( key, value ) {\n\t\t\t\t\t// If value is a function, invoke it and return its value\n\t\t\t\t\tvalue = ( typeof value === 'function' ) ? value( ) : ( value == null ? \"\" : value );\n\t\t\t\t\ts[ s.length ] = encodeURIComponent( key ) + \"=\" + encodeURIComponent( value );\n\t\t\t\t};\n\t\t// If an array was passed in, assume that it is an array of form elements.\n\t\tif ( Array.isArray( a ) ) {\n\t\t\t// Serialize the form elements\n\t\t\ta.forEach( function ( item, index ) {\n\t\t\t\tadd( item.name, item.value );\n\t\t\t} );\n\t\t} else {\n\t\t\t// If traditional, encode the \"old\" way (the way 1.3.2 or older\n\t\t\t// did it), otherwise encode params recursively.\n\t\t\tfor ( prefix in a ) {\n\n\t\t\t\tbuildParams( prefix, a[ prefix ], traditional, add );\n\t\t\t}\n\t\t}\n\n\t\t// Return the resulting serialization\n\t\treturn s.join( \"&\" ).replace( r20, \"+\" );\n\t},\n\n\tlog: function ( ) {\n\t\tif ( mode.DEBUG ) {\n\t\t\tFunction.apply.call( console.log, console, arguments );\n\t\t}\n\t},\n\n\tlogWarn: function ( ) {\n\t\tif ( mode.DEBUG ) {\n\t\t\tFunction.apply.call( console.info, console, arguments );\n\t\t}\n\t},\n\n\tlogInfo: function ( ) {\n\t\tif ( mode.DEBUG ) {\n\t\t\tFunction.apply.call( console.warn, console, arguments );\n\t\t}\n\t},\n\n\tlogError: function ( ) {\n\t\tif ( mode.DEBUG ) {\n\t\t\tFunction.apply.call( console.error, console, arguments );\n\t\t}\n\t}\n};\n\nfunction buildParams( prefix, obj, traditional, add ) {\n\tvar name;\n\tif ( Array.isArray( obj ) ) {\n\t\t// Serialize array item.\n\t\tobj.forEach( function ( item, index ) {\n\t\t\tif ( traditional || rbracket.test( prefix ) ) {\n\t\t\t\t// Treat each array item as a scalar.\n\t\t\t\tadd( prefix, item );\n\t\t\t} else {\n\t\t\t\t// Item is non-scalar (array or object), encode its numeric index.\n\t\t\t\tbuildParams( prefix + \"[\" + ( typeof item === \"object\" ? index : \"\" ) + \"]\", item, traditional, add );\n\t\t\t}\n\t\t} );\n\t} else if ( ! traditional && type( obj ) === \"object\" ) {\n\t\tdebugger;\n\t\t// Serialize object item.\n\t\tfor ( name in obj ) {\n\t\t\tbuildParams( prefix + \"[\" + name + \"]\", obj[ name ], traditional, add );\n\t\t}\n\n\t} else {\n\t\t// Serialize scalar item.\n\t\tadd( prefix, obj );\n\t}\n}\n\nfunction type( obj ) {\n\treturn Object.prototype.toString.call( obj ).replace( /^\\[object (.+)\\]$/, \"$1\" ).toLowerCase( );\n}\n\nexport default utils;\n","import eventer from \"./eventer\";\nimport utils from  \"../utils/util\";\n\nvar callstack = [ ];\n\nvar resetRequest = false;\n\nsetupListeners();\n\nvar handler = {\n\n\t//init: ( options ) => {\n\t//},\n\n\tcheck: () => {\n\t\tif ( callstack.length > 1 ) {\n\t\t\teventer.emit( \"routeAbuseStart\" );\n\n\t\t\t// After a short delay we check if the callstack is back to normal.\n\t\t\t// If at the end of the dely the callstack is normal, we emit \"callstackNormal\" event.\n\t\t\t// If the callstack overflows again during the delay, we cancel the reset request\n\t\t\t// and begin a new reset request after a delay.\n\t\t\tvar delay = 2000;\n\t\t\tresetWhenNormal( delay );\n\t\t}\n\t},\n\treset: () => {\n\t\tcallstack = [ ];\n\t\teventer.emit( \"routeAbuseEnd\" );\n\t},\n\n\tpush: () => {\n\t\tcallstack.push( 1 );\n\t\thandler.check();\n\t},\n\n\tpop: () => {\n\t\tcallstack.splice( 0, 1 );\n\t\tif ( callstack.length === 0 ) {\n\t\t}\n\t}\n};\n\nfunction setupListeners() {\n\n\teventer.on( \"goto\", ( options ) => {\n\t\thandler.push();\n\t} );\n\n\n\teventer.on( \"error\", ( options ) => {\n\t\thandler.pop();\n\t} );\n\n\teventer.on( \"entered\", ( options ) => {\n\t\thandler.pop();\n\t} );\n\n\teventer.on( \"updated\", ( options ) => {\n\t\thandler.pop();\n\t} );\n}\n\nfunction resetWhenNormal( delay = 2000 ) {\n\n\t// if a request was already made to reenable animations, clear it and make a new request\n\tif ( resetRequest ) {\n\t\tclearTimeout( resetRequest );\n\t}\n\n\t// We wait a bit before restting callstack in case user is still thrashing UI.\n\tresetRequest = setTimeout( function ( ) {\n\t\thandler.reset( );\n\t}, delay );\n}\n\nexport default handler;\n","import roadtrip from  \"../roadtrip/roadtrip\";\nimport eventer from \"./handler/eventer\";\nimport journeyUtils from \"./utils/util.js\";\nimport roadtripUtils from \"../roadtrip/utils/util.js\";\nimport mode from \"./utils/mode\";\nimport events from \"./utils/events\";\nimport \"./handler/routeAbuseMonitor\";\nimport config from \"./utils/config.js\";\n\n// Enables HTML5-History-API polyfill: https://github.com/devote/HTML5-History-API\nconst location = window && ( window.history.location || window.location );\n\nvar journey = {\t};\n\neventer.init( journey );\n\njourney.add = function add( path, options ) {\n\t\n\tif (path == null) {\n\t\tthrow new Error(\"journey.add does not accept 'null' path\");\n\t}\n\t\n\tif (options == null) {\n\t\tthrow new Error(\"journey.add does not accept 'null' options\");\n\t}\n\t\n\toptions = roadtripUtils.extend( { }, options );\n\twrap( options );\n\n\troadtrip.add( path, options );\n\n\treturn journey;\n};\n\njourney.start = function( options ) {\n\n\troadtripUtils.extend( config, options );\n\n\tmode.DEBUG = config.debug;\n\t\n\twrapRoadtripGoto();\n\n\treturn roadtrip.start( options );\n};\n\njourney.goto = function ( href, internalOptions = {}) {\n\tif (roadtrip._origGoto == null) {\n\t\tthrow new Error(\"call start() before using journey\");\n\t}\n\t\tvar promise = roadtrip._origGoto( href, internalOptions );\n\n\tif (promise._sameRoute) {\n\t\treturn promise;\n\t}\n\n\tjourney.emit( journey, \"goto\", {href: location.href} );\n\n\t//routeAbuseMonitor.push();\n\t//callstack.check();\n\n\treturn promise;\n};\n\njourney.getBase = function( ) {\n\treturn roadtrip.base;\n};\n\njourney.getCurrentRoute = function( ) {\n\treturn roadtrip.getCurrentRoute();\n};\n\nfunction raiseError( options ) {\n\tjourneyUtils.logError( options.error );\n\tjourney.emit( journey, \"error\", options );\n}\n\nfunction raiseEvent( event, args ) {\n\tvar options = { };\n\tif ( event === events.UPDATE || event === events.UPDATED ) {\n\t\toptions.route = args[0];\n\t\toptions.options = args[1];\n\n\t} else if ( event === events.BEFORE_ENTER || event === events.BEFORE_ENTER_COMPLETE ) {\n\t\toptions.to = args[0];\n\t\toptions.from = args[1];\n\t\toptions.options = args[2];\n\n\t} else if ( event === events.ENTER || event === events.ENTERED ) {\n\t\toptions.to = args[0];\n\t\toptions.from = args[1];\n\t\toptions.options = args[2];\n\n\t} else if ( event === events.LEAVE || event === events.LEFT ) {\n\t\toptions.from = args[0];\n\t\toptions.to = args[1];\n\t\toptions.options = args[2];\n\t}\n\n\tjourney.emit( journey, event, options );\n}\n\nfunction wrap( options ) {\n\tenhanceEvent( events.ENTER, options );\n\tenhanceEvent( events.UPDATE, options );\n\tenhanceEvent( events.BEFORE_ENTER, options );\n\tenhanceEvent( events.LEAVE, options );\n}\n\nfunction enhanceEvent( name, options ) {\n\tvar handler = options[name];\n\n\tif ( handler == null ) {\n\t\treturn;\n\t}\n\n\tvar wrapper = function ( ) {\n\t\tvar that = this;\n\t\t//var thatArgs = arguments;\n\n\t\t// Handle errors thrown by handler: enter, leave, update or beforeenter\n\t\ttry {\n\t\t\t// convert arguments into a proper array\n\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\n\t\t\tvar options = {};\n\t\t\t\n\t\t\tif (name === events.UPDATE) { // update only accepts one argument\n\t\t\t\targs[1] = options;\n\t\t\t\t/*\n\t\t\t\tif (options == null) {\n\t\t\t\t\toptions = args[1] = {};\n\t\t\t\t}*/\n\n\t\t\t} else {\n\t\t\t\targs[2] = options;\n\t\t\t\t/*\n\t\t\t\tif (options == null) {\n\t\t\t\t\toptions = args[2] = {};\n\t\t\t\t}*/\n\t\t\t}\n\n\t\t\t// Ensure default target is passed to events, but don't override if already present\n\t\t\toptions.target = config.target;\n\t\t\toptions.startOptions = config;\n\n\t\t\traiseEvent( name, args );\n\n\t\t\t// Call handler\n\t\t\tvar result = handler.apply( that, args );\n\n\t\t\tresult = Promise.all( [ result ] ); // Ensure handler result can be handled as promise\n\t\t\tresult.then( () => {\n\n\t\t\t\tif ( name === events.BEFORE_ENTER ) {\n\t\t\t\t\traiseEvent( events.BEFORE_ENTER_COMPLETE, args );\n\n\t\t\t\t} else if ( name === events.ENTER ) {\n\t\t\t\t\traiseEvent( events.ENTERED, args );\n\n\t\t\t\t} else if ( name === events.LEAVE ) {\n\t\t\t\t\traiseEvent( events.LEFT, args );\n\n\t\t\t\t} else if ( name === events.UPDATE ) {\n\t\t\t\t\traiseEvent( events.UPDATED, args );\n\t\t\t\t}\n\t\t\t} ).catch( err => {\n\t\t\t\tvar options = gatherErrorOptions( name, args, err );\n\t\t\t\traiseError( options );\n\t\t\t} );\n\n\t\t\treturn result;\n\n\t\t} catch ( err ) {\n\t\t\tvar options = gatherErrorOptions( name, args, err );\n\t\t\traiseError( options );\n\t\t\treturn Promise.reject( \"error occurred in [\" + name + \"] - \" + err.message ); // let others handle further up the stack\n\t\t}\n\t};\n\n\toptions[name] = wrapper;\n}\n\nfunction gatherErrorOptions( event, args, err ) {\n\tvar route, from, to;\n\n\tif ( event === events.UPDATE ) {\n\t\troute = args[0];\n\n\t} else if ( event === events.BEFORE_ENTER || event === events.ENTER ) {\n\t\troute = args[0];\n\t\tto = args[0];\n\t\tfrom = args[1];\n\t} else {\n\t\troute = args[1];\n\t\tto = args[1];\n\t\tfrom = args[0];\n\t}\n\tvar options = { error: err, event: event, from: from, to: to, route: route };\n\treturn options;\n\n}\n\nfunction wrapRoadtripGoto() {\n\t// Ensure to only wrap goto once, in case journey.start is called more than once\n\tif (roadtrip._origGoto != null) return;\n\n\troadtrip._origGoto = roadtrip.goto;\n\troadtrip.goto = journey.goto;\n\n\t\n}\n\nexport default journey;\n\n","const toString = Object.prototype.toString;\r\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\r\n\r\nexport function isArrayLike ( obj ) {\r\n\treturn arrayLikePattern.test( toString.call( obj ) );\r\n}\r\n\r\nexport function isEqual ( a, b ) {\r\n\tif ( a === null && b === null ) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif ( typeof a === 'object' || typeof b === 'object' ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn a === b;\r\n}\r\n\r\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\r\nexport function isNumeric ( thing ) {\r\n\treturn !isNaN( parseFloat( thing ) ) && isFinite( thing );\r\n}\r\n\r\nexport function isObject ( thing ) {\r\n\treturn ( thing && toString.call( thing ) === '[object Object]' );\r\n}\r\n\r\nexport function isObjectLike ( thing ) {\r\n\tif ( !thing ) return false;\r\n\tconst type = typeof thing;\r\n\tif ( type === 'object' || type === 'function' ) return true;\r\n}\r\n","/* global console */\r\n/* eslint no-console:\"off\" */\r\n\r\nimport { hasConsole } from '../config/environment';\r\nimport Ractive from '../Ractive';\r\nimport noop from './noop';\r\n\r\nconst alreadyWarned = {};\r\nlet log, printWarning, welcome;\r\n\r\nif ( hasConsole ) {\r\n\tconst welcomeIntro = [\r\n\t\t`%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\r\n\t\t'color: rgb(114, 157, 52); font-weight: normal;',\r\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\r\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\r\n\t\t'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\r\n\t];\r\n\tconst welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\r\n\r\nTo disable debug mode, add this line at the start of your app:\r\n  Ractive.DEBUG = false;\r\n\r\nTo disable debug mode when your app is minified, add this snippet:\r\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\r\n\r\nGet help and support:\r\n  http://docs.ractivejs.org\r\n  http://stackoverflow.com/questions/tagged/ractivejs\r\n  http://groups.google.com/forum/#!forum/ractive-js\r\n  http://twitter.com/ractivejs\r\n\r\nFound a bug? Raise an issue:\r\n  https://github.com/ractivejs/ractive/issues\r\n\r\n`;\r\n\r\n\twelcome = () => {\r\n\t\tif ( Ractive.WELCOME_MESSAGE === false ) {\r\n\t\t\twelcome = noop;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\r\n\t\tconst hasGroup = !!console.groupCollapsed;\r\n\t\tif ( hasGroup ) console.groupCollapsed.apply( console, welcomeIntro );\r\n\t\tconsole.log( message );\r\n\t\tif ( hasGroup ) {\r\n\t\t\tconsole.groupEnd( welcomeIntro );\r\n\t\t}\r\n\r\n\t\twelcome = noop;\r\n\t};\r\n\r\n\tprintWarning = ( message, args ) => {\r\n\t\twelcome();\r\n\r\n\t\t// extract information about the instance this message pertains to, if applicable\r\n\t\tif ( typeof args[ args.length - 1 ] === 'object' ) {\r\n\t\t\tconst options = args.pop();\r\n\t\t\tconst ractive = options ? options.ractive : null;\r\n\r\n\t\t\tif ( ractive ) {\r\n\t\t\t\t// if this is an instance of a component that we know the name of, add\r\n\t\t\t\t// it to the message\r\n\t\t\t\tlet name;\r\n\t\t\t\tif ( ractive.component && ( name = ractive.component.name ) ) {\r\n\t\t\t\t\tmessage = `<${name}> ${message}`;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet node;\r\n\t\t\t\tif ( node = ( options.node || ( ractive.fragment && ractive.fragment.rendered && ractive.find( '*' ) ) ) ) {\r\n\t\t\t\t\targs.push( node );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.warn.apply( console, [ '%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);' ].concat( args ) );\r\n\t};\r\n\r\n\tlog = function () {\r\n\t\tconsole.log.apply( console, arguments );\r\n\t};\r\n} else {\r\n\tprintWarning = log = welcome = noop;\r\n}\r\n\r\nfunction format ( message, args ) {\r\n\treturn message.replace( /%s/g, () => args.shift() );\r\n}\r\n\r\nfunction fatal ( message, ...args ) {\r\n\tmessage = format( message, args );\r\n\tthrow new Error( message );\r\n}\r\n\r\nfunction logIfDebug () {\r\n\tif ( Ractive.DEBUG ) {\r\n\t\tlog.apply( null, arguments );\r\n\t}\r\n}\r\n\r\nfunction warn ( message, ...args ) {\r\n\tmessage = format( message, args );\r\n\tprintWarning( message, args );\r\n}\r\n\r\nfunction warnOnce ( message, ...args ) {\r\n\tmessage = format( message, args );\r\n\r\n\tif ( alreadyWarned[ message ] ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\talreadyWarned[ message ] = true;\r\n\tprintWarning( message, args );\r\n}\r\n\r\nfunction warnIfDebug () {\r\n\tif ( Ractive.DEBUG ) {\r\n\t\twarn.apply( null, arguments );\r\n\t}\r\n}\r\n\r\nfunction warnOnceIfDebug () {\r\n\tif ( Ractive.DEBUG ) {\r\n\t\twarnOnce.apply( null, arguments );\r\n\t}\r\n}\r\n\r\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\r\n","export function findInViewHierarchy ( registryName, ractive, name ) {\r\n\tconst instance = findInstance( registryName, ractive, name );\r\n\treturn instance ? instance[ registryName ][ name ] : null;\r\n}\r\n\r\nexport function findInstance ( registryName, ractive, name ) {\r\n\twhile ( ractive ) {\r\n\t\tif ( name in ractive[ registryName ] ) {\r\n\t\t\treturn ractive;\r\n\t\t}\r\n\r\n\t\tif ( ractive.isolated ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tractive = ractive.parent;\r\n\t}\r\n}","import { fatal } from '../utils/log';\r\nimport { missingPlugin } from '../config/errors';\r\nimport interpolators from '../Ractive/static/interpolators';\r\nimport { findInViewHierarchy } from './registry';\r\n\r\nexport default function interpolate ( from, to, ractive, type ) {\r\n\tif ( from === to ) return null;\r\n\r\n\tif ( type ) {\r\n\t\tconst interpol = findInViewHierarchy( 'interpolators', ractive, type );\r\n\t\tif ( interpol ) return interpol( from, to ) || null;\r\n\r\n\t\tfatal( missingPlugin( type, 'interpolator' ) );\r\n\t}\r\n\r\n\treturn interpolators.number( from, to ) ||\r\n\t       interpolators.array( from, to ) ||\r\n\t       interpolators.object( from, to ) ||\r\n\t       null;\r\n}\r\n","import { isObject, isNumeric } from '../../utils/is';\r\nimport interpolate from '../../shared/interpolate';\r\n\r\nfunction snap ( to ) {\r\n\treturn () => to;\r\n}\r\n\r\nconst interpolators = {\r\n\tnumber ( from, to ) {\r\n\t\tif ( !isNumeric( from ) || !isNumeric( to ) ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfrom = +from;\r\n\t\tto = +to;\r\n\r\n\t\tconst delta = to - from;\r\n\r\n\t\tif ( !delta ) {\r\n\t\t\treturn function () { return from; };\r\n\t\t}\r\n\r\n\t\treturn function ( t ) {\r\n\t\t\treturn from + ( t * delta );\r\n\t\t};\r\n\t},\r\n\r\n\tarray ( from, to ) {\r\n\t\tlet len, i;\r\n\r\n\t\tif ( !Array.isArray( from ) || !Array.isArray( to ) ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst intermediate = [];\r\n\t\tconst interpolators = [];\r\n\r\n\t\ti = len = Math.min( from.length, to.length );\r\n\t\twhile ( i-- ) {\r\n\t\t\tinterpolators[i] = interpolate( from[i], to[i] );\r\n\t\t}\r\n\r\n\t\t// surplus values - don't interpolate, but don't exclude them either\r\n\t\tfor ( i=len; i<from.length; i+=1 ) {\r\n\t\t\tintermediate[i] = from[i];\r\n\t\t}\r\n\r\n\t\tfor ( i=len; i<to.length; i+=1 ) {\r\n\t\t\tintermediate[i] = to[i];\r\n\t\t}\r\n\r\n\t\treturn function ( t ) {\r\n\t\t\tlet i = len;\r\n\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tintermediate[i] = interpolators[i]( t );\r\n\t\t\t}\r\n\r\n\t\t\treturn intermediate;\r\n\t\t};\r\n\t},\r\n\r\n\tobject ( from, to ) {\r\n\t\tif ( !isObject( from ) || !isObject( to ) ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst properties = [];\r\n\t\tconst intermediate = {};\r\n\t\tconst interpolators = {};\r\n\r\n\t\tfor ( const prop in from ) {\r\n\t\t\tif ( from.hasOwnProperty( prop ) ) {\r\n\t\t\t\tif ( to.hasOwnProperty( prop ) ) {\r\n\t\t\t\t\tproperties.push( prop );\r\n\t\t\t\t\tinterpolators[ prop ] = interpolate( from[ prop ], to[ prop ] ) || snap( to[ prop ] );\r\n\t\t\t\t}\r\n\r\n\t\t\t\telse {\r\n\t\t\t\t\tintermediate[ prop ] = from[ prop ];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor ( const prop in to ) {\r\n\t\t\tif ( to.hasOwnProperty( prop ) && !from.hasOwnProperty( prop ) ) {\r\n\t\t\t\tintermediate[ prop ] = to[ prop ];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst len = properties.length;\r\n\r\n\t\treturn function ( t ) {\r\n\t\t\tlet i = len;\r\n\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tconst prop = properties[i];\r\n\r\n\t\t\t\tintermediate[ prop ] = interpolators[ prop ]( t );\r\n\t\t\t}\r\n\r\n\t\t\treturn intermediate;\r\n\t\t};\r\n\t}\r\n};\r\n\r\nexport default interpolators;\r\n","export function addToArray ( array, value ) {\r\n\tconst index = array.indexOf( value );\r\n\r\n\tif ( index === -1 ) {\r\n\t\tarray.push( value );\r\n\t}\r\n}\r\n\r\nexport function arrayContains ( array, value ) {\r\n\tfor ( let i = 0, c = array.length; i < c; i++ ) {\r\n\t\tif ( array[i] == value ) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nexport function arrayContentsMatch ( a, b ) {\r\n\tlet i;\r\n\r\n\tif ( !Array.isArray( a ) || !Array.isArray( b ) ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif ( a.length !== b.length ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\ti = a.length;\r\n\twhile ( i-- ) {\r\n\t\tif ( a[i] !== b[i] ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nexport function ensureArray ( x ) {\r\n\tif ( typeof x === 'string' ) {\r\n\t\treturn [ x ];\r\n\t}\r\n\r\n\tif ( x === undefined ) {\r\n\t\treturn [];\r\n\t}\r\n\r\n\treturn x;\r\n}\r\n\r\nexport function lastItem ( array ) {\r\n\treturn array[ array.length - 1 ];\r\n}\r\n\r\nexport function removeFromArray ( array, member ) {\r\n\tif ( !array ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst index = array.indexOf( member );\r\n\r\n\tif ( index !== -1 ) {\r\n\t\tarray.splice( index, 1 );\r\n\t}\r\n}\r\n\r\nexport function combine ( ...arrays ) {\r\n\tconst res = arrays.concat.apply( [], arrays );\r\n\tlet i = res.length;\r\n\twhile ( i-- ) {\r\n\t\tconst idx = res.indexOf( res[i] );\r\n\t\tif ( ~idx && idx < i ) res.splice( i, 1 );\r\n\t}\r\n\r\n\treturn res;\r\n}\r\n\r\nexport function toArray ( arrayLike ) {\r\n\tconst array = [];\r\n\tlet i = arrayLike.length;\r\n\twhile ( i-- ) {\r\n\t\tarray[i] = arrayLike[i];\r\n\t}\r\n\r\n\treturn array;\r\n}\r\n\r\nexport function findMap ( array, fn ) {\r\n\tconst len = array.length;\r\n\tfor ( let i = 0; i < len; i++ ) {\r\n\t\tconst result = fn( array[i] );\r\n\t\tif ( result ) return result;\r\n\t}\r\n}\r\n","import { removeFromArray } from '../utils/array';\r\n\r\nexport default class TransitionManager {\r\n\tconstructor ( callback, parent ) {\r\n\t\tthis.callback = callback;\r\n\t\tthis.parent = parent;\r\n\r\n\t\tthis.intros = [];\r\n\t\tthis.outros = [];\r\n\r\n\t\tthis.children = [];\r\n\t\tthis.totalChildren = this.outroChildren = 0;\r\n\r\n\t\tthis.detachQueue = [];\r\n\t\tthis.outrosComplete = false;\r\n\r\n\t\tif ( parent ) {\r\n\t\t\tparent.addChild( this );\r\n\t\t}\r\n\t}\r\n\r\n\tadd ( transition ) {\r\n\t\tconst list = transition.isIntro ? this.intros : this.outros;\r\n\t\ttransition.starting = true;\r\n\t\tlist.push( transition );\r\n\t}\r\n\r\n\taddChild ( child ) {\r\n\t\tthis.children.push( child );\r\n\r\n\t\tthis.totalChildren += 1;\r\n\t\tthis.outroChildren += 1;\r\n\t}\r\n\r\n\tdecrementOutros () {\r\n\t\tthis.outroChildren -= 1;\r\n\t\tcheck( this );\r\n\t}\r\n\r\n\tdecrementTotal () {\r\n\t\tthis.totalChildren -= 1;\r\n\t\tcheck( this );\r\n\t}\r\n\r\n\tdetachNodes () {\r\n\t\tthis.detachQueue.forEach( detach );\r\n\t\tthis.children.forEach( _detachNodes );\r\n\t\tthis.detachQueue = [];\r\n\t}\r\n\r\n\tready () {\r\n\t\tif ( this.detachQueue.length ) detachImmediate( this );\r\n\t}\r\n\r\n\tremove ( transition ) {\r\n\t\tconst list = transition.isIntro ? this.intros : this.outros;\r\n\t\tremoveFromArray( list, transition );\r\n\t\tcheck( this );\r\n\t}\r\n\r\n\tstart () {\r\n\t\tthis.children.forEach( c => c.start() );\r\n\t\tthis.intros.concat( this.outros ).forEach( t => t.start() );\r\n\t\tthis.ready = true;\r\n\t\tcheck( this );\r\n\t}\r\n}\r\n\r\nfunction detach ( element ) {\r\n\telement.detach();\r\n}\r\n\r\nfunction _detachNodes ( tm ) { // _ to avoid transpiler quirk\r\n\ttm.detachNodes();\r\n}\r\n\r\nfunction check ( tm ) {\r\n\tif ( !tm.ready || tm.outros.length || tm.outroChildren ) return;\r\n\r\n\t// If all outros are complete, and we haven't already done this,\r\n\t// we notify the parent if there is one, otherwise\r\n\t// start detaching nodes\r\n\tif ( !tm.outrosComplete ) {\r\n\t\ttm.outrosComplete = true;\r\n\r\n\t\tif ( tm.parent && !tm.parent.outrosComplete ) {\r\n\t\t\ttm.parent.decrementOutros( tm );\r\n\t\t} else {\r\n\t\t\ttm.detachNodes();\r\n\t\t}\r\n\t}\r\n\r\n\t// Once everything is done, we can notify parent transition\r\n\t// manager and call the callback\r\n\tif ( !tm.intros.length && !tm.totalChildren ) {\r\n\t\tif ( typeof tm.callback === 'function' ) {\r\n\t\t\ttm.callback();\r\n\t\t}\r\n\r\n\t\tif ( tm.parent && !tm.notifiedTotal ) {\r\n\t\t\ttm.notifiedTotal = true;\r\n\t\t\ttm.parent.decrementTotal();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// check through the detach queue to see if a node is up or downstream from a\r\n// transition and if not, go ahead and detach it\r\nfunction detachImmediate ( manager ) {\r\n\tconst queue = manager.detachQueue;\r\n\tconst outros = collectAllOutros( manager );\r\n\r\n\tlet i = queue.length;\r\n\tlet j = 0;\r\n\tlet node, trans;\r\n\tstart: while ( i-- ) {\r\n\t\tnode = queue[i].node;\r\n\t\tj = outros.length;\r\n\t\twhile ( j-- ) {\r\n\t\t\ttrans = outros[j].element.node;\r\n\t\t\t// check to see if the node is, contains, or is contained by the transitioning node\r\n\t\t\tif ( trans === node || trans.contains( node ) || node.contains( trans ) ) continue start;\r\n\t\t}\r\n\r\n\t\t// no match, we can drop it\r\n\t\tqueue[i].detach();\r\n\t\tqueue.splice( i, 1 );\r\n\t}\r\n}\r\n\r\nfunction collectAllOutros ( manager, _list ) {\r\n\tlet list = _list;\r\n\r\n\t// if there's no list, we're starting at the root to build one\r\n\tif ( !list ) {\r\n\t\tlist = [];\r\n\t\tlet parent = manager;\r\n\t\twhile ( parent.parent ) parent = parent.parent;\r\n\t\treturn collectAllOutros( parent, list );\r\n\t} else {\r\n\t\t// grab all outros from child managers\r\n\t\tlet i = manager.children.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tlist = collectAllOutros( manager.children[i], list );\r\n\t\t}\r\n\r\n\t\t// grab any from this manager if there are any\r\n\t\tif ( manager.outros.length ) list = list.concat( manager.outros );\r\n\r\n\t\treturn list;\r\n\t}\r\n}\r\n","import { addToArray } from '../utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n\tstart ( instance ) {\n\t\tlet fulfilPromise;\n\t\tconst promise = new Promise( f => ( fulfilPromise = f ) );\n\n\t\tbatch = {\n\t\t\tpreviousBatch: batch,\n\t\t\ttransitionManager: new TransitionManager( fulfilPromise, batch && batch.transitionManager ),\n\t\t\tfragments: [],\n\t\t\ttasks: [],\n\t\t\timmediateObservers: [],\n\t\t\tdeferredObservers: [],\n\t\t\tinstance,\n\t\t\tpromise\n\t\t};\n\n\t\treturn promise;\n\t},\n\n\tend () {\n\t\tflushChanges();\n\n\t\tif ( !batch.previousBatch ) batch.transitionManager.start();\n\n\t\tbatch = batch.previousBatch;\n\t},\n\n\taddFragment ( fragment ) {\n\t\taddToArray( batch.fragments, fragment );\n\t},\n\n\t// TODO: come up with a better way to handle fragments that trigger their own update\n\taddFragmentToRoot ( fragment ) {\n\t\tif ( !batch ) return;\n\n\t\tlet b = batch;\n\t\twhile ( b.previousBatch ) {\n\t\t\tb = b.previousBatch;\n\t\t}\n\n\t\taddToArray( b.fragments, fragment );\n\t},\n\n\taddObserver ( observer, defer ) {\n\t\tif ( !batch ) {\n\t\t\tobserver.dispatch();\n\t\t} else {\n\t\t\taddToArray( defer ? batch.deferredObservers : batch.immediateObservers, observer );\n\t\t}\n\t},\n\n\tregisterTransition ( transition ) {\n\t\ttransition._manager = batch.transitionManager;\n\t\tbatch.transitionManager.add( transition );\n\t},\n\n\t// synchronise node detachments with transition ends\n\tdetachWhenReady ( thing ) {\n\t\tbatch.transitionManager.detachQueue.push( thing );\n\t},\n\n\tscheduleTask ( task, postRender ) {\n\t\tlet _batch;\n\n\t\tif ( !batch ) {\n\t\t\ttask();\n\t\t} else {\n\t\t\t_batch = batch;\n\t\t\twhile ( postRender && _batch.previousBatch ) {\n\t\t\t\t// this can't happen until the DOM has been fully updated\n\t\t\t\t// otherwise in some situations (with components inside elements)\n\t\t\t\t// transitions and decorators will initialise prematurely\n\t\t\t\t_batch = _batch.previousBatch;\n\t\t\t}\n\n\t\t\t_batch.tasks.push( task );\n\t\t}\n\t},\n\n\tpromise () {\n\t\tif ( !batch ) return Promise.resolve();\n\n\t\tlet target = batch;\n\t\twhile ( target.previousBatch ) {\n\t\t\ttarget = target.previousBatch;\n\t\t}\n\n\t\treturn target.promise || Promise.resolve();\n\t}\n};\n\nexport default runloop;\n\nfunction dispatch ( observer ) {\n\tobserver.dispatch();\n}\n\nfunction flushChanges () {\n\tlet which = batch.immediateObservers;\n\tbatch.immediateObservers = [];\n\twhich.forEach( dispatch );\n\n\t// Now that changes have been fully propagated, we can update the DOM\n\t// and complete other tasks\n\tlet i = batch.fragments.length;\n\tlet fragment;\n\n\twhich = batch.fragments;\n\tbatch.fragments = [];\n\n\twhile ( i-- ) {\n\t\tfragment = which[i];\n\t\tfragment.update();\n\t}\n\n\tbatch.transitionManager.ready();\n\n\twhich = batch.deferredObservers;\n\tbatch.deferredObservers = [];\n\twhich.forEach( dispatch );\n\n\tconst tasks = batch.tasks;\n\tbatch.tasks = [];\n\n\tfor ( i = 0; i < tasks.length; i += 1 ) {\n\t\ttasks[i]();\n\t}\n\n\t// If updating the view caused some model blowback - e.g. a triple\n\t// containing <option> elements caused the binding on the <select>\n\t// to update - then we start over\n\tif ( batch.fragments.length || batch.immediateObservers.length || batch.deferredObservers.length || batch.tasks.length ) return flushChanges();\n}\n","const refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\r\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\r\nconst escapeKeyPattern = /\\\\|\\./g;\r\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\r\n\r\nexport function escapeKey ( key ) {\r\n\tif ( typeof key === 'string' ) {\r\n\t\treturn key.replace( escapeKeyPattern, '\\\\$&' );\r\n\t}\r\n\r\n\treturn key;\r\n}\r\n\r\nexport function normalise ( ref ) {\r\n\treturn ref ? ref.replace( refPattern, '.$1' ) : '';\r\n}\r\n\r\nexport function splitKeypath ( keypath ) {\r\n\tconst result = [];\r\n\tlet match;\r\n\r\n\tkeypath = normalise( keypath );\r\n\r\n\twhile ( match = splitPattern.exec( keypath ) ) {\r\n\t\tconst index = match.index + match[1].length;\r\n\t\tresult.push( keypath.substr( 0, index ) );\r\n\t\tkeypath = keypath.substr( index + 1 );\r\n\t}\r\n\r\n\tresult.push( keypath );\r\n\r\n\treturn result;\r\n}\r\n\r\nexport function unescapeKey ( key ) {\r\n\tif ( typeof key === 'string' ) {\r\n\t\treturn key.replace( unescapeKeyPattern, '$1$2' );\r\n\t}\r\n\r\n\treturn key;\r\n}\r\n","const stack = [];\r\nlet captureGroup;\r\n\r\nexport function startCapturing () {\r\n\tstack.push( captureGroup = [] );\r\n}\r\n\r\nexport function stopCapturing () {\r\n\tconst dependencies = stack.pop();\r\n\tcaptureGroup = stack[ stack.length - 1 ];\r\n\treturn dependencies;\r\n}\r\n\r\nexport function capture ( model ) {\r\n\tif ( captureGroup ) {\r\n\t\tcaptureGroup.push( model );\r\n\t}\r\n}\r\n","export function bind               ( x ) { x.bind(); }\r\nexport function cancel             ( x ) { x.cancel(); }\r\nexport function destroyed          ( x ) { x.destroyed(); }\r\nexport function handleChange       ( x ) { x.handleChange(); }\r\nexport function mark               ( x ) { x.mark(); }\r\nexport function marked             ( x ) { x.marked(); }\r\nexport function markedAll          ( x ) { x.markedAll(); }\r\nexport function render             ( x ) { x.render(); }\r\nexport function shuffled           ( x ) { x.shuffled(); }\r\nexport function teardown           ( x ) { x.teardown(); }\r\nexport function unbind             ( x ) { x.unbind(); }\r\nexport function unrender           ( x ) { x.unrender(); }\r\nexport function unrenderAndDestroy ( x ) { x.unrender( true ); }\r\nexport function update             ( x ) { x.update(); }\r\nexport function toString           ( x ) { return x.toString(); }\r\nexport function toEscapedString    ( x ) { return x.toString( true ); }\r\n","const fnBind = Function.prototype.bind;\r\n\r\nexport default function bind ( fn, context ) {\r\n\tif ( !/this/.test( fn.toString() ) ) return fn;\r\n\r\n\tconst bound = fnBind.call( fn, context );\r\n\tfor ( const prop in fn ) bound[ prop ] = fn[ prop ];\r\n\r\n\treturn bound;\r\n}\r\n","import KeyModel from './specials/KeyModel';\r\nimport KeypathModel from './specials/KeypathModel';\r\nimport { escapeKey, unescapeKey } from '../shared/keypaths';\r\nimport { handleChange } from '../shared/methodCallers';\r\nimport { addToArray, removeFromArray } from '../utils/array';\r\nimport { isObject } from '../utils/is';\r\nimport bind from '../utils/bind';\r\n\r\nconst hasProp = Object.prototype.hasOwnProperty;\r\n\r\nconst shuffleTasks = { early: [], mark: [] };\r\nconst registerQueue = { early: [], mark: [] };\r\n\r\nexport default class ModelBase {\r\n\tconstructor ( parent ) {\r\n\t\tthis.deps = [];\r\n\r\n\t\tthis.children = [];\r\n\t\tthis.childByKey = {};\r\n\t\tthis.links = [];\r\n\r\n\t\tthis.keyModels = {};\r\n\r\n\t\tthis.bindings = [];\r\n\t\tthis.patternObservers = [];\r\n\r\n\t\tif ( parent ) {\r\n\t\t\tthis.parent = parent;\r\n\t\t\tthis.root = parent.root;\r\n\t\t}\r\n\t}\r\n\r\n\taddShuffleTask ( task, stage = 'early' ) { shuffleTasks[stage].push( task ); }\r\n\taddShuffleRegister ( item, stage = 'early' ) { registerQueue[stage].push({ model: this, item }); }\r\n\r\n\tfindMatches ( keys ) {\r\n\t\tconst len = keys.length;\r\n\r\n\t\tlet existingMatches = [ this ];\r\n\t\tlet matches;\r\n\t\tlet i;\r\n\r\n\t\tfor ( i = 0; i < len; i += 1 ) {\r\n\t\t\tconst key = keys[i];\r\n\r\n\t\t\tif ( key === '*' ) {\r\n\t\t\t\tmatches = [];\r\n\t\t\t\texistingMatches.forEach( model => {\r\n\t\t\t\t\tmatches.push.apply( matches, model.getValueChildren( model.get() ) );\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tmatches = existingMatches.map( model => model.joinKey( key ) );\r\n\t\t\t}\r\n\r\n\t\t\texistingMatches = matches;\r\n\t\t}\r\n\r\n\t\treturn matches;\r\n\t}\r\n\r\n\tgetKeyModel ( key, skip ) {\r\n\t\tif ( key !== undefined && !skip ) return this.parent.getKeyModel( key, true );\r\n\r\n\t\tif ( !( key in this.keyModels ) ) this.keyModels[ key ] = new KeyModel( escapeKey( key ), this );\r\n\r\n\t\treturn this.keyModels[ key ];\r\n\t}\r\n\r\n\tgetKeypath ( ractive ) {\r\n\t\tif ( ractive !== this.ractive && this._link ) return this._link.target.getKeypath( ractive );\r\n\r\n\t\tif ( !this.keypath ) {\r\n\t\t\tconst parent = this.parent && this.parent.getKeypath( ractive );\r\n\t\t\tthis.keypath = parent ? `${this.parent.getKeypath( ractive )}.${escapeKey( this.key )}` : escapeKey( this.key );\r\n\t\t}\r\n\r\n\t\treturn this.keypath;\r\n\t}\r\n\r\n\tgetValueChildren ( value ) {\r\n\t\tlet children;\r\n\t\tif ( Array.isArray( value ) ) {\r\n\t\t\tchildren = [];\r\n\t\t\tif ( 'length' in this && this.length !== value.length ) {\r\n\t\t\t\tchildren.push( this.joinKey( 'length' ) );\r\n\t\t\t}\r\n\t\t\tvalue.forEach( ( m, i ) => {\r\n\t\t\t\tchildren.push( this.joinKey( i ) );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\telse if ( isObject( value ) || typeof value === 'function' ) {\r\n\t\t\tchildren = Object.keys( value ).map( key => this.joinKey( key ) );\r\n\t\t}\r\n\r\n\t\telse if ( value != null ) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\treturn children;\r\n\t}\r\n\r\n\tgetVirtual ( shouldCapture ) {\r\n\t\tconst value = this.get( shouldCapture, { virtual: false } );\r\n\t\tif ( isObject( value ) ) {\r\n\t\t\tconst result = Array.isArray( value ) ? [] : {};\r\n\r\n\t\t\tconst keys = Object.keys( value );\r\n\t\t\tlet i = keys.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tconst child = this.childByKey[ keys[i] ];\r\n\t\t\t\tif ( !child ) result[ keys[i] ] = value[ keys[i] ];\r\n\t\t\t\telse if ( child._link ) result[ keys[i] ] = child._link.getVirtual();\r\n\t\t\t\telse result[ keys[i] ] = child.getVirtual();\r\n\t\t\t}\r\n\r\n\t\t\ti = this.children.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tconst child = this.children[i];\r\n\t\t\t\tif ( !( child.key in result ) && child._link ) {\r\n\t\t\t\t\tresult[ child.key ] = child._link.getVirtual();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t} else return value;\r\n\t}\r\n\r\n\thas ( key ) {\r\n\t\tif ( this._link ) return this._link.has( key );\r\n\r\n\t\tconst value = this.get();\r\n\t\tif ( !value ) return false;\r\n\r\n\t\tkey = unescapeKey( key );\r\n\t\tif ( hasProp.call( value, key ) ) return true;\r\n\r\n\t\t// We climb up the constructor chain to find if one of them contains the key\r\n\t\tlet constructor = value.constructor;\r\n\t\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\r\n\t\t\tif ( hasProp.call( constructor.prototype, key ) ) return true;\r\n\t\t\tconstructor = constructor.constructor;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tjoinAll ( keys, opts ) {\r\n\t\tlet model = this;\r\n\t\tfor ( let i = 0; i < keys.length; i += 1 ) {\r\n\t\t\tif ( opts && opts.lastLink === false && i + 1 === keys.length && model.childByKey[keys[i]] && model.childByKey[keys[i]]._link ) return model.childByKey[keys[i]];\r\n\t\t\tmodel = model.joinKey( keys[i], opts );\r\n\t\t}\r\n\r\n\t\treturn model;\r\n\t}\r\n\r\n\tnotifyUpstream ( startPath ) {\r\n\t\tlet parent = this.parent;\r\n\t\tconst path = startPath || [ this.key ];\r\n\t\twhile ( parent ) {\r\n\t\t\tif ( parent.patternObservers.length ) parent.patternObservers.forEach( o => o.notify( path.slice() ) );\r\n\t\t\tpath.unshift( parent.key );\r\n\t\t\tparent.links.forEach( l => l.notifiedUpstream( path, this.root ) );\r\n\t\t\tparent.deps.forEach( handleChange );\r\n\t\t\tparent = parent.parent;\r\n\t\t}\r\n\t}\r\n\r\n\trebind ( next, previous, safe ) {\r\n\t\t// tell the deps to move to the new target\r\n\t\tlet i = this.deps.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tif ( this.deps[i].rebind ) this.deps[i].rebind( next, previous, safe );\r\n\t\t}\r\n\r\n\t\ti = this.links.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst link = this.links[i];\r\n\t\t\t// only relink the root of the link tree\r\n\t\t\tif ( link.owner._link ) link.relinking( next, safe );\r\n\t\t}\r\n\r\n\t\ti = this.children.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst child = this.children[i];\r\n\t\t\tchild.rebind( next ? next.joinKey( child.key ) : undefined, child, safe );\r\n\t\t}\r\n\r\n\t\tif ( this.keypathModel ) this.keypathModel.rebind( next, previous, false );\r\n\r\n\t\ti = this.bindings.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tthis.bindings[i].rebind( next, previous, safe );\r\n\t\t}\r\n\t}\r\n\r\n\treference () {\r\n\t\t'refs' in this ? this.refs++ : this.refs = 1;\r\n\t}\r\n\r\n\tregister ( dep ) {\r\n\t\tthis.deps.push( dep );\r\n\t}\r\n\r\n\tregisterLink ( link ) {\r\n\t\taddToArray( this.links, link );\r\n\t}\r\n\r\n\tregisterPatternObserver ( observer ) {\r\n\t\tthis.patternObservers.push( observer );\r\n\t\tthis.register( observer );\r\n\t}\r\n\r\n\tregisterTwowayBinding ( binding ) {\r\n\t\tthis.bindings.push( binding );\r\n\t}\r\n\r\n\tunreference () {\r\n\t\tif ( 'refs' in this ) this.refs--;\r\n\t}\r\n\r\n\tunregister ( dep ) {\r\n\t\tremoveFromArray( this.deps, dep );\r\n\t}\r\n\r\n\tunregisterLink ( link ) {\r\n\t\tremoveFromArray( this.links, link );\r\n\t}\r\n\r\n\tunregisterPatternObserver ( observer ) {\r\n\t\tremoveFromArray( this.patternObservers, observer );\r\n\t\tthis.unregister( observer );\r\n\t}\r\n\r\n\tunregisterTwowayBinding ( binding ) {\r\n\t\tremoveFromArray( this.bindings, binding );\r\n\t}\r\n\r\n\tupdateFromBindings ( cascade ) {\r\n\t\tlet i = this.bindings.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst value = this.bindings[i].getValue();\r\n\t\t\tif ( value !== this.value ) this.set( value );\r\n\t\t}\r\n\r\n\t\t// check for one-way bindings if there are no two-ways\r\n\t\tif ( !this.bindings.length ) {\r\n\t\t\tconst oneway = findBoundValue( this.deps );\r\n\t\t\tif ( oneway && oneway.value !== this.value ) this.set( oneway.value );\r\n\t\t}\r\n\r\n\t\tif ( cascade ) {\r\n\t\t\tthis.children.forEach( updateFromBindings );\r\n\t\t\tthis.links.forEach( updateFromBindings );\r\n\t\t\tif ( this._link ) this._link.updateFromBindings( cascade );\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\r\nexport function maybeBind ( model, value, shouldBind ) {\r\n\tif ( shouldBind && typeof value === 'function' && model.parent && model.parent.isRoot ) {\r\n\t\tif ( !model.boundValue ) {\r\n\t\t\tmodel.boundValue = bind( value._r_unbound || value, model.parent.ractive );\r\n\t\t}\r\n\r\n\t\treturn model.boundValue;\r\n\t}\r\n\r\n\treturn value;\r\n}\r\n\r\nfunction updateFromBindings ( model ) {\r\n\tmodel.updateFromBindings( true );\r\n}\r\n\r\nexport function findBoundValue( list ) {\r\n\tlet i = list.length;\r\n\twhile ( i-- ) {\r\n\t\tif ( list[i].bound ) {\r\n\t\t\tconst owner = list[i].owner;\r\n\t\t\tif ( owner ) {\r\n\t\t\t\tconst value = owner.name === 'checked' ?\r\n\t\t\t\t\towner.node.checked :\r\n\t\t\t\t\towner.node.value;\r\n\t\t\t\treturn { value };\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function fireShuffleTasks ( stage ) {\r\n\tif ( !stage ) {\r\n\t\tfireShuffleTasks( 'early' );\r\n\t\tfireShuffleTasks( 'mark' );\r\n\t} else {\r\n\t\tconst tasks = shuffleTasks[stage];\r\n\t\tshuffleTasks[stage] = [];\r\n\t\tlet i = tasks.length;\r\n\t\twhile ( i-- ) tasks[i]();\r\n\r\n\t\tconst register = registerQueue[stage];\r\n\t\tregisterQueue[stage] = [];\r\n\t\ti = register.length;\r\n\t\twhile ( i-- ) register[i].model.register( register[i].item );\r\n\t}\r\n}\r\n\r\nexport function shuffle ( model, newIndices, link ) {\r\n\tmodel.shuffling = true;\r\n\r\n\tlet i = newIndices.length;\r\n\twhile ( i-- ) {\r\n\t\tconst idx = newIndices[ i ];\r\n\t\t// nothing is actually changing, so move in the index and roll on\r\n\t\tif ( i === idx ) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\t// rebind the children on i to idx\r\n\t\tif ( i in model.childByKey ) model.childByKey[ i ].rebind( !~idx ? undefined : model.joinKey( idx ), model.childByKey[ i ], true );\r\n\r\n\t\tif ( !~idx && model.keyModels[ i ] ) {\r\n\t\t\tmodel.keyModels[i].rebind( undefined, model.keyModels[i], false );\r\n\t\t} else if ( ~idx && model.keyModels[ i ] ) {\r\n\t\t\tif ( !model.keyModels[ idx ] ) model.childByKey[ idx ].getKeyModel( idx );\r\n\t\t\tmodel.keyModels[i].rebind( model.keyModels[ idx ], model.keyModels[i], false );\r\n\t\t}\r\n\t}\r\n\r\n\tconst upstream = model.source().length !== model.source().value.length;\r\n\r\n\tmodel.links.forEach( l => l.shuffle( newIndices ) );\r\n\tif ( !link ) fireShuffleTasks( 'early' );\r\n\r\n\ti = model.deps.length;\r\n\twhile ( i-- ) {\r\n\t\tif ( model.deps[i].shuffle ) model.deps[i].shuffle( newIndices );\r\n\t}\r\n\r\n\tmodel[ link ? 'marked' : 'mark' ]();\r\n\tif ( !link ) fireShuffleTasks( 'mark' );\r\n\r\n\tif ( upstream ) model.notifyUpstream();\r\n\r\n\tmodel.shuffling = false;\r\n}\r\n\r\nKeyModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\r\nKeyModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\r\nKeypathModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\r\nKeypathModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\r\n","import { splitKeypath } from './keypaths';\r\n\r\n// this is the dry method of checking to see if a rebind applies to\r\n// a particular keypath because in some cases, a dep may be bound\r\n// directly to a particular keypath e.g. foo.bars.0.baz and need\r\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\r\nexport function rebindMatch ( template, next, previous, fragment ) {\r\n\tconst keypath = template.r || template;\r\n\r\n\t// no valid keypath, go with next\r\n\tif ( !keypath || typeof keypath !== 'string' ) return next;\r\n\r\n\t// completely contextual ref, go with next\r\n\tif ( keypath === '.' || keypath[0] === '@' || ( next || previous ).isKey || ( next || previous ).isKeypath ) return next;\r\n\r\n\tconst parts = keypath.split( '/' );\r\n\tlet keys = splitKeypath( parts[ parts.length - 1 ] );\r\n\tconst last = keys[ keys.length - 1 ];\r\n\r\n\t// check the keypath against the model keypath to see if it matches\r\n\tlet model = next || previous;\r\n\r\n\t// check to see if this was an alias\r\n\tif ( model && keys.length === 1 && last !== model.key && fragment ) {\r\n\t\tkeys = findAlias( last, fragment ) || keys;\r\n\t}\r\n\r\n\tlet i = keys.length;\r\n\tlet match = true;\r\n\tlet shuffling = false;\r\n\r\n\twhile ( model && i-- ) {\r\n\t\tif ( model.shuffling ) shuffling = true;\r\n\t\t// non-strict comparison to account for indices in keypaths\r\n\t\tif ( keys[i] != model.key ) match = false;\r\n\t\tmodel = model.parent;\r\n\t}\r\n\r\n\t// next is undefined, but keypath is shuffling and previous matches\r\n\tif ( !next && match && shuffling ) return previous;\r\n\t// next is defined, but doesn't match the keypath\r\n\telse if ( next && !match && shuffling ) return previous;\r\n\telse return next;\r\n}\r\n\r\nfunction findAlias ( name, fragment ) {\r\n\twhile ( fragment ) {\r\n\t\tconst z = fragment.aliases;\r\n\t\tif ( z && z[ name ] ) {\r\n\t\t\tconst aliases = ( fragment.owner.iterations ? fragment.owner : fragment ).owner.template.z;\r\n\t\t\tfor ( let i = 0; i < aliases.length; i++ ) {\r\n\t\t\t\tif ( aliases[i].n === name ) {\r\n\t\t\t\t\tconst alias = aliases[i].x;\r\n\t\t\t\t\tif ( !alias.r ) return false;\r\n\t\t\t\t\tconst parts = alias.r.split( '/' );\r\n\t\t\t\t\treturn splitKeypath( parts[ parts.length - 1 ] );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfragment = fragment.componentParent || fragment.parent;\r\n\t}\r\n}\r\n","import runloop from '../global/runloop';\r\n\r\n// TODO what happens if a transition is aborted?\r\n\r\nconst tickers = [];\r\nlet running = false;\r\n\r\nfunction tick () {\r\n\trunloop.start();\r\n\r\n\tconst now = performance.now();\r\n\r\n\tlet i;\r\n\tlet ticker;\r\n\r\n\tfor ( i = 0; i < tickers.length; i += 1 ) {\r\n\t\tticker = tickers[i];\r\n\r\n\t\tif ( !ticker.tick( now ) ) {\r\n\t\t\t// ticker is complete, remove it from the stack, and decrement i so we don't miss one\r\n\t\t\ttickers.splice( i--, 1 );\r\n\t\t}\r\n\t}\r\n\r\n\trunloop.end();\r\n\r\n\tif ( tickers.length ) {\r\n\t\trequestAnimationFrame( tick );\r\n\t} else {\r\n\t\trunning = false;\r\n\t}\r\n}\r\n\r\nexport default class Ticker {\r\n\tconstructor ( options ) {\r\n\t\tthis.duration = options.duration;\r\n\t\tthis.step = options.step;\r\n\t\tthis.complete = options.complete;\r\n\t\tthis.easing = options.easing;\r\n\r\n\t\tthis.start = performance.now();\r\n\t\tthis.end = this.start + this.duration;\r\n\r\n\t\tthis.running = true;\r\n\r\n\t\ttickers.push( this );\r\n\t\tif ( !running ) requestAnimationFrame( tick );\r\n\t}\r\n\r\n\ttick ( now ) {\r\n\t\tif ( !this.running ) return false;\r\n\r\n\t\tif ( now > this.end ) {\r\n\t\t\tif ( this.step ) this.step( 1 );\r\n\t\t\tif ( this.complete ) this.complete( 1 );\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst elapsed = now - this.start;\r\n\t\tconst eased = this.easing( elapsed / this.duration );\r\n\r\n\t\tif ( this.step ) this.step( eased );\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tstop () {\r\n\t\tif ( this.abort ) this.abort();\r\n\t\tthis.running = false;\r\n\t}\r\n}\r\n","const prefixers = {};\r\n\r\n// TODO this is legacy. sooner we can replace the old adaptor API the better\r\nfunction prefixKeypath ( obj, prefix ) {\r\n\tconst prefixed = {};\r\n\r\n\tif ( !prefix ) {\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tprefix += '.';\r\n\r\n\tfor ( const key in obj ) {\r\n\t\tif ( obj.hasOwnProperty( key ) ) {\r\n\t\t\tprefixed[ prefix + key ] = obj[ key ];\r\n\t\t}\r\n\t}\r\n\r\n\treturn prefixed;\r\n}\r\n\r\nexport default function getPrefixer ( rootKeypath ) {\r\n\tlet rootDot;\r\n\r\n\tif ( !prefixers[ rootKeypath ] ) {\r\n\t\trootDot = rootKeypath ? rootKeypath + '.' : '';\r\n\r\n\t\tprefixers[ rootKeypath ] = function ( relativeKeypath, value ) {\r\n\t\t\tlet obj;\r\n\r\n\t\t\tif ( typeof relativeKeypath === 'string' ) {\r\n\t\t\t\tobj = {};\r\n\t\t\t\tobj[ rootDot + relativeKeypath ] = value;\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\r\n\t\t\tif ( typeof relativeKeypath === 'object' ) {\r\n\t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\r\n\t\t\t\treturn rootDot ? prefixKeypath( relativeKeypath, rootKeypath ) : relativeKeypath;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\treturn prefixers[ rootKeypath ];\r\n}\r\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\r\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\r\nimport KeypathModel from './specials/KeypathModel';\r\nimport { capture } from '../global/capture';\r\nimport { isEqual, isNumeric, isObjectLike } from '../utils/is';\r\nimport { handleChange, mark, marked, teardown } from '../shared/methodCallers';\r\nimport Ticker from '../shared/Ticker';\r\nimport getPrefixer from './helpers/getPrefixer';\r\nimport { unescapeKey } from '../shared/keypaths';\r\nimport { warnIfDebug } from '../utils/log';\r\n\r\nexport default class Model extends ModelBase {\r\n\tconstructor ( parent, key ) {\r\n\t\tsuper( parent );\r\n\r\n\t\tthis.ticker = null;\r\n\r\n\t\tif ( parent ) {\r\n\t\t\tthis.key = unescapeKey( key );\r\n\t\t\tthis.isReadonly = parent.isReadonly;\r\n\r\n\t\t\tif ( parent.value ) {\r\n\t\t\t\tthis.value = parent.value[ this.key ];\r\n\t\t\t\tif ( Array.isArray( this.value ) ) this.length = this.value.length;\r\n\t\t\t\tthis.adapt();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tadapt () {\r\n\t\tconst adaptors = this.root.adaptors;\r\n\t\tconst len = adaptors.length;\r\n\r\n\t\tthis.rewrap = false;\r\n\r\n\t\t// Exit early if no adaptors\r\n\t\tif ( len === 0 ) return;\r\n\r\n\t\tconst value = this.wrapper ? ( 'newWrapperValue' in this ? this.newWrapperValue : this.wrapperValue ) : this.value;\r\n\r\n\t\t// TODO remove this legacy nonsense\r\n\t\tconst ractive = this.root.ractive;\r\n\t\tconst keypath = this.getKeypath();\r\n\r\n\t\t// tear previous adaptor down if present\r\n\t\tif ( this.wrapper ) {\r\n\t\t\tconst shouldTeardown = this.wrapperValue === value ? false : !this.wrapper.reset || this.wrapper.reset( value ) === false;\r\n\r\n\t\t\tif ( shouldTeardown ) {\r\n\t\t\t\tthis.wrapper.teardown();\r\n\t\t\t\tthis.wrapper = null;\r\n\r\n\t\t\t\t// don't branch for undefined values\r\n\t\t\t\tif ( this.value !== undefined ) {\r\n\t\t\t\t\tconst parentValue = this.parent.value || this.parent.createBranch( this.key );\r\n\t\t\t\t\tif ( parentValue[ this.key ] !== value ) parentValue[ this.key ] = value;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdelete this.newWrapperValue;\r\n\t\t\t\tthis.wrapperValue = value;\r\n\t\t\t\tthis.value = this.wrapper.get();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet i;\r\n\r\n\t\tfor ( i = 0; i < len; i += 1 ) {\r\n\t\t\tconst adaptor = adaptors[i];\r\n\t\t\tif ( adaptor.filter( value, keypath, ractive ) ) {\r\n\t\t\t\tthis.wrapper = adaptor.wrap( ractive, value, keypath, getPrefixer( keypath ) );\r\n\t\t\t\tthis.wrapperValue = value;\r\n\t\t\t\tthis.wrapper.__model = this; // massive temporary hack to enable array adaptor\r\n\r\n\t\t\t\tthis.value = this.wrapper.get();\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tanimate ( from, to, options, interpolator ) {\r\n\t\tif ( this.ticker ) this.ticker.stop();\r\n\r\n\t\tlet fulfilPromise;\r\n\t\tconst promise = new Promise( fulfil => fulfilPromise = fulfil );\r\n\r\n\t\tthis.ticker = new Ticker({\r\n\t\t\tduration: options.duration,\r\n\t\t\teasing: options.easing,\r\n\t\t\tstep: t => {\r\n\t\t\t\tconst value = interpolator( t );\r\n\t\t\t\tthis.applyValue( value );\r\n\t\t\t\tif ( options.step ) options.step( t, value );\r\n\t\t\t},\r\n\t\t\tcomplete: () => {\r\n\t\t\t\tthis.applyValue( to );\r\n\t\t\t\tif ( options.complete ) options.complete( to );\r\n\r\n\t\t\t\tthis.ticker = null;\r\n\t\t\t\tfulfilPromise();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tpromise.stop = this.ticker.stop;\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tapplyValue ( value, notify = true ) {\r\n\t\tif ( isEqual( value, this.value ) ) return;\r\n\t\tif ( this.boundValue ) this.boundValue = null;\r\n\r\n\t\tif ( this.parent.wrapper && this.parent.wrapper.set ) {\r\n\t\t\tthis.parent.wrapper.set( this.key, value );\r\n\t\t\tthis.parent.value = this.parent.wrapper.get();\r\n\r\n\t\t\tthis.value = this.parent.value[ this.key ];\r\n\t\t\tif ( this.wrapper ) this.newWrapperValue = this.value;\r\n\t\t\tthis.adapt();\r\n\t\t} else if ( this.wrapper ) {\r\n\t\t\tthis.newWrapperValue = value;\r\n\t\t\tthis.adapt();\r\n\t\t} else {\r\n\t\t\tconst parentValue = this.parent.value || this.parent.createBranch( this.key );\r\n\t\t\tif ( isObjectLike( parentValue ) ) {\r\n\t\t\t\tparentValue[ this.key ] = value;\r\n\t\t\t} else {\r\n\t\t\t\twarnIfDebug( `Attempted to set a property of a non-object '${this.getKeypath()}'` );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.value = value;\r\n\t\t\tthis.adapt();\r\n\t\t}\r\n\r\n\t\t// keep track of array stuff\r\n\t\tif ( Array.isArray( value ) ) {\r\n\t\t\tthis.length = value.length;\r\n\t\t\tthis.isArray = true;\r\n\t\t} else {\r\n\t\t\tthis.isArray = false;\r\n\t\t}\r\n\r\n\t\t// notify dependants\r\n\t\tthis.links.forEach( handleChange );\r\n\t\tthis.children.forEach( mark );\r\n\t\tthis.deps.forEach( handleChange );\r\n\r\n\t\tif ( notify ) this.notifyUpstream();\r\n\r\n\t\tif ( this.parent.isArray ) {\r\n\t\t\tif ( this.key === 'length' ) this.parent.length = value;\r\n\t\t\telse this.parent.joinKey( 'length' ).mark();\r\n\t\t}\r\n\t}\r\n\r\n\tcreateBranch ( key ) {\r\n\t\tconst branch = isNumeric( key ) ? [] : {};\r\n\t\tthis.applyValue( branch, false );\r\n\r\n\t\treturn branch;\r\n\t}\r\n\r\n\tget ( shouldCapture, opts ) {\r\n\t\tif ( this._link ) return this._link.get( shouldCapture, opts );\r\n\t\tif ( shouldCapture ) capture( this );\r\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\r\n\t\tif ( opts && opts.virtual ) return this.getVirtual( false );\r\n\t\treturn maybeBind( this, ( ( opts && 'unwrap' in opts ) ? opts.unwrap !== false : shouldCapture ) && this.wrapper ? this.wrapperValue : this.value, !opts || opts.shouldBind !== false );\r\n\t}\r\n\r\n\tgetKeypathModel () {\r\n\t\tif ( !this.keypathModel ) this.keypathModel = new KeypathModel( this );\r\n\t\treturn this.keypathModel;\r\n\t}\r\n\r\n\tjoinKey ( key, opts ) {\r\n\t\tif ( this._link ) {\r\n\t\t\tif ( opts && opts.lastLink !== false && ( key === undefined || key === '' ) ) return this;\r\n\t\t\treturn this._link.joinKey( key );\r\n\t\t}\r\n\r\n\t\tif ( key === undefined || key === '' ) return this;\r\n\r\n\r\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\r\n\t\t\tconst child = new Model( this, key );\r\n\t\t\tthis.children.push( child );\r\n\t\t\tthis.childByKey[ key ] = child;\r\n\t\t}\r\n\r\n\t\tif ( this.childByKey[ key ]._link && ( !opts || opts.lastLink !== false ) ) return this.childByKey[ key ]._link;\r\n\t\treturn this.childByKey[ key ];\r\n\t}\r\n\r\n\tmark ( force ) {\r\n\t\tif ( this._link ) return this._link.mark();\r\n\r\n\t\tconst value = this.retrieve();\r\n\r\n\t\tif ( force || !isEqual( value, this.value ) ) {\r\n\t\t\tconst old = this.value;\r\n\t\t\tthis.value = value;\r\n\t\t\tif ( this.boundValue ) this.boundValue = null;\r\n\r\n\t\t\t// make sure the wrapper stays in sync\r\n\t\t\tif ( old !== value || this.rewrap ) {\r\n\t\t\t\tif ( this.wrapper ) this.newWrapperValue = value;\r\n\t\t\t\tthis.adapt();\r\n\t\t\t}\r\n\r\n\t\t\t// keep track of array stuff\r\n\t\t\tif ( Array.isArray( value ) ) {\r\n\t\t\t\tthis.length = value.length;\r\n\t\t\t\tthis.isArray = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.isArray = false;\r\n\t\t\t}\r\n\r\n\t\t\tthis.children.forEach( mark );\r\n\t\t\tthis.links.forEach( marked );\r\n\r\n\t\t\tthis.deps.forEach( handleChange );\r\n\t\t}\r\n\t}\r\n\r\n\tmerge ( array, comparator ) {\r\n\t\tlet oldArray = this.value;\r\n\t\tlet newArray = array;\r\n\t\tif ( oldArray === newArray ) oldArray = recreateArray( this );\r\n\t\tif ( comparator ) {\r\n\t\t\toldArray = oldArray.map( comparator );\r\n\t\t\tnewArray = newArray.map( comparator );\r\n\t\t}\r\n\r\n\t\tconst oldLength = oldArray.length;\r\n\r\n\t\tconst usedIndices = {};\r\n\t\tlet firstUnusedIndex = 0;\r\n\r\n\t\tconst newIndices = oldArray.map( item => {\r\n\t\t\tlet index;\r\n\t\t\tlet start = firstUnusedIndex;\r\n\r\n\t\t\tdo {\r\n\t\t\t\tindex = newArray.indexOf( item, start );\r\n\r\n\t\t\t\tif ( index === -1 ) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstart = index + 1;\r\n\t\t\t} while ( ( usedIndices[ index ] === true ) && start < oldLength );\r\n\r\n\t\t\t// keep track of the first unused index, so we don't search\r\n\t\t\t// the whole of newArray for each item in oldArray unnecessarily\r\n\t\t\tif ( index === firstUnusedIndex ) {\r\n\t\t\t\tfirstUnusedIndex += 1;\r\n\t\t\t}\r\n\t\t\t// allow next instance of next \"equal\" to be found item\r\n\t\t\tusedIndices[ index ] = true;\r\n\t\t\treturn index;\r\n\t\t});\r\n\r\n\t\tthis.parent.value[ this.key ] = array;\r\n\t\tthis.shuffle( newIndices );\r\n\t}\r\n\r\n\tretrieve () {\r\n\t\treturn this.parent.value ? this.parent.value[ this.key ] : undefined;\r\n\t}\r\n\r\n\tset ( value ) {\r\n\t\tif ( this.ticker ) this.ticker.stop();\r\n\t\tthis.applyValue( value );\r\n\t}\r\n\r\n\tshuffle ( newIndices ) {\r\n\t\tshuffle( this, newIndices, false );\r\n\t}\r\n\r\n\tsource () { return this; }\r\n\r\n\tteardown () {\r\n\t\tif ( this._link ) this._link.teardown();\r\n\t\tthis.children.forEach( teardown );\r\n\t\tif ( this.wrapper ) this.wrapper.teardown();\r\n\t\tif ( this.keypathModel ) this.keypathModel.teardown();\r\n\t}\r\n}\r\n\r\nfunction recreateArray( model ) {\r\n\tconst array = [];\r\n\r\n\tfor ( let i = 0; i < model.length; i++ ) {\r\n\t\tarray[ i ] = (model.childByKey[i] || {}).value;\r\n\t}\r\n\r\n\treturn array;\r\n}\r\n","import { splitKeypath } from '../../shared/keypaths';\nimport SharedModel, { GlobalModel } from '../../model/specials/SharedModel';\nimport { warnIfDebug } from '../../utils/log';\n\nexport default function resolveReference ( fragment, ref ) {\n\tconst initialFragment = fragment;\n\t// current context ref\n\tif ( ref === '.' ) return fragment.findContext();\n\n\t// ancestor references\n\tif ( ref[0] === '~' ) return fragment.ractive.viewmodel.joinAll( splitKeypath( ref.slice( 2 ) ) );\n\n\t// scoped references\n\tif ( ref[0] === '.' || ref[0] === '^' ) {\n\t\tlet frag = fragment;\n\t\tconst parts = ref.split( '/' );\n\t\tconst explicitContext = parts[0] === '^^';\n\t\tlet context = explicitContext ? null : fragment.findContext();\n\n\t\t// account for the first context hop\n\t\tif ( explicitContext ) parts.unshift( '^^' );\n\n\t\t// walk up the context chain\n\t\twhile ( parts[0] === '^^' ) {\n\t\t\tparts.shift();\n\t\t\tcontext = null;\n\t\t\twhile ( frag && !context ) {\n\t\t\t\tcontext = frag.context;\n\t\t\t\tfrag = frag.parent.component ? frag.parent.component.parentFragment : frag.parent;\n\t\t\t}\n\t\t}\n\n\t\tif ( !context && explicitContext ) {\n\t\t\tthrow new Error( `Invalid context parent reference ('${ref}'). There is not context at that level.` );\n\t\t}\n\n\t\t// walk up the context path\n\t\twhile ( parts[0] === '.' || parts[0] === '..' ) {\n\t\t\tconst part = parts.shift();\n\n\t\t\tif ( part === '..' ) {\n\t\t\t\tcontext = context.parent;\n\t\t\t}\n\t\t}\n\n\t\tref = parts.join( '/' );\n\n\t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n\t\tif ( ref[0] === '.' ) ref = ref.slice( 1 );\n\t\treturn context.joinAll( splitKeypath( ref ) );\n\t}\n\n\tconst keys = splitKeypath( ref );\n\tif ( !keys.length ) return;\n\tconst base = keys.shift();\n\n\t// special refs\n\tif ( base[0] === '@' ) {\n\t\t// shorthand from outside the template\n\t\t// @this referring to local ractive instance\n\t\tif ( base === '@this' || base === '@' ) {\n\t\t\treturn fragment.ractive.viewmodel.getRactiveModel().joinAll( keys );\n\t\t}\n\n\t\t// @index or @key referring to the nearest repeating index or key\n\t\telse if ( base === '@index' || base === '@key' ) {\n\t\t\tif ( keys.length ) badReference( base );\n\t\t\tconst repeater = fragment.findRepeatingFragment();\n\t\t\t// make sure the found fragment is actually an iteration\n\t\t\tif ( !repeater.isIteration ) return;\n\t\t\treturn repeater.context.getKeyModel( repeater[ ref[1] === 'i' ? 'index' : 'key' ] );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@global' ) {\n\t\t\treturn GlobalModel.joinAll( keys );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@shared' ) {\n\t\t\treturn SharedModel.joinAll( keys );\n\t\t}\n\n\t\t// @keypath or @rootpath, the current keypath string\n\t\telse if ( base === '@keypath' || base === '@rootpath' ) {\n\t\t\tconst root = ref[1] === 'r' ? fragment.ractive.root : null;\n\t\t\tlet context = fragment.findContext();\n\n\t\t\t// skip over component roots, which provide no context\n\t\t\twhile ( root && context.isRoot && context.ractive.component ) {\n\t\t\t\tcontext = context.ractive.component.parentFragment.findContext();\n\t\t\t}\n\n\t\t\treturn context.getKeypathModel( root );\n\t\t}\n\n\t\telse if ( base === '@context' ) {\n\t\t\treturn new ContextModel( fragment.getContext() );\n\t\t}\n\n\t\t// @context-local data\n\t\telse if ( base === '@local' ) {\n\t\t\treturn fragment.getContext()._data.joinAll( keys );\n\t\t}\n\n\t\t// nope\n\t\telse {\n\t\t\tthrow new Error( `Invalid special reference '${base}'` );\n\t\t}\n\t}\n\n\tconst context = fragment.findContext();\n\n\t// check immediate context for a match\n\tif ( context.has( base ) ) {\n\t\treturn context.joinKey( base ).joinAll( keys );\n\t}\n\n\t// walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n\tlet createMapping = false;\n\tconst shouldWarn = fragment.ractive.warnAboutAmbiguity;\n\n\twhile ( fragment ) {\n\t\t// repeated fragments\n\t\tif ( fragment.isIteration ) {\n\t\t\tif ( base === fragment.parent.keyRef ) {\n\t\t\t\tif ( keys.length ) badReference( base );\n\t\t\t\treturn fragment.context.getKeyModel( fragment.key );\n\t\t\t}\n\n\t\t\tif ( base === fragment.parent.indexRef ) {\n\t\t\t\tif ( keys.length ) badReference( base );\n\t\t\t\treturn fragment.context.getKeyModel( fragment.index );\n\t\t\t}\n\t\t}\n\n\t\t// alias node or iteration\n\t\tif ( fragment.aliases  && fragment.aliases.hasOwnProperty( base ) ) {\n\t\t\tconst model = fragment.aliases[ base ];\n\n\t\t\tif ( keys.length === 0 ) return model;\n\t\t\telse if ( typeof model.joinAll === 'function' ) {\n\t\t\t\treturn model.joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\t// check fragment context to see if it has the key we need\n\t\tif ( fragment.context && fragment.context.has( base ) ) {\n\t\t\t// this is an implicit mapping\n\t\t\tif ( createMapping ) {\n\t\t\t\tif ( shouldWarn ) warnIfDebug( `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.` );\n\t\t\t\treturn context.root.createLink( base, fragment.context.joinKey( base ), base, { implicit: true }).joinAll( keys );\n\t\t\t}\n\n\t\t\tif ( shouldWarn ) warnIfDebug( `'${ref}' resolved but is ambiguous.` );\n\t\t\treturn fragment.context.joinKey( base ).joinAll( keys );\n\t\t}\n\n\t\tif ( ( fragment.componentParent || ( !fragment.parent && fragment.ractive.component ) ) && !fragment.ractive.isolated ) {\n\t\t\t// ascend through component boundary\n\t\t\tfragment = fragment.componentParent || fragment.ractive.component.parentFragment;\n\t\t\tcreateMapping = true;\n\t\t} else {\n\t\t\tfragment = fragment.parent;\n\t\t}\n\t}\n\n\t// if enabled, check the instance for a match\n\tif ( initialFragment.ractive.resolveInstanceMembers ) {\n\t\tconst model = initialFragment.ractive.viewmodel.getRactiveModel();\n\t\tif ( model.has( base ) ) {\n\t\t\treturn model.joinKey( base ).joinAll( keys );\n\t\t}\n\t}\n\n\tif ( shouldWarn ) {\n\t\twarnIfDebug( `'${ref}' is ambiguous and did not resolve.` );\n\t}\n\n\t// didn't find anything, so go ahead and create the key on the local model\n\treturn context.joinKey( base ).joinAll( keys );\n}\n\nfunction badReference ( key ) {\n\tthrow new Error( `An index or key reference (${key}) cannot have child properties` );\n}\n\nclass ContextModel {\n\tconstructor ( context ) {\n\t\tthis.context = context;\n\t}\n\n\tget () { return this.context; }\n}\n","import noop from '../utils/noop';\n\nexport const extern = {};\n\nexport default function getRactiveContext ( ractive, ...assigns ) {\n\tconst fragment = ractive.fragment || ractive._fakeFragment || ( ractive._fakeFragment = new FakeFragment( ractive ) );\n\treturn fragment.getContext.apply( fragment, assigns );\n}\n\nexport function getContext ( ...assigns ) {\n\tif ( !this.ctx ) this.ctx = new extern.Context( this );\n\tassigns.unshift( Object.create( this.ctx ) );\n\treturn Object.assign.apply( null, assigns );\n}\n\nexport class FakeFragment {\n\tconstructor ( ractive ) {\n\t\tthis.ractive = ractive;\n\t}\n\n\tfindContext () { return this.ractive.viewmodel; }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n","import runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { isObject } from '../utils/is';\nimport { warnIfDebug } from '../utils/log';\nimport resolveReference from '../view/resolvers/resolveReference';\nimport { FakeFragment } from './getRactiveContext';\n\nexport let keep = false;\n\nexport function set ( ractive, pairs, options ) {\n\tconst k = keep;\n\n\tconst deep = options && options.deep;\n\tconst shuffle = options && options.shuffle;\n\tconst promise = runloop.start( ractive, true );\n\tif ( options && 'keep' in options ) keep = options.keep;\n\n\tlet i = pairs.length;\n\twhile ( i-- ) {\n\t\tconst model = pairs[i][0];\n\t\tconst value = pairs[i][1];\n\t\tconst keypath = pairs[i][2];\n\n\t\tif ( !model ) {\n\t\t\trunloop.end();\n\t\t\tthrow new Error( `Failed to set invalid keypath '${ keypath }'` );\n\t\t}\n\n\t\tif ( deep ) deepSet( model, value );\n\t\telse if ( shuffle ) {\n\t\t\tlet array = value;\n\t\t\tconst target = model.get();\n\t\t\t// shuffle target array with itself\n\t\t\tif ( !array ) array = target;\n\n\t\t\tif ( !Array.isArray( target ) || !Array.isArray( array ) ) {\n\t\t\t\tthrow new Error( 'You cannot merge an array with a non-array' );\n\t\t\t}\n\n\t\t\tconst comparator = getComparator( shuffle );\n\t\t\tmodel.merge( array, comparator );\n\t\t} else model.set( value );\n\t}\n\n\trunloop.end();\n\n\tkeep = k;\n\n\treturn promise;\n}\n\nconst star = /\\*/;\nexport function gather ( ractive, keypath, base, isolated ) {\n\tif ( !base && ( keypath[0] === '.' || keypath[1] === '^' ) ) {\n\t\twarnIfDebug( `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.` );\n\t\treturn [];\n\t}\n\n\tconst keys = splitKeypath( keypath );\n\tconst model = base || ractive.viewmodel;\n\n\tif ( star.test( keypath ) ) {\n\t\treturn model.findMatches( keys );\n\t} else {\n\t\tif ( model === ractive.viewmodel ) {\n\t\t\t// allow implicit mappings\n\t\t\tif ( ractive.component && !ractive.isolated && !model.has( keys[0] ) && keypath[0] !== '@' && keypath[0] && !isolated ) {\n\t\t\t\treturn [ resolveReference( ractive.fragment || new FakeFragment( ractive ), keypath ) ];\n\t\t\t} else {\n\t\t\t\treturn [ model.joinAll( keys ) ];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [ model.joinAll( keys ) ];\n\t\t}\n\t}\n}\n\nexport function build ( ractive, keypath, value, isolated ) {\n\tconst sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tfor ( const k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push.apply( sets, gather( ractive, k, null, isolated ).map( m => [ m, keypath[k], k ] ) );\n\t\t\t}\n\t\t}\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push.apply( sets, gather( ractive, keypath, null, isolated ).map( m => [ m, value, keypath ] ) );\n\t}\n\n\treturn sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet( model, value ) {\n\tconst dest = model.get( false, deepOpts );\n\n\t// if dest doesn't exist, just set it\n\tif ( dest == null || typeof value !== 'object' ) return model.set( value );\n\tif ( typeof dest !== 'object' ) return model.set( value );\n\n\tfor ( const k in value ) {\n\t\tif ( value.hasOwnProperty( k ) ) {\n\t\t\tdeepSet( model.joinKey( k ), value[k] );\n\t\t}\n\t}\n}\n\nconst comparators = {};\nfunction getComparator ( option ) {\n\tif ( option === true ) return null; // use existing arrays\n\tif ( typeof option === 'function' ) return option;\n\n\tif ( typeof option === 'string' ) {\n\t\treturn comparators[ option ] || ( comparators[ option ] = thing => thing[ option ] );\n\t}\n\n\tthrow new Error( 'If supplied, options.compare must be a string, function, or true' ); // TODO link to docs\n}\n","import { isNumeric } from '../../../utils/is';\nimport { build, set } from '../../../shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add ( ractive, keypath, d, options ) {\n\tif ( typeof keypath !== 'string' || !isNumeric( d ) ) {\n\t\tthrow new Error( 'Bad arguments' );\n\t}\n\n\tconst sets = build( ractive, keypath, d, options && options.isolated );\n\n\treturn set( ractive, sets.map( pair => {\n\t\tconst [ model, add ] = pair;\n\t\tconst value = model.get();\n\t\tif ( !isNumeric( add ) || !isNumeric( value ) ) throw new Error( errorMessage );\n\t\treturn [ model, value + add ];\n\t}));\n}\n","import add from './shared/add';\r\n\r\nexport default function Ractive$add ( keypath, d, options ) {\r\n\tconst num = typeof d === 'number' ? d : 1;\r\n\tconst opts = typeof d === 'object' ? d : options;\r\n\treturn add( this, keypath, num, opts );\r\n}\r\n","import runloop from '../../global/runloop';\r\nimport interpolate from '../../shared/interpolate';\r\nimport { isEqual } from '../../utils/is';\r\nimport { splitKeypath } from '../../shared/keypaths';\r\nimport easing from '../../Ractive/static/easing';\r\nimport noop from '../../utils/noop';\r\n\r\nconst noAnimation = Promise.resolve();\r\nObject.defineProperty( noAnimation, 'stop', { value: noop });\r\n\r\nconst linear = easing.linear;\r\n\r\nfunction getOptions ( options, instance ) {\r\n\toptions = options || {};\r\n\r\n\tlet easing;\r\n\tif ( options.easing ) {\r\n\t\teasing = typeof options.easing === 'function' ?\r\n\t\t\toptions.easing :\r\n\t\t\tinstance.easing[ options.easing ];\r\n\t}\r\n\r\n\treturn {\r\n\t\teasing: easing || linear,\r\n\t\tduration: 'duration' in options ? options.duration : 400,\r\n\t\tcomplete: options.complete || noop,\r\n\t\tstep: options.step || noop\r\n\t};\r\n}\r\n\r\nexport function animate ( ractive, model, to, options ) {\r\n\toptions = getOptions( options, ractive );\r\n\tconst from = model.get();\r\n\r\n\t// don't bother animating values that stay the same\r\n\tif ( isEqual( from, to ) ) {\r\n\t\toptions.complete( options.to );\r\n\t\treturn noAnimation; // TODO should this have .then and .catch methods?\r\n\t}\r\n\r\n\tconst interpolator = interpolate( from, to, ractive, options.interpolator );\r\n\r\n\t// if we can't interpolate the value, set it immediately\r\n\tif ( !interpolator ) {\r\n\t\trunloop.start();\r\n\t\tmodel.set( to );\r\n\t\trunloop.end();\r\n\r\n\t\treturn noAnimation;\r\n\t}\r\n\r\n\treturn model.animate( from, to, options, interpolator );\r\n}\r\n\r\nexport default function Ractive$animate ( keypath, to, options ) {\r\n\tif ( typeof keypath === 'object' ) {\r\n\t\tconst keys = Object.keys( keypath );\r\n\r\n\t\tthrow new Error( `ractive.animate(...) no longer supports objects. Instead of ractive.animate({\r\n  ${keys.map( key => `'${key}': ${keypath[ key ]}` ).join( '\\n  ' )}\r\n}, {...}), do\r\n\r\n${keys.map( key => `ractive.animate('${key}', ${keypath[ key ]}, {...});` ).join( '\\n' )}\r\n` );\r\n\t}\r\n\r\n\r\n\treturn animate( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), to, options );\r\n}\r\n","export function enqueue ( ractive, event ) {\r\n\tif ( ractive.event ) {\r\n\t\tractive._eventQueue.push( ractive.event );\r\n\t}\r\n\r\n\tractive.event = event;\r\n}\r\n\r\nexport function dequeue ( ractive ) {\r\n\tif ( ractive._eventQueue.length ) {\r\n\t\tractive.event = ractive._eventQueue.pop();\r\n\t} else {\r\n\t\tractive.event = null;\r\n\t}\r\n}\r\n","import { enqueue, dequeue } from './eventStack';\r\n\r\nconst initStars = {};\r\nconst bubbleStars = {};\r\n\r\n// cartesian product of name parts and stars\r\n// adjusted appropriately for special cases\r\nfunction variants ( name, initial ) {\r\n\tconst map = initial ? initStars : bubbleStars;\r\n\tif ( map[ name ] ) return map[ name ];\r\n\r\n\tconst parts = name.split( '.' );\r\n\tconst result = [];\r\n\tlet base = false;\r\n\r\n\t// initial events the implicit namespace of 'this'\r\n\tif ( initial ) {\r\n\t\tparts.unshift( 'this' );\r\n\t\tbase = true;\r\n\t}\r\n\r\n\t// use max - 1 bits as a bitmap to pick a part or a *\r\n\t// need to skip the full star case if the namespace is synthetic\r\n\tconst max = Math.pow( 2, parts.length ) - ( initial ? 1 : 0 );\r\n\tfor ( let i = 0; i < max; i++ ) {\r\n\t\tconst join = [];\r\n\t\tfor ( let j = 0; j < parts.length; j++ ) {\r\n\t\t\tjoin.push( 1 & ( i >> j ) ? '*' : parts[j] );\r\n\t\t}\r\n\t\tresult.unshift( join.join( '.' ) );\r\n\t}\r\n\r\n\tif ( base ) {\r\n\t\t// include non-this-namespaced versions\r\n\t\tif ( parts.length > 2 ) {\r\n\t\t\tresult.push.apply( result, variants( name, false ) );\r\n\t\t} else {\r\n\t\t\tresult.push( '*' );\r\n\t\t\tresult.push( name );\r\n\t\t}\r\n\t}\r\n\r\n\tmap[ name ] = result;\r\n\treturn result;\r\n}\r\n\r\nexport default function fireEvent ( ractive, eventName, context, args = [] ) {\r\n\tif ( !eventName ) { return; }\r\n\r\n\tcontext.name = eventName;\r\n\targs.unshift( context );\r\n\r\n\tconst eventNames = ractive._nsSubs ? variants( eventName, true ) : [ '*', eventName ];\r\n\r\n\treturn fireEventAs( ractive, eventNames, context, args, true );\r\n}\r\n\r\nfunction fireEventAs  ( ractive, eventNames, context, args, initialFire = false ) {\r\n\tlet bubble = true;\r\n\r\n\tif ( initialFire || ractive._nsSubs ) {\r\n\t\tenqueue( ractive, context );\r\n\r\n\t\tlet i = eventNames.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tif ( eventNames[ i ] in ractive._subs ) {\r\n\t\t\t\tbubble = notifySubscribers( ractive, ractive._subs[ eventNames[ i ] ], context, args ) && bubble;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdequeue( ractive );\r\n\t}\r\n\r\n\tif ( ractive.parent && bubble ) {\r\n\t\tif ( initialFire && ractive.component ) {\r\n\t\t\tconst fullName = ractive.component.name + '.' + eventNames[ eventNames.length - 1 ];\r\n\t\t\teventNames = variants( fullName, false );\r\n\r\n\t\t\tif ( context && !context.component ) {\r\n\t\t\t\tcontext.component = ractive;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tbubble = fireEventAs( ractive.parent, eventNames, context, args );\r\n\t}\r\n\r\n\treturn bubble;\r\n}\r\n\r\nfunction notifySubscribers ( ractive, subscribers, context, args ) {\r\n\tlet originalEvent = null;\r\n\tlet stopEvent = false;\r\n\r\n\t// subscribers can be modified inflight, e.g. \"once\" functionality\r\n\t// so we need to copy to make sure everyone gets called\r\n\tsubscribers = subscribers.slice();\r\n\r\n\tfor ( let i = 0, len = subscribers.length; i < len; i += 1 ) {\r\n\t\tif ( !subscribers[ i ].off && subscribers[ i ].handler.apply( ractive, args ) === false ) {\r\n\t\t\tstopEvent = true;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( context && stopEvent && ( originalEvent = context.event ) ) {\r\n\t\toriginalEvent.preventDefault && originalEvent.preventDefault();\r\n\t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\r\n\t}\r\n\r\n\treturn !stopEvent;\r\n}\r\n","export function findAnchors ( fragment, name = null ) {\r\n\tconst res = [];\r\n\r\n\tfindAnchorsIn( fragment, name, res );\r\n\r\n\treturn res;\r\n}\r\n\r\nfunction findAnchorsIn ( item, name, result ) {\r\n\tif ( item.isAnchor ) {\r\n\t\tif ( !name || item.name === name ) {\r\n\t\t\tresult.push( item );\r\n\t\t}\r\n\t} else if ( item.items ) {\r\n\t\titem.items.forEach( i => findAnchorsIn( i, name, result ) );\r\n\t} else if ( item.iterations ) {\r\n\t\titem.iterations.forEach( i => findAnchorsIn( i, name, result ) );\r\n\t} else if ( item.fragment && !item.component ) {\r\n\t\tfindAnchorsIn( item.fragment, name, result );\r\n\t}\r\n}\r\n\r\nexport function updateAnchors ( instance, name = null ) {\r\n\tconst anchors = findAnchors( instance.fragment, name );\r\n\tconst idxs = {};\r\n\tconst children = instance._children.byName;\r\n\r\n\tanchors.forEach( a => {\r\n\t\tconst name = a.name;\r\n\t\tif ( !( name in idxs ) ) idxs[name] = 0;\r\n\t\tconst idx = idxs[name];\r\n\t\tconst child = ( children[name] || [] )[idx];\r\n\r\n\t\tif ( child && child.lastBound !== a ) {\r\n\t\t\tif ( child.lastBound ) child.lastBound.removeChild( child );\r\n\t\t\ta.addChild( child );\r\n\t\t}\r\n\r\n\t\tidxs[name]++;\r\n\t});\r\n}\r\n\r\nexport function unrenderChild ( meta ) {\r\n\tif ( meta.instance.fragment.rendered ) {\r\n\t\tmeta.shouldDestroy = true;\r\n\t\tmeta.instance.unrender();\r\n\t}\r\n\tmeta.instance.el = null;\r\n}\r\n","import Hook from '../../events/Hook';\nimport runloop from '../../global/runloop';\nimport { unrenderChild, updateAnchors } from '../../shared/anchors';\n\nconst attachHook = new Hook( 'attachchild' );\n\nexport default function attachChild ( child, options = {} ) {\n\tconst children = this._children;\n\n\tif ( child.parent && child.parent !== this ) throw new Error( `Instance ${child._guid} is already attached to a different instance ${child.parent._guid}. Please detach it from the other instance using detachChild first.` );\n\telse if ( child.parent ) throw new Error( `Instance ${child._guid} is already attached to this instance.` );\n\n\tconst meta = {\n\t\tinstance: child,\n\t\tractive: this,\n\t\tname: options.name || child.constructor.name || 'Ractive',\n\t\ttarget: options.target || false,\n\t\tbubble,\n\t\tfindNextNode\n\t};\n\tmeta.nameOption = options.name;\n\n\t// child is managing itself\n\tif ( !meta.target ) {\n\t\tmeta.parentFragment = this.fragment;\n\t\tmeta.external = true;\n\t} else {\n\t\tlet list;\n\t\tif ( !( list = children.byName[ meta.target ] ) ) {\n\t\t\tlist = [];\n\t\t\tthis.set( `@this.children.byName.${meta.target}`, list );\n\t\t}\n\t\tconst idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n\t\tlist.splice( idx, 0, meta );\n\t}\n\n\tchild.set({\n\t\t'@this.parent': this,\n\t\t'@this.root': this.root\n\t});\n\tchild.component = meta;\n\tchildren.push( meta );\n\n\tattachHook.fire( child );\n\n\tconst promise = runloop.start( child, true );\n\n\tif ( meta.target ) {\n\t\tunrenderChild( meta );\n\t\tthis.set( `@this.children.byName.${meta.target}`, null, { shuffle: true } );\n\t\tupdateAnchors( this, meta.target );\n\t} else {\n\t\tif ( !child.isolated ) child.viewmodel.attached( this.fragment );\n\t}\n\n\trunloop.end();\n\n\tpromise.ractive = child;\n\treturn promise.then( () => child );\n}\n\nfunction bubble () { runloop.addFragment( this.instance.fragment ); }\n\nfunction findNextNode () {\n\tif ( this.anchor ) return this.anchor.findNextNode();\n}\n","import Hook from '../../events/Hook';\r\nimport { removeFromArray } from '../../utils/array';\r\n\r\nconst detachHook = new Hook( 'detach' );\r\n\r\nexport default function Ractive$detach () {\r\n\tif ( this.isDetached ) {\r\n\t\treturn this.el;\r\n\t}\r\n\r\n\tif ( this.el ) {\r\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\r\n\t}\r\n\r\n\tthis.el = this.fragment.detach();\r\n\tthis.isDetached = true;\r\n\r\n\tdetachHook.fire( this );\r\n\treturn this.el;\r\n}\r\n","import Hook from '../../events/Hook';\r\nimport runloop from '../../global/runloop';\r\nimport { updateAnchors } from '../../shared/anchors';\r\n\r\nconst detachHook = new Hook( 'detachchild' );\r\n\r\nexport default function detachChild ( child ) {\r\n\tconst children = this._children;\r\n\tlet meta, index;\r\n\r\n\tlet i = children.length;\r\n\twhile ( i-- ) {\r\n\t\tif ( children[i].instance === child ) {\r\n\t\t\tindex = i;\r\n\t\t\tmeta = children[i];\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( !meta || child.parent !== this ) throw new Error( `Instance ${child._guid} is not attached to this instance.` );\r\n\r\n\tconst promise = runloop.start( child, true );\r\n\r\n\tif ( meta.anchor ) meta.anchor.removeChild( meta );\r\n\tif ( !child.isolated ) child.viewmodel.detached();\r\n\r\n\trunloop.end();\r\n\r\n\tchildren.splice( index, 1 );\r\n\tif ( meta.target ) {\r\n\t\tconst list = children.byName[ meta.target ];\r\n\t\tlist.splice( list.indexOf( meta ), 1 );\r\n\t\tthis.set( `@this.children.byName.${meta.target}`, null, { shuffle: true } );\r\n\t\tupdateAnchors( this, meta.target );\r\n\t}\r\n\tchild.set({\r\n\t\t'@this.parent': undefined,\r\n\t\t'@this.root': child\r\n\t});\r\n\tchild.component = null;\r\n\r\n\tdetachHook.fire( child );\r\n\r\n\tpromise.ractive = child;\r\n\treturn promise.then( () => child );\r\n}\r\n","export default function Ractive$find ( selector, options = {} ) {\r\n\tif ( !this.el ) throw new Error( `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM` );\r\n\r\n\tlet node = this.fragment.find( selector, options );\r\n\tif ( node ) return node;\r\n\r\n\tif ( options.remote ) {\r\n\t\tfor ( let i = 0; i < this._children.length; i++ ) {\r\n\t\t\tif ( !this._children[i].instance.fragment.rendered ) continue;\r\n\t\t\tnode = this._children[i].instance.find( selector, options );\r\n\t\t\tif ( node ) return node;\r\n\t\t}\r\n\t}\r\n}\r\n","export default function Ractive$findAll ( selector, options = {} ) {\r\n\tif ( !this.el ) throw new Error( `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM` );\r\n\r\n\tif ( !Array.isArray( options.result ) ) options.result = [];\r\n\r\n\tthis.fragment.findAll( selector, options );\r\n\r\n\tif ( options.remote ) {\r\n\t\t// seach non-fragment children\r\n\t\tthis._children.forEach( c => {\r\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\r\n\t\t\t\tc.instance.findAll( selector, options );\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn options.result;\r\n}\r\n","export default function Ractive$findAllComponents ( selector, options ) {\r\n\tif ( !options && typeof selector === 'object' ) {\r\n\t\toptions = selector;\r\n\t\tselector = '';\r\n\t}\r\n\r\n\toptions = options || {};\r\n\r\n\tif ( !Array.isArray( options.result ) ) options.result = [];\r\n\r\n\tthis.fragment.findAllComponents( selector, options );\r\n\r\n\tif ( options.remote ) {\r\n\t\t// search non-fragment children\r\n\t\tthis._children.forEach( c => {\r\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\r\n\t\t\t\tif ( !selector || c.name === selector ) {\r\n\t\t\t\t\toptions.result.push( c.instance );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc.instance.findAllComponents( selector, options );\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn options.result;\r\n}\r\n\r\n","export default function Ractive$findComponent ( selector, options = {} ) {\r\n\tif ( typeof selector === 'object' ) {\r\n\t\toptions = selector;\r\n\t\tselector = '';\r\n\t}\r\n\r\n\tlet child = this.fragment.findComponent( selector, options );\r\n\tif ( child ) return child;\r\n\r\n\tif ( options.remote ) {\r\n\t\tif ( !selector && this._children.length ) return this._children[0].instance;\r\n\t\tfor ( let i = 0; i < this._children.length; i++ ) {\r\n\t\t\t// skip children that are or should be in an anchor\r\n\t\t\tif ( this._children[i].target ) continue;\r\n\t\t\tif ( this._children[i].name === selector ) return this._children[i].instance;\r\n\t\t\tchild = this._children[i].instance.findComponent( selector, options );\r\n\t\t\tif ( child ) return child;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n","export default function Ractive$findContainer ( selector ) {\r\n\tif ( this.container ) {\r\n\t\tif ( this.container.component && this.container.component.name === selector ) {\r\n\t\t\treturn this.container;\r\n\t\t} else {\r\n\t\t\treturn this.container.findContainer( selector );\r\n\t\t}\r\n\t}\r\n\r\n\treturn null;\r\n}","export default function Ractive$findParent ( selector ) {\r\n\r\n\tif ( this.parent ) {\r\n\t\tif ( this.parent.component && this.parent.component.name === selector ) {\r\n\t\t\treturn this.parent;\r\n\t\t} else {\r\n\t\t\treturn this.parent.findParent ( selector );\r\n\t\t}\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","// This function takes an array, the name of a mutator method, and the\r\n// arguments to call that mutator method with, and returns an array that\r\n// maps the old indices to their new indices.\r\n\r\n// So if you had something like this...\r\n//\r\n//     array = [ 'a', 'b', 'c', 'd' ];\r\n//     array.push( 'e' );\r\n//\r\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\r\n// have changed. If you then did this...\r\n//\r\n//     array.unshift( 'z' );\r\n//\r\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\r\n// one higher to make room for the 'z'. If you removed an item, the new index\r\n// would be -1...\r\n//\r\n//     array.splice( 2, 2 );\r\n//\r\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\r\n//\r\n// This information is used to enable fast, non-destructive shuffling of list\r\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\r\n\r\nexport default function getNewIndices ( length, methodName, args ) {\r\n\tconst newIndices = [];\r\n\r\n\tconst spliceArguments = getSpliceEquivalent( length, methodName, args );\r\n\r\n\tif ( !spliceArguments ) {\r\n\t\treturn null; // TODO support reverse and sort?\r\n\t}\r\n\r\n\tconst balance = ( spliceArguments.length - 2 ) - spliceArguments[1];\r\n\r\n\tconst removeStart = Math.min( length, spliceArguments[0] );\r\n\tconst removeEnd = removeStart + spliceArguments[1];\r\n\tnewIndices.startIndex = removeStart;\r\n\r\n\tlet i;\r\n\tfor ( i = 0; i < removeStart; i += 1 ) {\r\n\t\tnewIndices.push( i );\r\n\t}\r\n\r\n\tfor ( ; i < removeEnd; i += 1 ) {\r\n\t\tnewIndices.push( -1 );\r\n\t}\r\n\r\n\tfor ( ; i < length; i += 1 ) {\r\n\t\tnewIndices.push( i + balance );\r\n\t}\r\n\r\n\t// there is a net shift for the rest of the array starting with index + balance\r\n\tif ( balance !== 0 ) {\r\n\t\tnewIndices.touchedFrom = spliceArguments[0];\r\n\t} else {\r\n\t\tnewIndices.touchedFrom = length;\r\n\t}\r\n\r\n\treturn newIndices;\r\n}\r\n\r\n\r\n// The pop, push, shift an unshift methods can all be represented\r\n// as an equivalent splice\r\nfunction getSpliceEquivalent ( length, methodName, args ) {\r\n\tswitch ( methodName ) {\r\n\t\tcase 'splice':\r\n\t\t\tif ( args[0] !== undefined && args[0] < 0 ) {\r\n\t\t\t\targs[0] = length + Math.max( args[0], -length );\r\n\t\t\t}\r\n\r\n\t\t\tif ( args[0] === undefined ) args[0] = 0;\r\n\r\n\t\t\twhile ( args.length < 2 ) {\r\n\t\t\t\targs.push( length - args[0] );\r\n\t\t\t}\r\n\r\n\t\t\tif ( typeof args[1] !== 'number' ) {\r\n\t\t\t\targs[1] = length - args[0];\r\n\t\t\t}\r\n\r\n\t\t\t// ensure we only remove elements that exist\r\n\t\t\targs[1] = Math.min( args[1], length - args[0] );\r\n\r\n\t\t\treturn args;\r\n\r\n\t\tcase 'sort':\r\n\t\tcase 'reverse':\r\n\t\t\treturn null;\r\n\r\n\t\tcase 'pop':\r\n\t\t\tif ( length ) {\r\n\t\t\t\treturn [ length - 1, 1 ];\r\n\t\t\t}\r\n\t\t\treturn [ 0, 0 ];\r\n\r\n\t\tcase 'push':\r\n\t\t\treturn [ length, 0 ].concat( args );\r\n\r\n\t\tcase 'shift':\r\n\t\t\treturn [ 0, length ? 1 : 0 ];\r\n\r\n\t\tcase 'unshift':\r\n\t\t\treturn [ 0, 0 ].concat( args );\r\n\t}\r\n}\r\n","import Hook from '../../events/Hook';\r\nimport runloop from '../../global/runloop';\r\nimport { splitKeypath } from '../../shared/keypaths';\r\n\r\nconst updateHook = new Hook( 'update' );\r\n\r\nexport function update ( ractive, model, options ) {\r\n\t// if the parent is wrapped, the adaptor will need to be updated before\r\n\t// updating on this keypath\r\n\tif ( model.parent && model.parent.wrapper ) {\r\n\t\tmodel.parent.adapt();\r\n\t}\r\n\r\n\tconst promise = runloop.start( ractive, true );\r\n\r\n\tmodel.mark( options && options.force );\r\n\r\n\t// notify upstream of changes\r\n\tmodel.notifyUpstream();\r\n\r\n\trunloop.end();\r\n\r\n\tupdateHook.fire( ractive, model );\r\n\r\n\treturn promise;\r\n}\r\n\r\nexport default function Ractive$update ( keypath, options ) {\r\n\tlet opts, path;\r\n\r\n\tif ( typeof keypath === 'string' ) {\r\n\t\tpath = splitKeypath( keypath );\r\n\t\topts = options;\r\n\t} else {\r\n\t\topts = keypath;\r\n\t}\r\n\r\n\treturn update( this, path ? this.viewmodel.joinAll( path ) : this.viewmodel, opts );\r\n}\r\n","import { ANCHOR, COMPONENT, ELEMENT } from '../../../config/types';\r\n\r\nexport default function findElement( start, orComponent = true, name ) {\r\n\twhile ( start && ( start.type !== ELEMENT || ( name && start.name !== name ) ) && ( !orComponent || ( start.type !== COMPONENT && start.type !== ANCHOR ) ) ) {\r\n\t\t// start is a fragment - look at the owner\r\n\t\tif ( start.owner ) start = start.owner;\r\n\t\t// start is a component or yielder - look at the container\r\n\t\telse if ( start.component ) start = start.containerFragment || start.component.parentFragment;\r\n\t\t// start is an item - look at the parent\r\n\t\telse if ( start.parent ) start = start.parent;\r\n\t\t// start is an item without a parent - look at the parent fragment\r\n\t\telse if ( start.parentFragment ) start = start.parentFragment;\r\n\r\n\t\telse start = undefined;\r\n\t}\r\n\r\n\treturn start;\r\n}\r\n","import resolveReference from '../view/resolvers/resolveReference';\nimport { set as sharedSet } from './set';\nimport { isNumeric, isObject } from '../utils/is';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport runloop from '../global/runloop';\nimport findElement from '../view/items/shared/findElement';\nimport getRactiveContext, { extern } from './getRactiveContext';\nimport Model from '../model/Model';\n\nconst modelPush = makeArrayMethod( 'push' ).model;\nconst modelPop = makeArrayMethod( 'pop' ).model;\nconst modelShift = makeArrayMethod( 'shift' ).model;\nconst modelUnshift = makeArrayMethod( 'unshift' ).model;\nconst modelSort = makeArrayMethod( 'sort' ).model;\nconst modelSplice = makeArrayMethod( 'splice' ).model;\nconst modelReverse = makeArrayMethod( 'reverse' ).model;\n\nclass ContextData extends Model {\n\tconstructor ( options ) {\n\t\tsuper( null, null );\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.value = {};\n\t\tthis.ractive = options.ractive;\n\t\tthis.adaptors = [];\n\t\tthis.context = options.context;\n\t}\n\n\tgetKeypath () {\n\t\treturn '@context.data';\n\t}\n}\n\nexport default class Context {\n\tconstructor ( fragment, element ) {\n\t\tthis.fragment = fragment;\n\t\tthis.element = element || findElement( fragment );\n\t\tthis.node = this.element && this.element.node;\n\t\tthis.ractive = fragment.ractive;\n\t\tthis.root = this;\n\t}\n\n\tget decorators () {\n\t\tconst items = {};\n\t\tif ( !this.element ) return items;\n\t\tthis.element.decorators.forEach( d => items[ d.name ] = d.intermediary );\n\t\treturn items;\n\t}\n\n\tget _data () {\n\t\treturn this.model || ( this.root.model = new ContextData({ ractive: this.ractive, context: this.root }) );\n\t}\n\n\t// the usual mutation suspects\n\tadd ( keypath, d, options ) {\n\t\tconst num = typeof d === 'number' ? +d : 1;\n\t\tconst opts = typeof d === 'object' ? d : options;\n\t\treturn sharedSet( this.ractive, build( this, keypath, num ).map( pair => {\n\t\t\tconst [ model, val ] = pair;\n\t\t\tconst value = model.get();\n\t\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) throw new Error( 'Cannot add non-numeric value' );\n\t\t\treturn [ model, value + val ];\n\t\t}), opts );\n\t}\n\n\tanimate ( keypath, value, options ) {\n\t\tconst model = findModel( this, keypath ).model;\n\t\treturn protoAnimate( this.ractive, model, value, options );\n\t}\n\n\t// get relative keypaths and values\n\tget ( keypath ) {\n\t\tif ( !keypath ) return this.fragment.findContext().get( true );\n\n\t\tconst { model } = findModel( this, keypath );\n\n\t\treturn model ? model.get( true ) : undefined;\n\t}\n\n\tlink ( source, dest ) {\n\t\tconst there = findModel( this, source ).model;\n\t\tconst here = findModel( this, dest ).model;\n\t\tconst promise = runloop.start( this.ractive, true );\n\t\there.link( there, source );\n\t\trunloop.end();\n\t\treturn promise;\n\t}\n\n\tobserve ( keypath, callback, options = {} ) {\n\t\tif ( isObject( keypath ) ) options = callback || {};\n\t\toptions.fragment = this.fragment;\n\t\treturn this.ractive.observe( keypath, callback, options );\n\t}\n\n\tobserveOnce ( keypath, callback, options = {} ) {\n\t\tif ( isObject( keypath ) ) options = callback || {};\n\t\toptions.fragment = this.fragment;\n\t\treturn this.ractive.observeOnce( keypath, callback, options );\n\t}\n\n\tpop ( keypath ) {\n\t\treturn modelPop( findModel( this, keypath ).model, [] );\n\t}\n\n\tpush ( keypath, ...values ) {\n\t\treturn modelPush( findModel( this, keypath ).model, values );\n\t}\n\n\traise ( name, event, ...args ) {\n\t\tlet element = this.element;\n\n\t\twhile ( element ) {\n\t\t\tconst events = element.events;\n\t\t\tfor ( let i = 0; i < events.length; i++ ) {\n\t\t\t\tconst ev = events[i];\n\t\t\t\tif ( ~ev.template.n.indexOf( name ) ) {\n\t\t\t\t\tev.fire( ev.element.getContext( event ), args );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telement = element.parent;\n\t\t}\n\t}\n\n\treadLink ( keypath, options ) {\n\t\treturn this.ractive.readLink( this.resolve( keypath ), options );\n\t}\n\n\tresolve ( path, ractive ) {\n\t\tconst { model, instance } = findModel( this, path );\n\t\treturn model ? model.getKeypath( ractive || instance ) : path;\n\t}\n\n\treverse ( keypath ) {\n\t\treturn modelReverse( findModel( this, keypath ).model, [] );\n\t}\n\n\tset ( keypath, value, options ) {\n\t\treturn sharedSet( this.ractive, build( this, keypath, value ), options );\n\t}\n\n\tshift ( keypath ) {\n\t\treturn modelShift( findModel( this, keypath ).model, [] );\n\t}\n\n\tsplice ( keypath, index, drop, ...add ) {\n\t\tadd.unshift( index, drop );\n\t\treturn modelSplice( findModel( this, keypath ).model, add );\n\t}\n\n\tsort ( keypath ) {\n\t\treturn modelSort( findModel( this, keypath ).model, [] );\n\t}\n\n\tsubtract ( keypath, d, options ) {\n\t\tconst num = typeof d === 'number' ? d : 1;\n\t\tconst opts = typeof d === 'object' ? d : options;\n\t\treturn sharedSet( this.ractive, build( this, keypath, num ).map( pair => {\n\t\t\tconst [ model, val ] = pair;\n\t\t\tconst value = model.get();\n\t\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) throw new Error( 'Cannot add non-numeric value' );\n\t\t\treturn [ model, value - val ];\n\t\t}), opts );\n\t}\n\n\ttoggle ( keypath, options ) {\n\t\tconst { model } = findModel( this, keypath );\n\t\treturn sharedSet( this.ractive, [ [ model, !model.get() ] ], options );\n\t}\n\n\tunlink ( dest ) {\n\t\tconst here = findModel( this, dest ).model;\n\t\tconst promise = runloop.start( this.ractive, true );\n\t\tif ( here.owner && here.owner._link ) here.owner.unlink();\n\t\trunloop.end();\n\t\treturn promise;\n\t}\n\n\tunshift ( keypath, ...add ) {\n\t\treturn modelUnshift( findModel( this, keypath ).model, add );\n\t}\n\n\tupdate ( keypath, options ) {\n\t\treturn protoUpdate( this.ractive, findModel( this, keypath ).model, options );\n\t}\n\n\tupdateModel ( keypath, cascade ) {\n\t\tconst { model } = findModel( this, keypath );\n\t\tconst promise = runloop.start( this.ractive, true );\n\t\tmodel.updateFromBindings( cascade );\n\t\trunloop.end();\n\t\treturn promise;\n\t}\n\n\t// two-way binding related helpers\n\tisBound () {\n\t\tconst { model } = this.getBindingModel( this );\n\t\treturn !!model;\n\t}\n\n\tgetBindingPath ( ractive ) {\n\t\tconst { model, instance } = this.getBindingModel( this );\n\t\tif ( model ) return model.getKeypath( ractive || instance );\n\t}\n\n\tgetBinding () {\n\t\tconst { model } = this.getBindingModel( this );\n\t\tif ( model ) return model.get( true );\n\t}\n\n\tgetBindingModel ( ctx ) {\n\t\tconst el = ctx.element;\n\t\treturn { model: el.binding && el.binding.model, instance: el.parentFragment.ractive };\n\t}\n\n\tsetBinding ( value ) {\n\t\tconst { model } = this.getBindingModel( this );\n\t\treturn sharedSet( this.ractive, [ [ model, value ] ] );\n\t}\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build ( ctx, keypath, value ) {\n\tconst sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tfor ( const k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push( [ findModel( ctx, k ).model, keypath[k] ] );\n\t\t\t}\n\t\t}\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push( [ findModel( ctx, keypath ).model, value ] );\n\t}\n\n\treturn sets;\n}\n\nfunction findModel ( ctx, path ) {\n\tconst frag = ctx.fragment;\n\n\tif ( typeof path !== 'string' ) {\n\t\treturn { model: frag.findContext(), instance: path };\n\t}\n\n\treturn { model: resolveReference( frag, path ), instance: frag.ractive };\n}\n","import fireEvent from '../../events/fireEvent';\r\nimport Context from '../../shared/Context';\r\n\r\nexport default function Ractive$fire ( eventName, ...args ) {\r\n\t// watch for reproxy\r\n\tif ( args[0] instanceof Context ) {\r\n\t\tconst proto = args.shift();\r\n\t\tconst ctx = Object.create( proto );\r\n\t\tObject.assign( ctx, proto );\r\n\t\treturn fireEvent( this, eventName, ctx, args );\r\n\t} else {\r\n\t\treturn fireEvent( this, eventName, Context.forRactive( this ), args );\r\n\t}\r\n}\r\n","import { splitKeypath } from '../../shared/keypaths';\nimport resolveReference from '../../view/resolvers/resolveReference';\nimport { FakeFragment } from '../../shared/getRactiveContext';\n\nexport default function Ractive$get ( keypath, opts ) {\n\tif ( typeof keypath !== 'string' ) return this.viewmodel.get( true, keypath );\n\n\tconst keys = splitKeypath( keypath );\n\tconst key = keys[0];\n\n\tlet model;\n\n\tif ( !this.viewmodel.has( key ) ) {\n\t\t// if this is an inline component, we may need to create\n\t\t// an implicit mapping\n\t\tif ( this.component && !this.isolated ) {\n\t\t\tmodel = resolveReference( this.fragment || new FakeFragment( this ), key );\n\t\t}\n\t}\n\n\tmodel = this.viewmodel.joinAll( keys );\n\treturn model.get( true, opts );\n}\n","import { doc } from '../../config/environment';\nimport getRactiveContext from '../../shared/getRactiveContext';\nimport { warnOnceIfDebug } from '../../utils/log';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext ( node ) {\n\tif ( typeof node === 'string' && query ) {\n\t\tnode = query.call( document, node );\n\t}\n\n\tlet instances;\n\tif ( node ) {\n\t\tif ( node._ractive ) {\n\t\t\treturn node._ractive.proxy.getContext();\n\t\t} else if ( ( instances = node.__ractive_instances__ ) && instances.length === 1 ) {\n\t\t\treturn getRactiveContext( instances[0] );\n\t\t}\n\t}\n}\n\nexport function getNodeInfo ( node ) {\n\twarnOnceIfDebug( `getNodeInfo has been renamed to getContext, and the getNodeInfo alias will be removed in a future release.` );\n\treturn getContext ( node );\n}\n","import staticContext, { getNodeInfo as staticInfo } from '../static/getContext';\n\nexport default function getContext ( node, options ) {\n\tif ( typeof node === 'string' ) {\n\t\tnode = this.find( node, options );\n\t}\n\n\treturn staticContext( node );\n}\n\nexport function getNodeInfo ( node, options ) {\n\tif ( typeof node === 'string' ) {\n\t\tnode = this.find( node, options );\n\t}\n\n\treturn staticInfo( node );\n}\n","import { isClient, svg, vendors, win, doc } from '../config/environment';\r\nimport { html } from '../config/namespaces';\r\n\r\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\r\n\r\n// Test for SVG support\r\nif ( !svg ) {\r\n\tcreateElement = ( type, ns, extend ) => {\r\n\t\tif ( ns && ns !== html ) {\r\n\t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\r\n\t\t}\r\n\r\n\t\treturn extend ?\r\n\t\t\tdoc.createElement( type, extend ) :\r\n\t\t\tdoc.createElement( type );\r\n\t};\r\n} else {\r\n\tcreateElement = ( type, ns, extend ) => {\r\n\t\tif ( !ns || ns === html ) {\r\n\t\t\treturn extend ?\r\n\t\t\t\tdoc.createElement( type, extend ) :\r\n\t\t\t\tdoc.createElement( type );\r\n\t\t}\r\n\r\n\t\treturn extend ?\r\n\t\t\tdoc.createElementNS( ns, type, extend ) :\r\n\t\t\tdoc.createElementNS( ns, type );\r\n\t};\r\n}\r\n\r\nexport function createDocumentFragment () {\r\n\treturn doc.createDocumentFragment();\r\n}\r\n\r\nfunction getElement ( input ) {\r\n\tlet output;\r\n\r\n\tif ( !input || typeof input === 'boolean' ) { return; }\r\n\r\n\tif ( !win || !doc || !input ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// We already have a DOM node - no work to do. (Duck typing alert!)\r\n\tif ( input.nodeType ) {\r\n\t\treturn input;\r\n\t}\r\n\r\n\t// Get node from string\r\n\tif ( typeof input === 'string' ) {\r\n\t\t// try ID first\r\n\t\toutput = doc.getElementById( input );\r\n\r\n\t\t// then as selector, if possible\r\n\t\tif ( !output && doc.querySelector ) {\r\n\t\t\toutput = doc.querySelector( input );\r\n\t\t}\r\n\r\n\t\t// did it work?\r\n\t\tif ( output && output.nodeType ) {\r\n\t\t\treturn output;\r\n\t\t}\r\n\t}\r\n\r\n\t// If we've been given a collection (jQuery, Zepto etc), extract the first item\r\n\tif ( input[0] && input[0].nodeType ) {\r\n\t\treturn input[0];\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\nif ( !isClient ) {\r\n\tmatches = null;\r\n} else {\r\n\tdiv = createElement( 'div' );\r\n\tmethodNames = [ 'matches', 'matchesSelector' ];\r\n\r\n\tmakeFunction = function ( methodName ) {\r\n\t\treturn function ( node, selector ) {\r\n\t\t\treturn node[ methodName ]( selector );\r\n\t\t};\r\n\t};\r\n\r\n\ti = methodNames.length;\r\n\r\n\twhile ( i-- && !matches ) {\r\n\t\tunprefixed = methodNames[i];\r\n\r\n\t\tif ( div[ unprefixed ] ) {\r\n\t\t\tmatches = makeFunction( unprefixed );\r\n\t\t} else {\r\n\t\t\tj = vendors.length;\r\n\t\t\twhile ( j-- ) {\r\n\t\t\t\tprefixed = vendors[i] + unprefixed.substr( 0, 1 ).toUpperCase() + unprefixed.substring( 1 );\r\n\r\n\t\t\t\tif ( div[ prefixed ] ) {\r\n\t\t\t\t\tmatches = makeFunction( prefixed );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// IE8...\r\n\tif ( !matches ) {\r\n\t\tmatches = function ( node, selector ) {\r\n\t\t\tlet parentNode, i;\r\n\r\n\t\t\tparentNode = node.parentNode;\r\n\r\n\t\t\tif ( !parentNode ) {\r\n\t\t\t\t// empty dummy <div>\r\n\t\t\t\tdiv.innerHTML = '';\r\n\r\n\t\t\t\tparentNode = div;\r\n\t\t\t\tnode = node.cloneNode();\r\n\r\n\t\t\t\tdiv.appendChild( node );\r\n\t\t\t}\r\n\r\n\t\t\tconst nodes = parentNode.querySelectorAll( selector );\r\n\r\n\t\t\ti = nodes.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tif ( nodes[i] === node ) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t};\r\n\t}\r\n}\r\n\r\nfunction detachNode ( node ) {\r\n\t// stupid ie\r\n\tif ( node && typeof node.parentNode !== 'unknown' && node.parentNode ) { // eslint-disable-line valid-typeof\r\n\t\tnode.parentNode.removeChild( node );\r\n\t}\r\n\r\n\treturn node;\r\n}\r\n\r\nfunction safeToStringValue ( value ) {\r\n\treturn ( value == null || !value.toString ) ? '' : '' + value;\r\n}\r\n\r\nfunction safeAttributeString ( string ) {\r\n\treturn safeToStringValue( string )\r\n\t\t.replace( /&/g, '&amp;' )\r\n\t\t.replace( /\"/g, '&quot;' )\r\n\t\t.replace( /'/g, '&#39;' );\r\n}\r\n\r\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\r\n","import Hook from '../../events/Hook';\r\nimport { getElement } from '../../utils/dom';\r\n\r\nconst insertHook = new Hook( 'insert' );\r\n\r\nexport default function Ractive$insert ( target, anchor ) {\r\n\tif ( !this.fragment.rendered ) {\r\n\t\t// TODO create, and link to, documentation explaining this\r\n\t\tthrow new Error( 'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.' );\r\n\t}\r\n\r\n\ttarget = getElement( target );\r\n\tanchor = getElement( anchor ) || null;\r\n\r\n\tif ( !target ) {\r\n\t\tthrow new Error( 'You must specify a valid target to insert into' );\r\n\t}\r\n\r\n\ttarget.insertBefore( this.detach(), anchor );\r\n\tthis.el = target;\r\n\r\n\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( this );\r\n\tthis.isDetached = false;\r\n\r\n\tfireInsertHook( this );\r\n}\r\n\r\nfunction fireInsertHook( ractive ) {\r\n\tinsertHook.fire( ractive );\r\n\r\n\tractive.findAllComponents('*').forEach( child => {\r\n\t\tfireInsertHook( child.instance );\r\n\t});\r\n}\r\n","import { splitKeypath } from '../../shared/keypaths';\nimport resolveReference from '../../view/resolvers/resolveReference';\nimport runloop from '../../global/runloop';\n\nexport default function link( there, here, options ) {\n\tlet model;\n\tconst target = ( options && ( options.ractive || options.instance ) ) || this;\n\n\t// may need to allow a mapping to resolve implicitly\n\tconst sourcePath = splitKeypath( there );\n\tif ( !target.viewmodel.has( sourcePath[0] ) && target.component ) {\n\t\tmodel = resolveReference( target.component.parentFragment, sourcePath[0] );\n\t\tmodel = model.joinAll( sourcePath.slice( 1 ) );\n\t}\n\n\tconst src = model || target.viewmodel.joinAll( sourcePath );\n\tconst dest = this.viewmodel.joinAll( splitKeypath( here ), { lastLink: false });\n\n\tif ( isUpstream( src, dest ) || isUpstream( dest, src ) ) {\n\t\tthrow new Error( 'A keypath cannot be linked to itself.' );\n\t}\n\n\tconst promise = runloop.start();\n\n\tdest.link( src, there );\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nfunction isUpstream ( check, start ) {\n\tlet model = start;\n\twhile ( model ) {\n\t\tif ( model === check ) return true;\n\t\tmodel = model.target || model.parent;\n\t}\n}\n","import { isEqual } from '../../../utils/is';\r\nimport { removeFromArray } from '../../../utils/array';\r\nimport runloop from '../../../global/runloop';\r\nimport { rebindMatch } from '../../../shared/rebind';\r\n\r\nexport default class Observer {\r\n\tconstructor ( ractive, model, callback, options ) {\r\n\t\tthis.context = options.context || ractive;\r\n\t\tthis.callback = callback;\r\n\t\tthis.ractive = ractive;\r\n\t\tthis.keypath = options.keypath;\r\n\t\tthis.options = options;\r\n\r\n\t\tif ( model ) this.resolved( model );\r\n\r\n\t\tif ( typeof options.old === 'function' ) {\r\n\t\t\tthis.oldContext = Object.create( ractive );\r\n\t\t\tthis.old = options.old;\r\n\t\t} else {\r\n\t\t\tthis.old = old;\r\n\t\t}\r\n\r\n\t\tif ( options.init !== false ) {\r\n\t\t\tthis.dirty = true;\r\n\t\t\tthis.dispatch();\r\n\t\t} else {\r\n\t\t\tthis.oldValue = this.old.call( this.oldContext, undefined, this.newValue );\r\n\t\t}\r\n\r\n\t\tthis.dirty = false;\r\n\t}\r\n\r\n\tcancel () {\r\n\t\tthis.cancelled = true;\r\n\t\tif ( this.model ) {\r\n\t\t\tthis.model.unregister( this );\r\n\t\t} else {\r\n\t\t\tthis.resolver.unbind();\r\n\t\t}\r\n\t\tremoveFromArray( this.ractive._observers, this );\r\n\t}\r\n\r\n\tdispatch () {\r\n\t\tif ( !this.cancelled ) {\r\n\t\t\tthis.callback.call( this.context, this.newValue, this.oldValue, this.keypath );\r\n\t\t\tthis.oldValue = this.old.call( this.oldContext, this.oldValue, this.model ? this.model.get() : this.newValue );\r\n\t\t\tthis.dirty = false;\r\n\t\t}\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tconst newValue = this.model.get();\r\n\t\t\tif ( isEqual( newValue, this.oldValue ) ) return;\r\n\r\n\t\t\tthis.newValue = newValue;\r\n\r\n\t\t\tif ( this.options.strict && this.newValue === this.oldValue ) return;\r\n\r\n\t\t\trunloop.addObserver( this, this.options.defer );\r\n\t\t\tthis.dirty = true;\r\n\r\n\t\t\tif ( this.options.once ) runloop.scheduleTask( () => this.cancel() );\r\n\t\t}\r\n\t}\r\n\r\n\trebind ( next, previous ) {\r\n\t\tnext = rebindMatch( this.keypath, next, previous );\r\n\t\t// TODO: set up a resolver if next is undefined?\r\n\t\tif ( next === this.model ) return false;\r\n\r\n\t\tif ( this.model ) this.model.unregister( this );\r\n\t\tif ( next ) next.addShuffleTask( () => this.resolved( next ) );\r\n\t}\r\n\r\n\tresolved ( model ) {\r\n\t\tthis.model = model;\r\n\r\n\t\tthis.oldValue = undefined;\r\n\t\tthis.newValue = model.get();\r\n\r\n\t\tmodel.register( this );\r\n\t}\r\n}\r\n\r\nfunction old ( previous, next ) {\r\n\treturn next;\r\n}\r\n","import { removeFromArray } from '../../../utils/array';\r\nimport runloop from '../../../global/runloop';\r\n\r\nfunction negativeOne () {\r\n\treturn -1;\r\n}\r\n\r\nexport default class ArrayObserver {\r\n\tconstructor ( ractive, model, callback, options ) {\r\n\t\tthis.ractive = ractive;\r\n\t\tthis.model = model;\r\n\t\tthis.keypath = model.getKeypath();\r\n\t\tthis.callback = callback;\r\n\t\tthis.options = options;\r\n\r\n\t\tthis.pending = null;\r\n\r\n\t\tmodel.register( this );\r\n\r\n\t\tif ( options.init !== false ) {\r\n\t\t\tthis.sliced = [];\r\n\t\t\tthis.shuffle([]);\r\n\t\t\tthis.dispatch();\r\n\t\t} else {\r\n\t\t\tthis.sliced = this.slice();\r\n\t\t}\r\n\t}\r\n\r\n\tcancel () {\r\n\t\tthis.model.unregister( this );\r\n\t\tremoveFromArray( this.ractive._observers, this );\r\n\t}\r\n\r\n\tdispatch () {\r\n\t\tthis.callback( this.pending );\r\n\t\tthis.pending = null;\r\n\t\tif ( this.options.once ) this.cancel();\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tif ( this.pending ) {\r\n\t\t\t// post-shuffle\r\n\t\t\trunloop.addObserver( this, this.options.defer );\r\n\t\t} else {\r\n\t\t\t// entire array changed\r\n\t\t\tthis.shuffle( this.sliced.map( negativeOne ) );\r\n\t\t\tthis.handleChange();\r\n\t\t}\r\n\t}\r\n\r\n\tshuffle ( newIndices ) {\r\n\t\tconst newValue = this.slice();\r\n\r\n\t\tconst inserted = [];\r\n\t\tconst deleted = [];\r\n\t\tlet start;\r\n\r\n\t\tconst hadIndex = {};\r\n\r\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\r\n\t\t\thadIndex[ newIndex ] = true;\r\n\r\n\t\t\tif ( newIndex !== oldIndex && start === undefined ) {\r\n\t\t\t\tstart = oldIndex;\r\n\t\t\t}\r\n\r\n\t\t\tif ( newIndex === -1 ) {\r\n\t\t\t\tdeleted.push( this.sliced[ oldIndex ] );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif ( start === undefined ) start = newIndices.length;\r\n\r\n\t\tconst len = newValue.length;\r\n\t\tfor ( let i = 0; i < len; i += 1 ) {\r\n\t\t\tif ( !hadIndex[i] ) inserted.push( newValue[i] );\r\n\t\t}\r\n\r\n\t\tthis.pending = { inserted, deleted, start };\r\n\t\tthis.sliced = newValue;\r\n\t}\r\n\r\n\tslice () {\r\n\t\tconst value = this.model.get();\r\n\t\treturn Array.isArray( value ) ? value.slice() : [];\r\n\t}\r\n}\r\n\r\n","import { isObject } from '../../utils/is';\r\nimport { warnOnceIfDebug } from '../../utils/log';\r\nimport { splitKeypath } from '../../shared/keypaths';\r\nimport resolveReference from '../../view/resolvers/resolveReference';\r\nimport Observer from './observe/Observer';\r\nimport PatternObserver from './observe/Pattern';\r\nimport ArrayObserver from './observe/Array';\r\n\r\nexport default function observe ( keypath, callback, options ) {\r\n\tconst observers = [];\r\n\tlet map;\r\n\tlet opts;\r\n\r\n\tif ( isObject( keypath ) ) {\r\n\t\tmap = keypath;\r\n\t\topts = callback || {};\r\n\t} else {\r\n\t\tif ( typeof keypath === 'function' ) {\r\n\t\t\tmap = { '': keypath };\r\n\t\t\topts = callback || {};\r\n\t\t} else {\r\n\t\t\tmap = {};\r\n\t\t\tmap[ keypath ] = callback;\r\n\t\t\topts = options || {};\r\n\t\t}\r\n\t}\r\n\r\n\tlet silent = false;\r\n\tObject.keys( map ).forEach( keypath => {\r\n\t\tconst callback = map[ keypath ];\r\n\t\tconst caller = function ( ...args ) {\r\n\t\t\tif ( silent ) return;\r\n\t\t\treturn callback.apply( this, args );\r\n\t\t};\r\n\r\n\t\tlet keypaths = keypath.split( ' ' );\r\n\t\tif ( keypaths.length > 1 ) keypaths = keypaths.filter( k => k );\r\n\r\n\t\tkeypaths.forEach( keypath => {\r\n\t\t\topts.keypath = keypath;\r\n\t\t\tconst observer = createObserver( this, keypath, caller, opts );\r\n\t\t\tif ( observer ) observers.push( observer );\r\n\t\t});\r\n\t});\r\n\r\n\t// add observers to the Ractive instance, so they can be\r\n\t// cancelled on ractive.teardown()\r\n\tthis._observers.push.apply( this._observers, observers );\r\n\r\n\treturn {\r\n\t\tcancel: () => observers.forEach( o => o.cancel() ),\r\n\t\tisSilenced: () => silent,\r\n\t\tsilence: () => silent = true,\r\n\t\tresume: () => silent = false\r\n\t};\r\n}\r\n\r\nfunction createObserver ( ractive, keypath, callback, options ) {\r\n\tconst keys = splitKeypath( keypath );\r\n\tlet wildcardIndex = keys.indexOf( '*' );\r\n\tif ( !~wildcardIndex ) wildcardIndex = keys.indexOf( '**' );\r\n\r\n\toptions.fragment = options.fragment || ractive.fragment;\r\n\r\n\tlet model;\r\n\tif ( !options.fragment ) {\r\n\t\tmodel = ractive.viewmodel.joinKey( keys[0] );\r\n\t} else {\r\n\t\t// .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\r\n\t\tif ( ~keys[0].indexOf( '.*' ) ) {\r\n\t\t\tmodel = options.fragment.findContext();\r\n\t\t\twildcardIndex = 0;\r\n\t\t\tkeys[0] = keys[0].slice( 1 );\r\n\t\t} else {\r\n\t\t\tmodel = wildcardIndex === 0 ? options.fragment.findContext() : resolveReference( options.fragment, keys[0] );\r\n\t\t}\r\n\t}\r\n\r\n\t// the model may not exist key\r\n\tif ( !model ) model = ractive.viewmodel.joinKey( keys[0] );\r\n\r\n\tif ( !~wildcardIndex ) {\r\n\t\tmodel = model.joinAll( keys.slice( 1 ) );\r\n\t\tif ( options.array ) {\r\n\t\t\treturn new ArrayObserver( ractive, model, callback, options );\r\n\t\t} else {\r\n\t\t\treturn new Observer( ractive, model, callback, options );\r\n\t\t}\r\n\t} else {\r\n\t\tconst double = keys.indexOf( '**' );\r\n\t\tif ( ~double ) {\r\n\t\t\tif ( double + 1 !== keys.length || ~keys.indexOf( '*' ) ) {\r\n\t\t\t\twarnOnceIfDebug( `Recursive observers may only specify a single '**' at the end of the path.` );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmodel = model.joinAll( keys.slice( 1, wildcardIndex ) );\r\n\r\n\t\treturn new PatternObserver( ractive, model, keys.slice( wildcardIndex ), callback, options );\r\n\t}\r\n}\r\n","import { isObject } from '../../utils/is';\r\n\r\nconst onceOptions = { init: false, once: true };\r\n\r\nexport default function observeOnce ( keypath, callback, options ) {\r\n\tif ( isObject( keypath ) || typeof keypath === 'function' ) {\r\n\t\toptions = Object.assign( callback || {}, onceOptions );\r\n\t\treturn this.observe( keypath, options );\r\n\t}\r\n\r\n\toptions = Object.assign( options || {}, onceOptions );\r\n\treturn this.observe( keypath, callback, options );\r\n}\r\n","import trim from './shared/trim';\r\nimport notEmptyString from './shared/notEmptyString';\r\nimport { removeFromArray } from '../../utils/array';\r\n\r\nexport default function Ractive$off ( eventName, callback ) {\r\n\t// if no event is specified, remove _all_ event listeners\r\n\tif ( !eventName ) {\r\n\t\tthis._subs = {};\r\n\t} else {\r\n\t\t// Handle multiple space-separated event names\r\n\t\tconst eventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\r\n\r\n\t\teventNames.forEach( event => {\r\n\t\t\tconst subs = this._subs[ event ];\r\n\t\t\t// if given a specific callback to remove, remove only it\r\n\t\t\tif ( subs && callback ) {\r\n\t\t\t\tconst entry = subs.find( s => s.callback === callback );\r\n\t\t\t\tif ( entry ) {\r\n\t\t\t\t\tremoveFromArray( subs, entry );\r\n\t\t\t\t\tentry.off = true;\r\n\r\n\t\t\t\t\tif ( event.indexOf( '.' ) ) this._nsSubs--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// otherwise, remove all listeners for this event\r\n\t\t\telse if ( subs ) {\r\n\t\t\t\tif ( event.indexOf( '.' ) ) this._nsSubs -= subs.length;\r\n\t\t\t\tsubs.length = 0;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import trim from './shared/trim';\r\nimport notEmptyString from './shared/notEmptyString';\r\n\r\nexport default function Ractive$on ( eventName, callback ) {\r\n\t// eventName may already be a map\r\n\tconst map = typeof eventName === 'object' ? eventName : {};\r\n\t// or it may be a string along with a callback\r\n\tif ( typeof eventName === 'string' ) map[ eventName ] = callback;\r\n\r\n\tlet silent = false;\r\n\tconst events = [];\r\n\r\n\tfor ( const k in map ) {\r\n\t\tconst callback = map[k];\r\n\t\tconst caller = function ( ...args ) {\r\n\t\t\tif ( !silent ) return callback.apply( this, args );\r\n\t\t};\r\n\t\tconst entry = {\r\n\t\t\tcallback,\r\n\t\t\thandler: caller\r\n\t\t};\r\n\r\n\t\tif ( map.hasOwnProperty( k ) ) {\r\n\t\t\tconst names = k.split( ' ' ).map( trim ).filter( notEmptyString );\r\n\t\t\tnames.forEach( n => {\r\n\t\t\t\t( this._subs[ n ] || ( this._subs[ n ] = [] ) ).push( entry );\r\n\t\t\t\tif ( n.indexOf( '.' ) ) this._nsSubs++;\r\n\t\t\t\tevents.push( [ n, entry ] );\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tcancel: () => events.forEach( e => this.off( e[0], e[1].callback ) ),\r\n\t\tisSilenced: () => silent,\r\n\t\tsilence: () => silent = true,\r\n\t\tresume: () => silent = false\r\n\t};\r\n}\r\n","export default function Ractive$once ( eventName, handler ) {\r\n\tconst listener = this.on( eventName, function () {\r\n\t\thandler.apply( this, arguments );\r\n\t\tlistener.cancel();\r\n\t});\r\n\r\n\t// so we can still do listener.cancel() manually\r\n\treturn listener;\r\n}\r\n","import { splitKeypath } from '../../shared/keypaths';\r\n\r\nexport default function readLink ( keypath, options = {} ) {\r\n\tconst path = splitKeypath( keypath );\r\n\r\n\tif ( this.viewmodel.has( path[0] ) ) {\r\n\t\tlet model = this.viewmodel.joinAll( path );\r\n\r\n\t\tif ( !model.isLink ) return;\r\n\r\n\t\twhile ( ( model = model.target ) && options.canonical !== false ) {\r\n\t\t\tif ( !model.isLink ) break;\r\n\t\t}\r\n\r\n\t\tif ( model ) return { ractive: model.root.ractive, keypath: model.getKeypath() };\r\n\t}\r\n}\r\n","import { doc } from '../config/environment';\r\n\r\nconst PREFIX = '/* Ractive.js component styles */';\r\n\r\n// Holds current definitions of styles.\r\nconst styleDefinitions = [];\r\n\r\n// Flag to tell if we need to update the CSS\r\nlet isDirty = false;\r\n\r\n// These only make sense on the browser. See additional setup below.\r\nlet styleElement = null;\r\nlet useCssText = null;\r\n\r\nexport function addCSS( styleDefinition ) {\r\n\tstyleDefinitions.push( styleDefinition );\r\n\tisDirty = true;\r\n}\r\n\r\nexport function applyCSS() {\r\n\r\n\t// Apply only seems to make sense when we're in the DOM. Server-side renders\r\n\t// can call toCSS to get the updated CSS.\r\n\tif ( !doc || !isDirty ) return;\r\n\r\n\tif ( useCssText ) {\r\n\t\tstyleElement.styleSheet.cssText = getCSS( null );\r\n\t} else {\r\n\t\tstyleElement.innerHTML = getCSS( null );\r\n\t}\r\n\r\n\tisDirty = false;\r\n}\r\n\r\nexport function getCSS( cssIds ) {\r\n\r\n\tconst filteredStyleDefinitions = cssIds ? styleDefinitions.filter( style => ~cssIds.indexOf( style.id ) ) : styleDefinitions;\r\n\r\n\treturn filteredStyleDefinitions.reduce( ( styles, style ) => `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}`, PREFIX );\r\n\r\n}\r\n\r\n// If we're on the browser, additional setup needed.\r\nif ( doc && ( !styleElement || !styleElement.parentNode ) ) {\r\n\r\n\tstyleElement = doc.createElement( 'style' );\r\n\tstyleElement.type = 'text/css';\r\n\r\n\tdoc.getElementsByTagName( 'head' )[ 0 ].appendChild( styleElement );\r\n\r\n\tuseCssText = !!styleElement.styleSheet;\r\n}\r\n","export function fillGaps ( target, ...sources ) {\r\n\r\n\tfor (let i = 0; i < sources.length; i++){\r\n\t\tconst source = sources[i];\r\n\t\tfor ( const key in source ) {\r\n\t\t\t// Source can be a prototype-less object.\r\n\t\t\tif ( key in target || !Object.prototype.hasOwnProperty.call( source, key ) ) continue;\r\n\t\t\ttarget[ key ] = source[ key ];\r\n\t\t}\r\n\t}\r\n\r\n\treturn target;\r\n}\r\n\r\nexport function toPairs ( obj = {} ) {\r\n\tconst pairs = [];\r\n\tfor ( const key in obj ) {\r\n\t\t// Source can be a prototype-less object.\r\n\t\tif ( !Object.prototype.hasOwnProperty.call( obj, key ) ) continue;\r\n\t\tpairs.push( [ key, obj[ key ] ] );\r\n\t}\r\n\treturn pairs;\r\n}\r\n","import cleanCss from '../../../../utils/cleanCss';\r\n\r\nconst selectorsPattern = /(?:^|\\}|\\{)\\s*([^\\{\\}\\0]+)\\s*(?=\\{)/g;\r\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\r\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\r\nconst excludePattern = /^(?:@|\\d+%)/;\r\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\r\n\r\nfunction trim ( str ) {\r\n\treturn str.trim();\r\n}\r\n\r\nfunction extractString ( unit ) {\r\n\treturn unit.str;\r\n}\r\n\r\nfunction transformSelector ( selector, parent ) {\r\n\tconst selectorUnits = [];\r\n\tlet match;\r\n\r\n\twhile ( match = selectorUnitPattern.exec( selector ) ) {\r\n\t\tselectorUnits.push({\r\n\t\t\tstr: match[0],\r\n\t\t\tbase: match[1],\r\n\t\t\tmodifiers: match[2]\r\n\t\t});\r\n\t}\r\n\r\n\t// For each simple selector within the selector, we need to create a version\r\n\t// that a) combines with the id, and b) is inside the id\r\n\tconst base = selectorUnits.map( extractString );\r\n\r\n\tconst transformed = [];\r\n\tlet i = selectorUnits.length;\r\n\r\n\twhile ( i-- ) {\r\n\t\tconst appended = base.slice();\r\n\r\n\t\t// Pseudo-selectors should go after the attribute selector\r\n\t\tconst unit = selectorUnits[i];\r\n\t\tappended[i] = unit.base + parent + unit.modifiers || '';\r\n\r\n\t\tconst prepended = base.slice();\r\n\t\tprepended[i] = parent + ' ' + prepended[i];\r\n\r\n\t\ttransformed.push( appended.join( ' ' ), prepended.join( ' ' ) );\r\n\t}\r\n\r\n\treturn transformed.join( ', ' );\r\n}\r\n\r\nexport default function transformCss ( css, id ) {\r\n\tconst dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\r\n\r\n\tlet transformed;\r\n\r\n\tif ( dataRvcGuidPattern.test( css ) ) {\r\n\t\ttransformed = css.replace( dataRvcGuidPattern, dataAttr );\r\n\t} else {\r\n\t\ttransformed = cleanCss( css, ( css, reconstruct ) => {\r\n\t\t\tcss = css.replace( selectorsPattern, ( match, $1 ) => {\r\n\t\t\t\t// don't transform at-rules and keyframe declarations\r\n\t\t\t\tif ( excludePattern.test( $1 ) ) return match;\r\n\r\n\t\t\t\tconst selectors = $1.split( ',' ).map( trim );\r\n\t\t\t\tconst transformed = selectors\r\n\t\t\t\t\t.map( selector => transformSelector( selector, dataAttr ) )\r\n\t\t\t\t\t.join( ', ' ) + ' ';\r\n\r\n\t\t\t\treturn match.replace( $1, transformed );\r\n\t\t\t});\r\n\r\n\t\t\treturn reconstruct( css );\r\n\t\t}, [ keyframesDeclarationPattern ]);\r\n\t}\r\n\r\n\treturn transformed;\r\n}\r\n","function s4() {\r\n\treturn Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\r\n}\r\n\r\nexport function uuid() {\r\n\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\r\n}\r\n","import { fatal, warnIfDebug, warnOnceIfDebug } from '../../../utils/log';\r\nimport { isObject } from '../../../utils/is';\r\nimport bind from '../../../utils/bind';\r\n\r\nfunction validate ( data ) {\r\n\t// Warn if userOptions.data is a non-POJO\r\n\tif ( data && data.constructor !== Object ) {\r\n\t\tif ( typeof data === 'function' ) {\r\n\t\t\t// TODO do we need to support this in the new Ractive() case?\r\n\t\t} else if ( typeof data !== 'object' ) {\r\n\t\t\tfatal( `data option must be an object or a function, \\`${data}\\` is not valid` );\r\n\t\t} else {\r\n\t\t\twarnIfDebug( 'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged' );\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default {\r\n\tname: 'data',\r\n\r\n\textend: ( Parent, proto, options ) => {\r\n\t\tlet key;\r\n\t\tlet value;\r\n\r\n\t\t// check for non-primitives, which could cause mutation-related bugs\r\n\t\tif ( options.data && isObject( options.data ) ) {\r\n\t\t\tfor ( key in options.data ) {\r\n\t\t\t\tvalue = options.data[ key ];\r\n\r\n\t\t\t\tif ( value && typeof value === 'object' ) {\r\n\t\t\t\t\tif ( isObject( value ) || Array.isArray( value ) ) {\r\n\t\t\t\t\t\twarnIfDebug( `Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\r\n\r\n  // this...\r\n  data: function () {\r\n    return {\r\n      myObject: {}\r\n    };\r\n  })\r\n\r\n  // instead of this:\r\n  data: {\r\n    myObject: {}\r\n  }` );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tproto.data = combine( proto.data, options.data );\r\n\t},\r\n\r\n\tinit: ( Parent, ractive, options ) => {\r\n\t\tlet result = combine( Parent.prototype.data, options.data );\r\n\r\n\t\tif ( typeof result === 'function' ) result = result.call( ractive );\r\n\r\n\t\t// bind functions to the ractive instance at the top level,\r\n\t\t// unless it's a non-POJO (in which case alarm bells should ring)\r\n\t\tif ( result && result.constructor === Object ) {\r\n\t\t\tfor ( const prop in result ) {\r\n\t\t\t\tif ( typeof result[ prop ] === 'function' ) {\r\n\t\t\t\t\tconst value = result[ prop ];\r\n\t\t\t\t\tresult[ prop ] = bind( value, ractive );\r\n\t\t\t\t\tresult[ prop ]._r_unbound = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result || {};\r\n\t},\r\n\r\n\treset ( ractive ) {\r\n\t\tconst result = this.init( ractive.constructor, ractive, ractive.viewmodel );\r\n\t\tractive.viewmodel.root.set( result );\r\n\t\treturn true;\r\n\t}\r\n};\r\n\r\nfunction combine ( parentValue, childValue ) {\r\n\tvalidate( childValue );\r\n\r\n\tconst parentIsFn = typeof parentValue === 'function';\r\n\tconst childIsFn = typeof childValue === 'function';\r\n\r\n\t// Very important, otherwise child instance can become\r\n\t// the default data object on Ractive or a component.\r\n\t// then ractive.set() ends up setting on the prototype!\r\n\tif ( !childValue && !parentIsFn ) {\r\n\t\tchildValue = {};\r\n\t}\r\n\r\n\t// Fast path, where we just need to copy properties from\r\n\t// parent to child\r\n\tif ( !parentIsFn && !childIsFn ) {\r\n\t\treturn fromProperties( childValue, parentValue );\r\n\t}\r\n\r\n\treturn function () {\r\n\t\tconst child = childIsFn ? callDataFunction( childValue, this ) : childValue;\r\n\t\tconst parent = parentIsFn ? callDataFunction( parentValue, this ) : parentValue;\r\n\r\n\t\treturn fromProperties( child, parent );\r\n\t};\r\n}\r\n\r\nfunction callDataFunction ( fn, context ) {\r\n\tconst data = fn.call( context );\r\n\r\n\tif ( !data ) return;\r\n\r\n\tif ( typeof data !== 'object' ) {\r\n\t\tfatal( 'Data function must return an object' );\r\n\t}\r\n\r\n\tif ( data.constructor !== Object ) {\r\n\t\twarnOnceIfDebug( 'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged' );\r\n\t}\r\n\r\n\treturn data;\r\n}\r\n\r\nfunction fromProperties ( primary, secondary ) {\r\n\tif ( primary && secondary ) {\r\n\t\tfor ( const key in secondary ) {\r\n\t\t\tif ( !( key in primary ) ) {\r\n\t\t\t\tprimary[ key ] = secondary[ key ];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn primary;\r\n\t}\r\n\r\n\treturn primary || secondary;\r\n}\r\n","const pattern = /\\$\\{([^\\}]+)\\}/g;\r\n\r\nexport function fromExpression ( body, length = 0 ) {\r\n\tconst args = new Array( length );\r\n\r\n\twhile ( length-- ) {\r\n\t\targs[length] = `_${length}`;\r\n\t}\r\n\r\n\t// Functions created directly with new Function() look like this:\r\n\t//     function anonymous (_0 /**/) { return _0*2 }\r\n\t//\r\n\t// With this workaround, we get a little more compact:\r\n\t//     function (_0){return _0*2}\r\n\treturn new Function( [], `return function (${args.join(',')}){return(${body});};` )();\r\n}\r\n\r\nexport function fromComputationString ( str, bindTo ) {\r\n\tlet hasThis;\r\n\r\n\tlet functionBody = 'return (' + str.replace( pattern, ( match, keypath ) => {\r\n\t\thasThis = true;\r\n\t\treturn `__ractive.get(\"${keypath}\")`;\r\n\t}) + ');';\r\n\r\n\tif ( hasThis ) functionBody = `var __ractive = this; ${functionBody}`;\r\n\tconst fn = new Function( functionBody );\r\n\treturn hasThis ? fn.bind( bindTo ) : fn;\r\n}\r\n","import { createFunction } from '../Ractive/config/runtime-parser';\r\n\r\nconst functions = Object.create( null );\r\n\r\nexport default function getFunction ( str, i ) {\r\n\tif ( functions[ str ] ) return functions[ str ];\r\n\treturn functions[ str ] = createFunction( str, i );\r\n}\r\n\r\nexport function addFunctions( template ) {\r\n\tif ( !template ) return;\r\n\r\n\tconst exp = template.e;\r\n\r\n\tif ( !exp ) return;\r\n\r\n\tObject.keys( exp ).forEach( ( str ) => {\r\n\t\tif ( functions[ str ] ) return;\r\n\t\tfunctions[ str ] = exp[ str ];\r\n\t});\r\n}\r\n\r\n\r\n","const delimiterChangePattern = /^[^\\s=]+/;\r\nconst whitespacePattern = /^\\s+/;\r\n\r\nexport default function readDelimiterChange ( parser ) {\r\n\tif ( !parser.matchString( '=' ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst start = parser.pos;\r\n\r\n\t// allow whitespace before new opening delimiter\r\n\tparser.allowWhitespace();\r\n\r\n\tconst opening = parser.matchPattern( delimiterChangePattern );\r\n\tif ( !opening ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// allow whitespace (in fact, it's necessary...)\r\n\tif ( !parser.matchPattern( whitespacePattern ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst closing = parser.matchPattern( delimiterChangePattern );\r\n\tif ( !closing ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// allow whitespace before closing '='\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( '=' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn [ opening, closing ];\r\n}\r\n","import { REGEXP_LITERAL } from '../../../../../config/types';\r\n\r\nconst regexpPattern = /^(\\/(?:[^\\n\\r\\u2028\\u2029/\\\\[]|\\\\.|\\[(?:[^\\n\\r\\u2028\\u2029\\]\\\\]|\\\\.)*])+\\/(?:([gimuy])(?![a-z]*\\2))*(?![a-zA-Z_$0-9]))/;\r\n\r\nexport default function readNumberLiteral ( parser ) {\r\n\tlet result;\r\n\r\n\tif ( result = parser.matchPattern( regexpPattern ) ) {\r\n\t\treturn {\r\n\t\t\tt: REGEXP_LITERAL,\r\n\t\t\tv: result\r\n\t\t};\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","const pattern = /[-/\\\\^$*+?.()|[\\]{}]/g;\r\n\r\nexport default function escapeRegExp ( str ) {\r\n\treturn str.replace( pattern, '\\\\$&' );\r\n}\r\n","// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\r\nexport const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\r\nexport const voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\r\n\r\nconst htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, int: 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830\t};\r\nconst controlCharacters = [ 8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376 ];\r\nconst entityPattern = new RegExp( '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys( htmlEntities ).join( '|' ) + '));?', 'g' );\r\nconst codePointSupport = typeof String.fromCodePoint === 'function';\r\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\r\n\r\nexport function decodeCharacterReferences ( html ) {\r\n\treturn html.replace( entityPattern, ( match, entity ) => {\r\n\t\tlet code;\r\n\r\n\t\t// Handle named entities\r\n\t\tif ( entity[0] !== '#' ) {\r\n\t\t\tcode = htmlEntities[ entity ];\r\n\t\t} else if ( entity[1] === 'x' ) {\r\n\t\t\tcode = parseInt( entity.substring( 2 ), 16 );\r\n\t\t} else {\r\n\t\t\tcode = parseInt( entity.substring( 1 ), 10 );\r\n\t\t}\r\n\r\n\t\tif ( !code ) {\r\n\t\t\treturn match;\r\n\t\t}\r\n\r\n\t\treturn codeToChar( validateCode( code ) );\r\n\t});\r\n}\r\n\r\nconst lessThan = /</g;\r\nconst greaterThan = />/g;\r\nconst amp = /&/g;\r\nconst invalid = 65533;\r\n\r\nexport function escapeHtml ( str ) {\r\n\treturn str\r\n\t\t.replace( amp, '&amp;' )\r\n\t\t.replace( lessThan, '&lt;' )\r\n\t\t.replace( greaterThan, '&gt;' );\r\n}\r\n\r\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\r\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\r\n// to replace them ourselves\r\n//\r\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\r\nfunction validateCode ( code ) {\r\n\tif ( !code ) {\r\n\t\treturn invalid;\r\n\t}\r\n\r\n\t// line feed becomes generic whitespace\r\n\tif ( code === 10 ) {\r\n\t\treturn 32;\r\n\t}\r\n\r\n\t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\r\n\tif ( code < 128 ) {\r\n\t\treturn code;\r\n\t}\r\n\r\n\t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\r\n\t// to correct the mistake or we'll end up with missing € signs and so on\r\n\tif ( code <= 159 ) {\r\n\t\treturn controlCharacters[ code - 128 ];\r\n\t}\r\n\r\n\t// basic multilingual plane\r\n\tif ( code < 55296 ) {\r\n\t\treturn code;\r\n\t}\r\n\r\n\t// UTF-16 surrogate halves\r\n\tif ( code <= 57343 ) {\r\n\t\treturn invalid;\r\n\t}\r\n\r\n\t// rest of the basic multilingual plane\r\n\tif ( code <= 65535 ) {\r\n\t\treturn code;\r\n\t} else if ( !codePointSupport ) {\r\n\t\treturn invalid;\r\n\t}\r\n\r\n\t// supplementary multilingual plane 0x10000 - 0x1ffff\r\n\tif ( code >= 65536 && code <= 131071 ) {\r\n\t\treturn code;\r\n\t}\r\n\r\n\t// supplementary ideographic plane 0x20000 - 0x2ffff\r\n\tif ( code >= 131072 && code <= 196607 ) {\r\n\t\treturn code;\r\n\t}\r\n\r\n\treturn invalid;\r\n}\r\n","import { NUMBER_LITERAL } from '../../../../../config/types';\r\n\r\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\r\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\r\n\r\nexport default function readNumberLiteral ( parser ) {\r\n\tlet result;\r\n\r\n\tif ( result = parser.matchPattern( numberPattern ) ) {\r\n\t\treturn {\r\n\t\t\tt: NUMBER_LITERAL,\r\n\t\t\tv: result\r\n\t\t};\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","import { BOOLEAN_LITERAL } from '../../../../../config/types';\r\n\r\nexport default function readBooleanLiteral ( parser ) {\r\n\tconst remaining = parser.remaining();\r\n\r\n\tif ( remaining.substr( 0, 4 ) === 'true' ) {\r\n\t\tparser.pos += 4;\r\n\t\treturn {\r\n\t\t\tt: BOOLEAN_LITERAL,\r\n\t\t\tv: 'true'\r\n\t\t};\r\n\t}\r\n\r\n\tif ( remaining.substr( 0, 5 ) === 'false' ) {\r\n\t\tparser.pos += 5;\r\n\t\treturn {\r\n\t\t\tt: BOOLEAN_LITERAL,\r\n\t\t\tv: 'false'\r\n\t\t};\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","import readExpression from '../../../readExpression';\r\nimport { STRING_LITERAL, BRACKETED, INFIX_OPERATOR } from '../../../../../config/types';\r\nimport { escapeSequencePattern, lineContinuationPattern } from './stringLiteral/makeQuotedStringMatcher';\r\n\r\n// Match one or more characters until: \", ', or \\\r\nconst stringMiddlePattern = /^[^`\"\\\\\\$]+?(?:(?=[`\"\\\\\\$]))/;\r\n\r\nconst escapes = /[\\r\\n\\t\\b\\f]/g;\r\nfunction getString ( literal ) {\r\n\treturn JSON.parse( `\"${literal.replace( escapes, escapeChar )}\"` );\r\n}\r\n\r\nfunction escapeChar ( c ) {\r\n\tswitch ( c ) {\r\n\t\tcase '\\n': return '\\\\n';\r\n\t\tcase '\\r': return '\\\\r';\r\n\t\tcase '\\t': return '\\\\t';\r\n\t\tcase '\\b': return '\\\\b';\r\n\t\tcase '\\f': return '\\\\f';\r\n\t}\r\n}\r\n\r\nexport default function readTemplateStringLiteral ( parser ) {\r\n\tif ( !parser.matchString( '`' ) ) return null;\r\n\r\n\tlet literal = '';\r\n\tlet done = false;\r\n\tlet next;\r\n\tconst parts = [];\r\n\r\n\twhile ( !done ) {\r\n\t\tnext = parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) ||\r\n\t\t\tparser.matchString( '$' ) || parser.matchString( '\"' );\r\n\t\tif ( next ) {\r\n\t\t\tif ( next === `\"` ) {\r\n\t\t\t\tliteral += `\\\\\"`;\r\n\t\t\t} else if ( next === '\\\\`' ) {\r\n\t\t\t\tliteral += '`';\r\n\t\t\t} else if ( next === '$' ) {\r\n\t\t\t\tif ( parser.matchString( '{' ) ) {\r\n\t\t\t\t\tparts.push({ t: STRING_LITERAL, v: getString( literal ) });\r\n\t\t\t\t\tliteral = '';\r\n\r\n\t\t\t\t\tparser.allowWhitespace();\r\n\t\t\t\t\tconst expr = readExpression( parser );\r\n\r\n\t\t\t\t\tif ( !expr ) parser.error( 'Expected valid expression' );\r\n\r\n\t\t\t\t\tparts.push({ t: BRACKETED, x: expr });\r\n\r\n\t\t\t\t\tparser.allowWhitespace();\r\n\t\t\t\t\tif ( !parser.matchString( '}' ) ) parser.error( `Expected closing '}' after interpolated expression` );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tliteral += '$';\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tliteral += next;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tnext = parser.matchPattern( lineContinuationPattern );\r\n\t\t\tif ( next ) {\r\n\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\r\n\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt(1).toString(16) ).slice( -4 );\r\n\t\t\t} else {\r\n\t\t\t\tdone = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif ( literal.length ) parts.push({ t: STRING_LITERAL, v: getString( literal ) });\r\n\r\n\tif ( !parser.matchString( '`' ) ) parser.error( \"Expected closing '`'\" );\r\n\r\n\tif ( parts.length === 1 ) {\r\n\t\treturn parts[0];\r\n\t} else {\r\n\t\tlet result = parts.pop();\r\n\t\tlet part;\r\n\r\n\t\twhile ( part = parts.pop() ) {\r\n\t\t\tresult = {\r\n\t\t\t\tt: INFIX_OPERATOR,\r\n\t\t\t\ts: '+',\r\n\t\t\t\to: [ part, result ]\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tt: BRACKETED,\r\n\t\t\tx: result\r\n\t\t};\r\n\t}\r\n}\r\n","import readStringLiteral from '../primary/literal/readStringLiteral';\r\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\r\nimport { name as namePattern } from './patterns';\r\n\r\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\r\n\r\n// http://mathiasbynens.be/notes/javascript-properties\r\n// can be any name, string literal, or number literal\r\nexport default function readKey ( parser ) {\r\n\tlet token;\r\n\r\n\tif ( token = readStringLiteral( parser ) ) {\r\n\t\treturn identifier.test( token.v ) ? token.v : '\"' + token.v.replace( /\"/g, '\\\\\"' ) + '\"';\r\n\t}\r\n\r\n\tif ( token = readNumberLiteral( parser ) ) {\r\n\t\treturn token.v;\r\n\t}\r\n\r\n\tif ( token = parser.matchPattern( namePattern ) ) {\r\n\t\treturn token;\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","import { KEY_VALUE_PAIR, REFERENCE } from '../../../../../../config/types';\r\nimport readKey from '../../../shared/readKey';\r\nimport readExpression from '../../../../readExpression';\r\nimport { name as namePattern, spreadPattern } from '../../../shared/patterns';\r\n\r\nexport default function readKeyValuePair ( parser ) {\r\n\tlet spread;\r\n\tconst start = parser.pos;\r\n\r\n\t// allow whitespace between '{' and key\r\n\tparser.allowWhitespace();\r\n\r\n\tconst refKey = parser.nextChar() !== '\\'' && parser.nextChar() !== '\"';\r\n\tif ( refKey ) spread = parser.matchPattern( spreadPattern );\r\n\r\n\tconst key = spread ? readExpression( parser ) : readKey( parser );\r\n\tif ( key === null ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// allow whitespace between key and ':'\r\n\tparser.allowWhitespace();\r\n\r\n\t// es2015 shorthand property\r\n\tif ( refKey && ( parser.nextChar() === ',' || parser.nextChar() === '}' ) ) {\r\n\t\tif ( !spread && !namePattern.test( key ) ) {\r\n\t\t\tparser.error( `Expected a valid reference, but found '${key}' instead.` );\r\n\t\t}\r\n\r\n\t\tconst pair = {\r\n\t\t\tt: KEY_VALUE_PAIR,\r\n\t\t\tk: key,\r\n\t\t\tv: {\r\n\t\t\t\tt: REFERENCE,\r\n\t\t\t\tn: key\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif ( spread ) {\r\n\t\t\tpair.p = true;\r\n\t\t}\r\n\r\n\t\treturn pair;\r\n\t}\r\n\r\n\r\n\t// next character must be ':'\r\n\tif ( !parser.matchString( ':' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// allow whitespace between ':' and value\r\n\tparser.allowWhitespace();\r\n\r\n\t// next expression must be a, well... expression\r\n\tconst value = readExpression( parser );\r\n\tif ( value === null ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn {\r\n\t\tt: KEY_VALUE_PAIR,\r\n\t\tk: key,\r\n\t\tv: value\r\n\t};\r\n}\r\n","import getKeyValuePair from './keyValuePair';\r\n\r\nexport default function readKeyValuePairs ( parser ) {\r\n\tconst start = parser.pos;\r\n\r\n\tconst pair = getKeyValuePair( parser );\r\n\tif ( pair === null ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst pairs = [ pair ];\r\n\r\n\tif ( parser.matchString( ',' ) ) {\r\n\t\tconst keyValuePairs = readKeyValuePairs( parser );\r\n\r\n\t\tif ( !keyValuePairs ) {\r\n\t\t\tparser.pos = start;\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn pairs.concat( keyValuePairs );\r\n\t}\r\n\r\n\treturn pairs;\r\n}\r\n","import readNumberLiteral from './literal/readNumberLiteral';\r\nimport readBooleanLiteral from './literal/readBooleanLiteral';\r\nimport readStringLiteral from './literal/readStringLiteral';\r\nimport readTemplateStringLiteral from './literal/readTemplateStringLiteral';\r\nimport readObjectLiteral from './literal/readObjectLiteral';\r\nimport readArrayLiteral from './literal/readArrayLiteral';\r\nimport readRegexpLiteral from './literal/readRegexpLiteral';\r\n\r\nexport default function readLiteral ( parser ) {\r\n\treturn readNumberLiteral( parser )         ||\r\n\t       readBooleanLiteral( parser )        ||\r\n\t       readStringLiteral( parser )         ||\r\n\t       readTemplateStringLiteral( parser ) ||\r\n\t       readObjectLiteral( parser )         ||\r\n\t       readArrayLiteral( parser )          ||\r\n\t       readRegexpLiteral( parser );\r\n}\r\n","import { BRACKETED, GLOBAL, REFERENCE } from '../../../../config/types';\r\nimport { normalise } from '../../../../shared/keypaths';\r\nimport { legalReference, relaxedName } from '../shared/patterns';\r\n\r\n// if a reference is a browser global, we don't deference it later, so it needs special treatment\r\nconst globals = /^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null|Object|Number|String|Boolean)\\b/;\r\n\r\n// keywords are not valid references, with the exception of `this`\r\nconst keywords = /^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;\r\n\r\nconst prefixPattern = /^(?:\\@\\.|\\@|~\\/|(?:\\^\\^\\/(?:\\^\\^\\/)*(?:\\.\\.\\/)*)|(?:\\.\\.\\/)+|\\.\\/(?:\\.\\.\\/)*|\\.)/;\r\nconst specials = /^(key|index|keypath|rootpath|this|global|shared|context|event|node|local)/;\r\n\r\nexport default function readReference ( parser ) {\r\n\tlet prefix, name, global, reference, lastDotIndex;\r\n\r\n\tconst startPos = parser.pos;\r\n\r\n\tprefix = parser.matchPattern( prefixPattern ) || '';\r\n\tname = ( !prefix && parser.relaxedNames && parser.matchPattern( relaxedName ) ) ||\r\n\t\t\tparser.matchPattern( legalReference );\r\n\tconst actual = prefix.length + ( ( name && name.length ) || 0 );\r\n\r\n\tif ( prefix === '@.' ) {\r\n\t\tprefix = '@';\r\n\t\tif ( name ) name = 'this.' + name;\r\n\t\telse name = 'this';\r\n\t}\r\n\r\n\tif ( !name && prefix ) {\r\n\t\tname = prefix;\r\n\t\tprefix = '';\r\n\t}\r\n\r\n\tif ( !name ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( prefix === '@' ) {\r\n\t\tif ( !specials.test( name ) ) {\r\n\t\t\tparser.error( `Unrecognized special reference @${name}` );\r\n\t\t} else if ( ( ~name.indexOf( 'event' ) || ~name.indexOf( 'node' ) ) && !parser.inEvent ) {\r\n\t\t\tparser.error( `@event and @node are only valid references within an event directive` );\r\n\t\t} else if ( ~name.indexOf( 'context' ) ) {\r\n\t\t\tparser.pos = parser.pos - ( name.length - 7 );\r\n\t\t\treturn {\r\n\t\t\t\tt: BRACKETED,\r\n\t\t\t\tx: {\r\n\t\t\t\t\tt: REFERENCE,\r\n\t\t\t\t\tn: '@context'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t// bug out if it's a keyword (exception for ancestor/restricted refs - see https://github.com/ractivejs/ractive/issues/1497)\r\n\tif ( !prefix && !parser.relaxedNames && keywords.test( name ) ) {\r\n\t\tparser.pos = startPos;\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// if this is a browser global, stop here\r\n\tif ( !prefix && globals.test( name ) ) {\r\n\t\tglobal = globals.exec( name )[0];\r\n\t\tparser.pos = startPos + global.length;\r\n\r\n\t\treturn {\r\n\t\t\tt: GLOBAL,\r\n\t\t\tv: global\r\n\t\t};\r\n\t}\r\n\r\n\treference = ( prefix || '' ) + normalise( name );\r\n\r\n\tif ( parser.matchString( '(' ) ) {\r\n\t\t// if this is a method invocation (as opposed to a function) we need\r\n\t\t// to strip the method name from the reference combo, else the context\r\n\t\t// will be wrong\r\n\t\t// but only if the reference was actually a member and not a refinement\r\n\t\tlastDotIndex = reference.lastIndexOf( '.' );\r\n\t\tif ( lastDotIndex !== -1 && name[ name.length - 1 ] !== ']' ) {\r\n\t\t\tconst refLength = reference.length;\r\n\t\t\treference = reference.substr( 0, lastDotIndex );\r\n\t\t\tparser.pos = startPos + ( actual - ( refLength - lastDotIndex ) );\r\n\t\t} else {\r\n\t\t\tparser.pos -= 1;\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tt: REFERENCE,\r\n\t\tn: reference.replace( /^this\\./, './' ).replace( /^this$/, '.' )\r\n\t};\r\n}\r\n","import { BRACKETED } from '../../../../config/types';\r\nimport { expectedExpression, expectedParen } from '../shared/errors';\r\nimport readExpression from '../../readExpression';\r\n\r\nexport default function readBracketedExpression ( parser ) {\r\n\tif ( !parser.matchString( '(' ) ) return null;\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst expr = readExpression( parser );\r\n\r\n\tif ( !expr ) parser.error( expectedExpression );\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( ')' ) ) parser.error( expectedParen );\r\n\r\n\treturn {\r\n\t\tt: BRACKETED,\r\n\t\tx: expr\r\n\t};\r\n}\r\n","import { REFINEMENT } from '../../../../config/types';\r\nimport { expectedExpression } from './errors';\r\nimport { name as namePattern } from './patterns';\r\nimport readExpression from '../../readExpression';\r\n\r\nexport default function readRefinement ( parser ) {\r\n\t// some things call for strict refinement (partial names), meaning no space between reference and refinement\r\n\tif ( !parser.strictRefinement ) {\r\n\t\tparser.allowWhitespace();\r\n\t}\r\n\r\n\t// \".\" name\r\n\tif ( parser.matchString( '.' ) ) {\r\n\t\tparser.allowWhitespace();\r\n\r\n\t\tconst name = parser.matchPattern( namePattern );\r\n\t\tif ( name ) {\r\n\t\t\treturn {\r\n\t\t\t\tt: REFINEMENT,\r\n\t\t\t\tn: name\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tparser.error( 'Expected a property name' );\r\n\t}\r\n\r\n\t// \"[\" expression \"]\"\r\n\tif ( parser.matchString( '[' ) ) {\r\n\t\tparser.allowWhitespace();\r\n\r\n\t\tconst expr = readExpression( parser );\r\n\t\tif ( !expr ) parser.error( expectedExpression );\r\n\r\n\t\tparser.allowWhitespace();\r\n\r\n\t\tif ( !parser.matchString( ']' ) ) parser.error( `Expected ']'` );\r\n\r\n\t\treturn {\r\n\t\t\tt: REFINEMENT,\r\n\t\t\tx: expr\r\n\t\t};\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","import { CONDITIONAL } from '../../../config/types';\r\nimport readLogicalOr from './readLogicalOr';\r\nimport { expectedExpression } from './shared/errors';\r\nimport readExpression from '../readExpression';\r\n\r\n// The conditional operator is the lowest precedence operator, so we start here\r\nexport default function getConditional ( parser ) {\r\n\tconst expression = readLogicalOr( parser );\r\n\tif ( !expression ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst start = parser.pos;\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( '?' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn expression;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst ifTrue = readExpression( parser );\r\n\tif ( !ifTrue ) {\r\n\t\tparser.error( expectedExpression );\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( ':' ) ) {\r\n\t\tparser.error( 'Expected \":\"' );\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst ifFalse = readExpression( parser );\r\n\tif ( !ifFalse ) {\r\n\t\tparser.error( expectedExpression );\r\n\t}\r\n\r\n\treturn {\r\n\t\tt: CONDITIONAL,\r\n\t\to: [ expression, ifTrue, ifFalse ]\r\n\t};\r\n}\r\n","import readConditional from './expressions/readConditional';\r\n\r\nexport default function readExpression ( parser ) {\r\n\t// The conditional operator is the lowest precedence operator (except yield,\r\n\t// assignment operators, and commas, none of which are supported), so we\r\n\t// start there. If it doesn't match, it 'falls through' to progressively\r\n\t// higher precedence operators, until it eventually matches (or fails to\r\n\t// match) a 'primary' - a literal or a reference. This way, the abstract syntax\r\n\t// tree has everything in its proper place, i.e. 2 + 3 * 4 === 14, not 20.\r\n\treturn readConditional( parser );\r\n}","import { expectedExpression } from './errors';\r\nimport readExpression from '../../readExpression';\r\nimport { spreadPattern } from './patterns';\r\n\r\nexport default function readExpressionList ( parser, spread ) {\r\n\tlet isSpread;\r\n\tconst expressions = [];\r\n\r\n\tconst pos = parser.pos;\r\n\r\n\tdo {\r\n\t\tparser.allowWhitespace();\r\n\r\n\t\tif ( spread ) {\r\n\t\t\tisSpread = parser.matchPattern( spreadPattern );\r\n\t\t}\r\n\r\n\t\tconst expr = readExpression( parser );\r\n\r\n\t\tif ( expr === null && expressions.length ) {\r\n\t\t\tparser.error( expectedExpression );\r\n\t\t} else if ( expr === null ) {\r\n\t\t\tparser.pos = pos;\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif ( isSpread ) {\r\n\t\t\texpr.p = true;\r\n\t\t}\r\n\r\n\t\texpressions.push( expr );\r\n\r\n\t\tparser.allowWhitespace();\r\n\t} while ( parser.matchString( ',' ) );\r\n\r\n\treturn expressions;\r\n}\r\n","import { REFERENCE } from '../../config/types';\r\nimport readExpression from './readExpression';\r\nimport readReference from './expressions/primary/readReference';\r\n\r\nexport default function readExpressionOrReference ( parser, expectedFollowers ) {\r\n\tconst start = parser.pos;\r\n\tconst expression = readExpression( parser );\r\n\r\n\tif ( !expression ) {\r\n\t\t// valid reference but invalid expression e.g. `{{new}}`?\r\n\t\tconst ref = parser.matchPattern( /^(\\w+)/ );\r\n\t\tif ( ref ) {\r\n\t\t\treturn {\r\n\t\t\t\tt: REFERENCE,\r\n\t\t\t\tn: ref\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfor ( let i = 0; i < expectedFollowers.length; i += 1 ) {\r\n\t\tif ( parser.remaining().substr( 0, expectedFollowers[i].length ) === expectedFollowers[i] ) {\r\n\t\t\treturn expression;\r\n\t\t}\r\n\t}\r\n\r\n\tparser.pos = start;\r\n\treturn readReference( parser );\r\n}\r\n","import { REFERENCE, BOOLEAN_LITERAL, GLOBAL, NUMBER_LITERAL, REGEXP_LITERAL, STRING_LITERAL, ARRAY_LITERAL, OBJECT_LITERAL, KEY_VALUE_PAIR, PREFIX_OPERATOR, INFIX_OPERATOR, INVOCATION, BRACKETED, MEMBER, REFINEMENT, CONDITIONAL } from '../../config/types';\r\nimport { isObject } from '../../utils/is';\r\n\r\nexport default function flattenExpression ( expression ) {\r\n\tlet refs;\r\n\tlet count = 0;\r\n\r\n\textractRefs( expression, refs = [] );\r\n\tconst stringified = stringify( expression );\r\n\r\n\treturn {\r\n\t\tr: refs,\r\n\t\ts: getVars(stringified)\r\n\t};\r\n\r\n\tfunction getVars(expr) {\r\n\t\tconst vars = [];\r\n\t\tfor ( let i = count - 1; i >= 0; i-- ) {\r\n\t\t\tvars.push( `x$${i}` );\r\n\t\t}\r\n\t\treturn vars.length ? `(function(){var ${vars.join(',')};return(${expr});})()` : expr;\r\n\t}\r\n\r\n\tfunction stringify ( node ) {\r\n\t\tif ( typeof node === 'string' ) {\r\n\t\t\treturn node;\r\n\t\t}\r\n\r\n\t\tswitch ( node.t ) {\r\n\t\t\tcase BOOLEAN_LITERAL:\r\n\t\t\tcase GLOBAL:\r\n\t\t\tcase NUMBER_LITERAL:\r\n\t\t\tcase REGEXP_LITERAL:\r\n\t\t\t\treturn node.v;\r\n\r\n\t\t\tcase STRING_LITERAL:\r\n\t\t\t\treturn JSON.stringify( String( node.v ) );\r\n\r\n\t\t\tcase ARRAY_LITERAL:\r\n\t\t\t\tif ( node.m && hasSpread( node.m )) {\r\n\t\t\t\t\treturn `[].concat(${ makeSpread( node.m, '[', ']', stringify ) })`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '[' + ( node.m ? node.m.map( stringify ).join( ',' ) : '' ) + ']';\r\n\t\t\t\t}\r\n\r\n\t\t\tcase OBJECT_LITERAL:\r\n\t\t\t\tif ( node.m && hasSpread( node.m ) ) {\r\n\t\t\t\t\treturn `Object.assign({},${ makeSpread( node.m, '{', '}', stringifyPair) })`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '{' + ( node.m ? node.m.map( n => `${ n.k }:${ stringify( n.v ) }` ).join( ',' ) : '' ) + '}';\r\n\t\t\t\t}\r\n\r\n\t\t\tcase PREFIX_OPERATOR:\r\n\t\t\t\treturn ( node.s === 'typeof' ? 'typeof ' : node.s ) + stringify( node.o );\r\n\r\n\t\t\tcase INFIX_OPERATOR:\r\n\t\t\t\treturn stringify( node.o[0] ) + ( node.s.substr( 0, 2 ) === 'in' ? ' ' + node.s + ' ' : node.s ) + stringify( node.o[1] );\r\n\r\n\t\t\tcase INVOCATION:\r\n\t\t\t\tif ( node.o && hasSpread( node.o ) ) {\r\n\t\t\t\t\tconst id = count++;\r\n\t\t\t\t\treturn `(x$${ id }=${ stringify(node.x) }).apply(x$${ id },${ stringify({ t: ARRAY_LITERAL, m: node.o }) })`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn stringify( node.x ) + '(' + ( node.o ? node.o.map( stringify ).join( ',' ) : '' ) + ')';\r\n\t\t\t\t}\r\n\r\n\t\t\tcase BRACKETED:\r\n\t\t\t\treturn '(' + stringify( node.x ) + ')';\r\n\r\n\t\t\tcase MEMBER:\r\n\t\t\t\treturn stringify( node.x ) + stringify( node.r );\r\n\r\n\t\t\tcase REFINEMENT:\r\n\t\t\t\treturn ( node.n ? '.' + node.n : '[' + stringify( node.x ) + ']' );\r\n\r\n\t\t\tcase CONDITIONAL:\r\n\t\t\t\treturn stringify( node.o[0] ) + '?' + stringify( node.o[1] ) + ':' + stringify( node.o[2] );\r\n\r\n\t\t\tcase REFERENCE:\r\n\t\t\t\treturn '_' + refs.indexOf( node.n );\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'Expected legal JavaScript' );\r\n\t\t}\r\n\t}\r\n\r\n\tfunction stringifyPair ( node ) { return node.p ? stringify( node.k ) : `${ node.k }:${ stringify( node.v ) }`; }\r\n\r\n\tfunction makeSpread ( list, open, close, fn ) {\r\n\t\tconst out = list.reduce( ( a, c ) => {\r\n\t\t\tif ( c.p ) {\r\n\t\t\t\ta.str += `${ a.open ? close + ',' : a.str.length ? ',' : '' }${ fn( c ) }`;\r\n\t\t\t} else {\r\n\t\t\t\ta.str += `${ !a.str.length ? open : !a.open ? ',' + open : ',' }${ fn( c ) }`;\r\n\t\t\t}\r\n\t\t\ta.open = !c.p;\r\n\t\t\treturn a;\r\n\t\t}, { open: false, str: '' } );\r\n\t\tif ( out.open ) out.str += close;\r\n\t\treturn out.str;\r\n\t}\r\n}\r\n\r\nfunction hasSpread ( list ) {\r\n\tfor ( let i = 0; i < list.length; i++ ) {\r\n\t\tif ( list[i].p ) return true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\n// TODO maybe refactor this?\r\nfunction extractRefs ( node, refs ) {\r\n\tif ( node.t === REFERENCE && typeof node.n === 'string' ) {\r\n\t\tif ( !~refs.indexOf( node.n ) ) {\r\n\t\t\trefs.unshift( node.n );\r\n\t\t}\r\n\t}\r\n\r\n\tconst list = node.o || node.m;\r\n\tif ( list ) {\r\n\t\tif ( isObject( list ) ) {\r\n\t\t\textractRefs( list, refs );\r\n\t\t} else {\r\n\t\t\tlet i = list.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\textractRefs( list[i], refs );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif ( node.k && node.t === KEY_VALUE_PAIR && typeof node.k !== 'string' ) {\r\n\t\textractRefs( node.k, refs );\r\n\t}\r\n\r\n\tif ( node.x ) {\r\n\t\textractRefs( node.x, refs );\r\n\t}\r\n\r\n\tif ( node.r ) {\r\n\t\textractRefs( node.r, refs );\r\n\t}\r\n\r\n\tif ( node.v ) {\r\n\t\textractRefs( node.v, refs );\r\n\t}\r\n}\r\n","import { REFERENCE, BRACKETED, MEMBER, REFINEMENT } from '../../config/types';\r\nimport flattenExpression from './flattenExpression';\r\n\r\nexport default function refineExpression ( expression, mustache ) {\r\n\tlet referenceExpression;\r\n\r\n\tif ( expression ) {\r\n\t\twhile ( expression.t === BRACKETED && expression.x ) {\r\n\t\t\texpression = expression.x;\r\n\t\t}\r\n\r\n\t\tif ( expression.t === REFERENCE ) {\r\n\t\t\tconst n = expression.n;\r\n\t\t\tif ( !~n.indexOf( '@context' ) ) {\r\n\t\t\t\tmustache.r = expression.n;\r\n\t\t\t} else {\r\n\t\t\t\tmustache.x = flattenExpression( expression );\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif ( referenceExpression = getReferenceExpression( expression ) ) {\r\n\t\t\t\tmustache.rx = referenceExpression;\r\n\t\t\t} else {\r\n\t\t\t\tmustache.x = flattenExpression( expression );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn mustache;\r\n\t}\r\n}\r\n\r\n// TODO refactor this! it's bewildering\r\nfunction getReferenceExpression ( expression ) {\r\n\tconst members = [];\r\n\tlet refinement;\r\n\r\n\twhile ( expression.t === MEMBER && expression.r.t === REFINEMENT ) {\r\n\t\trefinement = expression.r;\r\n\r\n\t\tif ( refinement.x ) {\r\n\t\t\tif ( refinement.x.t === REFERENCE ) {\r\n\t\t\t\tmembers.unshift( refinement.x );\r\n\t\t\t} else {\r\n\t\t\t\tmembers.unshift( flattenExpression( refinement.x ) );\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmembers.unshift( refinement.n );\r\n\t\t}\r\n\r\n\t\texpression = expression.x;\r\n\t}\r\n\r\n\tif ( expression.t !== REFERENCE ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn {\r\n\t\tr: expression.n,\r\n\t\tm: members\r\n\t};\r\n}\r\n","import { ARRAY_LITERAL, ATTRIBUTE, DECORATOR, DELEGATE_FLAG, BINDING_FLAG, INTERPOLATOR, TRANSITION, EVENT } from '../../../config/types';\r\nimport getLowestIndex from '../utils/getLowestIndex';\r\nimport readMustache from '../readMustache';\r\nimport { decodeCharacterReferences } from '../../../utils/html';\r\nimport readExpressionList from '../expressions/shared/readExpressionList';\r\nimport readExpressionOrReference from '../readExpressionOrReference';\r\nimport flattenExpression from '../../utils/flattenExpression';\r\nimport refineExpression from '../../utils/refineExpression';\r\n\r\nconst attributeNamePattern = /^[^\\s\"'>\\/=]+/;\r\nconst onPattern = /^on/;\r\nconst eventPattern = /^on-([a-zA-Z\\*\\.$_]((?:[a-zA-Z\\*\\.$_0-9\\-]|\\\\-)+))$/;\r\nconst reservedEventNames = /^(?:change|reset|teardown|update|construct|config|init|render|complete|unrender|detach|insert|destruct|attachchild|detachchild)$/;\r\nconst decoratorPattern = /^as-([a-z-A-Z][-a-zA-Z_0-9]*)$/;\r\nconst transitionPattern = /^([a-zA-Z](?:(?!-in-out)[-a-zA-Z_0-9])*)-(in|out|in-out)$/;\r\nconst boundPattern = /^((bind|class)-(([-a-zA-Z0-9_])+))$/;\r\nconst directives = {\r\n\tlazy: { t: BINDING_FLAG, v: 'l' },\r\n\ttwoway: { t: BINDING_FLAG, v: 't' },\r\n\t'no-delegation': { t: DELEGATE_FLAG }\r\n};\r\nconst unquotedAttributeValueTextPattern = /^[^\\s\"'=<>\\/`]+/;\r\nconst proxyEvent = /^[^\\s\"'=<>@\\[\\]()]*/;\r\nconst whitespace = /^\\s+/;\r\n\r\nconst slashes = /\\\\/g;\r\nfunction splitEvent ( str ) {\r\n\tconst result = [];\r\n\tlet s = 0;\r\n\r\n\tfor ( let i = 0; i < str.length; i++ ) {\r\n\t\tif ( str[i] === '-' && str[ i - 1 ] !== '\\\\' ) {\r\n\t\t\tresult.push( str.substring( s, i ).replace( slashes, '' ) );\r\n\t\t\ts = i + 1;\r\n\t\t}\r\n\t}\r\n\r\n\tresult.push( str.substring( s ).replace( slashes, '' ) );\r\n\r\n\treturn result;\r\n}\r\n\r\nexport default function readAttribute ( parser ) {\r\n\tlet name, i, nearest, idx;\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tname = parser.matchPattern( attributeNamePattern );\r\n\tif ( !name ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// check for accidental delimiter consumption e.g. <tag bool{{>attrs}} />\r\n\tnearest = name.length;\r\n\tfor ( i = 0; i < parser.tags.length; i++ ) {\r\n\t\tif ( ~( idx = name.indexOf( parser.tags[ i ].open ) ) ) {\r\n\t\t\tif ( idx < nearest ) nearest = idx;\r\n\t\t}\r\n\t}\r\n\tif ( nearest < name.length ) {\r\n\t\tparser.pos -= name.length - nearest;\r\n\t\tname = name.substr( 0, nearest );\r\n\t\tif ( !name ) return null;\r\n\t}\r\n\r\n\treturn { n: name };\r\n}\r\n\r\nfunction readAttributeValue ( parser ) {\r\n\tconst start = parser.pos;\r\n\r\n\t// next character must be `=`, `/`, `>` or whitespace\r\n\tif ( !/[=\\/>\\s]/.test( parser.nextChar() ) ) {\r\n\t\tparser.error( 'Expected `=`, `/`, `>` or whitespace' );\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( '=' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst valueStart = parser.pos;\r\n\tconst startDepth = parser.sectionDepth;\r\n\r\n\tconst value = readQuotedAttributeValue( parser, `'` ) ||\r\n\t\t\treadQuotedAttributeValue( parser, `\"` ) ||\r\n\t\t\treadUnquotedAttributeValue( parser );\r\n\r\n\tif ( value === null ) {\r\n\t\tparser.error( 'Expected valid attribute value' );\r\n\t}\r\n\r\n\tif ( parser.sectionDepth !== startDepth ) {\r\n\t\tparser.pos = valueStart;\r\n\t\tparser.error( 'An attribute value must contain as many opening section tags as closing section tags' );\r\n\t}\r\n\r\n\tif ( !value.length ) {\r\n\t\treturn '';\r\n\t}\r\n\r\n\tif ( value.length === 1 && typeof value[0] === 'string' ) {\r\n\t\treturn decodeCharacterReferences( value[0] );\r\n\t}\r\n\r\n\treturn value;\r\n}\r\n\r\nfunction readUnquotedAttributeValueToken ( parser ) {\r\n\tlet text, index;\r\n\r\n\tconst start = parser.pos;\r\n\r\n\ttext = parser.matchPattern( unquotedAttributeValueTextPattern );\r\n\r\n\tif ( !text ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst haystack = text;\r\n\tconst needles = parser.tags.map( t => t.open ); // TODO refactor... we do this in readText.js as well\r\n\r\n\tif ( ( index = getLowestIndex( haystack, needles ) ) !== -1 ) {\r\n\t\ttext = text.substr( 0, index );\r\n\t\tparser.pos = start + text.length;\r\n\t}\r\n\r\n\treturn text;\r\n}\r\n\r\nfunction readUnquotedAttributeValue ( parser ) {\r\n\tparser.inAttribute = true;\r\n\r\n\tconst tokens = [];\r\n\r\n\tlet token = readMustache( parser ) || readUnquotedAttributeValueToken( parser );\r\n\twhile ( token ) {\r\n\t\ttokens.push( token );\r\n\t\ttoken = readMustache( parser ) || readUnquotedAttributeValueToken( parser );\r\n\t}\r\n\r\n\tif ( !tokens.length ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.inAttribute = false;\r\n\treturn tokens;\r\n}\r\n\r\nfunction readQuotedAttributeValue ( parser, quoteMark ) {\r\n\tconst start = parser.pos;\r\n\r\n\tif ( !parser.matchString( quoteMark ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.inAttribute = quoteMark;\r\n\r\n\tconst tokens = [];\r\n\r\n\tlet token = readMustache( parser ) || readQuotedStringToken( parser, quoteMark );\r\n\twhile ( token !== null ) {\r\n\t\ttokens.push( token );\r\n\t\ttoken = readMustache( parser ) || readQuotedStringToken( parser, quoteMark );\r\n\t}\r\n\r\n\tif ( !parser.matchString( quoteMark ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.inAttribute = false;\r\n\r\n\treturn tokens;\r\n}\r\n\r\nfunction readQuotedStringToken ( parser, quoteMark ) {\r\n\tconst haystack = parser.remaining();\r\n\r\n\tconst needles = parser.tags.map( t => t.open ); // TODO refactor... we do this in readText.js as well\r\n\tneedles.push( quoteMark );\r\n\r\n\tconst index = getLowestIndex( haystack, needles );\r\n\r\n\tif ( index === -1 ) {\r\n\t\tparser.error( 'Quoted attribute value must have a closing quote' );\r\n\t}\r\n\r\n\tif ( !index ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.pos += index;\r\n\treturn haystack.substr( 0, index );\r\n}\r\n\r\nexport function readAttributeOrDirective ( parser ) {\r\n\tlet match, directive;\r\n\r\n\tconst attribute = readAttribute( parser, false );\r\n\r\n\tif ( !attribute ) return null;\r\n\r\n\t\t// lazy, twoway\r\n\tif ( directive = directives[ attribute.n ] ) {\r\n\t\tattribute.t = directive.t;\r\n\t\tif ( directive.v ) attribute.v = directive.v;\r\n\t\tdelete attribute.n; // no name necessary\r\n\t\tparser.allowWhitespace();\r\n\t\tif ( parser.nextChar() === '=' ) attribute.f = readAttributeValue( parser );\r\n\t}\r\n\r\n\t\t// decorators\r\n\telse if ( match = decoratorPattern.exec( attribute.n ) ) {\r\n\t\tattribute.n = match[1];\r\n\t\tattribute.t = DECORATOR;\r\n\t\treadArguments( parser, attribute );\r\n\t}\r\n\r\n\t\t// transitions\r\n\telse if ( match = transitionPattern.exec( attribute.n ) ) {\r\n\t\tattribute.n = match[1];\r\n\t\tattribute.t = TRANSITION;\r\n\t\treadArguments( parser, attribute );\r\n\t\tattribute.v = match[2] === 'in-out' ? 't0' : match[2] === 'in' ? 't1' : 't2';\r\n\t}\r\n\r\n\t\t// on-click etc\r\n\telse if ( match = eventPattern.exec( attribute.n ) ) {\r\n\t\tattribute.n = splitEvent( match[1] );\r\n\t\tattribute.t = EVENT;\r\n\r\n\t\tparser.inEvent = true;\r\n\r\n\t\t\t// check for a proxy event\r\n\t\tif ( !readProxyEvent( parser, attribute ) ) {\r\n\t\t\t\t// otherwise, it's an expression\r\n\t\t\treadArguments( parser, attribute, true );\r\n\t\t} else if ( reservedEventNames.test( attribute.f ) ) {\r\n\t\t\tparser.pos -= attribute.f.length;\r\n\t\t\tparser.error( 'Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, complete, detach, insert, destruct, attachchild, detachchild)' );\r\n\t\t}\r\n\r\n\t\tparser.inEvent = false;\r\n\t}\r\n\r\n\t\t// bound directives\r\n\telse if ( match = boundPattern.exec( attribute.n ) ){\r\n\t\tconst bind = match[2] === 'bind';\r\n\t\tattribute.n = bind ? match[3] : match[1];\r\n\t\tattribute.t = ATTRIBUTE;\r\n\t\treadArguments( parser, attribute, false, true );\r\n\r\n\t\tif ( !attribute.f ) {\r\n\t\t\tif ( !bind ) {\r\n\t\t\t\tattribute.f = [{ t: INTERPOLATOR, x: { r: [], s: 'true' } }];\r\n\t\t\t} else {\r\n\t\t\t\tattribute.f = [{ t: INTERPOLATOR, r: match[3] }];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\telse {\r\n\t\tparser.allowWhitespace();\r\n\t\tconst value = parser.nextChar() === '=' ? readAttributeValue( parser ) : null;\r\n\t\tattribute.f = value != null ? value : attribute.f;\r\n\r\n\t\tif ( parser.sanitizeEventAttributes && onPattern.test( attribute.n ) ) {\r\n\t\t\treturn { exclude: true };\r\n\t\t} else {\r\n\t\t\tattribute.f = attribute.f || ( attribute.f === '' ? '' : 0 );\r\n\t\t\tattribute.t = ATTRIBUTE;\r\n\t\t}\r\n\t}\r\n\r\n\treturn attribute;\r\n}\r\n\r\nfunction readProxyEvent ( parser, attribute ) {\r\n\tconst start = parser.pos;\r\n\tif ( !parser.matchString( '=' ) ) parser.error( `Missing required directive arguments` );\r\n\r\n\tconst quote = parser.matchString( `'` ) || parser.matchString( `\"` );\r\n\tparser.allowWhitespace();\r\n\tconst proxy = parser.matchPattern( proxyEvent );\r\n\r\n\tif ( proxy !== undefined ) {\r\n\t\tif ( quote ) {\r\n\t\t\tparser.allowWhitespace();\r\n\t\t\tif ( !parser.matchString( quote ) ) parser.pos = start;\r\n\t\t\telse return ( attribute.f = proxy ) || true;\r\n\t\t} else if ( !parser.matchPattern( whitespace ) ) {\r\n\t\t\tparser.pos = start;\r\n\t\t} else {\r\n\t\t\treturn ( attribute.f = proxy ) || true;\r\n\t\t}\r\n\t} else {\r\n\t\tparser.pos = start;\r\n\t}\r\n}\r\n\r\nfunction readArguments ( parser, attribute, required = false, single = false ) {\r\n\tparser.allowWhitespace();\r\n\tif ( !parser.matchString( '=' ) ) {\r\n\t\tif ( required ) parser.error( `Missing required directive arguments` );\r\n\t\treturn;\r\n\t}\r\n\tparser.allowWhitespace();\r\n\r\n\tconst quote = parser.matchString( '\"' ) || parser.matchString( \"'\" );\r\n\tconst spread = parser.spreadArgs;\r\n\tparser.spreadArgs = true;\r\n\tparser.inUnquotedAttribute = !quote;\r\n\tconst expr = single ? readExpressionOrReference( parser, [ quote || ' ', '/', '>' ] ) : { m: readExpressionList( parser ), t: ARRAY_LITERAL };\r\n\tparser.inUnquotedAttribute = false;\r\n\tparser.spreadArgs = spread;\r\n\r\n\tif ( quote ) {\r\n\t\tparser.allowWhitespace();\r\n\t\tif ( parser.matchString( quote ) !== quote ) parser.error( `Expected matching quote '${quote}'` );\r\n\t}\r\n\r\n\tif ( single ) {\r\n\t\tconst interpolator = { t: INTERPOLATOR };\r\n\t\trefineExpression( expr, interpolator );\r\n\t\tattribute.f = [interpolator];\r\n\t} else {\r\n\t\tattribute.f = flattenExpression( expr );\r\n\t}\r\n}\r\n","import { DELIMCHANGE } from '../../config/types';\r\nimport readDelimiterChange from './mustache/readDelimiterChange';\r\nimport readRegexpLiteral from './expressions/primary/literal/readRegexpLiteral';\r\nimport { readAttributeOrDirective } from './element/readAttribute';\r\n\r\nconst delimiterChangeToken = { t: DELIMCHANGE, exclude: true };\r\n\r\nexport default function readMustache ( parser ) {\r\n\tlet mustache, i;\r\n\r\n\t// If we're inside a <script> or <style> tag, and we're not\r\n\t// interpolating, bug out\r\n\tif ( parser.interpolate[ parser.inside ] === false ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfor ( i = 0; i < parser.tags.length; i += 1 ) {\r\n\t\tif ( mustache = readMustacheOfType( parser, parser.tags[i] ) ) {\r\n\t\t\treturn mustache;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( parser.inTag && !parser.inAttribute ) {\r\n\t\tmustache = readAttributeOrDirective( parser );\r\n\t\tif ( mustache ) {\r\n\t\t\tparser.allowWhitespace();\r\n\t\t\treturn mustache;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction readMustacheOfType ( parser, tag ) {\r\n\tlet mustache, reader, i;\r\n\r\n\tconst start = parser.pos;\r\n\r\n\tif ( parser.matchString( '\\\\' + tag.open ) ) {\r\n\t\tif ( start === 0 || parser.str[ start - 1 ] !== '\\\\' ) {\r\n\t\t\treturn tag.open;\r\n\t\t}\r\n\t} else if ( !parser.matchString( tag.open ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// delimiter change?\r\n\tif ( mustache = readDelimiterChange( parser ) ) {\r\n\t\t// find closing delimiter or abort...\r\n\t\tif ( !parser.matchString( tag.close ) ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// ...then make the switch\r\n\t\ttag.open = mustache[0];\r\n\t\ttag.close = mustache[1];\r\n\t\tparser.sortMustacheTags();\r\n\r\n\t\treturn delimiterChangeToken;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\t// illegal section closer\r\n\tif ( parser.matchString( '/' ) ) {\r\n\t\tparser.pos -= 1;\r\n\t\tconst rewind = parser.pos;\r\n\t\tif ( !readRegexpLiteral( parser ) ) {\r\n\t\t\tparser.pos = rewind - ( tag.close.length );\r\n\t\t\tif ( parser.inAttribute ) {\r\n\t\t\t\tparser.pos = start;\r\n\t\t\t\treturn null;\r\n\t\t\t} else {\r\n\t\t\t\tparser.error( 'Attempted to close a section that wasn\\'t open' );\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tparser.pos = rewind;\r\n\t\t}\r\n\t}\r\n\r\n\tfor ( i = 0; i < tag.readers.length; i += 1 ) {\r\n\t\treader = tag.readers[i];\r\n\r\n\t\tif ( mustache = reader( parser, tag ) ) {\r\n\t\t\tif ( tag.isStatic ) {\r\n\t\t\t\tmustache.s = 1;\r\n\t\t\t}\r\n\r\n\t\t\tif ( parser.includeLinePositions ) {\r\n\t\t\t\tmustache.p = parser.getLinePos( start );\r\n\t\t\t}\r\n\r\n\t\t\treturn mustache;\r\n\t\t}\r\n\t}\r\n\r\n\tparser.pos = start;\r\n\treturn null;\r\n}\r\n","import { TRIPLE } from '../../../config/types';\r\nimport readExpression from '../readExpression';\r\nimport refineExpression from '../../utils/refineExpression';\r\n\r\nexport default function readTriple ( parser, tag ) {\r\n\tconst expression = readExpression( parser );\r\n\r\n\tif ( !expression ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( !parser.matchString( tag.close ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${tag.close}'` );\r\n\t}\r\n\r\n\tconst triple = { t: TRIPLE };\r\n\trefineExpression( expression, triple ); // TODO handle this differently - it's mysterious\r\n\r\n\treturn triple;\r\n}\r\n","import { TRIPLE } from '../../../config/types';\r\nimport readExpression from '../readExpression';\r\nimport refineExpression from '../../utils/refineExpression';\r\n\r\nexport default function readUnescaped ( parser, tag ) {\r\n\tif ( !parser.matchString( '&' ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst expression = readExpression( parser );\r\n\r\n\tif ( !expression ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( !parser.matchString( tag.close ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${tag.close}'` );\r\n\t}\r\n\r\n\tconst triple = { t: TRIPLE };\r\n\trefineExpression( expression, triple ); // TODO handle this differently - it's mysterious\r\n\r\n\treturn triple;\r\n}\r\n","import readExpression from '../readExpression';\r\nimport refineExpression from '../../utils/refineExpression';\r\n\r\nconst legalAlias = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\r\nconst asRE = /^as/i;\r\n\r\nexport function readAliases( parser ) {\r\n\tconst aliases = [];\r\n\tlet alias;\r\n\tconst start = parser.pos;\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\talias = readAlias( parser );\r\n\r\n\tif ( alias ) {\r\n\t\talias.x = refineExpression( alias.x, {} );\r\n\t\taliases.push( alias );\r\n\r\n\t\tparser.allowWhitespace();\r\n\r\n\t\twhile ( parser.matchString(',') ) {\r\n\t\t\talias = readAlias( parser );\r\n\r\n\t\t\tif ( !alias ) {\r\n\t\t\t\tparser.error( 'Expected another alias.' );\r\n\t\t\t}\r\n\r\n\t\t\talias.x = refineExpression( alias.x, {} );\r\n\t\t\taliases.push( alias );\r\n\r\n\t\t\tparser.allowWhitespace();\r\n\t\t}\r\n\r\n\t\treturn aliases;\r\n\t}\r\n\r\n\tparser.pos = start;\r\n\treturn null;\r\n}\r\n\r\nexport function readAlias( parser ) {\r\n\tconst start = parser.pos;\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst expr = readExpression( parser, [] );\r\n\r\n\tif ( !expr ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchPattern( asRE ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst alias = parser.matchPattern( legalAlias );\r\n\r\n\tif ( !alias ) {\r\n\t\tparser.error( 'Expected a legal alias name.' );\r\n\t}\r\n\r\n\treturn { n: alias, x: expr };\r\n}\r\n","import { PARTIAL, YIELDER } from '../../../config/types';\r\nimport readExpression from '../readExpression';\r\nimport refineExpression from '../../utils/refineExpression';\r\nimport { readAliases } from './readAliases';\r\n\r\nexport default function readPartial ( parser, tag ) {\r\n\tconst type = parser.matchString( '>' ) || parser.matchString( 'yield' );\r\n\tconst partial = { t: type === '>' ? PARTIAL : YIELDER };\r\n\tlet aliases;\r\n\r\n\tif ( !type ) return null;\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( type === '>' || !( aliases = parser.matchString( 'with' ) ) ) {\r\n\t\t// Partial names can include hyphens, so we can't use readExpression\r\n\t\t// blindly. Instead, we use the `relaxedNames` flag to indicate that\r\n\t\t// `foo-bar` should be read as a single name, rather than 'subtract\r\n\t\t// bar from foo'\r\n\t\tparser.relaxedNames = parser.strictRefinement = true;\r\n\t\tconst expression = readExpression( parser );\r\n\t\tparser.relaxedNames = parser.strictRefinement = false;\r\n\r\n\t\tif ( !expression && type === '>' ) return null;\r\n\r\n\t\tif ( expression ) {\r\n\t\t\trefineExpression( expression, partial ); // TODO...\r\n\t\t\tparser.allowWhitespace();\r\n\t\t\tif ( type !== '>' ) aliases = parser.matchString( 'with' );\r\n\t\t}\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\t// check for alias context e.g. `{{>foo bar as bat, bip as bop}}`\r\n\tif ( aliases || type === '>' ) {\r\n\t\taliases = readAliases( parser );\r\n\t\tif ( aliases && aliases.length ) {\r\n\t\t\tpartial.z = aliases;\r\n\t\t}\r\n\r\n\t\t// otherwise check for literal context e.g. `{{>foo bar}}` then\r\n\t\t// turn it into `{{#with bar}}{{>foo}}{{/with}}`\r\n\t\telse if ( type === '>' ) {\r\n\t\t\tconst context = readExpression( parser );\r\n\t\t\tif ( context) {\r\n\t\t\t\tpartial.c = {};\r\n\t\t\t\trefineExpression( context, partial.c );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\telse {\r\n\t\t\t// {{yield with}} requires some aliases\r\n\t\t\tparser.error( `Expected one or more aliases` );\r\n\t\t}\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( tag.close ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${tag.close}'` );\r\n\t}\r\n\r\n\treturn partial;\r\n}\r\n","import { COMMENT } from '../../../config/types';\r\n\r\nexport default function readComment ( parser, tag ) {\r\n\tif ( !parser.matchString( '!' ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst index = parser.remaining().indexOf( tag.close );\r\n\r\n\tif ( index !== -1 ) {\r\n\t\tparser.pos += index + tag.close.length;\r\n\t\treturn { t: COMMENT };\r\n\t}\r\n}\r\n","import { INTERPOLATOR } from '../../../config/types';\r\nimport readExpressionOrReference from '../readExpressionOrReference';\r\nimport refineExpression from '../../utils/refineExpression';\r\n\r\nexport default function readInterpolator ( parser, tag ) {\r\n\tlet expression, err;\r\n\r\n\tconst start = parser.pos;\r\n\r\n\t// TODO would be good for perf if we could do away with the try-catch\r\n\ttry {\r\n\t\texpression = readExpressionOrReference( parser, [ tag.close ] );\r\n\t} catch ( e ) {\r\n\t\terr = e;\r\n\t}\r\n\r\n\tif ( !expression ) {\r\n\t\tif ( parser.str.charAt( start ) === '!' ) {\r\n\t\t\t// special case - comment\r\n\t\t\tparser.pos = start;\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif ( err ) {\r\n\t\t\tthrow err;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( !parser.matchString( tag.close ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${tag.close}' after reference` );\r\n\r\n\t\tif ( !expression ) {\r\n\t\t\t// special case - comment\r\n\t\t\tif ( parser.nextChar() === '!' ) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tparser.error( `Expected expression or legal reference` );\r\n\t\t}\r\n\t}\r\n\r\n\tconst interpolator = { t: INTERPOLATOR };\r\n\trefineExpression( expression, interpolator ); // TODO handle this differently - it's mysterious\r\n\r\n\treturn interpolator;\r\n}\r\n","import { CLOSING } from '../../../../config/types';\r\n\r\nexport default function readClosing ( parser, tag ) {\r\n\tconst start = parser.pos;\r\n\r\n\tif ( !parser.matchString( tag.open ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( '/' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tconst remaining = parser.remaining();\r\n\tconst index = remaining.indexOf( tag.close );\r\n\r\n\tif ( index !== -1 ) {\r\n\t\tconst closing = {\r\n\t\t\tt: CLOSING,\r\n\t\t\tr: remaining.substr( 0, index ).split( ' ' )[0]\r\n\t\t};\r\n\r\n\t\tparser.pos += index;\r\n\r\n\t\tif ( !parser.matchString( tag.close ) ) {\r\n\t\t\tparser.error( `Expected closing delimiter '${tag.close}'` );\r\n\t\t}\r\n\r\n\t\treturn closing;\r\n\t}\r\n\r\n\tparser.pos = start;\r\n\treturn null;\r\n}\r\n","import { ELSE } from '../../../../config/types';\r\n\r\nconst elsePattern = /^\\s*else\\s*/;\r\n\r\nexport default function readElse ( parser, tag ) {\r\n\tconst start = parser.pos;\r\n\r\n\tif ( !parser.matchString( tag.open ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( !parser.matchPattern( elsePattern ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( !parser.matchString( tag.close ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${tag.close}'` );\r\n\t}\r\n\r\n\treturn {\r\n\t\tt: ELSE\r\n\t};\r\n}","import { ELSEIF } from '../../../../config/types';\r\nimport readExpression from '../../readExpression';\r\n\r\nconst elsePattern = /^\\s*elseif\\s+/;\r\n\r\nexport default function readElseIf ( parser, tag ) {\r\n\tconst start = parser.pos;\r\n\r\n\tif ( !parser.matchString( tag.open ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( !parser.matchPattern( elsePattern ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst expression = readExpression( parser );\r\n\r\n\tif ( !parser.matchString( tag.close ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${tag.close}'` );\r\n\t}\r\n\r\n\treturn {\r\n\t\tt: ELSEIF,\r\n\t\tx: expression\r\n\t};\r\n}\r\n","import { ALIAS, SECTION, SECTION_IF, SECTION_UNLESS } from '../../../config/types';\r\nimport { READERS } from '../../_parse';\r\nimport readClosing from './section/readClosing';\r\nimport readElse from './section/readElse';\r\nimport readElseIf from './section/readElseIf';\r\nimport handlebarsBlockCodes from './handlebarsBlockCodes';\r\nimport readExpression from '../readExpression';\r\nimport refineExpression from '../../utils/refineExpression';\r\nimport { readAlias, readAliases } from './readAliases';\r\n\r\nconst indexRefPattern = /^\\s*:\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\r\nconst keyIndexRefPattern = /^\\s*,\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\r\nconst handlebarsBlockPattern = new RegExp( '^(' + Object.keys( handlebarsBlockCodes ).join( '|' ) + ')\\\\b' );\r\n\r\nexport default function readSection ( parser, tag ) {\r\n\tlet expression, section, child, children, hasElse, block, unlessBlock, closed, i, expectedClose;\r\n\tlet aliasOnly = false;\r\n\r\n\tconst start = parser.pos;\r\n\r\n\tif ( parser.matchString( '^' ) ) {\r\n\t\t// watch out for parent context refs - {{^^/^^/foo}}\r\n\t\tif ( parser.matchString( '^/' ) ){\r\n\t\t\tparser.pos = start;\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tsection = { t: SECTION, f: [], n: SECTION_UNLESS };\r\n\t} else if ( parser.matchString( '#' ) ) {\r\n\t\tsection = { t: SECTION, f: [] };\r\n\r\n\t\tif ( parser.matchString( 'partial' ) ) {\r\n\t\t\tparser.pos = start - parser.standardDelimiters[0].length;\r\n\t\t\tparser.error( 'Partial definitions can only be at the top level of the template, or immediately inside components' );\r\n\t\t}\r\n\r\n\t\tif ( block = parser.matchPattern( handlebarsBlockPattern ) ) {\r\n\t\t\texpectedClose = block;\r\n\t\t\tsection.n = handlebarsBlockCodes[ block ];\r\n\t\t}\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( block === 'with' ) {\r\n\t\tconst aliases = readAliases( parser );\r\n\t\tif ( aliases ) {\r\n\t\t\taliasOnly = true;\r\n\t\t\tsection.z = aliases;\r\n\t\t\tsection.t = ALIAS;\r\n\t\t}\r\n\t} else if ( block === 'each' ) {\r\n\t\tconst alias = readAlias( parser );\r\n\t\tif ( alias ) {\r\n\t\t\tsection.z = [ { n: alias.n, x: { r: '.' } } ];\r\n\t\t\texpression = alias.x;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( !aliasOnly ) {\r\n\t\tif ( !expression ) expression = readExpression( parser );\r\n\r\n\t\tif ( !expression ) {\r\n\t\t\tparser.error( 'Expected expression' );\r\n\t\t}\r\n\r\n\t\t// optional index and key references\r\n\t\tif ( i = parser.matchPattern( indexRefPattern ) ) {\r\n\t\t\tlet extra;\r\n\r\n\t\t\tif ( extra = parser.matchPattern( keyIndexRefPattern ) ) {\r\n\t\t\t\tsection.i = i + ',' + extra;\r\n\t\t\t} else {\r\n\t\t\t\tsection.i = i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( !block && expression.n ) {\r\n\t\t\texpectedClose = expression.n;\r\n\t\t}\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( tag.close ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${tag.close}'` );\r\n\t}\r\n\r\n\tparser.sectionDepth += 1;\r\n\tchildren = section.f;\r\n\r\n\tlet pos;\r\n\tdo {\r\n\t\tpos = parser.pos;\r\n\t\tif ( child = readClosing( parser, tag ) ) {\r\n\t\t\tif ( expectedClose && child.r !== expectedClose ) {\r\n\t\t\t\tif ( !block ) {\r\n\t\t\t\t\tif ( child.r ) parser.warn( `Expected ${tag.open}/${expectedClose}${tag.close} but found ${tag.open}/${child.r}${tag.close}` );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparser.pos = pos;\r\n\t\t\t\t\tparser.error( `Expected ${tag.open}/${expectedClose}${tag.close}` );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tparser.sectionDepth -= 1;\r\n\t\t\tclosed = true;\r\n\t\t}\r\n\r\n\t\telse if ( !aliasOnly && ( child = readElseIf( parser, tag ) ) ) {\r\n\t\t\tif ( section.n === SECTION_UNLESS ) {\r\n\t\t\t\tparser.error( '{{else}} not allowed in {{#unless}}' );\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasElse ) {\r\n\t\t\t\tparser.error( 'illegal {{elseif...}} after {{else}}' );\r\n\t\t\t}\r\n\r\n\t\t\tif ( !unlessBlock ) {\r\n\t\t\t\tunlessBlock = [];\r\n\t\t\t}\r\n\r\n\t\t\tconst mustache = {\r\n\t\t\t\tt: SECTION,\r\n\t\t\t\tn: SECTION_IF,\r\n\t\t\t\tf: children = []\r\n\t\t\t};\r\n\t\t\trefineExpression( child.x, mustache );\r\n\r\n\t\t\tunlessBlock.push( mustache );\r\n\t\t}\r\n\r\n\t\telse if ( !aliasOnly && ( child = readElse( parser, tag ) ) ) {\r\n\t\t\tif ( section.n === SECTION_UNLESS ) {\r\n\t\t\t\tparser.error( '{{else}} not allowed in {{#unless}}' );\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasElse ) {\r\n\t\t\t\tparser.error( 'there can only be one {{else}} block, at the end of a section' );\r\n\t\t\t}\r\n\r\n\t\t\thasElse = true;\r\n\r\n\t\t\t// use an unless block if there's no elseif\r\n\t\t\tif ( !unlessBlock ) {\r\n\t\t\t\tunlessBlock = [];\r\n\t\t\t}\r\n\r\n\t\t\tunlessBlock.push({\r\n\t\t\t\tt: SECTION,\r\n\t\t\t\tn: SECTION_UNLESS,\r\n\t\t\t\tf: children = []\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\telse {\r\n\t\t\tchild = parser.read( READERS );\r\n\r\n\t\t\tif ( !child ) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tchildren.push( child );\r\n\t\t}\r\n\t} while ( !closed );\r\n\r\n\tif ( unlessBlock ) {\r\n\t\tsection.l = unlessBlock;\r\n\t}\r\n\r\n\tif ( !aliasOnly ) {\r\n\t\trefineExpression( expression, section );\r\n\t}\r\n\r\n\t// TODO if a section is empty it should be discarded. Don't do\r\n\t// that here though - we need to clean everything up first, as\r\n\t// it may contain removeable whitespace. As a temporary measure,\r\n\t// to pass the existing tests, remove empty `f` arrays\r\n\tif ( !section.f.length ) {\r\n\t\tdelete section.f;\r\n\t}\r\n\r\n\treturn section;\r\n}\r\n","import { COMMENT } from '../../config/types';\r\n\r\nconst OPEN_COMMENT = '<!--';\r\nconst CLOSE_COMMENT = '-->';\r\n\r\nexport default function readHtmlComment ( parser ) {\r\n\tconst start = parser.pos;\r\n\r\n\tif ( parser.textOnlyMode || !parser.matchString( OPEN_COMMENT ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst remaining = parser.remaining();\r\n\tconst endIndex = remaining.indexOf( CLOSE_COMMENT );\r\n\r\n\tif ( endIndex === -1 ) {\r\n\t\tparser.error( 'Illegal HTML - expected closing comment sequence (\\'-->\\')' );\r\n\t}\r\n\r\n\tconst content = remaining.substr( 0, endIndex );\r\n\tparser.pos += endIndex + 3;\r\n\r\n\tconst comment = {\r\n\t\tt: COMMENT,\r\n\t\tc: content\r\n\t};\r\n\r\n\tif ( parser.includeLinePositions ) {\r\n\t\tcomment.p = parser.getLinePos( start );\r\n\t}\r\n\r\n\treturn comment;\r\n}\r\n","import { COMMENT, DELIMCHANGE, SECTION, INVERTED } from '../../config/types';\r\nimport { lastItem } from '../../utils/array';\r\n\r\nconst leadingLinebreak = /^[ \\t\\f\\r\\n]*\\r?\\n/;\r\nconst trailingLinebreak = /\\r?\\n[ \\t\\f\\r\\n]*$/;\r\n\r\nexport default function ( items ) {\r\n\tlet i, current, backOne, backTwo, lastSectionItem;\r\n\r\n\tfor ( i=1; i<items.length; i+=1 ) {\r\n\t\tcurrent = items[i];\r\n\t\tbackOne = items[i-1];\r\n\t\tbackTwo = items[i-2];\r\n\r\n\t\t// if we're at the end of a [text][comment][text] sequence...\r\n\t\tif ( isString( current ) && isComment( backOne ) && isString( backTwo ) ) {\r\n\r\n\t\t\t// ... and the comment is a standalone (i.e. line breaks either side)...\r\n\t\t\tif ( trailingLinebreak.test( backTwo ) && leadingLinebreak.test( current ) ) {\r\n\r\n\t\t\t\t// ... then we want to remove the whitespace after the first line break\r\n\t\t\t\titems[i-2] = backTwo.replace( trailingLinebreak, '\\n' );\r\n\r\n\t\t\t\t// and the leading line break of the second text token\r\n\t\t\t\titems[i] = current.replace( leadingLinebreak, '' );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// if the current item is a section, and it is preceded by a linebreak, and\r\n\t\t// its first item is a linebreak...\r\n\t\tif ( isSection( current ) && isString( backOne ) ) {\r\n\t\t\tif ( trailingLinebreak.test( backOne ) && isString( current.f[0] ) && leadingLinebreak.test( current.f[0] ) ) {\r\n\t\t\t\titems[i-1] = backOne.replace( trailingLinebreak, '\\n' );\r\n\t\t\t\tcurrent.f[0] = current.f[0].replace( leadingLinebreak, '' );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// if the last item was a section, and it is followed by a linebreak, and\r\n\t\t// its last item is a linebreak...\r\n\t\tif ( isString( current ) && isSection( backOne ) ) {\r\n\t\t\tlastSectionItem = lastItem( backOne.f );\r\n\r\n\t\t\tif ( isString( lastSectionItem ) && trailingLinebreak.test( lastSectionItem ) && leadingLinebreak.test( current ) ) {\r\n\t\t\t\tbackOne.f[ backOne.f.length - 1 ] = lastSectionItem.replace( trailingLinebreak, '\\n' );\r\n\t\t\t\titems[i] = current.replace( leadingLinebreak, '' );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn items;\r\n}\r\n\r\nfunction isString ( item ) {\r\n\treturn typeof item === 'string';\r\n}\r\n\r\nfunction isComment ( item ) {\r\n\treturn item.t === COMMENT || item.t === DELIMCHANGE;\r\n}\r\n\r\nfunction isSection ( item ) {\r\n\treturn ( item.t === SECTION || item.t === INVERTED ) && item.f;\r\n}\r\n","import { COMMENT, ELEMENT } from '../../config/types';\r\nimport stripStandalones from './stripStandalones';\r\nimport trimWhitespace from './trimWhitespace';\r\n\r\nconst contiguousWhitespace = /[ \\t\\f\\r\\n]+/g;\r\nconst preserveWhitespaceElements = /^(?:pre|script|style|textarea)$/i;\r\nconst leadingWhitespace = /^[ \\t\\f\\r\\n]+/;\r\nconst trailingWhitespace = /[ \\t\\f\\r\\n]+$/;\r\nconst leadingNewLine = /^(?:\\r\\n|\\r|\\n)/;\r\nconst trailingNewLine = /(?:\\r\\n|\\r|\\n)$/;\r\n\r\nexport default function cleanup ( items, stripComments, preserveWhitespace, removeLeadingWhitespace, removeTrailingWhitespace ) {\r\n\tif ( typeof items === 'string' ) return;\r\n\r\n\tlet i,\r\n\t\titem,\r\n\t\tpreviousItem,\r\n\t\tnextItem,\r\n\t\tpreserveWhitespaceInsideFragment,\r\n\t\tremoveLeadingWhitespaceInsideFragment,\r\n\t\tremoveTrailingWhitespaceInsideFragment;\r\n\r\n\t// First pass - remove standalones and comments etc\r\n\tstripStandalones( items );\r\n\r\n\ti = items.length;\r\n\twhile ( i-- ) {\r\n\t\titem = items[i];\r\n\r\n\t\t// Remove delimiter changes, unsafe elements etc\r\n\t\tif ( item.exclude ) {\r\n\t\t\titems.splice( i, 1 );\r\n\t\t}\r\n\r\n\t\t// Remove comments, unless we want to keep them\r\n\t\telse if ( stripComments && item.t === COMMENT ) {\r\n\t\t\titems.splice( i, 1 );\r\n\t\t}\r\n\t}\r\n\r\n\t// If necessary, remove leading and trailing whitespace\r\n\ttrimWhitespace( items, removeLeadingWhitespace ? leadingWhitespace : null, removeTrailingWhitespace ? trailingWhitespace : null );\r\n\r\n\ti = items.length;\r\n\twhile ( i-- ) {\r\n\t\titem = items[i];\r\n\r\n\t\t// Recurse\r\n\t\tif ( item.f ) {\r\n\t\t\tconst isPreserveWhitespaceElement = item.t === ELEMENT && preserveWhitespaceElements.test( item.e );\r\n\t\t\tpreserveWhitespaceInsideFragment = preserveWhitespace || isPreserveWhitespaceElement;\r\n\r\n\t\t\tif ( !preserveWhitespace && isPreserveWhitespaceElement ) {\r\n\t\t\t\ttrimWhitespace( item.f, leadingNewLine, trailingNewLine );\r\n\t\t\t}\r\n\r\n\t\t\tif ( !preserveWhitespaceInsideFragment ) {\r\n\t\t\t\tpreviousItem = items[ i - 1 ];\r\n\t\t\t\tnextItem = items[ i + 1 ];\r\n\r\n\t\t\t\t// if the previous item was a text item with trailing whitespace,\r\n\t\t\t\t// remove leading whitespace inside the fragment\r\n\t\t\t\tif ( !previousItem || ( typeof previousItem === 'string' && trailingWhitespace.test( previousItem ) ) ) {\r\n\t\t\t\t\tremoveLeadingWhitespaceInsideFragment = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// and vice versa\r\n\t\t\t\tif ( !nextItem || ( typeof nextItem === 'string' && leadingWhitespace.test( nextItem ) ) ) {\r\n\t\t\t\t\tremoveTrailingWhitespaceInsideFragment = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcleanup( item.f, stripComments, preserveWhitespaceInsideFragment, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\r\n\t\t}\r\n\r\n\t\t// Split if-else blocks into two (an if, and an unless)\r\n\t\tif ( item.l ) {\r\n\t\t\tcleanup( item.l, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\r\n\r\n\t\t\titem.l.forEach( s => s.l = 1 );\r\n\t\t\titem.l.unshift( i + 1, 0 );\r\n\t\t\titems.splice.apply( items, item.l );\r\n\t\t\tdelete item.l; // TODO would be nice if there was a way around this\r\n\t\t}\r\n\r\n\t\t// Clean up conditional attributes\r\n\t\tif ( item.m ) {\r\n\t\t\tcleanup( item.m, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\r\n\t\t\tif ( item.m.length < 1 ) delete item.m;\r\n\t\t}\r\n\t}\r\n\r\n\t// final pass - fuse text nodes together\r\n\ti = items.length;\r\n\twhile ( i-- ) {\r\n\t\tif ( typeof items[i] === 'string' ) {\r\n\t\t\tif ( typeof items[i+1] === 'string' ) {\r\n\t\t\t\titems[i] = items[i] + items[i+1];\r\n\t\t\t\titems.splice( i + 1, 1 );\r\n\t\t\t}\r\n\r\n\t\t\tif ( !preserveWhitespace ) {\r\n\t\t\t\titems[i] = items[i].replace( contiguousWhitespace, ' ' );\r\n\t\t\t}\r\n\r\n\t\t\tif ( items[i] === '' ) {\r\n\t\t\t\titems.splice( i, 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import { CLOSING_TAG } from '../../../config/types';\r\n\r\nconst closingTagPattern = /^([a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*)\\s*\\>/;\r\n\r\nexport default function readClosingTag ( parser ) {\r\n\tlet tag;\r\n\r\n\tconst start = parser.pos;\r\n\r\n\t// are we looking at a closing tag?\r\n\tif ( !parser.matchString( '</' ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( tag = parser.matchPattern( closingTagPattern ) ) {\r\n\t\tif ( parser.inside && tag !== parser.inside ) {\r\n\t\t\tparser.pos = start;\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tt: CLOSING_TAG,\r\n\t\t\te: tag\r\n\t\t};\r\n\t}\r\n\r\n\t// We have an illegal closing tag, report it\r\n\tparser.pos -= 2;\r\n\tparser.error( 'Illegal closing tag' );\r\n}\r\n","import { ANCHOR, DOCTYPE, ELEMENT } from '../../config/types';\nimport { voidElementNames } from '../../utils/html';\nimport { READERS, PARTIAL_READERS } from '../_parse';\nimport cleanup from '../utils/cleanup';\nimport readMustache from './readMustache';\nimport readClosing from './mustache/section/readClosing';\nimport readClosingTag from './element/readClosingTag';\n\nconst tagNamePattern = /^[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/;\nconst anchorPattern = /^[a-zA-Z_$][-a-zA-Z0-9_$]*/;\nconst validTagNameFollower = /^[\\s\\n\\/>]/;\nconst exclude = { exclude: true };\n\n// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\nconst disallowedContents = {\n\tli: [ 'li' ],\n\tdt: [ 'dt', 'dd' ],\n\tdd: [ 'dt', 'dd' ],\n\tp: 'address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split( ' ' ),\n\trt: [ 'rt', 'rp' ],\n\trp: [ 'rt', 'rp' ],\n\toptgroup: [ 'optgroup' ],\n\toption: [ 'option', 'optgroup' ],\n\tthead: [ 'tbody', 'tfoot' ],\n\ttbody: [ 'tbody', 'tfoot' ],\n\ttfoot: [ 'tbody' ],\n\ttr: [ 'tr', 'tbody' ],\n\ttd: [ 'td', 'th', 'tr' ],\n\tth: [ 'td', 'th', 'tr' ]\n};\n\nexport default readElement;\n\nfunction readElement ( parser ) {\n\tlet attribute, selfClosing, children, partials, hasPartials, child, closed, pos, remaining, closingTag, anchor;\n\n\tconst start = parser.pos;\n\n\tif ( parser.inside || parser.inAttribute || parser.textOnlyMode ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( '<' ) ) {\n\t\treturn null;\n\t}\n\n\t// if this is a closing tag, abort straight away\n\tif ( parser.nextChar() === '/' ) {\n\t\treturn null;\n\t}\n\n\tconst element = {};\n\tif ( parser.includeLinePositions ) {\n\t\telement.p = parser.getLinePos( start );\n\t}\n\n\t// check for doctype decl\n\tif ( parser.matchString( '!' ) ) {\n\t\telement.t = DOCTYPE;\n\t\tif ( !parser.matchPattern( /^doctype/i ) ) {\n\t\t\tparser.error( 'Expected DOCTYPE declaration' );\n\t\t}\n\n\t\telement.a = parser.matchPattern( /^(.+?)>/ );\n\t\treturn element;\n\t}\n\t// check for anchor\n\telse if ( anchor = parser.matchString( '#' ) ) {\n\t\tparser.allowWhitespace();\n\t\telement.t = ANCHOR;\n\t\telement.n = parser.matchPattern( anchorPattern );\n\t}\n\t// otherwise, it's an element/component\n\telse {\n\t\telement.t = ELEMENT;\n\n\t\t// element name\n\t\telement.e = parser.matchPattern( tagNamePattern );\n\t\tif ( !element.e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t// next character must be whitespace, closing solidus or '>'\n\tif ( !validTagNameFollower.test( parser.nextChar() ) ) {\n\t\tparser.error( 'Illegal tag name' );\n\t}\n\n\tparser.allowWhitespace();\n\n\tparser.inTag = true;\n\n\t// directives and attributes\n\twhile ( attribute = readMustache( parser ) ) {\n\t\tif ( attribute !== false ) {\n\t\t\tif ( !element.m ) element.m = [];\n\t\t\telement.m.push( attribute );\n\t\t}\n\n\t\tparser.allowWhitespace();\n\t}\n\n\tparser.inTag = false;\n\n\t// allow whitespace before closing solidus\n\tparser.allowWhitespace();\n\n\t// self-closing solidus?\n\tif ( parser.matchString( '/' ) ) {\n\t\tselfClosing = true;\n\t}\n\n\t// closing angle bracket\n\tif ( !parser.matchString( '>' ) ) {\n\t\treturn null;\n\t}\n\n\tconst lowerCaseName = ( element.e || element.n ).toLowerCase();\n\tconst preserveWhitespace = parser.preserveWhitespace;\n\n\tif ( !selfClosing && ( anchor || !voidElementNames.test( element.e ) ) ) {\n\t\tif ( !anchor ) {\n\t\t\tparser.elementStack.push( lowerCaseName );\n\n\t\t\t// Special case - if we open a script element, further tags should\n\t\t\t// be ignored unless they're a closing script element\n\t\t\tif ( lowerCaseName in parser.interpolate ) {\n\t\t\t\tparser.inside = lowerCaseName;\n\t\t\t}\n\t\t}\n\n\t\tchildren = [];\n\t\tpartials = Object.create( null );\n\n\t\tdo {\n\t\t\tpos = parser.pos;\n\t\t\tremaining = parser.remaining();\n\n\t\t\tif ( !remaining ) {\n\t\t\t\tparser.error( `Missing end ${\n\t\t\t\t\tparser.elementStack.length > 1 ? 'tags' : 'tag'\n\t\t\t\t} (${\n\t\t\t\t\tparser.elementStack.reverse().map( x => `</${x}>` ).join( '' )\n\t\t\t\t})` );\n\t\t\t}\n\n\t\t\t// if for example we're in an <li> element, and we see another\n\t\t\t// <li> tag, close the first so they become siblings\n\t\t\tif ( !anchor && !canContain( lowerCaseName, remaining ) ) {\n\t\t\t\tclosed = true;\n\t\t\t}\n\n\t\t\t// closing tag\n\t\t\telse if ( !anchor && ( closingTag = readClosingTag( parser ) ) ) {\n\t\t\t\tclosed = true;\n\n\t\t\t\tconst closingTagName = closingTag.e.toLowerCase();\n\n\t\t\t\t// if this *isn't* the closing tag for the current element...\n\t\t\t\tif ( closingTagName !== lowerCaseName ) {\n\t\t\t\t\t// rewind parser\n\t\t\t\t\tparser.pos = pos;\n\n\t\t\t\t\t// if it doesn't close a parent tag, error\n\t\t\t\t\tif ( !~parser.elementStack.indexOf( closingTagName ) ) {\n\t\t\t\t\t\tlet errorMessage = 'Unexpected closing tag';\n\n\t\t\t\t\t\t// add additional help for void elements, since component names\n\t\t\t\t\t\t// might clash with them\n\t\t\t\t\t\tif ( voidElementNames.test( closingTagName ) ) {\n\t\t\t\t\t\t\terrorMessage += ` (<${closingTagName}> is a void element - it cannot contain children)`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparser.error( errorMessage );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse if ( anchor && readAnchorClose( parser, element.n ) ) {\n\t\t\t\tclosed = true;\n\t\t\t}\n\n\t\t\t// implicit close by closing section tag. TODO clean this up\n\t\t\telse if ( child = readClosing( parser, { open: parser.standardDelimiters[0], close: parser.standardDelimiters[1] } ) ) {\n\t\t\t\tclosed = true;\n\t\t\t\tparser.pos = pos;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tif ( child = parser.read( PARTIAL_READERS ) ) {\n\t\t\t\t\tif ( partials[ child.n ] ) {\n\t\t\t\t\t\tparser.pos = pos;\n\t\t\t\t\t\tparser.error( 'Duplicate partial definition' );\n\t\t\t\t\t}\n\n\t\t\t\t\tcleanup( child.f, parser.stripComments, preserveWhitespace, !preserveWhitespace, !preserveWhitespace );\n\n\t\t\t\t\tpartials[ child.n ] = child.f;\n\t\t\t\t\thasPartials = true;\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tif ( child = parser.read( READERS ) ) {\n\t\t\t\t\t\tchildren.push( child );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclosed = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} while ( !closed );\n\n\t\tif ( children.length ) {\n\t\t\telement.f = children;\n\t\t}\n\n\t\tif ( hasPartials ) {\n\t\t\telement.p = partials;\n\t\t}\n\n\t\tparser.elementStack.pop();\n\t}\n\n\tparser.inside = null;\n\n\tif ( parser.sanitizeElements && parser.sanitizeElements.indexOf( lowerCaseName ) !== -1 ) {\n\t\treturn exclude;\n\t}\n\n\treturn element;\n}\n\nfunction canContain ( name, remaining ) {\n\tconst match = /^<([a-zA-Z][a-zA-Z0-9]*)/.exec( remaining );\n\tconst disallowed = disallowedContents[ name ];\n\n\tif ( !match || !disallowed ) {\n\t\treturn true;\n\t}\n\n\treturn !~disallowed.indexOf( match[1].toLowerCase() );\n}\n\nfunction readAnchorClose ( parser, name ) {\n\tconst pos = parser.pos;\n\tif ( !parser.matchString( '</' ) ) {\n\t\treturn null;\n\t}\n\n\tparser.matchString( '#' );\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( name ) ) {\n\t\tparser.pos = pos;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '>' ) ) {\n\t\tparser.pos = pos;\n\t\treturn null;\n\t}\n\n\treturn true;\n}\n","import getLowestIndex from './utils/getLowestIndex';\r\nimport { decodeCharacterReferences } from '../../utils/html';\r\n\r\nexport default function readText ( parser ) {\r\n\tlet index, disallowed, barrier;\r\n\r\n\tconst remaining = parser.remaining();\r\n\r\n\tif ( parser.textOnlyMode ) {\r\n\t\tdisallowed = parser.tags.map( t => t.open );\r\n\t\tdisallowed = disallowed.concat( parser.tags.map( t => '\\\\' + t.open ) );\r\n\r\n\t\tindex = getLowestIndex( remaining, disallowed );\r\n\t} else {\r\n\t\tbarrier = parser.inside ? '</' + parser.inside : '<';\r\n\r\n\t\tif ( parser.inside && !parser.interpolate[ parser.inside ] ) {\r\n\t\t\tindex = remaining.indexOf( barrier );\r\n\t\t} else {\r\n\t\t\tdisallowed = parser.tags.map( t => t.open );\r\n\t\t\tdisallowed = disallowed.concat( parser.tags.map( t => '\\\\' + t.open ) );\r\n\r\n\t\t\t// http://developers.whatwg.org/syntax.html#syntax-attributes\r\n\t\t\tif ( parser.inAttribute === true ) {\r\n\t\t\t\t// we're inside an unquoted attribute value\r\n\t\t\t\tdisallowed.push( `\"`, `'`, `=`, `<`, `>`, '`' );\r\n\t\t\t} else if ( parser.inAttribute ) {\r\n\t\t\t\t// quoted attribute value\r\n\t\t\t\tdisallowed.push( parser.inAttribute );\r\n\t\t\t} else {\r\n\t\t\t\tdisallowed.push( barrier );\r\n\t\t\t}\r\n\r\n\t\t\tindex = getLowestIndex( remaining, disallowed );\r\n\t\t}\r\n\t}\r\n\r\n\tif ( !index ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( index === -1 ) {\r\n\t\tindex = remaining.length;\r\n\t}\r\n\r\n\tparser.pos += index;\r\n\r\n\tif ( ( parser.inside && parser.inside !== 'textarea' ) || parser.textOnlyMode ) {\r\n\t\treturn remaining.substr( 0, index );\r\n\t} else {\r\n\t\treturn decodeCharacterReferences( remaining.substr( 0, index ) );\r\n\t}\r\n}\r\n","import { INLINE_PARTIAL } from '../../config/types';\r\nimport { READERS } from '../_parse';\r\nimport readClosing from './mustache/section/readClosing';\r\n\r\nconst partialDefinitionSectionPattern = /^\\s*#\\s*partial\\s+/;\r\n\r\nexport default function readPartialDefinitionSection ( parser ) {\r\n\tlet child, closed;\r\n\r\n\tconst start = parser.pos;\r\n\r\n\tconst delimiters = parser.standardDelimiters;\r\n\r\n\tif ( !parser.matchString( delimiters[0] ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( !parser.matchPattern( partialDefinitionSectionPattern ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst name = parser.matchPattern( /^[a-zA-Z_$][a-zA-Z_$0-9\\-\\/]*/ );\r\n\r\n\tif ( !name ) {\r\n\t\tparser.error( 'expected legal partial name' );\r\n\t}\r\n\r\n\tparser.allowWhitespace();\r\n\tif ( !parser.matchString( delimiters[1] ) ) {\r\n\t\tparser.error( `Expected closing delimiter '${delimiters[1]}'` );\r\n\t}\r\n\r\n\tconst content = [];\r\n\r\n\tconst [ open, close ] = delimiters;\r\n\r\n\tdo {\r\n\t\tif ( child = readClosing( parser, { open, close }) ) {\r\n\t\t\tif ( child.r !== 'partial' ) {\r\n\t\t\t\tparser.error( `Expected ${open}/partial${close}` );\r\n\t\t\t}\r\n\r\n\t\t\tclosed = true;\r\n\t\t}\r\n\r\n\t\telse {\r\n\t\t\tchild = parser.read( READERS );\r\n\r\n\t\t\tif ( !child ) {\r\n\t\t\t\tparser.error( `Expected ${open}/partial${close}` );\r\n\t\t\t}\r\n\r\n\t\t\tcontent.push( child );\r\n\t\t}\r\n\t} while ( !closed );\r\n\r\n\treturn {\r\n\t\tt: INLINE_PARTIAL,\r\n\t\tn: name,\r\n\t\tf: content\r\n\t};\r\n}\r\n","import { TEMPLATE_VERSION } from '../../config/template';\r\nimport { READERS, PARTIAL_READERS } from '../_parse';\r\nimport cleanup from '../utils/cleanup';\r\n\r\nexport default function readTemplate ( parser ) {\r\n\tconst fragment = [];\r\n\tconst partials = Object.create( null );\r\n\tlet hasPartials = false;\r\n\r\n\tconst preserveWhitespace = parser.preserveWhitespace;\r\n\r\n\twhile ( parser.pos < parser.str.length ) {\r\n\t\tconst pos = parser.pos;\r\n\t\tlet item, partial;\r\n\r\n\t\tif ( partial = parser.read( PARTIAL_READERS ) ) {\r\n\t\t\tif ( partials[ partial.n ] ) {\r\n\t\t\t\tparser.pos = pos;\r\n\t\t\t\tparser.error( 'Duplicated partial definition' );\r\n\t\t\t}\r\n\r\n\t\t\tcleanup( partial.f, parser.stripComments, preserveWhitespace, !preserveWhitespace, !preserveWhitespace );\r\n\r\n\t\t\tpartials[ partial.n ] = partial.f;\r\n\t\t\thasPartials = true;\r\n\t\t} else if ( item = parser.read( READERS ) ) {\r\n\t\t\tfragment.push( item );\r\n\t\t} else  {\r\n\t\t\tparser.error( 'Unexpected template content' );\r\n\t\t}\r\n\t}\r\n\r\n\tconst result = {\r\n\t\tv: TEMPLATE_VERSION,\r\n\t\tt: fragment\r\n\t};\r\n\r\n\tif ( hasPartials ) {\r\n\t\tresult.p = partials;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n","import { fromExpression } from './createFunction';\r\nimport { isObject } from '../../utils/is';\r\n\r\nexport default function insertExpressions ( obj, expr ) {\r\n\r\n\tObject.keys( obj ).forEach( key => {\r\n\t\tif  ( isExpression( key, obj ) ) return addTo( obj, expr );\r\n\r\n\t\tconst ref = obj[ key ];\r\n\t\tif ( hasChildren( ref ) ) insertExpressions( ref, expr );\r\n\t});\r\n}\r\n\r\nfunction isExpression( key, obj ) {\r\n\treturn key === 's' && Array.isArray( obj.r );\r\n}\r\n\r\nfunction addTo( obj, expr ) {\r\n\tconst { s, r } = obj;\r\n\tif ( !expr[ s ] ) expr[ s ] = fromExpression( s, r.length );\r\n}\r\n\r\nfunction hasChildren( ref ) {\r\n\treturn Array.isArray( ref ) || isObject( ref );\r\n}\r\n","import { TEMPLATE_VERSION } from '../config/template';\r\nimport { ELEMENT } from '../config/types';\r\nimport Parser from './Parser';\r\nimport readMustache from './converters/readMustache';\r\nimport readTriple from './converters/mustache/readTriple';\r\nimport readUnescaped from './converters/mustache/readUnescaped';\r\nimport readPartial from './converters/mustache/readPartial';\r\nimport readMustacheComment from './converters/mustache/readMustacheComment';\r\nimport readInterpolator from './converters/mustache/readInterpolator';\r\nimport readSection from './converters/mustache/readSection';\r\nimport readHtmlComment from './converters/readHtmlComment';\r\nimport readElement from './converters/readElement';\r\nimport readText from './converters/readText';\r\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\r\nimport readTemplate from './converters/readTemplate';\r\nimport cleanup from './utils/cleanup';\r\nimport insertExpressions from './utils/insertExpressions';\r\nimport shared from '../Ractive/shared';\r\n\r\n// See https://github.com/ractivejs/template-spec for information\r\n// about the Ractive template specification\r\n\r\nconst STANDARD_READERS = [ readPartial, readUnescaped, readSection, readInterpolator, readMustacheComment ];\r\nconst TRIPLE_READERS = [ readTriple ];\r\nconst STATIC_READERS = [ readUnescaped, readSection, readInterpolator ]; // TODO does it make sense to have a static section?\r\n\r\nexport const READERS = [ readMustache, readHtmlComment, readElement, readText ];\r\nexport const PARTIAL_READERS = [ readPartialDefinitionSection ];\r\n\r\nconst defaultInterpolate = [ 'script', 'style', 'template' ];\r\n\r\nconst StandardParser = Parser.extend({\r\n\tinit ( str, options ) {\r\n\t\tconst tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\r\n\t\tconst staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\r\n\t\tconst staticTripleDelimiters = options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\r\n\r\n\t\tthis.standardDelimiters = options.delimiters || shared.defaults.delimiters;\r\n\r\n\t\tthis.tags = [\r\n\t\t\t{ isStatic: false, isTriple: false, open: this.standardDelimiters[0], close: this.standardDelimiters[1], readers: STANDARD_READERS },\r\n\t\t\t{ isStatic: false, isTriple: true,  open: tripleDelimiters[0],        close: tripleDelimiters[1],        readers: TRIPLE_READERS },\r\n\t\t\t{ isStatic: true,  isTriple: false, open: staticDelimiters[0],        close: staticDelimiters[1],        readers: STATIC_READERS },\r\n\t\t\t{ isStatic: true,  isTriple: true,  open: staticTripleDelimiters[0],  close: staticTripleDelimiters[1],  readers: TRIPLE_READERS }\r\n\t\t];\r\n\r\n\t\tthis.contextLines = options.contextLines || shared.defaults.contextLines;\r\n\r\n\t\tthis.sortMustacheTags();\r\n\r\n\t\tthis.sectionDepth = 0;\r\n\t\tthis.elementStack = [];\r\n\r\n\t\tthis.interpolate = Object.create( options.interpolate || shared.defaults.interpolate || {} );\r\n\t\tthis.interpolate.textarea = true;\r\n\t\tdefaultInterpolate.forEach( t => this.interpolate[ t ] = !options.interpolate || options.interpolate[ t ] !== false );\r\n\r\n\t\tif ( options.sanitize === true ) {\r\n\t\t\toptions.sanitize = {\r\n\t\t\t\t// blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\r\n\t\t\t\telements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split( ' ' ),\r\n\t\t\t\teventAttributes: true\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tthis.stripComments = options.stripComments !== false;\r\n\t\tthis.preserveWhitespace = options.preserveWhitespace;\r\n\t\tthis.sanitizeElements = options.sanitize && options.sanitize.elements;\r\n\t\tthis.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\r\n\t\tthis.includeLinePositions = options.includeLinePositions;\r\n\t\tthis.textOnlyMode = options.textOnlyMode;\r\n\t\tthis.csp = options.csp;\r\n\r\n\t\tthis.transforms = options.transforms || options.parserTransforms;\r\n\t\tif ( this.transforms ) {\r\n\t\t\tthis.transforms = this.transforms.concat( shared.defaults.parserTransforms );\r\n\t\t} else {\r\n\t\t\tthis.transforms = shared.defaults.parserTransforms;\r\n\t\t}\r\n\t},\r\n\r\n\tpostProcess ( result ) {\r\n\t\t// special case - empty string\r\n\t\tif ( !result.length ) {\r\n\t\t\treturn { t: [], v: TEMPLATE_VERSION };\r\n\t\t}\r\n\r\n\t\tif ( this.sectionDepth > 0 ) {\r\n\t\t\tthis.error( 'A section was left open' );\r\n\t\t}\r\n\r\n\t\tcleanup( result[0].t, this.stripComments, this.preserveWhitespace, !this.preserveWhitespace, !this.preserveWhitespace );\r\n\r\n\t\tconst transforms = this.transforms;\r\n\t\tif ( transforms.length ) {\r\n\t\t\tconst tlen = transforms.length;\r\n\t\t\tconst walk = function ( fragment ) {\r\n\t\t\t\tlet len = fragment.length;\r\n\r\n\t\t\t\tfor ( let i = 0; i < len; i++ ) {\r\n\t\t\t\t\tlet node = fragment[i];\r\n\r\n\t\t\t\t\tif ( node.t === ELEMENT ) {\r\n\t\t\t\t\t\tfor ( let j = 0; j < tlen; j++ ) {\r\n\t\t\t\t\t\t\tconst res = transforms[j].call( shared.Ractive, node );\r\n\t\t\t\t\t\t\tif ( !res ) {\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t} else if ( res.remove ) {\r\n\t\t\t\t\t\t\t\tfragment.splice( i--, 1 );\r\n\t\t\t\t\t\t\t\tlen--;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t} else if ( res.replace ) {\r\n\t\t\t\t\t\t\t\tif ( Array.isArray( res.replace ) ) {\r\n\t\t\t\t\t\t\t\t\tfragment.splice( i--, 1, ...res.replace );\r\n\t\t\t\t\t\t\t\t\tlen += res.replace.length - 1;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tfragment[i--] = node = res.replace;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// watch for partials\r\n\t\t\t\t\t\tif ( node.p ) {\r\n\t\t\t\t\t\t\tfor ( const k in node.p ) walk( node.p[k] );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( node.f ) walk( node.f );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// process the root fragment\r\n\t\t\twalk( result[0].t );\r\n\r\n\t\t\t// watch for root partials\r\n\t\t\tif ( result[0].p ) {\r\n\t\t\t\tfor ( const k in result[0].p ) walk( result[0].p[k] );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( this.csp !== false ) {\r\n\t\t\tconst expr = {};\r\n\t\t\tinsertExpressions( result[0].t, expr );\r\n\t\t\tif ( Object.keys( expr ).length ) result[0].e = expr;\r\n\t\t}\r\n\r\n\t\treturn result[0];\r\n\t},\r\n\r\n\tconverters: [\r\n\t\treadTemplate\r\n\t],\r\n\r\n\tsortMustacheTags () {\r\n\t\t// Sort in order of descending opening delimiter length (longer first),\r\n\t\t// to protect against opening delimiters being substrings of each other\r\n\t\tthis.tags.sort( ( a, b ) => {\r\n\t\t\treturn b.open.length - a.open.length;\r\n\t\t});\r\n\t}\r\n});\r\n\r\nexport default function parse ( template, options ) {\r\n\treturn new StandardParser( template, options || {} ).result;\r\n}\r\n","import { fromExpression, fromComputationString } from '../../parse/utils/createFunction';\r\nimport { doc } from '../../config/environment';\r\nimport { fatal } from '../../utils/log';\r\nimport { addFunctions } from '../../shared/getFunction';\r\nimport parse from '../../parse/_parse';\r\n\r\nconst parseOptions = [\r\n\t'delimiters',\r\n\t'tripleDelimiters',\r\n\t'staticDelimiters',\r\n\t'staticTripleDelimiters',\r\n\t'csp',\r\n\t'interpolate',\r\n\t'preserveWhitespace',\r\n\t'sanitize',\r\n\t'stripComments',\r\n\t'contextLines'\r\n];\r\n\r\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\r\n\r\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\r\n\r\n\r\nfunction throwNoParse ( method, error, instructions ) {\r\n\tif ( !method ) {\r\n\t\tfatal( `Missing Ractive.parse - cannot parse ${error}. ${instructions}` );\r\n\t}\r\n}\r\n\r\nexport function createFunction ( body, length ) {\r\n\tthrowNoParse( fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS );\r\n\treturn fromExpression( body, length );\r\n}\r\n\r\nexport function createFunctionFromString ( str, bindTo ) {\r\n\tthrowNoParse( fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS );\r\n\treturn fromComputationString( str, bindTo );\r\n}\r\n\r\nconst parser = {\r\n\r\n\tfromId ( id, options ) {\r\n\t\tif ( !doc ) {\r\n\t\t\tif ( options && options.noThrow ) { return; }\r\n\t\t\tthrow new Error( `Cannot retrieve template #${id} as Ractive is not running in a browser.` );\r\n\t\t}\r\n\r\n\t\tif ( id ) id = id.replace( /^#/, '' );\r\n\r\n\t\tlet template;\r\n\r\n\t\tif ( !( template = doc.getElementById( id ) )) {\r\n\t\t\tif ( options && options.noThrow ) { return; }\r\n\t\t\tthrow new Error( `Could not find template element with id #${id}` );\r\n\t\t}\r\n\r\n\t\tif ( template.tagName.toUpperCase() !== 'SCRIPT' ) {\r\n\t\t\tif ( options && options.noThrow ) { return; }\r\n\t\t\tthrow new Error( `Template element with id #${id}, must be a <script> element` );\r\n\t\t}\r\n\r\n\t\treturn ( 'textContent' in template ? template.textContent : template.innerHTML );\r\n\r\n\t},\r\n\r\n\tisParsed ( template) {\r\n\t\treturn !( typeof template === 'string' );\r\n\t},\r\n\r\n\tgetParseOptions ( ractive ) {\r\n\t\t// Could be Ractive or a Component\r\n\t\tif ( ractive.defaults ) { ractive = ractive.defaults; }\r\n\r\n\t\treturn parseOptions.reduce( ( val, key ) => {\r\n\t\t\tval[ key ] = ractive[ key ];\r\n\t\t\treturn val;\r\n\t\t}, {});\r\n\t},\r\n\r\n\tparse ( template, options ) {\r\n\t\tthrowNoParse( parse, 'template', TEMPLATE_INSTRUCTIONS );\r\n\t\tconst parsed = parse( template, options );\r\n\t\taddFunctions( parsed );\r\n\t\treturn parsed;\r\n\t},\r\n\r\n\tparseFor( template, ractive ) {\r\n\t\treturn this.parse( template, this.getParseOptions( ractive ) );\r\n\t}\r\n};\r\n\r\nexport default parser;\r\n","import { TEMPLATE_VERSION } from '../../../config/template';\r\nimport parser from '../runtime-parser';\r\nimport { addFunctions } from '../../../shared/getFunction';\r\n\r\nexport default {\r\n\tname: 'template',\r\n\r\n\textend ( Parent, proto, options ) {\r\n\t\t// only assign if exists\r\n\t\tif ( 'template' in options ) {\r\n\t\t\tconst template = options.template;\r\n\r\n\t\t\tif ( typeof template === 'function' ) {\r\n\t\t\t\tproto.template = template;\r\n\t\t\t} else {\r\n\t\t\t\tproto.template = parseTemplate( template, proto );\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tinit ( Parent, ractive, options ) {\r\n\t\t// TODO because of prototypal inheritance, we might just be able to use\r\n\t\t// ractive.template, and not bother passing through the Parent object.\r\n\t\t// At present that breaks the test mocks' expectations\r\n\t\tlet template = 'template' in options ? options.template : Parent.prototype.template;\r\n\t\ttemplate = template || { v: TEMPLATE_VERSION, t: [] };\r\n\r\n\t\tif ( typeof template === 'function' ) {\r\n\t\t\tconst fn = template;\r\n\t\t\ttemplate = getDynamicTemplate( ractive, fn );\r\n\r\n\t\t\tractive._config.template = {\r\n\t\t\t\tfn,\r\n\t\t\t\tresult: template\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\ttemplate = parseTemplate( template, ractive );\r\n\r\n\t\t// TODO the naming of this is confusing - ractive.template refers to [...],\r\n\t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\r\n\t\t// it's unnecessary, because the developer never needs to access\r\n\t\t// ractive.template\r\n\t\tractive.template = template.t;\r\n\r\n\t\tif ( template.p ) {\r\n\t\t\textendPartials( ractive.partials, template.p );\r\n\t\t}\r\n\t},\r\n\r\n\treset ( ractive ) {\r\n\t\tconst result = resetValue( ractive );\r\n\r\n\t\tif ( result ) {\r\n\t\t\tconst parsed = parseTemplate( result, ractive );\r\n\r\n\t\t\tractive.template = parsed.t;\r\n\t\t\textendPartials( ractive.partials, parsed.p, true );\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nfunction resetValue ( ractive ) {\r\n\tconst initial = ractive._config.template;\r\n\r\n\t// If this isn't a dynamic template, there's nothing to do\r\n\tif ( !initial || !initial.fn ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst result = getDynamicTemplate( ractive, initial.fn );\r\n\r\n\t// TODO deep equality check to prevent unnecessary re-rendering\r\n\t// in the case of already-parsed templates\r\n\tif ( result !== initial.result ) {\r\n\t\tinitial.result = result;\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nfunction getDynamicTemplate ( ractive, fn ) {\r\n\treturn fn.call( ractive, {\r\n\t\tfromId: parser.fromId,\r\n\t\tisParsed: parser.isParsed,\r\n\t\tparse ( template, options = parser.getParseOptions( ractive ) ) {\r\n\t\t\treturn parser.parse( template, options );\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction parseTemplate ( template, ractive ) {\r\n\tif ( typeof template === 'string' ) {\r\n\t\t// parse will validate and add expression functions\r\n\t\ttemplate = parseAsString( template, ractive );\r\n\t}\r\n\telse {\r\n\t\t// need to validate and add exp for already parsed template\r\n\t\tvalidate( template );\r\n\t\taddFunctions( template );\r\n\t}\r\n\r\n\treturn template;\r\n}\r\n\r\nfunction parseAsString ( template, ractive ) {\r\n\t// ID of an element containing the template?\r\n\tif ( template[0] === '#' ) {\r\n\t\ttemplate = parser.fromId( template );\r\n\t}\r\n\r\n\treturn parser.parseFor( template, ractive );\r\n}\r\n\r\nfunction validate( template ) {\r\n\r\n\t// Check that the template even exists\r\n\tif ( template == undefined ) {\r\n\t\tthrow new Error( `The template cannot be ${template}.` );\r\n\t}\r\n\r\n\t// Check the parsed template has a version at all\r\n\telse if ( typeof template.v !== 'number' ) {\r\n\t\tthrow new Error( 'The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.' );\r\n\t}\r\n\r\n\t// Check we're using the correct version\r\n\telse if ( template.v !== TEMPLATE_VERSION ) {\r\n\t\tthrow new Error( `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${template.v}) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app` );\r\n\t}\r\n}\r\n\r\nfunction extendPartials ( existingPartials, newPartials, overwrite ) {\r\n\tif ( !newPartials ) return;\r\n\r\n\t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\r\n\t// case, but not initially...\r\n\r\n\tfor ( const key in newPartials ) {\r\n\t\tif ( overwrite || !existingPartials.hasOwnProperty( key ) ) {\r\n\t\t\texistingPartials[ key ] = newPartials[ key ];\r\n\t\t}\r\n\t}\r\n}\r\n","import noop from '../../utils/noop';\r\n\r\nexport default function wrap ( parent, name, method ) {\r\n\tif ( !/_super/.test( method ) ) return method;\r\n\r\n\tfunction wrapper () {\r\n\t\tconst superMethod = getSuperMethod( wrapper._parent, name );\r\n\t\tconst hasSuper = '_super' in this;\r\n\t\tconst oldSuper = this._super;\r\n\r\n\t\tthis._super = superMethod;\r\n\r\n\t\tconst result = method.apply( this, arguments );\r\n\r\n\t\tif ( hasSuper ) {\r\n\t\t\tthis._super = oldSuper;\r\n\t\t} else {\r\n\t\t\tdelete this._super;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\twrapper._parent = parent;\r\n\twrapper._method = method;\r\n\r\n\treturn wrapper;\r\n}\r\n\r\nfunction getSuperMethod ( parent, name ) {\r\n\tif ( name in parent ) {\r\n\t\tconst value = parent[ name ];\r\n\r\n\t\treturn typeof value === 'function' ?\r\n\t\t\tvalue :\r\n\t\t\t() => value;\r\n\t}\r\n\r\n\treturn noop;\r\n}\r\n","import { warnIfDebug } from '../../utils/log';\r\n\r\nfunction getMessage( deprecated, correct, isError ) {\r\n\treturn `options.${deprecated} has been deprecated in favour of options.${correct}.`\r\n\t\t+ ( isError ? ` You cannot specify both options, please use options.${correct}.` : '' );\r\n}\r\n\r\nfunction deprecateOption ( options, deprecatedOption, correct ) {\r\n\tif ( deprecatedOption in options ) {\r\n\t\tif( !( correct in options ) ) {\r\n\t\t\twarnIfDebug( getMessage( deprecatedOption, correct ) );\r\n\t\t\toptions[ correct ] = options[ deprecatedOption ];\r\n\t\t} else {\r\n\t\t\tthrow new Error( getMessage( deprecatedOption, correct, true ) );\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default function deprecate ( options ) {\r\n\tdeprecateOption( options, 'beforeInit', 'onconstruct' );\r\n\tdeprecateOption( options, 'init', 'onrender' );\r\n\tdeprecateOption( options, 'complete', 'oncomplete' );\r\n\tdeprecateOption( options, 'eventDefinitions', 'events' );\r\n\r\n\t// Using extend with Component instead of options,\r\n\t// like Human.extend( Spider ) means adaptors as a registry\r\n\t// gets copied to options. So we have to check if actually an array\r\n\tif ( Array.isArray( options.adaptors ) ) {\r\n\t\tdeprecateOption( options, 'adaptors', 'adapt' );\r\n\t}\r\n}\r\n","import { warnIfDebug } from '../../utils/log';\r\nimport adaptConfigurator from './custom/adapt';\r\nimport cssConfigurator from './custom/css/css';\r\nimport dataConfigurator from './custom/data';\r\nimport templateConfigurator from './custom/template';\r\nimport defaults from './defaults';\r\nimport registries from './registries';\r\nimport wrapPrototype from './wrapPrototypeMethod';\r\nimport deprecate from './deprecate';\r\nimport RactiveProto from '../prototype';\r\n\r\nconst custom = {\r\n\tadapt: adaptConfigurator,\r\n\tcss: cssConfigurator,\r\n\tdata: dataConfigurator,\r\n\ttemplate: templateConfigurator\r\n};\r\n\r\nconst defaultKeys = Object.keys( defaults );\r\n\r\nconst isStandardKey = makeObj( defaultKeys.filter( key => !custom[ key ] ) );\r\n\r\n// blacklisted keys that we don't double extend\r\nconst isBlacklisted = makeObj( defaultKeys.concat( registries.map( r => r.name ), [ 'on', 'observe', 'attributes' ] ) );\r\n\r\nconst order = [].concat(\r\n\tdefaultKeys.filter( key => !registries[ key ] && !custom[ key ] ),\r\n\tregistries,\r\n\t//custom.data,\r\n\tcustom.template,\r\n\tcustom.css\r\n);\r\n\r\nconst config = {\r\n\textend: ( Parent, proto, options ) => configure( 'extend', Parent, proto, options ),\r\n\r\n\tinit: ( Parent, ractive, options ) => configure( 'init', Parent, ractive, options ),\r\n\r\n\treset: ractive => {\r\n\t\treturn order.filter( c => {\r\n\t\t\treturn c.reset && c.reset( ractive );\r\n\t\t}).map( c => c.name );\r\n\t},\r\n\r\n\t// this defines the order. TODO this isn't used anywhere in the codebase,\r\n\t// only in the test suite - should get rid of it\r\n\torder\r\n};\r\n\r\nfunction configure ( method, Parent, target, options ) {\r\n\tdeprecate( options );\r\n\r\n\tfor ( const key in options ) {\r\n\t\tif ( isStandardKey.hasOwnProperty( key ) ) {\r\n\t\t\tconst value = options[ key ];\r\n\r\n\t\t\t// warn the developer if they passed a function and ignore its value\r\n\r\n\t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\r\n\t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\r\n\t\t\t// function object as the result of querySelector methods\r\n\t\t\tif ( key !== 'el' && typeof value === 'function' ) {\r\n\t\t\t\twarnIfDebug( `${ key } is a Ractive option that does not expect a function and will be ignored`,\r\n\t\t\t\t\tmethod === 'init' ? target : null );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttarget[ key ] = value;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// disallow combination of `append` and `enhance`\r\n\tif ( options.append && options.enhance ) {\r\n\t\tthrow new Error( 'Cannot use append and enhance at the same time' );\r\n\t}\r\n\r\n\tregistries.forEach( registry => {\r\n\t\tregistry[ method ]( Parent, target, options );\r\n\t});\r\n\r\n\tadaptConfigurator[ method ]( Parent, target, options );\r\n\ttemplateConfigurator[ method ]( Parent, target, options );\r\n\tcssConfigurator[ method ]( Parent, target, options );\r\n\r\n\textendOtherMethods( Parent.prototype, target, options );\r\n}\r\n\r\nconst _super = /\\b_super\\b/;\r\nfunction extendOtherMethods ( parent, target, options ) {\r\n\tfor ( const key in options ) {\r\n\t\tif ( !isBlacklisted[ key ] && options.hasOwnProperty( key ) ) {\r\n\t\t\tlet member = options[ key ];\r\n\r\n\t\t\t// if this is a method that overwrites a method, wrap it:\r\n\t\t\tif ( typeof member === 'function' ) {\r\n\t\t\t\tif ( key in RactiveProto && !_super.test( member.toString() ) ) {\r\n\t\t\t\t\twarnIfDebug( `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.` );\r\n\t\t\t\t}\r\n\t\t\t\tmember = wrapPrototype( parent, key, member );\r\n\t\t\t}\r\n\r\n\t\t\ttarget[ key ] = member;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction makeObj ( array ) {\r\n\tconst obj = {};\r\n\tarray.forEach( x => obj[x] = true );\r\n\treturn obj;\r\n}\r\n\r\nexport default config;\r\n","import resolveReference from './resolveReference';\r\nimport ExpressionProxy from './ExpressionProxy';\r\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\r\n\r\nexport default function resolve ( fragment, template ) {\r\n\tif ( template.r ) {\r\n\t\treturn resolveReference( fragment, template.r );\r\n\t}\r\n\r\n\telse if ( template.x ) {\r\n\t\treturn new ExpressionProxy( fragment, template.x );\r\n\t}\r\n\r\n\telse if ( template.rx ) {\r\n\t\treturn new ReferenceExpressionProxy( fragment, template.rx );\r\n\t}\r\n}\r\n","import Fragment from '../Fragment';\r\nimport { ContainerItem } from './shared/Item';\r\nimport resolve from '../resolvers/resolve';\r\n\r\nexport function resolveAliases( aliases, fragment ) {\r\n\tconst resolved = {};\r\n\r\n\tfor ( let i = 0; i < aliases.length; i++ ) {\r\n\t\tresolved[ aliases[i].n ] = resolve( fragment, aliases[i].x );\r\n\t}\r\n\r\n\tfor ( const k in resolved ) {\r\n\t\tresolved[k].reference();\r\n\t}\r\n\r\n\treturn resolved;\r\n}\r\n\r\nexport default class Alias extends ContainerItem {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.fragment = null;\r\n\t}\r\n\r\n\tbind () {\r\n\t\tthis.fragment = new Fragment({\r\n\t\t\towner: this,\r\n\t\t\ttemplate: this.template.f\r\n\t\t});\r\n\r\n\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.parentFragment );\r\n\t\tthis.fragment.bind();\r\n\t}\r\n\r\n\trender ( target ) {\r\n\t\tthis.rendered = true;\r\n\t\tif ( this.fragment ) this.fragment.render( target );\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tfor ( const k in this.fragment.aliases ) {\r\n\t\t\tthis.fragment.aliases[k].unreference();\r\n\t\t}\r\n\r\n\t\tthis.fragment.aliases = {};\r\n\t\tif ( this.fragment ) this.fragment.unbind();\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tif ( this.rendered && this.fragment ) this.fragment.unrender( shouldDestroy );\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\t\t\tthis.fragment.update();\r\n\t\t}\r\n\t}\r\n}\r\n","import cleanCss from '../../utils/cleanCss';\r\n\r\nconst space = /\\s+/;\r\n\r\nexport function readStyle ( css ) {\r\n\tif ( typeof css !== 'string' ) return {};\r\n\r\n\treturn cleanCss( css, ( css, reconstruct ) => {\r\n\t\treturn css.split( ';' )\r\n\t\t\t.filter( rule => !!rule.trim() )\r\n\t\t\t.map( reconstruct )\r\n\t\t\t.reduce(( rules, rule ) => {\r\n\t\t\t\tconst i = rule.indexOf(':');\r\n\t\t\t\tconst name = rule.substr( 0, i ).trim();\r\n\t\t\t\trules[ name ] = rule.substr( i + 1 ).trim();\r\n\t\t\t\treturn rules;\r\n\t\t\t}, {});\r\n\t});\r\n}\r\n\r\nexport function readClass ( str ) {\r\n\tconst list = str.split( space );\r\n\r\n  // remove any empty entries\r\n\tlet i = list.length;\r\n\twhile ( i-- ) {\r\n\t\tif ( !list[i] ) list.splice( i, 1 );\r\n\t}\r\n\r\n\treturn list;\r\n}\r\n","import { html } from '../../../../config/namespaces';\nimport { safeToStringValue} from '../../../../utils/dom';\nimport { arrayContains } from '../../../../utils/array';\nimport noop from '../../../../utils/noop';\nimport { readStyle, readClass } from '../../../helpers/specialAttrs';\nimport hyphenateCamel from '../../../../utils/hyphenateCamel';\n\nconst textTypes = [ undefined, 'text', 'search', 'url', 'email', 'hidden', 'password', 'search', 'reset', 'submit' ];\n\nexport default function getUpdateDelegate ( attribute ) {\n\tconst { element, name } = attribute;\n\n\tif ( name === 'value' ) {\n\t\tif ( attribute.interpolator ) attribute.interpolator.bound = true;\n\n\t\t// special case - selects\n\t\tif ( element.name === 'select' && name === 'value' ) {\n\t\t\treturn element.getAttribute( 'multiple' ) ? updateMultipleSelectValue : updateSelectValue;\n\t\t}\n\n\t\tif ( element.name === 'textarea' ) return updateStringValue;\n\n\t\t// special case - contenteditable\n\t\tif ( element.getAttribute( 'contenteditable' ) != null ) return updateContentEditableValue;\n\n\t\t// special case - <input>\n\t\tif ( element.name === 'input' ) {\n\t\t\tconst type = element.getAttribute( 'type' );\n\n\t\t\t// type='file' value='{{fileList}}'>\n\t\t\tif ( type === 'file' ) return noop; // read-only\n\n\t\t\t// type='radio' name='{{twoway}}'\n\t\t\tif ( type === 'radio' && element.binding && element.binding.attribute.name === 'name' ) return updateRadioValue;\n\n\t\t\tif ( ~textTypes.indexOf( type ) ) return updateStringValue;\n\t\t}\n\n\t\treturn updateValue;\n\t}\n\n\tconst node = element.node;\n\n\t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n\tif ( attribute.isTwoway && name === 'name' ) {\n\t\tif ( node.type === 'radio' ) return updateRadioName;\n\t\tif ( node.type === 'checkbox' ) return updateCheckboxName;\n\t}\n\n\tif ( name === 'style' ) return updateStyleAttribute;\n\n\tif ( name.indexOf( 'style-' ) === 0 ) return updateInlineStyle;\n\n\t// special case - class names. IE fucks things up, again\n\tif ( name === 'class' && ( !node.namespaceURI || node.namespaceURI === html ) ) return updateClassName;\n\n\tif ( name.indexOf( 'class-' ) === 0 ) return updateInlineClass;\n\n\tif ( attribute.isBoolean ) {\n\t\tconst type = element.getAttribute( 'type' );\n\t\tif ( attribute.interpolator && name === 'checked' && ( type === 'checkbox' || type === 'radio' ) ) attribute.interpolator.bound = true;\n\t\treturn updateBoolean;\n\t}\n\n\tif ( attribute.namespace && attribute.namespace !== attribute.node.namespaceURI ) return updateNamespacedAttribute;\n\n\treturn updateAttribute;\n}\n\nfunction updateMultipleSelectValue ( reset ) {\n\tlet value = this.getValue();\n\n\tif ( !Array.isArray( value ) ) value = [ value ];\n\n\tconst options = this.node.options;\n\tlet i = options.length;\n\n\tif ( reset ) {\n\t\twhile ( i-- ) options[i].selected = false;\n\t} else {\n\t\twhile ( i-- ) {\n\t\t\tconst option = options[i];\n\t\t\tconst optionValue = option._ractive ?\n\t\t\t\toption._ractive.value :\n\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\n\t\t\toption.selected = arrayContains( value, optionValue );\n\t\t}\n\t}\n}\n\nfunction updateSelectValue ( reset ) {\n\tconst value = this.getValue();\n\n\tif ( !this.locked ) { // TODO is locked still a thing?\n\t\tthis.node._ractive.value = value;\n\n\t\tconst options = this.node.options;\n\t\tlet i = options.length;\n\t\tlet wasSelected = false;\n\n\t\tif ( reset ) {\n\t\t\twhile ( i-- ) options[i].selected = false;\n\t\t} else {\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst option = options[i];\n\t\t\t\tconst optionValue = option._ractive ?\n\t\t\t\t\toption._ractive.value :\n\t\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\t\t\t\tif ( option.disabled && option.selected ) wasSelected = true;\n\n\t\t\t\tif ( optionValue == value ) { // double equals as we may be comparing numbers with strings\n\t\t\t\t\toption.selected = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !wasSelected ) this.node.selectedIndex = -1;\n\t}\n}\n\n\nfunction updateContentEditableValue ( reset ) {\n\tconst value = this.getValue();\n\n\tif ( !this.locked ) {\n\t\tif ( reset ) this.node.innerHTML = '';\n\t\telse this.node.innerHTML = value === undefined ? '' : value;\n\t}\n}\n\nfunction updateRadioValue ( reset ) {\n\tconst node = this.node;\n\tconst wasChecked = node.checked;\n\n\tconst value = this.getValue();\n\n\tif ( reset ) return node.checked = false;\n\n\t//node.value = this.element.getAttribute( 'value' );\n\tnode.value = this.node._ractive.value = value;\n\tnode.checked = this.element.compare( value, this.element.getAttribute( 'name' ) );\n\n\t// This is a special case - if the input was checked, and the value\n\t// changed so that it's no longer checked, the twoway binding is\n\t// most likely out of date. To fix it we have to jump through some\n\t// hoops... this is a little kludgy but it works\n\tif ( wasChecked && !node.checked && this.element.binding && this.element.binding.rendered ) {\n\t\tthis.element.binding.group.model.set( this.element.binding.group.getValue() );\n\t}\n}\n\nfunction updateValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t\tthis.node.value = this.node._ractive.value = null;\n\t\t} else {\n\t\t\tconst value = this.getValue();\n\n\t\t\tthis.node.value = this.node._ractive.value = value;\n\t\t\tthis.node.setAttribute( 'value', safeToStringValue( value ) );\n\t\t}\n\t}\n}\n\nfunction updateStringValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node._ractive.value = '';\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t} else {\n\t\t\tconst value = this.getValue();\n\n\t\t\tthis.node._ractive.value = value;\n\n\t\t\tthis.node.value = safeToStringValue( value );\n\t\t\tthis.node.setAttribute( 'value', safeToStringValue( value ) );\n\t\t}\n\t}\n}\n\nfunction updateRadioName ( reset ) {\n\tif ( reset ) this.node.checked = false;\n\telse this.node.checked = this.element.compare( this.getValue(), this.element.binding.getValue() );\n}\n\nfunction updateCheckboxName ( reset ) {\n\tconst { element, node } = this;\n\tconst binding = element.binding;\n\n\tconst value = this.getValue();\n\tconst valueAttribute = element.getAttribute( 'value' );\n\n\tif ( reset ) {\n\t\t// TODO: WAT?\n\t}\n\n\tif ( !Array.isArray( value ) ) {\n\t\tbinding.isChecked = node.checked = element.compare( value, valueAttribute );\n\t} else {\n\t\tlet i = value.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( element.compare ( valueAttribute, value[i] ) ) {\n\t\t\t\tbinding.isChecked = node.checked = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tbinding.isChecked = node.checked = false;\n\t}\n}\n\nfunction updateStyleAttribute ( reset ) {\n\tconst props = reset ? {} : readStyle( this.getValue() || '' );\n\tconst style = this.node.style;\n\tconst keys = Object.keys( props );\n\tconst prev = this.previous || [];\n\n\tlet i = 0;\n\twhile ( i < keys.length ) {\n\t\tif ( keys[i] in style ) {\n\t\t\tconst safe = props[ keys[i] ].replace( '!important', '' );\n\t\t\tstyle.setProperty( keys[i], safe, safe.length !== props[ keys[i] ].length ? 'important' : '' );\n\t\t}\n\t\ti++;\n\t}\n\n\t// remove now-missing attrs\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~keys.indexOf( prev[i] ) && prev[i] in style ) style.setProperty( prev[i], '', '' );\n\t}\n\n\tthis.previous = keys;\n}\n\nfunction updateInlineStyle ( reset ) {\n\tif ( !this.style ) {\n\t\tthis.style = hyphenateCamel( this.name.substr( 6 ) );\n\t}\n\n\tconst value = reset ? '' : safeToStringValue( this.getValue() );\n\tconst safe = value.replace( '!important', '' );\n\tthis.node.style.setProperty( this.style, safe, safe.length !== value.length ? 'important' : '' );\n}\n\nfunction updateClassName ( reset ) {\n\tconst value = reset ? [] : readClass( safeToStringValue( this.getValue() ) );\n\n\t// watch out for werdo svg elements\n\tlet cls = this.node.className;\n\tcls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n\tconst attr = readClass( cls );\n\tconst prev = this.previous || attr.slice( 0 );\n\n\tconst className = value.concat( attr.filter( c => !~prev.indexOf( c ) ) ).join( ' ' );\n\n\tif ( className !== cls ) {\n\t\tif ( typeof this.node.className !== 'string' ) {\n\t\t\tthis.node.className.baseVal = className;\n\t\t} else {\n\t\t\tthis.node.className = className;\n\t\t}\n\t}\n\n\tthis.previous = value;\n}\n\nfunction updateInlineClass ( reset ) {\n\tconst name = this.name.substr( 6 );\n\n\t// watch out for werdo svg elements\n\tlet cls = this.node.className;\n\tcls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n\tconst attr = readClass( cls );\n\tconst value = reset ? false : this.getValue();\n\n\tif ( !this.inlineClass ) this.inlineClass = name;\n\n\tif ( value && !~attr.indexOf( name ) ) attr.push( name );\n\telse if ( !value && ~attr.indexOf( name ) ) attr.splice( attr.indexOf( name ), 1 );\n\n\tif ( typeof this.node.className !== 'string' ) {\n\t\tthis.node.className.baseVal = attr.join( ' ' );\n\t} else {\n\t\tthis.node.className = attr.join( ' ' );\n\t}\n}\n\nfunction updateBoolean ( reset ) {\n\t// with two-way binding, only update if the change wasn't initiated by the user\n\t// otherwise the cursor will often be sent to the wrong place\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tif ( this.useProperty ) this.node[ this.propertyName ] = false;\n\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t} else {\n\t\t\tif ( this.useProperty ) {\n\t\t\t\tthis.node[ this.propertyName ] = this.getValue();\n\t\t\t} else {\n\t\t\t\tif ( this.getValue() ) {\n\t\t\t\t\tthis.node.setAttribute( this.propertyName, '' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateAttribute ( reset ) {\n\tif ( reset ) this.node.removeAttribute( this.name );\n\telse this.node.setAttribute( this.name, safeToStringValue( this.getString() ) );\n}\n\nfunction updateNamespacedAttribute ( reset ) {\n\tif ( reset ) this.node.removeAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ) );\n\telse this.node.setAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ), safeToStringValue( this.getString() ) );\n}\n","import { doc } from '../../../config/environment';\r\nimport { svg } from '../../../config/namespaces';\r\nimport { createElement } from '../../../utils/dom';\r\nimport { toArray } from '../../../utils/array';\r\nimport Fragment from '../../Fragment';\r\nimport Item from '../shared/Item';\r\nimport noop from '../../../utils/noop';\r\n\r\nconst div = doc ? createElement( 'div' ) : null;\r\n\r\nlet attributes = false;\r\nexport function inAttributes() { return attributes; }\r\nexport function doInAttributes( fn ) {\r\n\tattributes = true;\r\n\tfn();\r\n\tattributes = false;\r\n}\r\n\r\nexport default class ConditionalAttribute extends Item {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.attributes = [];\r\n\r\n\t\tthis.owner = options.owner;\r\n\r\n\t\tthis.fragment = new Fragment({\r\n\t\t\tractive: this.ractive,\r\n\t\t\towner: this,\r\n\t\t\ttemplate: this.template\r\n\t\t});\r\n\t\t// this fragment can't participate in node-y things\r\n\t\tthis.fragment.findNextNode = noop;\r\n\r\n\t\tthis.dirty = false;\r\n\t}\r\n\r\n\tbind () {\r\n\t\tthis.fragment.bind();\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.dirty = true;\r\n\t\t\tthis.owner.bubble();\r\n\t\t}\r\n\t}\r\n\r\n\trender () {\r\n\t\tthis.node = this.owner.node;\r\n\t\tif ( this.node ) {\r\n\t\t\tthis.isSvg = this.node.namespaceURI === svg;\r\n\t\t}\r\n\r\n\t\tattributes = true;\r\n\t\tif ( !this.rendered ) this.fragment.render();\r\n\r\n\t\tthis.rendered = true;\r\n\t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\r\n\t\tthis.update();\r\n\t\tattributes = false;\r\n\t}\r\n\r\n\ttoString () {\r\n\t\treturn this.fragment.toString();\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tthis.fragment.unbind();\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tthis.rendered = false;\r\n\t\tthis.fragment.unrender();\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tlet str;\r\n\t\tlet attrs;\r\n\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\r\n\t\t\tconst current = attributes;\r\n\t\t\tattributes = true;\r\n\t\t\tthis.fragment.update();\r\n\t\t\tattributes = current || false;\r\n\r\n\t\t\tif ( this.rendered && this.node ) {\r\n\t\t\t\tstr = this.fragment.toString();\r\n\t\t\t\tattrs = parseAttributes( str, this.isSvg );\r\n\r\n\t\t\t\t// any attributes that previously existed but no longer do\r\n\t\t\t\t// must be removed\r\n\t\t\t\tthis.attributes.filter( a => notIn( attrs, a ) ).forEach( a => {\r\n\t\t\t\t\tthis.node.removeAttribute( a.name );\r\n\t\t\t\t});\r\n\r\n\t\t\t\tattrs.forEach( a => {\r\n\t\t\t\t\tthis.node.setAttribute( a.name, a.value );\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.attributes = attrs;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nfunction parseAttributes ( str, isSvg ) {\r\n\tconst tagName = isSvg ? 'svg' : 'div';\r\n\treturn str\r\n\t\t? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) &&\r\n\t\t\ttoArray(div.childNodes[0].attributes)\r\n\t\t: [];\r\n}\r\n\r\nfunction notIn ( haystack, needle ) {\r\n\tlet i = haystack.length;\r\n\r\n\twhile ( i-- ) {\r\n\t\tif ( haystack[i].name === needle.name ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n","import { INTERPOLATOR } from '../../../config/types';\r\nimport namespaces from '../../../config/namespaces';\r\nimport Fragment from '../../Fragment';\r\nimport Item from '../shared/Item';\r\nimport findElement from '../shared/findElement';\r\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\r\nimport propertyNames from './attribute/propertyNames';\r\nimport { safeAttributeString } from '../../../utils/dom';\r\nimport { booleanAttributes } from '../../../utils/html';\r\nimport hyphenateCamel from '../../../utils/hyphenateCamel';\r\nimport { inAttributes } from './ConditionalAttribute';\r\n\r\nfunction lookupNamespace ( node, prefix ) {\r\n\tconst qualified = `xmlns:${prefix}`;\r\n\r\n\twhile ( node ) {\r\n\t\tif ( node.hasAttribute && node.hasAttribute( qualified ) ) return node.getAttribute( qualified );\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\r\n\treturn namespaces[ prefix ];\r\n}\r\n\r\nlet attribute = false;\r\nexport function inAttribute () { return attribute; }\r\n\r\nexport default class Attribute extends Item {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.name = options.template.n;\r\n\t\tthis.namespace = null;\r\n\r\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\r\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\r\n\t\tthis.parentFragment = options.parentFragment; // shared\r\n\t\tthis.ractive = this.parentFragment.ractive;\r\n\r\n\t\tthis.rendered = false;\r\n\t\tthis.updateDelegate = null;\r\n\t\tthis.fragment = null;\r\n\r\n\t\tthis.element.attributeByName[ this.name ] = this;\r\n\r\n\t\tif ( !Array.isArray( options.template.f ) ) {\r\n\t\t\tthis.value = options.template.f;\r\n\t\t\tif ( this.value === 0 ) {\r\n\t\t\t\tthis.value = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.fragment = new Fragment({\r\n\t\t\t\towner: this,\r\n\t\t\t\ttemplate: options.template.f\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.interpolator = this.fragment &&\r\n\t\t\tthis.fragment.items.length === 1 &&\r\n\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\r\n\t\t\tthis.fragment.items[0];\r\n\r\n\t\tif ( this.interpolator ) this.interpolator.owner = this;\r\n\t}\r\n\r\n\tbind () {\r\n\t\tif ( this.fragment ) {\r\n\t\t\tthis.fragment.bind();\r\n\t\t}\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.parentFragment.bubble();\r\n\t\t\tthis.element.bubble();\r\n\t\t\tthis.dirty = true;\r\n\t\t}\r\n\t}\r\n\r\n\tgetString () {\r\n\t\tattribute = true;\r\n\t\tconst value = this.fragment ?\r\n\t\t\tthis.fragment.toString() :\r\n\t\t\tthis.value != null ? '' + this.value : '';\r\n\t\tattribute = false;\r\n\t\treturn value;\r\n\t}\r\n\r\n\t// TODO could getValue ever be called for a static attribute,\r\n\t// or can we assume that this.fragment exists?\r\n\tgetValue () {\r\n\t\tattribute = true;\r\n\t\tconst value = this.fragment ? this.fragment.valueOf() : booleanAttributes.test( this.name ) ? true : this.value;\r\n\t\tattribute = false;\r\n\t\treturn value;\r\n\t}\r\n\r\n\trender () {\r\n\t\tconst node = this.element.node;\r\n\t\tthis.node = node;\r\n\r\n\t\t// should we use direct property access, or setAttribute?\r\n\t\tif ( !node.namespaceURI || node.namespaceURI === namespaces.html ) {\r\n\t\t\tthis.propertyName = propertyNames[ this.name ] || this.name;\r\n\r\n\t\t\tif ( node[ this.propertyName ] !== undefined ) {\r\n\t\t\t\tthis.useProperty = true;\r\n\t\t\t}\r\n\r\n\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\r\n\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\r\n\t\t\tif ( booleanAttributes.test( this.name ) || this.isTwoway ) {\r\n\t\t\t\tthis.isBoolean = true;\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.propertyName === 'value' ) {\r\n\t\t\t\tnode._ractive.value = this.value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( node.namespaceURI ) {\r\n\t\t\tconst index = this.name.indexOf( ':' );\r\n\t\t\tif ( index !== -1 ) {\r\n\t\t\t\tthis.namespace = lookupNamespace( node, this.name.slice( 0, index ) );\r\n\t\t\t} else {\r\n\t\t\t\tthis.namespace = node.namespaceURI;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.rendered = true;\r\n\t\tthis.updateDelegate = getUpdateDelegate( this );\r\n\t\tthis.updateDelegate();\r\n\t}\r\n\r\n\ttoString () {\r\n\t\tif ( inAttributes() ) return '';\r\n\t\tattribute = true;\r\n\r\n\t\tconst value = this.getValue();\r\n\r\n\t\t// Special case - select and textarea values (should not be stringified)\r\n\t\tif ( this.name === 'value' && ( this.element.getAttribute( 'contenteditable' ) !== undefined || ( this.element.name === 'select' || this.element.name === 'textarea' ) ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Special case – bound radio `name` attributes\r\n\t\tif ( this.name === 'name' && this.element.name === 'input' && this.interpolator && this.element.getAttribute( 'type' ) === 'radio' ) {\r\n\t\t\treturn `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\r\n\t\t}\r\n\r\n\t\t// Special case - style and class attributes and directives\r\n\t\tif ( this.owner === this.element && ( this.name === 'style' || this.name === 'class' || this.style || this.inlineClass ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( !this.rendered && this.owner === this.element && ( !this.name.indexOf( 'style-' ) || !this.name.indexOf( 'class-' ) ) ) {\r\n\t\t\tif ( !this.name.indexOf( 'style-' ) ) {\r\n\t\t\t\tthis.style = hyphenateCamel( this.name.substr( 6 ) );\r\n\t\t\t} else {\r\n\t\t\t\tthis.inlineClass = this.name.substr( 6 );\r\n\t\t\t}\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( booleanAttributes.test( this.name ) ) return value ? this.name : '';\r\n\t\tif ( value == null ) return '';\r\n\r\n\t\tconst str = safeAttributeString( this.getString() );\r\n\t\tattribute = false;\r\n\r\n\t\treturn str ?\r\n\t\t\t`${this.name}=\"${str}\"` :\r\n\t\t\tthis.name;\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tif ( this.fragment ) this.fragment.unbind();\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tthis.updateDelegate( true );\r\n\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\t\t\tif ( this.fragment ) this.fragment.update();\r\n\t\t\tif ( this.rendered ) this.updateDelegate();\r\n\t\t\tif ( this.isTwoway && !this.locked ) {\r\n\t\t\t\tthis.interpolator.twowayBinding.lastVal( true, this.interpolator.model.get() );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import Item from '../shared/Item';\r\nimport Fragment from '../../Fragment';\r\nimport findElement from '../shared/findElement';\r\nimport { INTERPOLATOR, ELEMENT } from '../../../config/types';\r\n\r\nexport default class BindingFlag extends Item {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\r\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\r\n\t\tthis.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\r\n\r\n\t\tif ( this.element.type === ELEMENT ) {\r\n\t\t\tif ( Array.isArray( options.template.f ) ) {\r\n\t\t\t\tthis.fragment = new Fragment({\r\n\t\t\t\t\towner: this,\r\n\t\t\t\t\ttemplate: options.template.f\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.interpolator = this.fragment &&\r\n\t\t\t\t\t\t\t\tthis.fragment.items.length === 1 &&\r\n\t\t\t\t\t\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\r\n\t\t\t\t\t\t\t\tthis.fragment.items[0];\r\n\t\t}\r\n\t}\r\n\r\n\tbind () {\r\n\t\tif ( this.fragment ) this.fragment.bind();\r\n\t\tset( this, this.getValue(), true );\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.element.bubble();\r\n\t\t\tthis.dirty = true;\r\n\t\t}\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\tif ( this.fragment ) return this.fragment.valueOf();\r\n\t\telse if ( 'value' in this ) return this.value;\r\n\t\telse if ( 'f' in this.template ) return this.template.f;\r\n\t\telse return true;\r\n\t}\r\n\r\n\trender () {\r\n\t\tset( this, this.getValue(), true );\r\n\t}\r\n\r\n\ttoString () { return ''; }\r\n\r\n\tunbind () {\r\n\t\tif ( this.fragment ) this.fragment.unbind();\r\n\r\n\t\tdelete this.element[ this.flag ];\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tif ( this.element.rendered ) this.element.recreateTwowayBinding();\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tif ( this.fragment ) this.fragment.update();\r\n\t\t\tset( this, this.getValue(), true );\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction set ( flag, value, update ) {\r\n\tif ( value === 0 ) {\r\n\t\tflag.value = true;\r\n\t} else if ( value === 'true' ) {\r\n\t\tflag.value = true;\r\n\t} else if ( value === 'false' || value === '0' ) {\r\n\t\tflag.value = false;\r\n\t} else {\r\n\t\tflag.value = value;\r\n\t}\r\n\r\n\tconst current = flag.element[ flag.flag ];\r\n\tflag.element[ flag.flag ] = flag.value;\r\n\tif ( update && !flag.element.attributes.binding && current !== flag.value ) {\r\n\t\tflag.element.recreateTwowayBinding();\r\n\t}\r\n\r\n\treturn flag.value;\r\n}\r\n","import Model from '../Model';\r\nimport { Missing } from '../LinkModel';\r\n\r\nexport default class RactiveModel extends Model {\r\n\tconstructor ( ractive ) {\r\n\t\tsuper( null, '' );\r\n\t\tthis.value = ractive;\r\n\t\tthis.isRoot = true;\r\n\t\tthis.root = this;\r\n\t\tthis.adaptors = [];\r\n\t\tthis.ractive = ractive;\r\n\t}\r\n\r\n\tjoinKey ( key ) {\r\n\t\tconst model = super.joinKey( key );\r\n\r\n\t\tif ( ( key === 'root' || key === 'parent' ) && !model.isLink ) return initLink( model, key );\r\n\t\telse if ( key === 'data' ) return this.ractive.viewmodel;\r\n\r\n\t\treturn model;\r\n\t}\r\n\r\n\tgetKeypath() {\r\n\t\treturn '@this';\r\n\t}\r\n\r\n\tretrieve () {\r\n\t\treturn this.ractive;\r\n\t}\r\n}\r\n\r\nfunction initLink ( model, key ) {\r\n\tmodel.applyValue = function ( value ) {\r\n\t\tthis.parent.value[ key ] = value;\r\n\t\tif ( value && value.viewmodel ) {\r\n\t\t\tthis.link( value.viewmodel.getRactiveModel(), key );\r\n\t\t\tthis._link.markedAll();\r\n\t\t} else {\r\n\t\t\tthis.link( Object.create( Missing ), key );\r\n\t\t\tthis._link.markedAll();\r\n\t\t}\r\n\t};\r\n\r\n\tmodel.applyValue( model.parent.ractive[ key ], key );\r\n\tmodel._link.set = v => model.applyValue( v );\r\n\tmodel._link.applyValue = v => model.applyValue( v );\r\n\treturn model._link;\r\n}\r\n","import { capture } from '../global/capture';\nimport Computation from './Computation';\nimport Model from './Model';\nimport { handleChange, mark } from '../shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel } from './specials/SharedModel';\nimport { splitKeypath, escapeKey, unescapeKey } from '../shared/keypaths';\nimport resolveReference from '../view/resolvers/resolveReference';\nimport noop from '../utils/noop';\n\nconst hasProp = Object.prototype.hasOwnProperty;\n\nexport default class RootModel extends Model {\n\tconstructor ( options ) {\n\t\tsuper( null, null );\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.ractive = options.ractive; // TODO sever this link\n\n\t\tthis.value = options.data;\n\t\tthis.adaptors = options.adapt;\n\t\tthis.adapt();\n\n\t\tthis.computationContext = options.ractive;\n\t\tthis.computations = {};\n\t}\n\n\tattached ( fragment ) {\n\t\tattachImplicits( this, fragment );\n\t}\n\n\tcompute ( key, signature ) {\n\t\tconst computation = new Computation( this, signature, key );\n\t\tthis.computations[ escapeKey( key ) ] = computation;\n\n\t\treturn computation;\n\t}\n\n\tcreateLink ( keypath, target, targetPath, options ) {\n\t\tconst keys = splitKeypath( keypath );\n\n\t\tlet model = this;\n\t\twhile ( keys.length ) {\n\t\t\tconst key = keys.shift();\n\t\t\tmodel = this.childByKey[ key ] || this.joinKey( key );\n\t\t}\n\n\t\treturn model.link( target, targetPath, options );\n\t}\n\n\tdetached () {\n\t\tdetachImplicits( this );\n\t}\n\n\tget ( shouldCapture, options ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( !options || options.virtual !== false ) {\n\t\t\tconst result = this.getVirtual();\n\t\t\tconst keys = Object.keys( this.computations );\n\t\t\tlet i = keys.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tresult[ keys[i] ] = this.computations[ keys[i] ].get();\n\t\t\t}\n\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn this.value;\n\t\t}\n\t}\n\n\tgetKeypath () {\n\t\treturn '';\n\t}\n\n\tgetRactiveModel() {\n\t\treturn this.ractiveModel || ( this.ractiveModel = new RactiveModel( this.ractive ) );\n\t}\n\n\tgetValueChildren () {\n\t\tconst children = super.getValueChildren( this.value );\n\n\t\tthis.children.forEach( child => {\n\t\t\tif ( child._link ) {\n\t\t\t\tconst idx = children.indexOf( child );\n\t\t\t\tif ( ~idx ) children.splice( idx, 1, child._link );\n\t\t\t\telse children.push( child._link );\n\t\t\t}\n\t\t});\n\n\t\tfor ( const k in this.computations ) {\n\t\t\tchildren.push( this.computations[k] );\n\t\t}\n\n\t\treturn children;\n\t}\n\n\thas ( key ) {\n\t\tconst value = this.value;\n\t\tlet unescapedKey = unescapeKey( key );\n\n\t\tif ( unescapedKey === '@this' || unescapedKey === '@global' || unescapedKey === '@shared' ) return true;\n\t\tif ( unescapedKey[0] === '~' && unescapedKey[1] === '/' ) unescapedKey = unescapedKey.slice( 2 );\n\t\tif ( hasProp.call( value, unescapedKey ) ) return true;\n\n\t\t// mappings/links and computations\n\t\tif ( key in this.computations || this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link ) return true;\n\n\t\t// We climb up the constructor chain to find if one of them contains the unescapedKey\n\t\tlet constructor = value.constructor;\n\t\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\t\tif ( hasProp.call( constructor.prototype, unescapedKey ) ) return true;\n\t\t\tconstructor = constructor.constructor;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tjoinKey ( key, opts ) {\n\t\tif ( key[0] === '@' ) {\n\t\t\tif ( key === '@this' || key === '@' ) return this.getRactiveModel();\n\t\t\tif ( key === '@global' ) return GlobalModel;\n\t\t\tif ( key === '@shared' ) return SharedModel;\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key[0] === '~' && key[1] === '/' ) key = key.slice( 2 );\n\n\t\treturn this.computations.hasOwnProperty( key ) ? this.computations[ key ] :\n\t\t       super.joinKey( key, opts );\n\t}\n\n\tset ( value ) {\n\t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n\t\tconst wrapper = this.wrapper;\n\t\tif ( wrapper ) {\n\t\t\tconst shouldTeardown = !wrapper.reset || wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\twrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.deps.forEach( handleChange );\n\t\tthis.children.forEach( mark );\n\t}\n\n\tretrieve () {\n\t\treturn this.wrapper ? this.wrapper.get() : this.value;\n\t}\n\n\tteardown () {\n\t\tsuper.teardown();\n\t\tfor ( const k in this.computations ) {\n\t\t\tthis.computations[ k ].teardown();\n\t\t}\n\t}\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits ( model, fragment ) {\n\tif ( model._link && model._link.implicit && model._link.isDetached() ) {\n\t\tmodel.attach( fragment );\n\t}\n\n\t// look for virtual children to relink and cascade\n\tfor ( const k in model.childByKey ) {\n\t\tif ( k in model.value ) {\n\t\t\tattachImplicits( model.childByKey[k], fragment );\n\t\t} else if ( !model.childByKey[k]._link || model.childByKey[k]._link.isDetached() ) {\n\t\t\tconst mdl = resolveReference( fragment, k );\n\t\t\tif ( mdl ) {\n\t\t\t\tmodel.childByKey[k].link( mdl, k, { implicit: true } );\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction detachImplicits ( model ) {\n\tif ( model._link && model._link.implicit ) {\n\t\tmodel.unlink();\n\t}\n\n\tfor ( const k in model.childByKey ) {\n\t\tdetachImplicits( model.childByKey[k] );\n\t}\n}\n","import { fatal } from '../../utils/log';\r\nimport bind from '../../utils/bind';\r\nimport { createFunctionFromString } from '../config/runtime-parser';\r\n\r\nexport default function getComputationSignature ( ractive, key, signature ) {\r\n\tlet getter;\r\n\tlet setter;\r\n\r\n\t// useful for debugging\r\n\tlet getterString;\r\n\tlet getterUseStack;\r\n\tlet setterString;\r\n\r\n\tif ( typeof signature === 'function' ) {\r\n\t\tgetter = bind( signature, ractive );\r\n\t\tgetterString = signature.toString();\r\n\t\tgetterUseStack = true;\r\n\t}\r\n\r\n\tif ( typeof signature === 'string' ) {\r\n\t\tgetter = createFunctionFromString( signature, ractive );\r\n\t\tgetterString = signature;\r\n\t}\r\n\r\n\tif ( typeof signature === 'object' ) {\r\n\t\tif ( typeof signature.get === 'string' ) {\r\n\t\t\tgetter = createFunctionFromString( signature.get, ractive );\r\n\t\t\tgetterString = signature.get;\r\n\t\t} else if ( typeof signature.get === 'function' ) {\r\n\t\t\tgetter = bind( signature.get, ractive );\r\n\t\t\tgetterString = signature.get.toString();\r\n\t\t\tgetterUseStack = true;\r\n\t\t} else {\r\n\t\t\tfatal( '`%s` computation must have a `get()` method', key );\r\n\t\t}\r\n\r\n\t\tif ( typeof signature.set === 'function' ) {\r\n\t\t\tsetter = bind( signature.set, ractive );\r\n\t\t\tsetterString = signature.set.toString();\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetter,\r\n\t\tsetter,\r\n\t\tgetterString,\r\n\t\tsetterString,\r\n\t\tgetterUseStack\r\n\t};\r\n}\r\n","import { fatal, warnIfDebug, welcome } from '../utils/log';\r\nimport { missingPlugin } from '../config/errors';\r\nimport { ensureArray, combine } from '../utils/array';\r\nimport { findInViewHierarchy } from '../shared/registry';\r\nimport dataConfigurator from './config/custom/data';\r\nimport RootModel from '../model/RootModel';\r\nimport Hook from '../events/Hook';\r\nimport getComputationSignature from './helpers/getComputationSignature';\r\nimport Ractive from '../Ractive';\r\nimport { ATTRIBUTE, INTERPOLATOR } from '../config/types';\r\n\r\nconst constructHook = new Hook( 'construct' );\r\n\r\nconst registryNames = [\r\n\t'adaptors',\r\n\t'components',\r\n\t'decorators',\r\n\t'easing',\r\n\t'events',\r\n\t'interpolators',\r\n\t'partials',\r\n\t'transitions'\r\n];\r\n\r\nlet uid = 0;\r\n\r\nexport default function construct ( ractive, options ) {\r\n\tif ( Ractive.DEBUG ) welcome();\r\n\r\n\tinitialiseProperties( ractive );\r\n\thandleAttributes( ractive );\r\n\r\n\t// if there's not a delegation setting, inherit from parent if it's not default\r\n\tif ( !options.hasOwnProperty( 'delegate' ) && ractive.parent && ractive.parent.delegate !== ractive.delegate ) {\r\n\t\tractive.delegate = false;\r\n\t}\r\n\r\n\t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\r\n\tconstructHook.fire( ractive, options );\r\n\r\n\t// Add registries\r\n\tlet i = registryNames.length;\r\n\twhile ( i-- ) {\r\n\t\tconst name = registryNames[ i ];\r\n\t\tractive[ name ] = Object.assign( Object.create( ractive.constructor[ name ] || null ), options[ name ] );\r\n\t}\r\n\r\n\tif ( ractive._attributePartial ) {\r\n\t\tractive.partials['extra-attributes'] = ractive._attributePartial;\r\n\t\tdelete ractive._attributePartial;\r\n\t}\r\n\r\n\t// Create a viewmodel\r\n\tconst viewmodel = new RootModel({\r\n\t\tadapt: getAdaptors( ractive, ractive.adapt, options ),\r\n\t\tdata: dataConfigurator.init( ractive.constructor, ractive, options ),\r\n\t\tractive\r\n\t});\r\n\r\n\tractive.viewmodel = viewmodel;\r\n\r\n\t// Add computed properties\r\n\tconst computed = Object.assign( Object.create( ractive.constructor.prototype.computed ), options.computed );\r\n\r\n\tfor ( const key in computed ) {\r\n\t\tif ( key === '__proto__' ) continue;\r\n\t\tconst signature = getComputationSignature( ractive, key, computed[ key ] );\r\n\t\tviewmodel.compute( key, signature );\r\n\t}\r\n}\r\n\r\nfunction getAdaptors ( ractive, protoAdapt, options ) {\r\n\tprotoAdapt = protoAdapt.map( lookup );\r\n\tconst adapt = ensureArray( options.adapt ).map( lookup );\r\n\r\n\tconst srcs = [ protoAdapt, adapt ];\r\n\tif ( ractive.parent && !ractive.isolated ) {\r\n\t\tsrcs.push( ractive.parent.viewmodel.adaptors );\r\n\t}\r\n\r\n\treturn combine.apply( null, srcs );\r\n\r\n\tfunction lookup ( adaptor ) {\r\n\t\tif ( typeof adaptor === 'string' ) {\r\n\t\t\tadaptor = findInViewHierarchy( 'adaptors', ractive, adaptor );\r\n\r\n\t\t\tif ( !adaptor ) {\r\n\t\t\t\tfatal( missingPlugin( adaptor, 'adaptor' ) );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn adaptor;\r\n\t}\r\n}\r\n\r\nfunction initialiseProperties ( ractive ) {\r\n\t// Generate a unique identifier, for places where you'd use a weak map if it\r\n\t// existed\r\n\tractive._guid = 'r-' + uid++;\r\n\r\n\t// events\r\n\tractive._subs = Object.create( null );\r\n\tractive._nsSubs = 0;\r\n\r\n\t// storage for item configuration from instantiation to reset,\r\n\t// like dynamic functions or original values\r\n\tractive._config = {};\r\n\r\n\t// events\r\n\tractive.event = null;\r\n\tractive._eventQueue = [];\r\n\r\n\t// observers\r\n\tractive._observers = [];\r\n\r\n\t// external children\r\n\tractive._children = [];\r\n\tractive._children.byName = {};\r\n\tractive.children = ractive._children;\r\n\r\n\tif ( !ractive.component ) {\r\n\t\tractive.root = ractive;\r\n\t\tractive.parent = ractive.container = null; // TODO container still applicable?\r\n\t}\r\n}\r\n\r\nfunction handleAttributes ( ractive ) {\r\n\tconst component = ractive.component;\r\n\tconst attributes = ractive.constructor.attributes;\r\n\r\n\tif ( attributes && component ) {\r\n\t\tconst tpl = component.template;\r\n\t\tconst attrs = tpl.m ? tpl.m.slice() : [];\r\n\r\n\t\t// grab all of the passed attribute names\r\n\t\tconst props = attrs.filter( a => a.t === ATTRIBUTE ).map( a => a.n );\r\n\r\n\t\t// warn about missing requireds\r\n\t\tattributes.required.forEach( p => {\r\n\t\t\tif ( !~props.indexOf( p ) ) {\r\n\t\t\t\twarnIfDebug( `Component '${component.name}' requires attribute '${p}' to be provided` );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// set up a partial containing non-property attributes\r\n\t\tconst all = attributes.optional.concat( attributes.required );\r\n\t\tconst partial = [];\r\n\t\tlet i = attrs.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst a = attrs[i];\r\n\t\t\tif ( a.t === ATTRIBUTE && !~all.indexOf( a.n ) ) {\r\n\t\t\t\tif ( attributes.mapAll ) {\r\n\t\t\t\t\t// map the attribute if requested and make the extra attribute in the partial refer to the mapping\r\n\t\t\t\t\tpartial.unshift({ t: ATTRIBUTE, n: a.n, f: [{ t: INTERPOLATOR, r: `~/${a.n}` }] });\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// transfer the attribute to the extra attributes partal\r\n\t\t\t\t\tpartial.unshift( attrs.splice( i, 1 )[0] );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( partial.length ) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\r\n\t\tractive._attributePartial = partial;\r\n\t}\r\n}\r\n","import Hook from '../../events/Hook';\nimport { removeFromArray } from '../../utils/array';\nimport { cancel } from '../../shared/methodCallers';\nimport { warnIfDebug } from '../../utils/log';\n\nconst teardownHook = new Hook( 'teardown' );\nconst destructHook = new Hook( 'destruct' );\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown () {\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.teardown() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise.resolve();\n\t}\n\n\tthis.shouldDestroy = true;\n\treturn teardown( this, () => this.fragment.rendered ? this.unrender() : Promise.resolve() );\n}\n\nexport function teardown ( instance, getPromise ) {\n\tinstance.torndown = true;\n\tinstance.viewmodel.teardown();\n\tinstance.fragment.unbind();\n\tinstance._observers.slice().forEach( cancel );\n\n\tif ( instance.el && instance.el.__ractive_instances__ ) {\n\t\tremoveFromArray( instance.el.__ractive_instances__, instance );\n\t}\n\n\tconst promise = getPromise();\n\n\tteardownHook.fire( instance );\n\tpromise.then( () => destructHook.fire( instance ) );\n\n\treturn promise;\n}\n","import runloop from '../../global/runloop';\r\nimport { warnIfDebug } from '../../utils/log';\r\nimport { ANCHOR, ATTRIBUTE, BINDING_FLAG, COMPONENT, DECORATOR, EVENT, TRANSITION, YIELDER } from '../../config/types';\r\nimport Item from './shared/Item';\r\nimport ConditionalAttribute from './element/ConditionalAttribute';\r\nimport construct from '../../Ractive/construct';\r\nimport initialise from '../../Ractive/initialise';\r\nimport render from '../../Ractive/render';\r\nimport { createDocumentFragment } from '../../utils/dom';\r\nimport createItem from './createItem';\r\nimport { bind, render as callRender, unbind, unrender, update } from '../../shared/methodCallers';\r\nimport { updateAnchors } from '../../shared/anchors';\r\nimport { teardown } from '../../Ractive/prototype/teardown';\r\nimport getRactiveContext from '../../shared/getRactiveContext';\r\n\r\nexport default class Component extends Item {\r\n\tconstructor ( options, ComponentConstructor ) {\r\n\t\tsuper( options );\r\n\t\tthis.isAnchor = this.template.t === ANCHOR;\r\n\t\tthis.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\r\n\r\n\t\tconst partials = options.template.p || {};\r\n\t\tif ( !( 'content' in partials ) ) partials.content = options.template.f || [];\r\n\t\tthis._partials = partials; // TEMP\r\n\r\n\t\tif ( this.isAnchor ) {\r\n\t\t\tthis.name = options.template.n;\r\n\r\n\t\t\tthis.addChild = addChild;\r\n\t\t\tthis.removeChild = removeChild;\r\n\t\t} else {\r\n\t\t\tconst instance = Object.create( ComponentConstructor.prototype );\r\n\r\n\t\t\tthis.instance = instance;\r\n\t\t\tthis.name = options.template.e;\r\n\r\n\t\t\tif ( instance.el ) {\r\n\t\t\t\twarnIfDebug( `The <${this.name}> component has a default 'el' property; it has been disregarded` );\r\n\t\t\t}\r\n\r\n\t\t\t// find container\r\n\t\t\tlet fragment = options.parentFragment;\r\n\t\t\tlet container;\r\n\t\t\twhile ( fragment ) {\r\n\t\t\t\tif ( fragment.owner.type === YIELDER ) {\r\n\t\t\t\t\tcontainer = fragment.owner.container;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfragment = fragment.parent;\r\n\t\t\t}\r\n\r\n\t\t\t// add component-instance-specific properties\r\n\t\t\tinstance.parent = this.parentFragment.ractive;\r\n\t\t\tinstance.container = container || null;\r\n\t\t\tinstance.root = instance.parent.root;\r\n\t\t\tinstance.component = this;\r\n\r\n\t\t\tconstruct( this.instance, { partials });\r\n\r\n\t\t\t// for hackability, this could be an open option\r\n\t\t\t// for any ractive instance, but for now, just\r\n\t\t\t// for components and just for ractive...\r\n\t\t\tinstance._inlinePartials = partials;\r\n\t\t}\r\n\r\n\t\tthis.attributeByName = {};\r\n\r\n\t\tthis.events = [];\r\n\t\tthis.attributes = [];\r\n\t\tconst leftovers = [];\r\n\t\t( this.template.m || [] ).forEach( template => {\r\n\t\t\tswitch ( template.t ) {\r\n\t\t\t\tcase ATTRIBUTE:\r\n\t\t\t\tcase EVENT:\r\n\t\t\t\t\tthis.attributes.push( createItem({\r\n\t\t\t\t\t\towner: this,\r\n\t\t\t\t\t\tparentFragment: this.parentFragment,\r\n\t\t\t\t\t\ttemplate\r\n\t\t\t\t\t}) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TRANSITION:\r\n\t\t\t\tcase BINDING_FLAG:\r\n\t\t\t\tcase DECORATOR:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tleftovers.push( template );\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif ( leftovers.length ) {\r\n\t\t\tthis.attributes.push( new ConditionalAttribute({\r\n\t\t\t\towner: this,\r\n\t\t\t\tparentFragment: this.parentFragment,\r\n\t\t\t\ttemplate: leftovers\r\n\t\t\t}) );\r\n\t\t}\r\n\r\n\t\tthis.eventHandlers = [];\r\n\t}\r\n\r\n\tbind () {\r\n\t\tif ( !this.isAnchor ) {\r\n\t\t\tthis.attributes.forEach( bind );\r\n\r\n\t\t\tinitialise( this.instance, {\r\n\t\t\t\tpartials: this._partials\r\n\t\t\t}, {\r\n\t\t\t\tcssIds: this.parentFragment.cssIds\r\n\t\t\t});\r\n\r\n\t\t\tthis.eventHandlers.forEach( bind );\r\n\r\n\t\t\tthis.bound = true;\r\n\t\t}\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.dirty = true;\r\n\t\t\tthis.parentFragment.bubble();\r\n\t\t}\r\n\t}\r\n\r\n\tdestroyed () {\r\n\t\tif ( !this.isAnchor && this.instance.fragment ) this.instance.fragment.destroyed();\r\n\t}\r\n\r\n\tdetach () {\r\n\t\tif ( this.isAnchor ) {\r\n\t\t\tif ( this.instance ) return this.instance.fragment.detach();\r\n\t\t\treturn createDocumentFragment();\r\n\t\t}\r\n\r\n\t\treturn this.instance.fragment.detach();\r\n\t}\r\n\r\n\tfind ( selector, options ) {\r\n\t\tif ( this.instance ) return this.instance.fragment.find( selector, options );\r\n\t}\r\n\r\n\tfindAll ( selector, options ) {\r\n\t\tif ( this.instance ) this.instance.fragment.findAll( selector, options );\r\n\t}\r\n\r\n\tfindComponent ( name, options ) {\r\n\t\tif ( !name || this.name === name ) return this.instance;\r\n\r\n\t\tif ( this.instance.fragment ) {\r\n\t\t\treturn this.instance.fragment.findComponent( name, options );\r\n\t\t}\r\n\t}\r\n\r\n\tfindAllComponents ( name, options ) {\r\n\t\tconst { result } = options;\r\n\r\n\t\tif ( this.instance && ( !name || this.name === name ) ) {\r\n\t\t\tresult.push( this.instance );\r\n\t\t}\r\n\r\n\t\tif ( this.instance ) this.instance.findAllComponents( name, options );\r\n\t}\r\n\r\n\tfirstNode ( skipParent ) {\r\n\t\tif ( this.instance ) return this.instance.fragment.firstNode( skipParent );\r\n\t}\r\n\r\n\tgetContext ( ...assigns ) {\r\n\t\tassigns.unshift( this );\r\n\t\treturn getRactiveContext.apply( null, assigns );\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tif ( this.isAnchor ) {\r\n\t\t\tthis.rendered = true;\r\n\t\t\tthis.target = target;\r\n\r\n\t\t\tif ( !checking.length ) {\r\n\t\t\t\tchecking.push( this.ractive );\r\n\t\t\t\tif ( occupants ) {\r\n\t\t\t\t\tthis.occupants = occupants;\r\n\t\t\t\t\tcheckAnchors();\r\n\t\t\t\t\tthis.occupants = null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\trunloop.scheduleTask( checkAnchors, true );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\trender( this.instance, target, null, occupants );\r\n\r\n\t\t\tthis.attributes.forEach( callRender );\r\n\t\t\tthis.eventHandlers.forEach( callRender );\r\n\r\n\t\t\tthis.rendered = true;\r\n\t\t}\r\n\t}\r\n\r\n\ttoString () {\r\n\t\tif ( this.instance ) return this.instance.toHTML();\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tif ( !this.isAnchor ) {\r\n\t\t\tthis.bound = false;\r\n\r\n\t\t\tthis.attributes.forEach( unbind );\r\n\r\n\t\t\tteardown( this.instance, () => runloop.promise() );\r\n\t\t}\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tthis.shouldDestroy = shouldDestroy;\r\n\r\n\t\tif ( this.isAnchor ) {\r\n\t\t\tif ( this.item ) unrenderItem( this, this.item );\r\n\t\t\tthis.target = null;\r\n\t\t\tif ( !checking.length ) {\r\n\t\t\t\tchecking.push( this.ractive );\r\n\t\t\t\trunloop.scheduleTask( checkAnchors, true );\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.instance.unrender();\r\n\t\t\tthis.instance.el = this.instance.target = null;\r\n\t\t\tthis.attributes.forEach( unrender );\r\n\t\t\tthis.eventHandlers.forEach( unrender );\r\n\t\t}\r\n\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tthis.dirty = false;\r\n\t\tif ( this.instance ) {\r\n\t\t\tthis.instance.fragment.update();\r\n\t\t\tthis.attributes.forEach( update );\r\n\t\t\tthis.eventHandlers.forEach( update );\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction addChild ( meta ) {\r\n\tif ( this.item ) this.removeChild( this.item );\r\n\r\n\tconst child = meta.instance;\r\n\tmeta.anchor = this;\r\n\r\n\tmeta.parentFragment = this.parentFragment;\r\n\tmeta.name = meta.nameOption || this.name;\r\n\tthis.name = meta.name;\r\n\r\n\r\n\tif ( !child.isolated ) child.viewmodel.attached( this.parentFragment );\r\n\r\n\t// render as necessary\r\n\tif ( this.rendered ) {\r\n\t\trenderItem( this, meta );\r\n\t}\r\n}\r\n\r\nfunction removeChild ( meta ) {\r\n\t// unrender as necessary\r\n\tif ( this.item === meta ) {\r\n\t\tunrenderItem( this, meta );\r\n\t\tthis.name = this.template.n;\r\n\t}\r\n}\r\n\r\nfunction renderItem ( anchor, meta ) {\r\n\tif ( !anchor.rendered ) return;\r\n\r\n\tmeta.shouldDestroy = false;\r\n\tmeta.parentFragment = anchor.parentFragment;\r\n\r\n\tanchor.item = meta;\r\n\tanchor.instance = meta.instance;\r\n\tconst nextNode = anchor.parentFragment.findNextNode( anchor );\r\n\r\n\tif ( meta.instance.fragment.rendered ) {\r\n\t\tmeta.instance.unrender();\r\n\t}\r\n\r\n\tmeta.partials = meta.instance.partials;\r\n\tmeta.instance.partials = Object.assign( {}, meta.partials, anchor._partials );\r\n\r\n\tmeta.instance.fragment.unbind();\r\n\tmeta.instance.fragment.bind( meta.instance.viewmodel );\r\n\r\n\tanchor.attributes.forEach( bind );\r\n\tanchor.eventHandlers.forEach( bind );\r\n\tanchor.attributes.forEach( callRender );\r\n\tanchor.eventHandlers.forEach( callRender );\r\n\r\n\tconst target = anchor.parentFragment.findParentNode();\r\n\trender( meta.instance, target, target.contains( nextNode ) ? nextNode : null, anchor.occupants );\r\n\r\n\tif ( meta.lastBound !== anchor ) {\r\n\t\tmeta.lastBound = anchor;\r\n\t}\r\n}\r\n\r\nfunction unrenderItem ( anchor, meta ) {\r\n\tif ( !anchor.rendered ) return;\r\n\r\n\tmeta.shouldDestroy = true;\r\n\tmeta.instance.unrender();\r\n\r\n\tanchor.eventHandlers.forEach( unrender );\r\n\tanchor.attributes.forEach( unrender );\r\n\tanchor.eventHandlers.forEach( unbind );\r\n\tanchor.attributes.forEach( unbind );\r\n\r\n\tmeta.instance.el = meta.instance.anchor = null;\r\n\tmeta.parentFragment = null;\r\n\tmeta.anchor = null;\r\n\tanchor.item = null;\r\n\tanchor.instance = null;\r\n}\r\n\r\nlet checking = [];\r\nexport function checkAnchors () {\r\n\tconst list = checking;\r\n\tchecking = [];\r\n\r\n\tlist.forEach( updateAnchors );\r\n}\r\n","import getFunction from '../../../shared/getFunction';\r\nimport resolveReference from '../../resolvers/resolveReference';\r\n\r\nexport function setupArgsFn ( item, template, fragment, opts = {} ) {\r\n\tif ( template && template.f && template.f.s ) {\r\n\t\titem.fn = getFunction( template.f.s, template.f.r.length );\r\n\t\tif ( opts.register === true ) {\r\n\t\t\titem.models = resolveArgs( item, template, fragment, opts );\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function resolveArgs ( item, template, fragment, opts = {} ) {\r\n\treturn template.f.r.map( ( ref, i ) => {\r\n\t\tlet model;\r\n\r\n\t\tif ( opts.specialRef && ( model = opts.specialRef( ref, i ) ) ) return model;\r\n\r\n\t\tmodel = resolveReference( fragment, ref );\r\n\t\tif ( opts.register === true ) {\r\n\t\t\tmodel.register( item );\r\n\t\t}\r\n\r\n\t\treturn model;\r\n\t});\r\n}\r\n\r\nexport function teardownArgsFn ( item, template ) {\r\n\tif ( template && template.f && template.f.s ) {\r\n\t\tif ( item.models ) item.models.forEach( m => {\r\n\t\t\tif ( m && m.unregister ) m.unregister( item );\r\n\t\t});\r\n\t\titem.models = null;\r\n\t}\r\n}\r\n","// This is the handler for DOM events that would lead to a change in the model\r\n// (i.e. change, sometimes, input, and occasionally click and keyup)\r\nexport default function handleDomEvent () {\r\n\tthis._ractive.binding.handleChange();\r\n}\r\n","import { removeFromArray } from '../../../../utils/array';\r\nimport Binding from './Binding';\r\n\r\nexport default function getBindingGroup ( group, model, getValue ) {\r\n\tconst hash = `${group}-bindingGroup`;\r\n\treturn model[hash] || ( model[ hash ] = new BindingGroup( hash, model, getValue ) );\r\n}\r\n\r\nclass BindingGroup {\r\n\tconstructor ( hash, model, getValue ) {\r\n\t\tthis.model = model;\r\n\t\tthis.hash = hash;\r\n\t\tthis.getValue = () => {\r\n\t\t\tthis.value = getValue.call(this);\r\n\t\t\treturn this.value;\r\n\t\t};\r\n\r\n\t\tthis.bindings = [];\r\n\t}\r\n\r\n\tadd ( binding ) {\r\n\t\tthis.bindings.push( binding );\r\n\t}\r\n\r\n\tbind () {\r\n\t\tthis.value = this.model.get();\r\n\t\tthis.model.registerTwowayBinding( this );\r\n\t\tthis.bound = true;\r\n\t}\r\n\r\n\tremove ( binding ) {\r\n\t\tremoveFromArray( this.bindings, binding );\r\n\t\tif ( !this.bindings.length ) {\r\n\t\t\tthis.unbind();\r\n\t\t}\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tthis.model.unregisterTwowayBinding( this );\r\n\t\tthis.bound = false;\r\n\t\tdelete this.model[this.hash];\r\n\t}\r\n}\r\n\r\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\r\n","import Binding from './Binding';\r\nimport getBindingGroup from './getBindingGroup';\r\nimport handleDomEvent from './handleDomEvent';\r\n\r\nconst push = [].push;\r\n\r\nfunction getValue() {\r\n\tconst all = this.bindings.filter(b => b.node && b.node.checked).map(b => b.element.getAttribute( 'value' ));\r\n\tconst res = [];\r\n\tall.forEach(v => { if ( !this.bindings[0].arrayContains( res, v ) ) res.push( v ); });\r\n\treturn res;\r\n}\r\n\r\nexport default class CheckboxNameBinding extends Binding {\r\n\tconstructor ( element ) {\r\n\t\tsuper( element, 'name' );\r\n\r\n\t\tthis.checkboxName = true; // so that ractive.updateModel() knows what to do with this\r\n\r\n\t\t// Each input has a reference to an array containing it and its\r\n\t\t// group, as two-way binding depends on being able to ascertain\r\n\t\t// the status of all inputs within the group\r\n\t\tthis.group = getBindingGroup( 'checkboxes', this.model, getValue );\r\n\t\tthis.group.add( this );\r\n\r\n\t\tif ( this.noInitialValue ) {\r\n\t\t\tthis.group.noInitialValue = true;\r\n\t\t}\r\n\r\n\t\t// If no initial value was set, and this input is checked, we\r\n\t\t// update the model\r\n\t\tif ( this.group.noInitialValue && this.element.getAttribute( 'checked' ) ) {\r\n\t\t\tconst existingValue = this.model.get();\r\n\t\t\tconst bindingValue = this.element.getAttribute( 'value' );\r\n\r\n\t\t\tif ( !this.arrayContains( existingValue, bindingValue ) ) {\r\n\t\t\t\tpush.call( existingValue, bindingValue ); // to avoid triggering runloop with array adaptor\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tbind () {\r\n\t\tif ( !this.group.bound ) {\r\n\t\t\tthis.group.bind();\r\n\t\t}\r\n\t}\r\n\r\n\tgetInitialValue () {\r\n\t\t// This only gets called once per group (of inputs that\r\n\t\t// share a name), because it only gets called if there\r\n\t\t// isn't an initial value. By the same token, we can make\r\n\t\t// a note of that fact that there was no initial value,\r\n\t\t// and populate it using any `checked` attributes that\r\n\t\t// exist (which users should avoid, but which we should\r\n\t\t// support anyway to avoid breaking expectations)\r\n\t\tthis.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\r\n\t\treturn [];\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\treturn this.group.value;\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tthis.isChecked = this.element.node.checked;\r\n\t\tthis.group.value = this.model.get();\r\n\t\tconst value = this.element.getAttribute( 'value' );\r\n\t\tif ( this.isChecked && !this.arrayContains( this.group.value, value ) ) {\r\n\t\t\tthis.group.value.push( value );\r\n\t\t} else if ( !this.isChecked && this.arrayContains( this.group.value, value ) ) {\r\n\t\t\tthis.removeFromArray( this.group.value, value );\r\n\t\t}\r\n\t\t// make sure super knows there's a change\r\n\t\tthis.lastValue = null;\r\n\t\tsuper.handleChange();\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\r\n\t\tconst node = this.node;\r\n\r\n\t\tconst existingValue = this.model.get();\r\n\t\tconst bindingValue = this.element.getAttribute( 'value' );\r\n\r\n\t\tif ( Array.isArray( existingValue ) ) {\r\n\t\t\tthis.isChecked = this.arrayContains( existingValue, bindingValue );\r\n\t\t} else {\r\n\t\t\tthis.isChecked = this.element.compare( existingValue, bindingValue );\r\n\t\t}\r\n\t\tnode.name = '{{' + this.model.getKeypath() + '}}';\r\n\t\tnode.checked = this.isChecked;\r\n\r\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\r\n\r\n\t\t// in case of IE emergency, bind to click event as well\r\n\t\tif ( node.attachEvent ) {\r\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\r\n\t\t}\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tthis.group.bindings.forEach( binding => binding.wasUndefined = true );\r\n\r\n\t\tif ( node.checked ) {\r\n\t\t\tconst valueSoFar = this.group.getValue();\r\n\t\t\tvalueSoFar.push( this.element.getAttribute( 'value' ) );\r\n\r\n\t\t\tthis.group.model.set( valueSoFar );\r\n\t\t}\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tthis.group.remove( this );\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tconst node = this.element.node;\r\n\r\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\r\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\r\n\t}\r\n\r\n\tarrayContains ( selectValue, optionValue ) {\r\n\t\tlet i = selectValue.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tif ( this.element.compare( optionValue, selectValue[i] ) ) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tremoveFromArray ( array, item ) {\r\n\t\tif (!array) return;\r\n\t\tlet i = array.length;\r\n\t\twhile( i-- ) {\r\n\t\t\tif ( this.element.compare( item, array[i] ) ) {\r\n\t\t\t\tarray.splice( i, 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import Binding from './Binding';\r\nimport { isNumeric } from '../../../../utils/is';\r\nimport handleDomEvent from './handleDomEvent';\r\n\r\nfunction handleBlur () {\r\n\thandleDomEvent.call( this );\r\n\r\n\tconst value = this._ractive.binding.model.get();\r\n\tthis.value = value == undefined ? '' : value;\r\n}\r\n\r\nfunction handleDelay ( delay ) {\r\n\tlet timeout;\r\n\r\n\treturn function () {\r\n\t\tif ( timeout ) clearTimeout( timeout );\r\n\r\n\t\ttimeout = setTimeout( () => {\r\n\t\t\tconst binding = this._ractive.binding;\r\n\t\t\tif ( binding.rendered ) handleDomEvent.call( this );\r\n\t\t\ttimeout = null;\r\n\t\t}, delay );\r\n\t};\r\n}\r\n\r\nexport default class GenericBinding extends Binding {\r\n\tgetInitialValue () {\r\n\t\treturn '';\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\treturn this.node.value;\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\r\n\t\t// any lazy setting for this element overrides the root\r\n\t\t// if the value is a number, it's a timeout\r\n\t\tlet lazy = this.ractive.lazy;\r\n\t\tlet timeout = false;\r\n\r\n\t\tif ( 'lazy' in this.element ) {\r\n\t\t\tlazy = this.element.lazy;\r\n\t\t}\r\n\r\n\t\tif ( isNumeric( lazy ) ) {\r\n\t\t\ttimeout = +lazy;\r\n\t\t\tlazy = false;\r\n\t\t}\r\n\r\n\t\tthis.handler = timeout ? handleDelay( timeout ) : handleDomEvent;\r\n\r\n\t\tconst node = this.node;\r\n\r\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\r\n\r\n\t\tif ( !lazy ) {\r\n\t\t\tnode.addEventListener( 'input', this.handler, false );\r\n\r\n\t\t\tif ( node.attachEvent ) {\r\n\t\t\t\tnode.addEventListener( 'keyup', this.handler, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tnode.addEventListener( 'blur', handleBlur, false );\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tconst node = this.element.node;\r\n\t\tthis.rendered = false;\r\n\r\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\r\n\t\tnode.removeEventListener( 'input', this.handler, false );\r\n\t\tnode.removeEventListener( 'keyup', this.handler, false );\r\n\t\tnode.removeEventListener( 'blur', handleBlur, false );\r\n\t}\r\n}\r\n","import { toArray } from './array';\r\n\r\nexport default function getSelectedOptions ( select ) {\r\n\treturn select.selectedOptions\r\n\t\t? toArray( select.selectedOptions )\r\n\t\t: select.options\r\n\t\t\t? toArray( select.options ).filter( option => option.selected )\r\n\t\t\t: [];\r\n}\r\n","import runloop from '../../../../global/runloop';\r\nimport { removeFromArray } from '../../../../utils/array';\r\nimport Binding from './Binding';\r\nimport handleDomEvent from './handleDomEvent';\r\n\r\nconst siblings = {};\r\n\r\nfunction getSiblings ( hash ) {\r\n\treturn siblings[ hash ] || ( siblings[ hash ] = [] );\r\n}\r\n\r\nexport default class RadioBinding extends Binding {\r\n\tconstructor ( element ) {\r\n\t\tsuper( element, 'checked' );\r\n\r\n\t\tthis.siblings = getSiblings( this.ractive._guid + this.element.getAttribute( 'name' ) );\r\n\t\tthis.siblings.push( this );\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\treturn this.node.checked;\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\trunloop.start( this.root );\r\n\r\n\t\tthis.siblings.forEach( binding => {\r\n\t\t\tbinding.model.set( binding.getValue() );\r\n\t\t});\r\n\r\n\t\trunloop.end();\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\r\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\r\n\r\n\t\tif ( this.node.attachEvent ) {\r\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\r\n\t\t}\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tthis.model.set( node.checked );\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tremoveFromArray( this.siblings, this );\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\r\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\r\n\t}\r\n}\r\n","import Binding from './Binding';\r\nimport getBindingGroup from './getBindingGroup';\r\nimport handleDomEvent from './handleDomEvent';\r\nimport noop from '../../../../utils/noop';\r\n\r\nfunction getValue() {\r\n\tconst checked = this.bindings.filter( b => b.node.checked );\r\n\tif ( checked.length > 0 ) {\r\n\t\treturn checked[0].element.getAttribute( 'value' );\r\n\t}\r\n}\r\n\r\nexport default class RadioNameBinding extends Binding {\r\n\tconstructor ( element ) {\r\n\t\tsuper( element, 'name' );\r\n\r\n\t\tthis.group = getBindingGroup( 'radioname', this.model, getValue );\r\n\t\tthis.group.add( this );\r\n\r\n\t\tif ( element.checked ) {\r\n\t\t\tthis.group.value = this.getValue();\r\n\t\t}\r\n\t}\r\n\r\n\tbind () {\r\n\t\tif ( !this.group.bound ) {\r\n\t\t\tthis.group.bind();\r\n\t\t}\r\n\r\n\t\t// update name keypath when necessary\r\n\t\tthis.nameAttributeBinding = {\r\n\t\t\thandleChange: () => this.node.name = `{{${this.model.getKeypath()}}}`,\r\n\t\t\trebind: noop\r\n\t\t};\r\n\r\n\t\tthis.model.getKeypathModel().register( this.nameAttributeBinding );\r\n\t}\r\n\r\n\tgetInitialValue () {\r\n\t\tif ( this.element.getAttribute( 'checked' ) ) {\r\n\t\t\treturn this.element.getAttribute( 'value' );\r\n\t\t}\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\treturn this.element.getAttribute( 'value' );\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\t// If this <input> is the one that's checked, then the value of its\r\n\t\t// `name` model gets set to its value\r\n\t\tif ( this.node.checked ) {\r\n\t\t\tthis.group.value = this.getValue();\r\n\t\t\tsuper.handleChange();\r\n\t\t}\r\n\t}\r\n\r\n\tlastVal ( setting, value ) {\r\n\t\tif ( !this.group ) return;\r\n\t\tif ( setting ) this.group.lastValue = value;\r\n\t\telse return this.group.lastValue;\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\r\n\t\tconst node = this.node;\r\n\r\n\t\tnode.name = `{{${this.model.getKeypath()}}}`;\r\n\t\tnode.checked = this.element.compare ( this.model.get(), this.element.getAttribute( 'value' ) );\r\n\r\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\r\n\r\n\t\tif ( node.attachEvent ) {\r\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\r\n\t\t}\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tif ( node.checked ) {\r\n\t\t\tthis.group.model.set( this.element.getAttribute( 'value' ) );\r\n\t\t}\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tthis.group.remove( this );\r\n\r\n\t\tthis.model.getKeypathModel().unregister( this.nameAttributeBinding );\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tconst node = this.node;\r\n\r\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\r\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\r\n\t}\r\n}\r\n","import { INTERPOLATOR, TRIPLE } from '../../../../config/types';\r\nimport { warnIfDebug } from '../../../../utils/log';\r\nimport CheckboxBinding from './CheckboxBinding';\r\nimport CheckboxNameBinding from './CheckboxNameBinding';\r\nimport ContentEditableBinding from './ContentEditableBinding';\r\nimport FileBinding from './FileBinding';\r\nimport GenericBinding from './GenericBinding';\r\nimport MultipleSelectBinding from './MultipleSelectBinding';\r\nimport NumericBinding from './NumericBinding';\r\nimport RadioBinding from './RadioBinding';\r\nimport RadioNameBinding from './RadioNameBinding';\r\nimport SingleSelectBinding from './SingleSelectBinding';\r\n\r\nexport function isBindable ( attribute ) {\r\n\r\n\t// The fragment must be a single non-string fragment\r\n\tif ( !attribute || !attribute.template.f || !attribute.template.f.length === 1 || attribute.template.f[0].s ) return false;\r\n\r\n\t// A binding is an interpolator `{{ }}`, yey.\r\n\tif ( attribute.template.f[0].t === INTERPOLATOR ) return true;\r\n\r\n\t// The above is probably the only true case. For the rest, show an appropriate\r\n\t// warning before returning false.\r\n\r\n\t// You can't bind a triple curly. HTML values on an attribute makes no sense.\r\n\tif ( attribute.template.f[0].t === TRIPLE ) warnIfDebug( 'It is not possible create a binding using a triple mustache.' );\r\n\r\n\treturn false;\r\n}\r\n\r\nexport default function selectBinding ( element ) {\r\n\tconst name = element.name;\r\n\tconst attributes = element.attributeByName;\r\n\tconst isBindableByValue = isBindable( attributes.value );\r\n\tconst isBindableByContentEditable = isBindable( attributes.contenteditable );\r\n\tconst isContentEditable =  element.getAttribute( 'contenteditable' );\r\n\r\n\t// contenteditable\r\n\t// Bind if the contenteditable is true or a binding that may become true.\r\n\tif ( ( isContentEditable || isBindableByContentEditable ) && isBindableByValue ) return ContentEditableBinding;\r\n\r\n\t// <input>\r\n\tif ( name === 'input' ) {\r\n\t\tconst type = element.getAttribute( 'type' );\r\n\r\n\t\tif ( type === 'radio' ) {\r\n\t\t\tconst isBindableByName = isBindable( attributes.name );\r\n\t\t\tconst isBindableByChecked = isBindable( attributes.checked );\r\n\r\n\t\t\t// For radios we can either bind the name or checked, but not both.\r\n\t\t\t// Name binding is handed instead.\r\n\t\t\tif ( isBindableByName && isBindableByChecked ) {\r\n\t\t\t\twarnIfDebug( 'A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\r\n\t\t\t\treturn RadioNameBinding;\r\n\t\t\t}\r\n\r\n\t\t\tif ( isBindableByName ) return RadioNameBinding;\r\n\r\n\t\t\tif ( isBindableByChecked ) return RadioBinding;\r\n\r\n\t\t\t// Dead end. Unknown binding on radio input.\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif ( type === 'checkbox' ) {\r\n\t\t\tconst isBindableByName = isBindable( attributes.name );\r\n\t\t\tconst isBindableByChecked = isBindable( attributes.checked );\r\n\r\n\t\t\t// A checkbox with bindings for both name and checked. Checked treated as\r\n\t\t\t// the checkbox value, name is treated as a regular binding.\r\n\t\t\t//\r\n\t\t\t// See https://github.com/ractivejs/ractive/issues/1749\r\n\t\t\tif ( isBindableByName && isBindableByChecked ) return CheckboxBinding;\r\n\r\n\t\t\tif ( isBindableByName ) return CheckboxNameBinding;\r\n\r\n\t\t\tif ( isBindableByChecked ) return CheckboxBinding;\r\n\r\n\t\t\t// Dead end. Unknown binding on checkbox input.\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif ( type === 'file' && isBindableByValue ) return FileBinding;\r\n\r\n\t\tif ( type === 'number' && isBindableByValue ) return NumericBinding;\r\n\r\n\t\tif ( type === 'range' && isBindableByValue ) return NumericBinding;\r\n\r\n\t\t// Some input of unknown type (browser usually falls back to text).\r\n\t\tif ( isBindableByValue ) return GenericBinding;\r\n\r\n\t\t// Dead end. Some unknown input and an unbindable.\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// <select>\r\n\tif ( name === 'select' && isBindableByValue ){\r\n\t\treturn element.getAttribute( 'multiple' ) ? MultipleSelectBinding : SingleSelectBinding;\r\n\t}\r\n\r\n\t// <textarea>\r\n\tif ( name === 'textarea' && isBindableByValue ) return GenericBinding;\r\n\r\n\t// Dead end. Some unbindable element.\r\n\treturn null;\r\n}\r\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from '../../config/types';\nimport runloop from '../../global/runloop';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport { toArray } from '../../utils/array';\nimport { escapeHtml, voidElementNames } from '../../utils/html';\nimport { bind, destroyed, render, unbind, update } from '../../shared/methodCallers';\nimport { createElement, detachNode, matches, safeAttributeString } from '../../utils/dom';\nimport createItem from './createItem';\nimport { html, svg } from '../../config/namespaces';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { DelegateProxy } from './shared/EventDirective';\nimport Context from '../../shared/Context';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.name = options.template.e.toLowerCase();\n\t\tthis.isVoid = voidElementNames.test( this.name );\n\n\t\t// find parent element\n\t\tthis.parent = findElement( this.parentFragment, false );\n\n\t\tif ( this.parent && this.parent.name === 'option' ) {\n\t\t\tthrow new Error( `An <option> element cannot contain other elements (encountered <${this.name}>)` );\n\t\t}\n\n\t\tthis.decorators = [];\n\t\tthis.events = [];\n\n\t\t// create attributes\n\t\tthis.attributeByName = {};\n\n\t\tthis.attributes = [];\n\t\tconst leftovers = [];\n\t\t( this.template.m || [] ).forEach( template => {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\tcase EVENT:\n\t\t\t\tcase TRANSITION:\n\t\t\t\t\tthis.attributes.push( createItem({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\t\t\ttemplate\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase DELEGATE_FLAG:\n\t\t\t\t  this.delegate = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif ( leftovers.length ) {\n\t\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate: leftovers\n\t\t\t}) );\n\t\t}\n\n\t\tthis.attributes.sort( sortAttributes );\n\n\t\t// create children\n\t\tif ( options.template.f && !options.deferContent ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\ttemplate: options.template.f,\n\t\t\t\towner: this,\n\t\t\t\tcssIds: null\n\t\t\t});\n\t\t}\n\n\t\tthis.binding = null; // filled in later\n\t}\n\n\tbind () {\n\t\tthis.attributes.binding = true;\n\t\tthis.attributes.forEach( bind );\n\t\tthis.attributes.binding = false;\n\n\t\tif ( this.fragment ) this.fragment.bind();\n\n\t\t// create two-way binding if necessary\n\t\tif ( !this.binding ) this.recreateTwowayBinding();\n\t\telse this.binding.bind();\n\t}\n\n\tcreateTwowayBinding () {\n\t\tif ( 'twoway' in this ? this.twoway : this.ractive.twoway ) {\n\t\t\tconst Binding = selectBinding( this );\n\t\t\tif ( Binding ) {\n\t\t\t\tconst binding = new Binding( this );\n\t\t\t\tif ( binding && binding.model ) return binding;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroyed () {\n\t\tthis.attributes.forEach( destroyed );\n\t\tfor ( const ev in this.delegates ) {\n\t\t\tthis.delegates[ev].unlisten();\n\t\t}\n\t\tif ( this.fragment ) this.fragment.destroyed();\n\t}\n\n\tdetach () {\n\t\t// if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n\t\tif ( !this.rendered ) this.destroyed();\n\n\t\treturn detachNode( this.node );\n\t}\n\n\tfind ( selector, options ) {\n\t\tif ( this.node && matches( this.node, selector ) ) return this.node;\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector, options );\n\t\t}\n\t}\n\n\tfindAll ( selector, options ) {\n\t\tconst { result } = options;\n\n\t\tif ( matches( this.node, selector ) ) {\n\t\t\tresult.push( this.node );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, options );\n\t\t}\n\t}\n\n\tfindNextNode () {\n\t\treturn null;\n\t}\n\n\tfirstNode () {\n\t\treturn this.node;\n\t}\n\n\tgetAttribute ( name ) {\n\t\tconst attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : undefined;\n\t}\n\n\tgetContext ( ...assigns ) {\n\t\tif ( this.fragment ) return this.fragment.getContext( ...assigns );\n\n\t\tif ( !this.ctx ) this.ctx = new Context( this.parentFragment, this );\n\t\tassigns.unshift( Object.create( this.ctx ) );\n\t\treturn Object.assign.apply( null, assigns );\n\t}\n\n\trecreateTwowayBinding () {\n\t\tif ( this.binding ) {\n\t\t\tthis.binding.unbind();\n\t\t\tthis.binding.unrender();\n\t\t}\n\n\t\tif ( this.binding = this.createTwowayBinding() ) {\n\t\t\tthis.binding.bind();\n\t\t\tif ( this.rendered ) this.binding.render();\n\t\t}\n\t}\n\n\trender ( target, occupants ) {\n\t\t// TODO determine correct namespace\n\t\tthis.namespace = getNamespace( this );\n\n\t\tlet node;\n\t\tlet existing = false;\n\n\t\tif ( occupants ) {\n\t\t\tlet n;\n\t\t\twhile ( ( n = occupants.shift() ) ) {\n\t\t\t\tif ( n.nodeName.toUpperCase() === this.template.e.toUpperCase() && n.namespaceURI === this.namespace ) {\n\t\t\t\t\tthis.node = node = n;\n\t\t\t\t\texisting = true;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tdetachNode( n );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !node ) {\n\t\t\tconst name = this.template.e;\n\t\t\tnode = createElement( this.namespace === html ? name.toLowerCase() : name, this.namespace, this.getAttribute( 'is' ) );\n\t\t\tthis.node = node;\n\t\t}\n\n\t\t// tie the node to this vdom element\n\t\tObject.defineProperty( node, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\tproxy: this\n\t\t\t}\n\t\t});\n\n\t\t// Is this a top-level node of a component? If so, we may need to add\n\t\t// a data-ractive-css attribute, for CSS encapsulation\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tnode.setAttribute( 'data-ractive-css', this.parentFragment.cssIds.map( x => `{${x}}` ).join( ' ' ) );\n\t\t}\n\n\t\tif ( existing && this.foundNode ) this.foundNode( node );\n\n\t\t// register intro before rendering content so children can find the intro\n\t\tconst intro = this.intro;\n\t\tif ( intro && intro.shouldFire( 'intro' ) ) {\n\t\t\tintro.isIntro = true;\n\t\t\tintro.isOutro = false;\n\t\t\trunloop.registerTransition( intro );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tconst children = existing ? toArray( node.childNodes ) : undefined;\n\n\t\t\tthis.fragment.render( node, children );\n\n\t\t\t// clean up leftover children\n\t\t\tif ( children ) {\n\t\t\t\tchildren.forEach( detachNode );\n\t\t\t}\n\t\t}\n\n\t\tif ( existing ) {\n\t\t\t// store initial values for two-way binding\n\t\t\tif ( this.binding && this.binding.wasUndefined ) this.binding.setFromNode( node );\n\t\t\t// remove unused attributes\n\t\t\tlet i = node.attributes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst name = node.attributes[i].name;\n\t\t\t\tif ( !( name in this.attributeByName ) )node.removeAttribute( name );\n\t\t\t}\n\t\t}\n\n\t\tthis.attributes.forEach( render );\n\t\tif ( this.delegates ) {\n\t\t\tfor ( const ev in this.delegates ) {\n\t\t\t\tthis.delegates[ev].listen( DelegateProxy );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.binding ) this.binding.render();\n\n\t\tif ( !existing ) {\n\t\t\ttarget.appendChild( node );\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\ttoString () {\n\t\tconst tagName = this.template.e;\n\n\t\tlet attrs = this.attributes.map( stringifyAttribute ).join( '' );\n\n\t\t// Special case - selected options\n\t\tif ( this.name === 'option' && this.isSelected() ) {\n\t\t\tattrs += ' selected';\n\t\t}\n\n\t\t// Special case - two-way radio name bindings\n\t\tif ( this.name === 'input' && inputIsCheckedRadio( this ) ) {\n\t\t\tattrs += ' checked';\n\t\t}\n\n\t\t// Special case style and class attributes and directives\n\t\tlet style, cls;\n\t\tthis.attributes.forEach( attr => {\n\t\t\tif ( attr.name === 'class' ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t} else if ( attr.name === 'style' ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t\tif ( style && !endsWithSemi.test( style ) ) style += ';';\n\t\t\t} else if ( attr.style ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) +  `${attr.style}: ${safeAttributeString( attr.getString() )};`;\n\t\t\t} else if ( attr.inlineClass && attr.getValue() ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + attr.inlineClass;\n\t\t\t}\n\t\t});\n\t\t// put classes first, then inline style\n\t\tif ( style !== undefined ) attrs = ' style' + ( style ? `=\"${style}\"` : '' ) + attrs;\n\t\tif ( cls !== undefined ) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tattrs += ` data-ractive-css=\"${this.parentFragment.cssIds.map( x => `{${x}}` ).join( ' ' )}\"`;\n\t\t}\n\n\t\tlet str = `<${tagName}${attrs}>`;\n\n\t\tif ( this.isVoid ) return str;\n\n\t\t// Special case - textarea\n\t\tif ( this.name === 'textarea' && this.getAttribute( 'value' ) !== undefined ) {\n\t\t\tstr += escapeHtml( this.getAttribute( 'value' ) );\n\t\t}\n\n\t\t// Special case - contenteditable\n\t\telse if ( this.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\tstr += ( this.getAttribute( 'value' ) || '' );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tstr += this.fragment.toString( !/^(?:script|style)$/i.test( this.template.e ) ); // escape text unless script/style\n\t\t}\n\n\t\tstr += `</${tagName}>`;\n\t\treturn str;\n\t}\n\n\tunbind () {\n\t\tthis.attributes.unbinding = true;\n\t\tthis.attributes.forEach( unbind );\n\t\tthis.attributes.unbinding = false;\n\n\t\tif ( this.binding ) this.binding.unbind();\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( !this.rendered ) return;\n\t\tthis.rendered = false;\n\n\t\t// unrendering before intro completed? complete it now\n\t\t// TODO should be an API for aborting transitions\n\t\tconst transition = this.intro;\n\t\tif ( transition && transition.complete ) transition.complete();\n\n\t\t// Detach as soon as we can\n\t\tif ( this.name === 'option' ) {\n\t\t\t// <option> elements detach immediately, so that\n\t\t\t// their parent <select> element syncs correctly, and\n\t\t\t// since option elements can't have transitions anyway\n\t\t\tthis.detach();\n\t\t} else if ( shouldDestroy ) {\n\t\t\trunloop.detachWhenReady( this );\n\t\t}\n\n\t\t// outro transition\n\t\tconst outro = this.outro;\n\t\tif ( outro && outro.shouldFire( 'outro' ) ) {\n\t\t\toutro.isIntro = false;\n\t\t\toutro.isOutro = true;\n\t\t\trunloop.registerTransition( outro );\n\t\t}\n\n\t\tif ( this.fragment ) this.fragment.unrender();\n\n\t\tif ( this.binding ) this.binding.unrender();\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.attributes.forEach( update );\n\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t}\n\t}\n}\n\nconst toFront = [ 'min', 'max', 'class', 'type' ];\nfunction sortAttributes ( left, right ) {\n\tleft = left.name;\n\tright = right.name;\n\tconst l = left === 'value' ? 1 : ~toFront.indexOf( left );\n\tconst r = right === 'value' ? 1 : ~toFront.indexOf( right );\n\treturn l < r ? -1 : l > r ? 1 : 0;\n}\n\nfunction inputIsCheckedRadio ( element ) {\n\tconst nameAttr = element.attributeByName.name;\n\treturn element.getAttribute( 'type' ) === 'radio' &&\n\t\t( nameAttr || {} ).interpolator &&\n\t\telement.getAttribute( 'value' ) === nameAttr.interpolator.model.get();\n}\n\nfunction stringifyAttribute ( attribute ) {\n\tconst str = attribute.toString();\n\treturn str ? ' ' + str : '';\n}\n\nfunction getNamespace ( element ) {\n\t// Use specified namespace...\n\tconst xmlns = element.getAttribute( 'xmlns' );\n\tif ( xmlns ) return xmlns;\n\n\t// ...or SVG namespace, if this is an <svg> element\n\tif ( element.name === 'svg' ) return svg;\n\n\tconst parent = element.parent;\n\n\tif ( parent ) {\n\t\t// ...or HTML, if the parent is a <foreignObject>\n\t\tif ( parent.name === 'foreignobject' ) return html;\n\n\t\t// ...or inherit from the parent node\n\t\treturn parent.node.namespaceURI;\n\t}\n\n\treturn element.ractive.el.namespaceURI;\n}\n","import runloop from '../../../../global/runloop';\r\nimport Element from '../../Element';\r\n\r\nexport default class Form extends Element {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\t\tthis.formBindings = [];\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tsuper.render( target, occupants );\r\n\t\tthis.node.addEventListener( 'reset', handleReset, false );\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tthis.node.removeEventListener( 'reset', handleReset, false );\r\n\t\tsuper.unrender( shouldDestroy );\r\n\t}\r\n}\r\n\r\nfunction handleReset () {\r\n\tconst element = this._ractive.proxy;\r\n\r\n\trunloop.start();\r\n\telement.formBindings.forEach( updateModel );\r\n\trunloop.end();\r\n}\r\n\r\nfunction updateModel ( binding ) {\r\n\tbinding.model.set( binding.resetValue );\r\n}\r\n","import { doc } from '../../../config/environment';\r\n\r\nexport default function progressiveText ( item, target, occupants, text ) {\r\n\tif ( occupants ) {\r\n\t\tlet n = occupants[0];\r\n\t\tif ( n && n.nodeType === 3 ) {\r\n\t\t\tconst idx = n.nodeValue.indexOf( text );\r\n\t\t\toccupants.shift();\r\n\r\n\t\t\tif ( idx === 0 ) {\r\n\t\t\t\tif ( n.nodeValue.length !== text.length ) {\r\n\t\t\t\t\toccupants.unshift( n.splitText( text.length ) );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tn.nodeValue = text;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tn = item.node = doc.createTextNode( text );\r\n\t\t\tif ( occupants[0] ) {\r\n\t\t\t\ttarget.insertBefore( n, occupants[0] );\r\n\t\t\t} else {\r\n\t\t\t\ttarget.appendChild( n );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\titem.node = n;\r\n\t} else {\r\n\t\tif ( !item.node ) item.node = doc.createTextNode( text );\r\n\t\ttarget.appendChild( item.node );\r\n\t}\r\n}\r\n","import Parser from '../parse/Parser';\r\nimport readStringLiteral from '../parse/converters/expressions/primary/literal/readStringLiteral';\r\nimport readKey from '../parse/converters/expressions/shared/readKey';\r\n\r\n// simple JSON parser, without the restrictions of JSON parse\r\n// (i.e. having to double-quote keys).\r\n//\r\n// If passed a hash of values as the second argument, ${placeholders}\r\n// will be replaced with those values\r\n\r\nconst specials = {\r\n\ttrue: true,\r\n\tfalse: false,\r\n\tnull: null,\r\n\tundefined\r\n};\r\n\r\nconst specialsPattern = new RegExp( '^(?:' + Object.keys( specials ).join( '|' ) + ')' );\r\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\r\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\r\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\r\nconst onlyWhitespace = /^\\s*$/;\r\n\r\nconst JsonParser = Parser.extend({\r\n\tinit ( str, options ) {\r\n\t\tthis.values = options.values;\r\n\t\tthis.allowWhitespace();\r\n\t},\r\n\r\n\tpostProcess ( result ) {\r\n\t\tif ( result.length !== 1 || !onlyWhitespace.test( this.leftover ) ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn { value: result[0].v };\r\n\t},\r\n\r\n\tconverters: [\r\n\t\tfunction getPlaceholder ( parser ) {\r\n\t\t\tif ( !parser.values ) return null;\r\n\r\n\t\t\tconst placeholder = parser.matchPattern( placeholderAtStartPattern );\r\n\r\n\t\t\tif ( placeholder && ( parser.values.hasOwnProperty( placeholder ) ) ) {\r\n\t\t\t\treturn { v: parser.values[ placeholder ] };\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfunction getSpecial ( parser ) {\r\n\t\t\tconst special = parser.matchPattern( specialsPattern );\r\n\t\t\tif ( special ) return { v: specials[ special ] };\r\n\t\t},\r\n\r\n\t\tfunction getNumber ( parser ) {\r\n\t\t\tconst number = parser.matchPattern( numberPattern );\r\n\t\t\tif ( number ) return { v: +number };\r\n\t\t},\r\n\r\n\t\tfunction getString ( parser ) {\r\n\t\t\tconst stringLiteral = readStringLiteral( parser );\r\n\t\t\tconst values = parser.values;\r\n\r\n\t\t\tif ( stringLiteral && values ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tv: stringLiteral.v.replace( placeholderPattern, ( match, $1 ) => ( $1 in values ? values[ $1 ] : $1 ) )\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn stringLiteral;\r\n\t\t},\r\n\r\n\t\tfunction getObject ( parser ) {\r\n\t\t\tif ( !parser.matchString( '{' ) ) return null;\r\n\r\n\t\t\tconst result = {};\r\n\r\n\t\t\tparser.allowWhitespace();\r\n\r\n\t\t\tif ( parser.matchString( '}' ) ) {\r\n\t\t\t\treturn { v: result };\r\n\t\t\t}\r\n\r\n\t\t\tlet pair;\r\n\t\t\twhile ( pair = getKeyValuePair( parser ) ) {\r\n\t\t\t\tresult[ pair.key ] = pair.value;\r\n\r\n\t\t\t\tparser.allowWhitespace();\r\n\r\n\t\t\t\tif ( parser.matchString( '}' ) ) {\r\n\t\t\t\t\treturn { v: result };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tfunction getArray ( parser ) {\r\n\t\t\tif ( !parser.matchString( '[' ) ) return null;\r\n\r\n\t\t\tconst result = [];\r\n\r\n\t\t\tparser.allowWhitespace();\r\n\r\n\t\t\tif ( parser.matchString( ']' ) ) {\r\n\t\t\t\treturn { v: result };\r\n\t\t\t}\r\n\r\n\t\t\tlet valueToken;\r\n\t\t\twhile ( valueToken = parser.read() ) {\r\n\t\t\t\tresult.push( valueToken.v );\r\n\r\n\t\t\t\tparser.allowWhitespace();\r\n\r\n\t\t\t\tif ( parser.matchString( ']' ) ) {\r\n\t\t\t\t\treturn { v: result };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tparser.allowWhitespace();\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\t]\r\n});\r\n\r\nfunction getKeyValuePair ( parser ) {\r\n\tparser.allowWhitespace();\r\n\r\n\tconst key = readKey( parser );\r\n\r\n\tif ( !key ) return null;\r\n\r\n\tconst pair = { key };\r\n\r\n\tparser.allowWhitespace();\r\n\tif ( !parser.matchString( ':' ) ) {\r\n\t\treturn null;\r\n\t}\r\n\tparser.allowWhitespace();\r\n\r\n\tconst valueToken = parser.read();\r\n\r\n\tif ( !valueToken ) return null;\r\n\r\n\tpair.value = valueToken.v;\r\n\treturn pair;\r\n}\r\n\r\nexport default function ( str, values ) {\r\n\tconst parser = new JsonParser( str, { values });\r\n\treturn parser.result;\r\n}\r\n","import { INTERPOLATOR } from '../../../config/types';\r\nimport Item from '../shared/Item';\r\nimport Fragment from '../../Fragment';\r\nimport findElement from '../shared/findElement';\r\nimport parseJSON from '../../../utils/parseJSON';\r\nimport resolve from '../../resolvers/resolve';\r\nimport runloop from '../../../global/runloop';\r\nimport { warnIfDebug } from '../../../utils/log';\r\n\r\nexport default class Mapping extends Item {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.name = options.template.n;\r\n\r\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\r\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\r\n\t\tthis.parentFragment = this.element.parentFragment; // shared\r\n\t\tthis.ractive = this.parentFragment.ractive;\r\n\r\n\t\tthis.fragment = null;\r\n\r\n\t\tthis.element.attributeByName[ this.name ] = this;\r\n\r\n\t\tthis.value = options.template.f;\r\n\t}\r\n\r\n\tbind () {\r\n\t\tif ( this.fragment ) {\r\n\t\t\tthis.fragment.bind();\r\n\t\t}\r\n\r\n\t\tconst template = this.template.f;\r\n\t\tconst viewmodel = this.element.instance.viewmodel;\r\n\r\n\t\tif ( template === 0 ) {\r\n\t\t\t// empty attributes are `true`\r\n\t\t\tviewmodel.joinKey( this.name ).set( true );\r\n\t\t}\r\n\r\n\t\telse if ( typeof template === 'string' ) {\r\n\t\t\tconst parsed = parseJSON( template );\r\n\t\t\tviewmodel.joinKey( this.name ).set( parsed ? parsed.value : template );\r\n\t\t}\r\n\r\n\t\telse if ( Array.isArray( template ) ) {\r\n\t\t\tcreateMapping( this, true );\r\n\t\t}\r\n\t}\r\n\r\n\trender () {}\r\n\r\n\tunbind () {\r\n\t\tif ( this.fragment ) this.fragment.unbind();\r\n\t\tif ( this.model ) this.model.unregister( this );\r\n\t\tif ( this.boundFragment ) this.boundFragment.unbind();\r\n\r\n\t\tif ( this.element.bound ) {\r\n\t\t\tif ( this.link.target === this.model ) this.link.owner.unlink();\r\n\t\t}\r\n\t}\r\n\r\n\tunrender () {}\r\n\r\n\tupdate () {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\t\t\tif ( this.fragment ) this.fragment.update();\r\n\t\t\tif ( this.boundFragment ) this.boundFragment.update();\r\n\t\t\tif ( this.rendered ) this.updateDelegate();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction createMapping ( item ) {\r\n\tconst template = item.template.f;\r\n\tconst viewmodel = item.element.instance.viewmodel;\r\n\tconst childData = viewmodel.value;\r\n\r\n\tif ( template.length === 1 && template[0].t === INTERPOLATOR ) {\r\n\t\tconst model = resolve( item.parentFragment, template[0] );\r\n\t\tconst val = model.get( false );\r\n\r\n\t\t// if the interpolator is not static\r\n\t\tif ( !template[0].s ) {\r\n\t\t\titem.model = model;\r\n\t\t\titem.link = viewmodel.createLink( item.name, model, template[0].r );\r\n\r\n\t\t\t// initialize parent side of the mapping from child data\r\n\t\t\tif ( val === undefined && !model.isReadonly && item.name in childData ) {\r\n\t\t\t\tmodel.set( childData[ item.name ] );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// copy non-object, non-computed vals through\r\n\t\telse if ( typeof val !== 'object' || template[0].x ) {\r\n\t\t\tviewmodel.joinKey( item.name ).set( val );\r\n\t\t}\r\n\r\n\t\t// warn about trying to copy an object\r\n\t\telse {\r\n\t\t\twarnIfDebug( `Cannot copy non-computed object value from static mapping '${item.name}'` );\r\n\t\t}\r\n\t}\r\n\r\n\telse {\r\n\t\titem.boundFragment = new Fragment({\r\n\t\t\towner: item,\r\n\t\t\ttemplate\r\n\t\t}).bind();\r\n\r\n\t\titem.model = viewmodel.joinKey( item.name );\r\n\t\titem.model.set( item.boundFragment.valueOf() );\r\n\r\n\t\t// item is a *bit* of a hack\r\n\t\titem.boundFragment.bubble = () => {\r\n\t\t\tFragment.prototype.bubble.call( item.boundFragment );\r\n\t\t\t// defer this to avoid mucking around model deps if there happens to be an expression involved\r\n\t\t\trunloop.scheduleTask(() => {\r\n\t\t\t\titem.boundFragment.update();\r\n\t\t\t\titem.model.set( item.boundFragment.valueOf() );\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n}\r\n","import { noRegistryFunctionReturn } from '../../../config/errors';\r\nimport { warnIfDebug } from '../../../utils/log';\r\nimport parser from '../../../Ractive/config/runtime-parser';\r\nimport { findInstance } from '../../../shared/registry';\r\nimport { fillGaps } from '../../../utils/object';\r\n\r\nexport default function getPartialTemplate ( ractive, name, parentFragment ) {\r\n\t// If the partial in instance or view heirarchy instances, great\r\n\tlet partial = getPartialFromRegistry( ractive, name, parentFragment || {} );\r\n\tif ( partial ) return partial;\r\n\r\n\t// Does it exist on the page as a script tag?\r\n\tpartial = parser.fromId( name, { noThrow: true } );\r\n\tif ( partial ) {\r\n\t\t// parse and register to this ractive instance\r\n\t\tconst parsed = parser.parseFor( partial, ractive );\r\n\r\n\t\t// register extra partials on the ractive instance if they don't already exist\r\n\t\tif ( parsed.p ) fillGaps( ractive.partials, parsed.p );\r\n\r\n\t\t// register (and return main partial if there are others in the template)\r\n\t\treturn ractive.partials[ name ] = parsed.t;\r\n\t}\r\n}\r\n\r\nfunction getPartialFromRegistry ( ractive, name, parentFragment ) {\r\n\t// if there was an instance up-hierarchy, cool\r\n\tlet partial = findParentPartial( name, parentFragment.owner );\r\n\tif ( partial ) return partial;\r\n\r\n\t// find first instance in the ractive or view hierarchy that has this partial\r\n\tconst instance = findInstance( 'partials', ractive, name );\r\n\r\n\tif ( !instance ) { return; }\r\n\r\n\tpartial = instance.partials[ name ];\r\n\r\n\t// partial is a function?\r\n\tlet fn;\r\n\tif ( typeof partial === 'function' ) {\r\n\t\tfn = partial.bind( instance );\r\n\t\tfn.isOwner = instance.partials.hasOwnProperty(name);\r\n\t\tpartial = fn.call( ractive, parser );\r\n\t}\r\n\r\n\tif ( !partial && partial !== '' ) {\r\n\t\twarnIfDebug( noRegistryFunctionReturn, name, 'partial', 'partial', { ractive });\r\n\t\treturn;\r\n\t}\r\n\r\n\t// If this was added manually to the registry,\r\n\t// but hasn't been parsed, parse it now\r\n\tif ( !parser.isParsed( partial ) ) {\r\n\t\t// use the parseOptions of the ractive instance on which it was found\r\n\t\tconst parsed = parser.parseFor( partial, instance );\r\n\r\n\t\t// Partials cannot contain nested partials!\r\n\t\t// TODO add a test for this\r\n\t\tif ( parsed.p ) {\r\n\t\t\twarnIfDebug( 'Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\r\n\t\t}\r\n\r\n\t\t// if fn, use instance to store result, otherwise needs to go\r\n\t\t// in the correct point in prototype chain on instance or constructor\r\n\t\tconst target = fn ? instance : findOwner( instance, name );\r\n\r\n\t\t// may be a template with partials, which need to be registered and main template extracted\r\n\t\ttarget.partials[ name ] = partial = parsed.t;\r\n\t}\r\n\r\n\t// store for reset\r\n\tif ( fn ) partial._fn = fn;\r\n\r\n\treturn partial.v ? partial.t : partial;\r\n}\r\n\r\nfunction findOwner ( ractive, key ) {\r\n\treturn ractive.partials.hasOwnProperty( key )\r\n\t\t? ractive\r\n\t\t: findConstructor( ractive.constructor, key);\r\n}\r\n\r\nfunction findConstructor ( constructor, key ) {\r\n\tif ( !constructor ) { return; }\r\n\treturn constructor.partials.hasOwnProperty( key )\r\n\t\t? constructor\r\n\t\t: findConstructor( constructor._Parent, key );\r\n}\r\n\r\nfunction findParentPartial( name, parent ) {\r\n\tif ( parent ) {\r\n\t\tif ( parent.template && parent.template.p && parent.template.p[name] ) {\r\n\t\t\treturn parent.template.p[name];\r\n\t\t} else if ( parent.parentFragment && parent.parentFragment.owner ) {\r\n\t\t\treturn findParentPartial( name, parent.parentFragment.owner );\r\n\t\t}\r\n\t}\r\n}\r\n","import { SECTION, SECTION_WITH, YIELDER } from '../../config/types';\r\nimport { warnOnceIfDebug, warnIfDebug } from '../../utils/log';\r\nimport { MustacheContainer } from './shared/Mustache';\r\nimport Fragment from '../Fragment';\r\nimport getPartialTemplate from './partial/getPartialTemplate';\r\nimport parser from '../../Ractive/config/runtime-parser';\r\nimport { doInAttributes } from './element/ConditionalAttribute';\r\nimport { resolveAliases } from './Alias';\r\n\r\nexport default class Partial extends MustacheContainer {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.yielder = options.template.t === YIELDER;\r\n\r\n\t\tif ( this.yielder ) {\r\n\t\t\tthis.container = options.parentFragment.ractive;\r\n\t\t\tthis.component = this.container.component;\r\n\r\n\t\t\tthis.containerFragment = options.parentFragment;\r\n\t\t\tthis.parentFragment = this.component.parentFragment;\r\n\r\n\t\t\t// {{yield}} is equivalent to {{yield content}}\r\n\t\t\tif ( !options.template.r && !options.template.rx && !options.template.x ) options.template.r = 'content';\r\n\t\t}\r\n\t}\r\n\r\n\tbind () {\r\n\t\t// keep track of the reference name for future resets\r\n\t\tthis.refName = this.template.r;\r\n\r\n\t\t// name matches take priority over expressions\r\n\t\tconst template = this.refName ? getPartialTemplate( this.ractive, this.refName, this.parentFragment ) || null : null;\r\n\t\tlet templateObj;\r\n\r\n\t\tif ( template ) {\r\n\t\t\tthis.named = true;\r\n\t\t\tthis.setTemplate( this.template.r, template );\r\n\t\t}\r\n\r\n\t\tif ( !template ) {\r\n\t\t\tsuper.bind();\r\n\t\t\tif ( ( templateObj = this.model.get() ) && typeof templateObj === 'object' && ( typeof templateObj.template === 'string' || Array.isArray( templateObj.t ) ) ) {\r\n\t\t\t\tif ( templateObj.template ) {\r\n\t\t\t\t\tthis.source = templateObj.template;\r\n\t\t\t\t\ttemplateObj = parsePartial( this.template.r, templateObj.template, this.ractive );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.source = templateObj.t;\r\n\t\t\t\t}\r\n\t\t\t\tthis.setTemplate( this.template.r, templateObj.t );\r\n\t\t\t} else if ( typeof this.model.get() !== 'string' && this.refName ) {\r\n\t\t\t\tthis.setTemplate( this.refName, template );\r\n\t\t\t} else {\r\n\t\t\t\tthis.setTemplate( this.model.get() );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst options = {\r\n\t\t\towner: this,\r\n\t\t\ttemplate: this.partialTemplate\r\n\t\t};\r\n\r\n\t\tif ( this.template.c ) {\r\n\t\t\toptions.template = [{ t: SECTION, n: SECTION_WITH, f: options.template }];\r\n\t\t\tfor ( const k in this.template.c ) {\r\n\t\t\t\toptions.template[0][k] = this.template.c[k];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( this.yielder ) {\r\n\t\t\toptions.ractive = this.container.parent;\r\n\t\t}\r\n\r\n\t\tthis.fragment = new Fragment(options);\r\n\t\tif ( this.template.z ) {\r\n\t\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.yielder ? this.containerFragment : this.parentFragment );\r\n\t\t}\r\n\t\tthis.fragment.bind();\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( this.yielder && !this.dirty ) {\r\n\t\t\tthis.containerFragment.bubble();\r\n\t\t\tthis.dirty = true;\r\n\t\t} else {\r\n\t\t\tsuper.bubble();\r\n\t\t}\r\n\t}\r\n\r\n\tfindNextNode() {\r\n\t\treturn this.yielder ? this.containerFragment.findNextNode( this ) : super.findNextNode();\r\n\t}\r\n\r\n\tforceResetTemplate () {\r\n\t\tthis.partialTemplate = undefined;\r\n\r\n\t\t// on reset, check for the reference name first\r\n\t\tif ( this.refName ) {\r\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.refName, this.parentFragment );\r\n\t\t}\r\n\r\n\t\t// then look for the resolved name\r\n\t\tif ( !this.partialTemplate ) {\r\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.name, this.parentFragment );\r\n\t\t}\r\n\r\n\t\tif ( !this.partialTemplate ) {\r\n\t\t\twarnOnceIfDebug( `Could not find template for partial '${this.name}'` );\r\n\t\t\tthis.partialTemplate = [];\r\n\t\t}\r\n\r\n\t\tif ( this.inAttribute ) {\r\n\t\t\tdoInAttributes( () => this.fragment.resetTemplate( this.partialTemplate ) );\r\n\t\t} else {\r\n\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\r\n\t\t}\r\n\r\n\t\tthis.bubble();\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\treturn this.fragment.render( target, occupants );\r\n\t}\r\n\r\n\tsetTemplate ( name, template ) {\r\n\t\tthis.name = name;\r\n\r\n\t\tif ( !template && template !== null ) template = getPartialTemplate( this.ractive, name, this.parentFragment );\r\n\r\n\t\tif ( !template ) {\r\n\t\t\twarnOnceIfDebug( `Could not find template for partial '${name}'` );\r\n\t\t}\r\n\r\n\t\tthis.partialTemplate = template || [];\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tsuper.unbind();\r\n\t\tthis.fragment.aliases = {};\r\n\t\tthis.fragment.unbind();\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tthis.fragment.unrender( shouldDestroy );\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tlet template;\r\n\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\r\n\t\t\tif ( !this.named ) {\r\n\t\t\t\tif ( this.model ) {\r\n\t\t\t\t\ttemplate = this.model.get();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( template && typeof template === 'string' && template !== this.name ) {\r\n\t\t\t\t\tthis.setTemplate( template );\r\n\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\r\n\t\t\t\t} else if ( template && typeof template === 'object' && ( typeof template.template === 'string' || Array.isArray( template.t ) ) ) {\r\n\t\t\t\t\tif ( template.t !== this.source && template.template !== this.source ) {\r\n\t\t\t\t\t\tif ( template.template ) {\r\n\t\t\t\t\t\t\tthis.source = template.template;\r\n\t\t\t\t\t\t\ttemplate = parsePartial( this.name, template.template, this.ractive );\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.source = template.t;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.setTemplate( this.name, template.t );\r\n\t\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.fragment.update();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction parsePartial( name, partial, ractive ) {\r\n\tlet parsed;\r\n\r\n\ttry {\r\n\t\tparsed = parser.parse( partial, parser.getParseOptions( ractive ) );\r\n\t} catch (e) {\r\n\t\twarnIfDebug( `Could not parse partial from expression '${name}'\\n${e.message}` );\r\n\t}\r\n\r\n\treturn parsed || { t: [] };\r\n}\r\n","import { createDocumentFragment } from '../../utils/dom';\r\nimport { SECTION_EACH, SECTION_IF, SECTION_IF_WITH, SECTION_UNLESS, SECTION_WITH } from '../../config/types';\r\nimport { isObject } from '../../utils/is';\r\nimport Fragment from '../Fragment';\r\nimport RepeatedFragment from '../RepeatedFragment';\r\nimport { MustacheContainer } from './shared/Mustache';\r\nimport { keep } from '../../shared/set';\r\nimport runloop from '../../global/runloop';\r\n\r\nfunction isEmpty ( value ) {\r\n\treturn !value ||\r\n\t       ( Array.isArray( value ) && value.length === 0 ) ||\r\n\t\t   ( isObject( value ) && Object.keys( value ).length === 0 );\r\n}\r\n\r\nfunction getType ( value, hasIndexRef ) {\r\n\tif ( hasIndexRef || Array.isArray( value ) ) return SECTION_EACH;\r\n\tif ( isObject( value ) || typeof value === 'function' ) return SECTION_IF_WITH;\r\n\tif ( value === undefined ) return null;\r\n\treturn SECTION_IF;\r\n}\r\n\r\nexport default class Section extends MustacheContainer {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.sectionType = options.template.n || null;\r\n\t\tthis.templateSectionType = this.sectionType;\r\n\t\tthis.subordinate = options.template.l === 1;\r\n\t\tthis.fragment = null;\r\n\t}\r\n\r\n\tbind () {\r\n\t\tsuper.bind();\r\n\r\n\t\tif ( this.subordinate ) {\r\n\t\t\tthis.sibling = this.parentFragment.items[ this.parentFragment.items.indexOf( this ) - 1 ];\r\n\t\t\tthis.sibling.nextSibling = this;\r\n\t\t}\r\n\r\n\t\t// if we managed to bind, we need to create children\r\n\t\tif ( this.model ) {\r\n\t\t\tthis.dirty = true;\r\n\t\t\tthis.update();\r\n\t\t} else if ( this.sectionType && this.sectionType === SECTION_UNLESS && ( !this.sibling || !this.sibling.isTruthy() ) ) {\r\n\t\t\tthis.fragment = new Fragment({\r\n\t\t\t\towner: this,\r\n\t\t\t\ttemplate: this.template.f\r\n\t\t\t}).bind();\r\n\t\t}\r\n\t}\r\n\r\n\tdetach () {\r\n\t\tconst frag = this.fragment || this.detached;\r\n\t\treturn frag ? frag.detach() : super.detach();\r\n\t}\r\n\r\n\tisTruthy () {\r\n\t\tif ( this.subordinate && this.sibling.isTruthy() ) return true;\r\n\t\tconst value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\r\n\t\treturn !!value && ( this.templateSectionType === SECTION_IF_WITH || !isEmpty( value ) );\r\n\t}\r\n\r\n\trebind ( next, previous, safe ) {\r\n\t\tif ( super.rebind( next, previous, safe ) ) {\r\n\t\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\r\n\t\t\t\tthis.fragment.rebind( next );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tthis.rendered = true;\r\n\t\tif ( this.fragment ) this.fragment.render( target, occupants );\r\n\t}\r\n\r\n\tshuffle ( newIndices ) {\r\n\t\tif ( this.fragment && this.sectionType === SECTION_EACH ) {\r\n\t\t\tthis.fragment.shuffle( newIndices );\r\n\t\t}\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tsuper.unbind();\r\n\t\tif ( this.fragment ) this.fragment.unbind();\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tif ( this.rendered && this.fragment ) this.fragment.unrender( shouldDestroy );\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( !this.dirty ) return;\r\n\r\n\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\r\n\t\t\tthis.fragment.context = this.model;\r\n\t\t}\r\n\r\n\t\tif ( !this.model && this.sectionType !== SECTION_UNLESS ) return;\r\n\r\n\t\tthis.dirty = false;\r\n\r\n\t\tconst value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\r\n\t\tconst siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\r\n\t\tconst lastType = this.sectionType;\r\n\r\n\t\t// watch for switching section types\r\n\t\tif ( this.sectionType === null || this.templateSectionType === null ) this.sectionType = getType( value, this.template.i );\r\n\t\tif ( lastType && lastType !== this.sectionType && this.fragment ) {\r\n\t\t\tif ( this.rendered ) {\r\n\t\t\t\tthis.fragment.unbind().unrender( true );\r\n\t\t\t}\r\n\r\n\t\t\tthis.fragment = null;\r\n\t\t}\r\n\r\n\t\tlet newFragment;\r\n\r\n\t\tconst fragmentShouldExist = this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\r\n\t\t                            this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\r\n\t\t                            ( siblingFalsey && ( this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy() ) ); // if, unless, and if-with depend on siblings and the condition\r\n\r\n\t\tif ( fragmentShouldExist ) {\r\n\t\t\tif ( !this.fragment ) this.fragment = this.detached;\r\n\r\n\t\t\tif ( this.fragment ) {\r\n\t\t\t\t// check for detached fragment\r\n\t\t\t\tif ( this.detached ) {\r\n\t\t\t\t\tattach( this, this.fragment );\r\n\t\t\t\t\tthis.detached = false;\r\n\t\t\t\t\tthis.rendered = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.fragment.update();\r\n\t\t\t} else {\r\n\t\t\t\tif ( this.sectionType === SECTION_EACH ) {\r\n\t\t\t\t\tnewFragment = new RepeatedFragment({\r\n\t\t\t\t\t\towner: this,\r\n\t\t\t\t\t\ttemplate: this.template.f,\r\n\t\t\t\t\t\tindexRef: this.template.i\r\n\t\t\t\t\t}).bind( this.model );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// only with and if-with provide context - if and unless do not\r\n\t\t\t\t\tconst context = this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ? this.model : null;\r\n\t\t\t\t\tnewFragment = new Fragment({\r\n\t\t\t\t\t\towner: this,\r\n\t\t\t\t\t\ttemplate: this.template.f\r\n\t\t\t\t\t}).bind( context );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif ( this.fragment && this.rendered ) {\r\n\t\t\t\tif ( keep !== true ) {\r\n\t\t\t\t\tthis.fragment.unbind().unrender( true );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.unrender( false );\r\n\t\t\t\t\tthis.detached = this.fragment;\r\n\t\t\t\t\trunloop.scheduleTask( () => this.detach() );\r\n\t\t\t\t}\r\n\t\t\t} else if ( this.fragment ) {\r\n\t\t\t\tthis.fragment.unbind();\r\n\t\t\t}\r\n\r\n\t\t\tthis.fragment = null;\r\n\t\t}\r\n\r\n\t\tif ( newFragment ) {\r\n\t\t\tif ( this.rendered ) {\r\n\t\t\t\tattach( this, newFragment );\r\n\t\t\t}\r\n\r\n\t\t\tthis.fragment = newFragment;\r\n\t\t}\r\n\r\n\t\tif ( this.nextSibling ) {\r\n\t\t\tthis.nextSibling.dirty = true;\r\n\t\t\tthis.nextSibling.update();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction attach ( section, fragment ) {\r\n\tconst anchor = section.parentFragment.findNextNode( section );\r\n\r\n\tif ( anchor ) {\r\n\t\tconst docFrag = createDocumentFragment();\r\n\t\tfragment.render( docFrag );\r\n\r\n\t\tanchor.parentNode.insertBefore( docFrag, anchor );\r\n\t} else {\r\n\t\tfragment.render( section.parentFragment.findParentNode() );\r\n\t}\r\n}\r\n","import { win, doc, vendors } from './environment';\r\n\r\nexport let visible;\r\nlet hidden = 'hidden';\r\n\r\nif ( doc ) {\r\n\tlet prefix;\r\n\r\n\tif ( hidden in doc ) {\r\n\t\tprefix = '';\r\n\t} else {\r\n\t\tlet i = vendors.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst vendor = vendors[i];\r\n\t\t\thidden = vendor + 'Hidden';\r\n\r\n\t\t\tif ( hidden in doc ) {\r\n\t\t\t\tprefix = vendor;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif ( prefix !== undefined ) {\r\n\t\tdoc.addEventListener( prefix + 'visibilitychange', onChange );\r\n\t\tonChange();\r\n\t} else {\r\n\t\t// gah, we're in an old browser\r\n\t\tif ( 'onfocusout' in doc ) {\r\n\t\t\tdoc.addEventListener( 'focusout', onHide );\r\n\t\t\tdoc.addEventListener( 'focusin', onShow );\r\n\t\t}\r\n\r\n\t\telse {\r\n\t\t\twin.addEventListener( 'pagehide', onHide );\r\n\t\t\twin.addEventListener( 'blur', onHide );\r\n\r\n\t\t\twin.addEventListener( 'pageshow', onShow );\r\n\t\t\twin.addEventListener( 'focus', onShow );\r\n\t\t}\r\n\r\n\t\tvisible = true; // until proven otherwise. Not ideal but hey\r\n\t}\r\n}\r\n\r\nfunction onChange () {\r\n\tvisible = !doc[ hidden ];\r\n}\r\n\r\nfunction onHide () {\r\n\tvisible = false;\r\n}\r\n\r\nfunction onShow () {\r\n\tvisible = true;\r\n}\r\n","export default function resetStyle ( node, style ) {\r\n\tif ( style ) {\r\n\t\tnode.setAttribute( 'style', style );\r\n\t} else {\r\n\t\t// Next line is necessary, to remove empty style attribute!\r\n\t\t// See http://stackoverflow.com/a/7167553\r\n\t\tnode.getAttribute( 'style' );\r\n\t\tnode.removeAttribute( 'style' );\r\n\t}\r\n}\r\n","import { win } from '../../../config/environment';\r\nimport { addToArray, removeFromArray } from '../../../utils/array';\r\nimport findElement from '../shared/findElement';\r\nimport prefix from './transitions/prefix';\r\nimport { warnOnceIfDebug } from '../../../utils/log';\r\nimport { missingPlugin } from '../../../config/errors';\r\nimport { findInViewHierarchy } from '../../../shared/registry';\r\nimport { visible } from '../../../config/visibility';\r\nimport createTransitions from './transitions/createTransitions';\r\nimport resetStyle from './transitions/resetStyle';\r\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\r\nimport noop from '../../../utils/noop';\r\n\r\nconst getComputedStyle = win && win.getComputedStyle;\r\nconst resolved = Promise.resolve();\r\n\r\nconst names = {\r\n\tt0: 'intro-outro',\r\n\tt1: 'intro',\r\n\tt2: 'outro'\r\n};\r\n\r\nexport default class Transition {\r\n\tconstructor ( options ) {\r\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\r\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\r\n\t\tthis.ractive = this.owner.ractive;\r\n\t\tthis.template = options.template;\r\n\t\tthis.parentFragment = options.parentFragment;\r\n\t\tthis.options = options;\r\n\t\tthis.onComplete = [];\r\n\t}\r\n\r\n\tanimateStyle ( style, value, options ) {\r\n\t\tif ( arguments.length === 4 ) {\r\n\t\t\tthrow new Error( 't.animateStyle() returns a promise - use .then() instead of passing a callback' );\r\n\t\t}\r\n\r\n\t\t// Special case - page isn't visible. Don't animate anything, because\r\n\t\t// that way you'll never get CSS transitionend events\r\n\t\tif ( !visible ) {\r\n\t\t\tthis.setStyle( style, value );\r\n\t\t\treturn resolved;\r\n\t\t}\r\n\r\n\t\tlet to;\r\n\r\n\t\tif ( typeof style === 'string' ) {\r\n\t\t\tto = {};\r\n\t\t\tto[ style ] = value;\r\n\t\t} else {\r\n\t\t\tto = style;\r\n\r\n\t\t\t// shuffle arguments\r\n\t\t\toptions = value;\r\n\t\t}\r\n\r\n\t\t// As of 0.3.9, transition authors should supply an `option` object with\r\n\t\t// `duration` and `easing` properties (and optional `delay`), plus a\r\n\t\t// callback function that gets called after the animation completes\r\n\r\n\t\t// TODO remove this check in a future version\r\n\t\tif ( !options ) {\r\n\t\t\twarnOnceIfDebug( 'The \"%s\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340', this.name );\r\n\t\t\toptions = this;\r\n\t\t}\r\n\r\n\t\treturn new Promise( fulfil => {\r\n\t\t\t// Edge case - if duration is zero, set style synchronously and complete\r\n\t\t\tif ( !options.duration ) {\r\n\t\t\t\tthis.setStyle( to );\r\n\t\t\t\tfulfil();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Get a list of the properties we're animating\r\n\t\t\tconst propertyNames = Object.keys( to );\r\n\t\t\tconst changedProperties = [];\r\n\r\n\t\t\t// Store the current styles\r\n\t\t\tconst computedStyle = getComputedStyle( this.node );\r\n\r\n\t\t\tlet i = propertyNames.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tconst prop = propertyNames[i];\r\n\t\t\t\tlet current = computedStyle[ prefix( prop ) ];\r\n\r\n\t\t\t\tif ( current === '0px' ) current = 0;\r\n\r\n\t\t\t\t// we need to know if we're actually changing anything\r\n\t\t\t\tif ( current != to[ prop ] ) { // use != instead of !==, so we can compare strings with numbers\r\n\t\t\t\t\tchangedProperties.push( prop );\r\n\r\n\t\t\t\t\t// make the computed style explicit, so we can animate where\r\n\t\t\t\t\t// e.g. height='auto'\r\n\t\t\t\t\tthis.node.style[ prefix( prop ) ] = current;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// If we're not actually changing anything, the transitionend event\r\n\t\t\t// will never fire! So we complete early\r\n\t\t\tif ( !changedProperties.length ) {\r\n\t\t\t\tfulfil();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcreateTransitions( this, to, options, changedProperties, fulfil );\r\n\t\t});\r\n\t}\r\n\r\n\tbind () {\r\n\t\tconst options = this.options;\r\n\t\tconst type = options.template && options.template.v;\r\n\t\tif ( type ) {\r\n\t\t\tif ( type === 't0' || type === 't1' ) this.element.intro = this;\r\n\t\t\tif ( type === 't0' || type === 't2' ) this.element.outro = this;\r\n\t\t\tthis.eventName = names[ type ];\r\n\t\t}\r\n\r\n\t\tconst ractive = this.owner.ractive;\r\n\r\n\t\tthis.name = options.name || options.template.n;\r\n\r\n\t\tif ( options.params ) {\r\n\t\t\tthis.params = options.params;\r\n\t\t}\r\n\r\n\t\tif ( typeof this.name === 'function' ) {\r\n\t\t\tthis._fn = this.name;\r\n\t\t\tthis.name = this._fn.name;\r\n\t\t} else {\r\n\t\t\tthis._fn = findInViewHierarchy( 'transitions', ractive, this.name );\r\n\t\t}\r\n\r\n\t\tif ( !this._fn ) {\r\n\t\t\twarnOnceIfDebug( missingPlugin( this.name, 'transition' ), { ractive });\r\n\t\t}\r\n\r\n\t\tsetupArgsFn( this, options.template );\r\n\t}\r\n\r\n\tgetParams () {\r\n\t\tif ( this.params ) return this.params;\r\n\r\n\t\t// get expression args if supplied\r\n\t\tif ( this.fn ) {\r\n\t\t\tconst values = resolveArgs( this, this.template, this.parentFragment ).map( model => {\r\n\t\t\t\tif ( !model ) return undefined;\r\n\r\n\t\t\t\treturn model.get();\r\n\t\t\t});\r\n\t\t\treturn this.fn.apply( this.ractive, values );\r\n\t\t}\r\n\t}\r\n\r\n\tgetStyle ( props ) {\r\n\t\tconst computedStyle = getComputedStyle( this.node );\r\n\r\n\t\tif ( typeof props === 'string' ) {\r\n\t\t\tconst value = computedStyle[ prefix( props ) ];\r\n\t\t\treturn value === '0px' ? 0 : value;\r\n\t\t}\r\n\r\n\t\tif ( !Array.isArray( props ) ) {\r\n\t\t\tthrow new Error( 'Transition$getStyle must be passed a string, or an array of strings representing CSS properties' );\r\n\t\t}\r\n\r\n\t\tconst styles = {};\r\n\r\n\t\tlet i = props.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst prop = props[i];\r\n\t\t\tlet value = computedStyle[ prefix( prop ) ];\r\n\r\n\t\t\tif ( value === '0px' ) value = 0;\r\n\t\t\tstyles[ prop ] = value;\r\n\t\t}\r\n\r\n\t\treturn styles;\r\n\t}\r\n\r\n\tprocessParams ( params, defaults ) {\r\n\t\tif ( typeof params === 'number' ) {\r\n\t\t\tparams = { duration: params };\r\n\t\t}\r\n\r\n\t\telse if ( typeof params === 'string' ) {\r\n\t\t\tif ( params === 'slow' ) {\r\n\t\t\t\tparams = { duration: 600 };\r\n\t\t\t} else if ( params === 'fast' ) {\r\n\t\t\t\tparams = { duration: 200 };\r\n\t\t\t} else {\r\n\t\t\t\tparams = { duration: 400 };\r\n\t\t\t}\r\n\t\t} else if ( !params ) {\r\n\t\t\tparams = {};\r\n\t\t}\r\n\r\n\t\treturn Object.assign( {}, defaults, params );\r\n\t}\r\n\r\n\tregisterCompleteHandler ( fn ) {\r\n\t\taddToArray( this.onComplete, fn );\r\n\t}\r\n\r\n\tsetStyle ( style, value ) {\r\n\t\tif ( typeof style === 'string' ) {\r\n\t\t\tthis.node.style[ prefix( style ) ] = value;\r\n\t\t}\r\n\r\n\t\telse {\r\n\t\t\tlet prop;\r\n\t\t\tfor ( prop in style ) {\r\n\t\t\t\tif ( style.hasOwnProperty( prop ) ) {\r\n\t\t\t\t\tthis.node.style[ prefix( prop ) ] = style[ prop ];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tshouldFire ( type ) {\r\n\t\tif ( !this.ractive.transitionsEnabled ) return false;\r\n\r\n\t\t// check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\r\n\t\tif ( type === 'intro' && this.ractive.rendering && nearestProp( 'noIntro', this.ractive, true ) ) return false;\r\n\t\tif ( type === 'outro' && this.ractive.unrendering && nearestProp( 'noOutro', this.ractive, false ) ) return false;\r\n\r\n\t\tconst params = this.getParams(); // this is an array, the params object should be the first member\r\n\t\t// if there's not a parent element, this can't be nested, so roll on\r\n\t\tif ( !this.element.parent ) return true;\r\n\r\n\t\t// if there is a local param, it takes precedent\r\n\t\tif ( params && params[0] && 'nested' in params[0] ) {\r\n\t\t\tif ( params[0].nested !== false ) return true;\r\n\t\t} else { // use the nearest instance setting\r\n\t\t\t// find the nearest instance that actually has a nested setting\r\n\t\t\tif ( nearestProp( 'nestedTransitions', this.ractive ) !== false ) return true;\r\n\t\t}\r\n\r\n\t\t// check to see if this is actually a nested transition\r\n\t\tlet el = this.element.parent;\r\n\t\twhile ( el ) {\r\n\t\t\tif ( el[type] && el[type].starting ) return false;\r\n\t\t\tel = el.parent;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tstart () {\r\n\t\tconst node = this.node = this.element.node;\r\n\t\tconst originalStyle = node.getAttribute( 'style' );\r\n\r\n\t\tlet completed;\r\n\t\tconst args = this.getParams();\r\n\r\n\t\t// create t.complete() - we don't want this on the prototype,\r\n\t\t// because we don't want `this` silliness when passing it as\r\n\t\t// an argument\r\n\t\tthis.complete = noReset => {\r\n\t\t\tthis.starting = false;\r\n\t\t\tif ( completed ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.onComplete.forEach( fn => fn() );\r\n\t\t\tif ( !noReset && this.isIntro ) {\r\n\t\t\t\tresetStyle( node, originalStyle);\r\n\t\t\t}\r\n\r\n\t\t\tthis._manager.remove( this );\r\n\r\n\t\t\tcompleted = true;\r\n\t\t};\r\n\r\n\t\t// If the transition function doesn't exist, abort\r\n\t\tif ( !this._fn ) {\r\n\t\t\tthis.complete();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst promise = this._fn.apply( this.ractive, [ this ].concat( args ) );\r\n\t\tif ( promise ) promise.then( this.complete );\r\n\t}\r\n\r\n\ttoString () { return ''; }\r\n\r\n\tunbind () {\r\n\t\tif ( !this.element.attributes.unbinding ) {\r\n\t\t\tconst type = this.options && this.options.template && this.options.template.v;\r\n\t\t\tif ( type === 't0' || type === 't1' ) this.element.intro = null;\r\n\t\t\tif ( type === 't0' || type === 't2' ) this.element.outro = null;\r\n\t\t}\r\n\t}\r\n\r\n\tunregisterCompleteHandler ( fn ) {\r\n\t\tremoveFromArray( this.onComplete, fn );\r\n\t}\r\n}\r\n\r\nconst proto = Transition.prototype;\r\nproto.destroyed = proto.render = proto.unrender = proto.update = noop;\r\n\r\nfunction nearestProp ( prop, ractive, rendering ) {\r\n\tlet instance = ractive;\r\n\twhile ( instance ) {\r\n\t\tif ( instance.hasOwnProperty( prop ) && ( rendering === undefined || rendering ? instance.rendering : instance.unrendering ) ) return instance[ prop ];\r\n\t\tinstance = instance.component && instance.component.ractive;\r\n\t}\r\n\r\n\treturn ractive[ prop ];\r\n}\r\n","import { svg } from '../../../config/namespaces';\r\nimport { createElement } from '../../../utils/dom';\r\n\r\nconst elementCache = {};\r\n\r\nlet ieBug;\r\nlet ieBlacklist;\r\n\r\ntry {\r\n\tcreateElement( 'table' ).innerHTML = 'foo';\r\n} catch ( err ) {\r\n\tieBug = true;\r\n\r\n\tieBlacklist = {\r\n\t\tTABLE:  [ '<table class=\"x\">', '</table>' ],\r\n\t\tTHEAD:  [ '<table><thead class=\"x\">', '</thead></table>' ],\r\n\t\tTBODY:  [ '<table><tbody class=\"x\">', '</tbody></table>' ],\r\n\t\tTR:     [ '<table><tr class=\"x\">', '</tr></table>' ],\r\n\t\tSELECT: [ '<select class=\"x\">', '</select>' ]\r\n\t};\r\n}\r\n\r\nexport default function ( html, node ) {\r\n\tconst nodes = [];\r\n\r\n\t// render 0 and false\r\n\tif ( html == null || html === '' ) return nodes;\r\n\r\n\tlet container;\r\n\tlet wrapper;\r\n\tlet selectedOption;\r\n\r\n\tif ( ieBug && ( wrapper = ieBlacklist[ node.tagName ] ) ) {\r\n\t\tcontainer = element( 'DIV' );\r\n\t\tcontainer.innerHTML = wrapper[0] + html + wrapper[1];\r\n\t\tcontainer = container.querySelector( '.x' );\r\n\r\n\t\tif ( container.tagName === 'SELECT' ) {\r\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\r\n\t\t}\r\n\t}\r\n\r\n\telse if ( node.namespaceURI === svg ) {\r\n\t\tcontainer = element( 'DIV' );\r\n\t\tcontainer.innerHTML = '<svg class=\"x\">' + html + '</svg>';\r\n\t\tcontainer = container.querySelector( '.x' );\r\n\t}\r\n\r\n\telse if ( node.tagName === 'TEXTAREA' ) {\r\n\t\tcontainer = createElement( 'div' );\r\n\r\n\t\tif ( typeof container.textContent !== 'undefined' ) {\r\n\t\t\tcontainer.textContent = html;\r\n\t\t} else {\r\n\t\t\tcontainer.innerHTML = html;\r\n\t\t}\r\n\t}\r\n\r\n\telse {\r\n\t\tcontainer = element( node.tagName );\r\n\t\tcontainer.innerHTML = html;\r\n\r\n\t\tif ( container.tagName === 'SELECT' ) {\r\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\r\n\t\t}\r\n\t}\r\n\r\n\tlet child;\r\n\twhile ( child = container.firstChild ) {\r\n\t\tnodes.push( child );\r\n\t\tcontainer.removeChild( child );\r\n\t}\r\n\r\n\t// This is really annoying. Extracting <option> nodes from the\r\n\t// temporary container <select> causes the remaining ones to\r\n\t// become selected. So now we have to deselect them. IE8, you\r\n\t// amaze me. You really do\r\n\t// ...and now Chrome too\r\n\tlet i;\r\n\tif ( node.tagName === 'SELECT' ) {\r\n\t\ti = nodes.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tif ( nodes[i] !== selectedOption ) {\r\n\t\t\t\tnodes[i].selected = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn nodes;\r\n}\r\n\r\nfunction element ( tagName ) {\r\n\treturn elementCache[ tagName ] || ( elementCache[ tagName ] = createElement( tagName ) );\r\n}\r\n","import { noRegistryFunctionReturn } from '../../../config/errors';\r\nimport { warnIfDebug } from '../../../utils/log';\r\nimport { findInstance } from '../../../shared/registry';\r\n\r\n// finds the component constructor in the registry or view hierarchy registries\r\nexport default function getComponentConstructor ( ractive, name ) {\r\n\tconst instance = findInstance( 'components', ractive, name );\r\n\tlet Component;\r\n\r\n\tif ( instance ) {\r\n\t\tComponent = instance.components[ name ];\r\n\r\n\t\t// best test we have for not Ractive.extend\r\n\t\tif ( Component && !Component._Parent ) {\r\n\t\t\t// function option, execute and store for reset\r\n\t\t\tconst fn = Component.bind( instance );\r\n\t\t\tfn.isOwner = instance.components.hasOwnProperty( name );\r\n\t\t\tComponent = fn();\r\n\r\n\t\t\tif ( !Component ) {\r\n\t\t\t\twarnIfDebug( noRegistryFunctionReturn, name, 'component', 'component', { ractive });\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( typeof Component === 'string' ) {\r\n\t\t\t\t// allow string lookup\r\n\t\t\t\tComponent = getComponentConstructor( ractive, Component );\r\n\t\t\t}\r\n\r\n\t\t\tComponent._fn = fn;\r\n\t\t\tinstance.components[ name ] = Component;\r\n\t\t}\r\n\t}\r\n\r\n\treturn Component;\r\n}\r\n","import { ALIAS, ANCHOR, COMPONENT, DOCTYPE, ELEMENT, INTERPOLATOR, PARTIAL, SECTION, TRIPLE, YIELDER } from '../../config/types';\r\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from '../../config/types';\r\nimport Alias from './Alias';\r\nimport Attribute from './element/Attribute';\r\nimport BindingFlag from './element/BindingFlag';\r\nimport Component from './Component';\r\nimport Decorator from './element/Decorator';\r\nimport Doctype from './Doctype';\r\nimport Form from './element/specials/Form';\r\nimport Element from './Element';\r\nimport EventDirective from './shared/EventDirective';\r\nimport Interpolator from './Interpolator';\r\nimport Input from './element/specials/Input';\r\nimport Mapping from './component/Mapping';\r\nimport Option from './element/specials/Option';\r\nimport Partial from './Partial';\r\nimport Section from './Section';\r\nimport Select from './element/specials/Select';\r\nimport Textarea from './element/specials/Textarea';\r\nimport Text from './Text';\r\nimport Transition from './element/Transition';\r\nimport Triple from './Triple';\r\n//import Yielder from './Yielder';\r\nimport getComponentConstructor from './component/getComponentConstructor';\r\nimport findElement from './shared/findElement';\r\n\r\nconst constructors = {};\r\nconstructors[ ALIAS ] = Alias;\r\nconstructors[ ANCHOR ] = Component;\r\nconstructors[ DOCTYPE ] = Doctype;\r\nconstructors[ INTERPOLATOR ] = Interpolator;\r\nconstructors[ PARTIAL ] = Partial;\r\nconstructors[ SECTION ] = Section;\r\nconstructors[ TRIPLE ] = Triple;\r\nconstructors[ YIELDER ] = Partial;\r\n\r\nconstructors[ ATTRIBUTE ] = Attribute;\r\nconstructors[ BINDING_FLAG ] = BindingFlag;\r\nconstructors[ DECORATOR ] = Decorator;\r\nconstructors[ EVENT ] = EventDirective;\r\nconstructors[ TRANSITION ] = Transition;\r\n\r\nconst specialElements = {\r\n\tdoctype: Doctype,\r\n\tform: Form,\r\n\tinput: Input,\r\n\toption: Option,\r\n\tselect: Select,\r\n\ttextarea: Textarea\r\n};\r\n\r\nexport default function createItem ( options ) {\r\n\tif ( typeof options.template === 'string' ) {\r\n\t\treturn new Text( options );\r\n\t}\r\n\r\n\tif ( options.template.t === ELEMENT ) {\r\n\t\t// could be component or element\r\n\t\tconst ComponentConstructor = getComponentConstructor( options.parentFragment.ractive, options.template.e );\r\n\t\tif ( ComponentConstructor ) {\r\n\t\t\treturn new Component( options, ComponentConstructor );\r\n\t\t}\r\n\r\n\t\tconst tagName = options.template.e.toLowerCase();\r\n\r\n\t\tconst ElementConstructor = specialElements[ tagName ] || Element;\r\n\t\treturn new ElementConstructor( options );\r\n\t}\r\n\r\n\tlet Item;\r\n\r\n\t// component mappings are a special case of attribute\r\n\tif ( options.template.t === ATTRIBUTE ) {\r\n\t\tlet el = options.owner;\r\n\t\tif ( !el || ( el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT ) ) {\r\n\t\t\tel = findElement( options.parentFragment );\r\n\t\t}\r\n\t\toptions.element = el;\r\n\r\n\t\tItem = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\r\n\t} else {\r\n\t\tItem = constructors[ options.template.t ];\r\n\t}\r\n\r\n\tif ( !Item ) throw new Error( `Unrecognised item type ${options.template.t}` );\r\n\r\n\treturn new Item( options );\r\n}\r\n","import { TEXT } from '../../config/types';\r\n\r\n// TODO all this code needs to die\r\nexport default function processItems ( items, values, guid, counter = 0 ) {\r\n\treturn items.map( item => {\r\n\t\tif ( item.type === TEXT ) {\r\n\t\t\treturn item.template;\r\n\t\t}\r\n\r\n\t\tif ( item.fragment ) {\r\n\t\t\tif ( item.fragment.iterations ) {\r\n\t\t\t\treturn item.fragment.iterations.map( fragment => {\r\n\t\t\t\t\treturn processItems( fragment.items, values, guid, counter );\r\n\t\t\t\t}).join( '' );\r\n\t\t\t} else {\r\n\t\t\t\treturn processItems( item.fragment.items, values, guid, counter );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst placeholderId = `${guid}-${counter++}`;\r\n\t\tconst model = item.model || item.newModel;\r\n\r\n\t\tvalues[ placeholderId ] = model ?\r\n\t\t\tmodel.wrapper ?\r\n\t\t\t\tmodel.wrapperValue :\r\n\t\t\t\tmodel.get() :\r\n\t\t\tundefined;\r\n\r\n\t\treturn '${' + placeholderId + '}';\r\n\t}).join( '' );\r\n}\r\n","import { ELEMENT, YIELDER } from '../config/types';\r\nimport runloop from '../global/runloop';\r\nimport createItem from './items/createItem';\r\nimport { bind, destroyed, shuffled, toEscapedString, toString, unbind, unrender, update } from '../shared/methodCallers';\r\nimport processItems from './helpers/processItems';\r\nimport parseJSON from '../utils/parseJSON';\r\nimport { createDocumentFragment } from '../utils/dom';\r\nimport { findMap } from '../utils/array';\r\nimport { getContext } from '../shared/getRactiveContext';\r\n\r\nfunction unrenderAndDestroy ( item ) {\r\n\titem.unrender( true );\r\n}\r\n\r\nexport default class Fragment {\r\n\tconstructor ( options ) {\r\n\t\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\r\n\r\n\t\tthis.isRoot = !options.owner.parentFragment;\r\n\t\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\r\n\t\tthis.ractive = options.ractive || ( this.isRoot ? options.owner : this.parent.ractive );\r\n\r\n\t\tthis.componentParent = ( this.isRoot && this.ractive.component ) ? this.ractive.component.parentFragment : null;\r\n\t\tthis.delegate = ( this.parent ? this.parent.delegate : ( this.componentParent && this.componentParent.delegate ) ) ||\r\n\t\t\t( this.owner.containerFragment && this.owner.containerFragment.delegate );\r\n\r\n\t\tthis.context = null;\r\n\t\tthis.rendered = false;\r\n\r\n\t\t// encapsulated styles should be inherited until they get applied by an element\r\n\t\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\r\n\r\n\t\tthis.dirty = false;\r\n\t\tthis.dirtyValue = true; // used for attribute values\r\n\r\n\t\tthis.template = options.template || [];\r\n\t\tthis.createItems();\r\n\t}\r\n\r\n\tbind ( context ) {\r\n\t\tthis.context = context;\r\n\t\tthis.items.forEach( bind );\r\n\t\tthis.bound = true;\r\n\r\n\t\t// in rare cases, a forced resolution (or similar) will cause the\r\n\t\t// fragment to be dirty before it's even finished binding. In those\r\n\t\t// cases we update immediately\r\n\t\tif ( this.dirty ) this.update();\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tthis.dirtyValue = true;\r\n\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.dirty = true;\r\n\r\n\t\t\tif ( this.isRoot ) { // TODO encapsulate 'is component root, but not overall root' check?\r\n\t\t\t\tif ( this.ractive.component ) {\r\n\t\t\t\t\tthis.ractive.component.bubble();\r\n\t\t\t\t} else if ( this.bound ) {\r\n\t\t\t\t\trunloop.addFragment( this );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.owner.bubble( this.index );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcreateItems () {\r\n\t\t// this is a hot code path\r\n\t\tconst max = this.template.length;\r\n\t\tthis.items = [];\r\n\t\tfor ( let i = 0; i < max; i++ ) {\r\n\t\t\tthis.items[i] = createItem({ parentFragment: this, template: this.template[i], index: i });\r\n\t\t}\r\n\t}\r\n\r\n\tdestroyed () {\r\n\t\tthis.items.forEach( destroyed );\r\n\t}\r\n\r\n\tdetach () {\r\n\t\tconst docFrag = createDocumentFragment();\r\n\t\tconst xs = this.items;\r\n\t\tconst len = xs.length;\r\n\t\tfor ( let i = 0; i < len; i++ ) {\r\n\t\t\tdocFrag.appendChild( xs[i].detach() );\r\n\t\t}\r\n\t\treturn docFrag;\r\n\t}\r\n\r\n\tfind ( selector, options ) {\r\n\t\treturn findMap( this.items, i => i.find( selector, options ) );\r\n\t}\r\n\r\n\tfindAll ( selector, options ) {\r\n\t\tif ( this.items ) {\r\n\t\t\tthis.items.forEach( i => i.findAll && i.findAll( selector, options ) );\r\n\t\t}\r\n\t}\r\n\r\n\tfindComponent ( name, options ) {\r\n\t\treturn findMap( this.items, i => i.findComponent( name, options ) );\r\n\t}\r\n\r\n\tfindAllComponents ( name, options ) {\r\n\t\tif ( this.items ) {\r\n\t\t\tthis.items.forEach( i => i.findAllComponents && i.findAllComponents( name, options ) );\r\n\t\t}\r\n\t}\r\n\r\n\tfindContext () {\r\n\t\tlet fragment = this;\r\n\t\twhile ( fragment && !fragment.context ) fragment = fragment.parent;\r\n\t\tif ( !fragment ) return this.ractive.viewmodel;\r\n\t\telse return fragment.context;\r\n\t}\r\n\r\n\tfindNextNode ( item ) {\r\n\t\t// search for the next node going forward\r\n\t\tif ( item ) {\r\n\t\t\tfor ( let i = item.index + 1; i < this.items.length; i++ ) {\r\n\t\t\t\tif ( !this.items[ i ] ) continue;\r\n\r\n\t\t\t\tconst node = this.items[ i ].firstNode( true );\r\n\t\t\t\tif ( node ) return node;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// if this is the root fragment, and there are no more items,\r\n\t\t// it means we're at the end...\r\n\t\tif ( this.isRoot ) {\r\n\t\t\tif ( this.ractive.component ) {\r\n\t\t\t\treturn this.ractive.component.parentFragment.findNextNode( this.ractive.component );\r\n\t\t\t}\r\n\r\n\t\t\t// TODO possible edge case with other content\r\n\t\t\t// appended to this.ractive.el?\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif ( this.parent ) return this.owner.findNextNode( this ); // the argument is in case the parent is a RepeatedFragment\r\n\t}\r\n\r\n\tfindParentNode () {\r\n\t\tlet fragment = this;\r\n\r\n\t\tdo {\r\n\t\t\tif ( fragment.owner.type === ELEMENT ) {\r\n\t\t\t\treturn fragment.owner.node;\r\n\t\t\t}\r\n\r\n\t\t\tif ( fragment.isRoot && !fragment.ractive.component ) { // TODO encapsulate check\r\n\t\t\t\treturn fragment.ractive.el;\r\n\t\t\t}\r\n\r\n\t\t\tif ( fragment.owner.type === YIELDER ) {\r\n\t\t\t\tfragment = fragment.owner.containerFragment;\r\n\t\t\t} else {\r\n\t\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\r\n\t\t\t}\r\n\t\t} while ( fragment );\r\n\r\n\t\tthrow new Error( 'Could not find parent node' ); // TODO link to issue tracker\r\n\t}\r\n\r\n\tfindRepeatingFragment () {\r\n\t\tlet fragment = this;\r\n\t\t// TODO better check than fragment.parent.iterations\r\n\t\twhile ( ( fragment.parent || fragment.componentParent ) && !fragment.isIteration ) {\r\n\t\t\tfragment = fragment.parent || fragment.componentParent;\r\n\t\t}\r\n\r\n\t\treturn fragment;\r\n\t}\r\n\r\n\tfirstNode ( skipParent ) {\r\n\t\tconst node = findMap( this.items, i => i.firstNode( true ) );\r\n\t\tif ( node ) return node;\r\n\t\tif ( skipParent ) return null;\r\n\r\n\t\treturn this.parent.findNextNode( this.owner );\r\n\t}\r\n\r\n\trebind ( next ) {\r\n\t\tthis.context = next;\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tif ( this.rendered ) throw new Error( 'Fragment is already rendered!' );\r\n\t\tthis.rendered = true;\r\n\r\n\t\tconst xs = this.items;\r\n\t\tconst len = xs.length;\r\n\t\tfor ( let i = 0; i < len; i++ ) {\r\n\t\t\txs[i].render( target, occupants );\r\n\t\t}\r\n\t}\r\n\r\n\tresetTemplate ( template ) {\r\n\t\tconst wasBound = this.bound;\r\n\t\tconst wasRendered = this.rendered;\r\n\r\n\t\t// TODO ensure transitions are disabled globally during reset\r\n\r\n\t\tif ( wasBound ) {\r\n\t\t\tif ( wasRendered ) this.unrender( true );\r\n\t\t\tthis.unbind();\r\n\t\t}\r\n\r\n\t\tthis.template = template;\r\n\t\tthis.createItems();\r\n\r\n\t\tif ( wasBound ) {\r\n\t\t\tthis.bind( this.context );\r\n\r\n\t\t\tif ( wasRendered ) {\r\n\t\t\t\tconst parentNode = this.findParentNode();\r\n\t\t\t\tconst anchor = this.findNextNode();\r\n\r\n\t\t\t\tif ( anchor ) {\r\n\t\t\t\t\tconst docFrag = createDocumentFragment();\r\n\t\t\t\t\tthis.render( docFrag );\r\n\t\t\t\t\tparentNode.insertBefore( docFrag, anchor );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.render( parentNode );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tshuffled () {\r\n\t\tthis.items.forEach( shuffled );\r\n\t}\r\n\r\n\ttoString ( escape ) {\r\n\t\treturn this.items.map( escape ? toEscapedString : toString ).join( '' );\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tthis.context = null;\r\n\t\tthis.items.forEach( unbind );\r\n\t\tthis.bound = false;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tthis.items.forEach( shouldDestroy ? unrenderAndDestroy : unrender );\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tif ( !this.updating ) {\r\n\t\t\t\tthis.dirty = false;\r\n\t\t\t\tthis.updating = true;\r\n\t\t\t\tthis.items.forEach( update );\r\n\t\t\t\tthis.updating = false;\r\n\t\t\t} else if ( this.isRoot ) {\r\n\t\t\t\trunloop.addFragmentToRoot( this );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tvalueOf () {\r\n\t\tif ( this.items.length === 1 ) {\r\n\t\t\treturn this.items[0].valueOf();\r\n\t\t}\r\n\r\n\t\tif ( this.dirtyValue ) {\r\n\t\t\tconst values = {};\r\n\t\t\tconst source = processItems( this.items, values, this.ractive._guid );\r\n\t\t\tconst parsed = parseJSON( source, values );\r\n\r\n\t\t\tthis.value = parsed ?\r\n\t\t\t\tparsed.value :\r\n\t\t\t\tthis.toString();\r\n\r\n\t\t\tthis.dirtyValue = false;\r\n\t\t}\r\n\r\n\t\treturn this.value;\r\n\t}\r\n}\r\nFragment.prototype.getContext = getContext;\r\n","import Hook from './Hook';\r\n\r\nfunction getChildQueue ( queue, ractive ) {\r\n\treturn queue[ ractive._guid ] || ( queue[ ractive._guid ] = [] );\r\n}\r\n\r\nfunction fire ( hookQueue, ractive ) {\r\n\tconst childQueue = getChildQueue( hookQueue.queue, ractive );\r\n\r\n\thookQueue.hook.fire( ractive );\r\n\r\n\t// queue is \"live\" because components can end up being\r\n\t// added while hooks fire on parents that modify data values.\r\n\twhile ( childQueue.length ) {\r\n\t\tfire( hookQueue, childQueue.shift() );\r\n\t}\r\n\r\n\tdelete hookQueue.queue[ ractive._guid ];\r\n}\r\n\r\nexport default class HookQueue {\r\n\tconstructor ( event ) {\r\n\t\tthis.hook = new Hook( event );\r\n\t\tthis.inProcess = {};\r\n\t\tthis.queue = {};\r\n\t}\r\n\r\n\tbegin ( ractive ) {\r\n\t\tthis.inProcess[ ractive._guid ] = true;\r\n\t}\r\n\r\n\tend ( ractive ) {\r\n\t\tconst parent = ractive.parent;\r\n\r\n\t\t// If this is *isn't* a child of a component that's in process,\r\n\t\t// it should call methods or fire at this point\r\n\t\tif ( !parent || !this.inProcess[ parent._guid ] ) {\r\n\t\t\tfire( this, ractive );\r\n\t\t}\r\n\t\t// elsewise, handoff to parent to fire when ready\r\n\t\telse {\r\n\t\t\tgetChildQueue( this.queue, parent ).push( ractive );\r\n\t\t}\r\n\r\n\t\tdelete this.inProcess[ ractive._guid ];\r\n\t}\r\n}\r\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from '../utils/log';\r\nimport { getElement } from '../utils/dom';\r\nimport { toPairs } from '../utils/object';\r\nimport config from './config/config';\r\nimport Fragment from '../view/Fragment';\r\nimport Hook from '../events/Hook';\r\nimport HookQueue from '../events/HookQueue';\r\nimport Ractive from '../Ractive';\r\n\r\nconst configHook = new Hook( 'config' );\r\nconst initHook = new HookQueue( 'init' );\r\n\r\nexport default function initialise ( ractive, userOptions, options ) {\r\n\tObject.keys( ractive.viewmodel.computations ).forEach( key => {\r\n\t\tconst computation = ractive.viewmodel.computations[ key ];\r\n\r\n\t\tif ( ractive.viewmodel.value.hasOwnProperty( key ) ) {\r\n\t\t\tcomputation.set( ractive.viewmodel.value[ key ] );\r\n\t\t}\r\n\t});\r\n\r\n\t// set up event subscribers\r\n\tsubscribe( ractive, userOptions, 'on' );\r\n\r\n\t// init config from Parent and options\r\n\tconfig.init( ractive.constructor, ractive, userOptions );\r\n\r\n\tconfigHook.fire( ractive );\r\n\r\n\t// general config done, set up observers\r\n\tsubscribe( ractive, userOptions, 'observe' );\r\n\r\n\tinitHook.begin( ractive );\r\n\r\n\tconst fragment = ractive.fragment = createFragment( ractive, options );\r\n\tif ( fragment ) fragment.bind( ractive.viewmodel );\r\n\r\n\tinitHook.end( ractive );\r\n\r\n\tif ( fragment ) {\r\n\t\t// render automatically ( if `el` is specified )\r\n\t\tconst el = getElement( ractive.el || ractive.target );\r\n\t\tif ( el ) {\r\n\t\t\tconst promise = ractive.render( el, ractive.append );\r\n\r\n\t\t\tif ( Ractive.DEBUG_PROMISES ) {\r\n\t\t\t\tpromise.catch( err => {\r\n\t\t\t\t\twarnOnceIfDebug( 'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;' );\r\n\t\t\t\t\twarnIfDebug( 'An error happened during rendering', { ractive });\r\n\t\t\t\t\tlogIfDebug( err );\r\n\r\n\t\t\t\t\tthrow err;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function createFragment ( ractive, options = {} ) {\r\n\tif ( ractive.template ) {\r\n\t\tlet cssIds;\r\n\r\n\t\tif ( options.cssIds || ractive.cssId ) {\r\n\t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\r\n\r\n\t\t\tif ( ractive.cssId ) {\r\n\t\t\t\tcssIds.push( ractive.cssId );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Fragment({\r\n\t\t\towner: ractive,\r\n\t\t\ttemplate: ractive.template,\r\n\t\t\tcssIds\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction subscribe ( instance, options, type ) {\r\n\tconst subs = ( instance.constructor[ `_${type}` ] || [] ).concat( toPairs( options[ type ] || [] ) );\r\n\tconst single = type === 'on' ? 'once' : `${type}Once`;\r\n\r\n\tsubs.forEach( ([ target, config ]) => {\r\n\t\tif ( typeof config === 'function' ) {\r\n\t\t\tinstance[type]( target, config );\r\n\t\t} else if ( typeof config === 'object' && typeof config.handler === 'function' ) {\r\n\t\t\tinstance[ config.once ? single : type ]( target, config.handler, config );\r\n\t\t}\r\n\t});\r\n}\r\n","import { doc } from '../config/environment';\nimport { applyCSS } from '../global/css';\nimport Hook from '../events/Hook';\nimport { getElement } from '../utils/dom';\nimport runloop from '../global/runloop';\nimport { createFragment } from './initialise';\n\nconst renderHook = new Hook( 'render' );\nconst completeHook = new Hook( 'complete' );\n\nexport default function render ( ractive, target, anchor, occupants ) {\n\t// set a flag to let any transitions know that this instance is currently rendering\n\tractive.rendering = true;\n\n\tconst promise = runloop.start( ractive, true );\n\trunloop.scheduleTask( () => renderHook.fire( ractive ), true );\n\n\tif ( ractive.fragment.rendered ) {\n\t\tthrow new Error( 'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first' );\n\t}\n\n\tif ( ractive.destroyed ) {\n\t\tractive.destroyed = false;\n\t\tractive.fragment = createFragment( ractive ).bind( ractive.viewmodel );\n\t}\n\n\tanchor = getElement( anchor ) || ractive.anchor;\n\n\tractive.el = ractive.target = target;\n\tractive.anchor = anchor;\n\n\t// ensure encapsulated CSS is up-to-date\n\tif ( ractive.cssId ) applyCSS();\n\n\tif ( target ) {\n\t\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( ractive );\n\n\t\tif ( anchor ) {\n\t\t\tconst docFrag = doc.createDocumentFragment();\n\t\t\tractive.fragment.render( docFrag );\n\t\t\ttarget.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\tractive.fragment.render( target, occupants );\n\t\t}\n\t}\n\n\trunloop.end();\n\tractive.rendering = false;\n\n\treturn promise.then( () => {\n\t\tif (!ractive.torndown) {\n\t\t\tcompleteHook.fire( ractive );\n\t\t}\n\t});\n}\n","import { getElement } from '../../utils/dom';\r\nimport { toArray } from '../../utils/array';\r\nimport render from '../render';\r\nimport { teardown } from '../../shared/methodCallers';\r\nimport { warnIfDebug } from '../../utils/log';\r\n\r\nexport default function Ractive$render ( target, anchor ) {\r\n\tif ( this.torndown ) {\r\n\t\twarnIfDebug( 'ractive.render() was called on a Ractive instance that was already torn down' );\r\n\t\treturn Promise.resolve();\r\n\t}\r\n\r\n\ttarget = getElement( target ) || this.el;\r\n\r\n\tif ( !this.append && target ) {\r\n\t\t// Teardown any existing instances *before* trying to set up the new one -\r\n\t\t// avoids certain weird bugs\r\n\t\tconst others = target.__ractive_instances__;\r\n\t\tif ( others ) others.forEach( teardown );\r\n\r\n\t\t// make sure we are the only occupants\r\n\t\tif ( !this.enhance ) {\r\n\t\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\r\n\t\t}\r\n\t}\r\n\r\n\tconst occupants = this.enhance ? toArray( target.childNodes ) : null;\r\n\tconst promise = render( this, target, anchor, occupants );\r\n\r\n\tif ( occupants ) {\r\n\t\twhile ( occupants.length ) target.removeChild( occupants.pop() );\r\n\t}\r\n\r\n\treturn promise;\r\n}\r\n","import config from '../config/config';\r\nimport Hook from '../../events/Hook';\r\nimport runloop from '../../global/runloop';\r\nimport dataConfigurator from '../config/custom/data';\r\n\r\nconst shouldRerender = [ 'template', 'partials', 'components', 'decorators', 'events' ];\r\n\r\nconst completeHook = new Hook( 'complete' );\r\nconst resetHook = new Hook( 'reset' );\r\nconst renderHook = new Hook( 'render' );\r\nconst unrenderHook = new Hook( 'unrender' );\r\n\r\nexport default function Ractive$reset ( data ) {\r\n\tdata = data || {};\r\n\r\n\tif ( typeof data !== 'object' ) {\r\n\t\tthrow new Error( 'The reset method takes either no arguments, or an object containing new data' );\r\n\t}\r\n\r\n\t// TEMP need to tidy this up\r\n\tdata = dataConfigurator.init( this.constructor, this, { data });\r\n\r\n\tconst promise = runloop.start( this, true );\r\n\r\n\t// If the root object is wrapped, try and use the wrapper's reset value\r\n\tconst wrapper = this.viewmodel.wrapper;\r\n\tif ( wrapper && wrapper.reset ) {\r\n\t\tif ( wrapper.reset( data ) === false ) {\r\n\t\t\t// reset was rejected, we need to replace the object\r\n\t\t\tthis.viewmodel.set( data );\r\n\t\t}\r\n\t} else {\r\n\t\tthis.viewmodel.set( data );\r\n\t}\r\n\r\n\t// reset config items and track if need to rerender\r\n\tconst changes = config.reset( this );\r\n\tlet rerender;\r\n\r\n\tlet i = changes.length;\r\n\twhile ( i-- ) {\r\n\t\tif ( shouldRerender.indexOf( changes[i] ) > -1 ) {\r\n\t\t\trerender = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( rerender ) {\r\n\t\tunrenderHook.fire( this );\r\n\t\tthis.fragment.resetTemplate( this.template );\r\n\t\trenderHook.fire( this );\r\n\t\tcompleteHook.fire( this );\r\n\t}\r\n\r\n\trunloop.end();\r\n\r\n\tresetHook.fire( this, data );\r\n\r\n\treturn promise;\r\n}\r\n","import runloop from '../../global/runloop';\r\nimport { PARTIAL, COMPONENT, ELEMENT } from '../../config/types';\r\n\r\nfunction collect( source, name, attr, dest ) {\r\n\tsource.forEach( item => {\r\n\t\t// queue to rerender if the item is a partial and the current name matches\r\n\t\tif ( item.type === PARTIAL && ( item.refName ===  name || item.name === name ) ) {\r\n\t\t\titem.inAttribute = attr;\r\n\t\t\tdest.push( item );\r\n\t\t\treturn; // go no further\r\n\t\t}\r\n\r\n\t\t// if it has a fragment, process its items\r\n\t\tif ( item.fragment ) {\r\n\t\t\tcollect( item.fragment.iterations || item.fragment.items, name, attr, dest );\r\n\t\t}\r\n\r\n\t\t// or if it is itself a fragment, process its items\r\n\t\telse if ( Array.isArray( item.items ) ) {\r\n\t\t\tcollect( item.items, name, attr, dest );\r\n\t\t}\r\n\r\n\t\t// or if it is a component, step in and process its items\r\n\t\telse if ( item.type === COMPONENT && item.instance ) {\r\n\t\t\t// ...unless the partial is shadowed\r\n\t\t\tif ( item.instance.partials[ name ] ) return;\r\n\t\t\tcollect( item.instance.fragment.items, name, attr, dest );\r\n\t\t}\r\n\r\n\t\t// if the item is an element, process its attributes too\r\n\t\tif ( item.type === ELEMENT ) {\r\n\t\t\tif ( Array.isArray( item.attributes ) ) {\r\n\t\t\t\tcollect( item.attributes, name, true, dest );\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction forceResetTemplate ( partial ) {\r\n\tpartial.forceResetTemplate();\r\n}\r\n\r\nexport default function ( name, partial ) {\r\n\tconst collection = [];\r\n\tcollect( this.fragment.items, name, false, collection );\r\n\r\n\tconst promise = runloop.start( this, true );\r\n\r\n\tthis.partials[ name ] = partial;\r\n\tcollection.forEach( forceResetTemplate );\r\n\r\n\trunloop.end();\r\n\r\n\treturn promise;\r\n}\r\n","import { default as templateConfigurator } from '../config/custom/template';\r\nimport { createDocumentFragment } from '../../utils/dom';\r\nimport Fragment from '../../view/Fragment';\r\nimport runloop from '../../global/runloop';\r\n\r\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\r\n// of outro, update template, intro? I reckon probably not, since that\r\n// could be achieved with unrender-resetTemplate-render. Also, it should\r\n// conceptually be similar to resetPartial, which couldn't be async\r\n\r\nexport default function Ractive$resetTemplate ( template ) {\r\n\ttemplateConfigurator.init( null, this, { template });\r\n\r\n\tconst transitionsEnabled = this.transitionsEnabled;\r\n\tthis.transitionsEnabled = false;\r\n\r\n\t// Is this is a component, we need to set the `shouldDestroy`\r\n\t// flag, otherwise it will assume by default that a parent node\r\n\t// will be detached, and therefore it doesn't need to bother\r\n\t// detaching its own nodes\r\n\tconst component = this.component;\r\n\tif ( component ) component.shouldDestroy = true;\r\n\tthis.unrender();\r\n\tif ( component ) component.shouldDestroy = false;\r\n\r\n\tconst promise = runloop.start();\r\n\r\n\t// remove existing fragment and create new one\r\n\tthis.fragment.unbind().unrender( true );\r\n\r\n\tthis.fragment = new Fragment({\r\n\t\ttemplate: this.template,\r\n\t\troot: this,\r\n\t\towner: this\r\n\t});\r\n\r\n\tconst docFrag = createDocumentFragment();\r\n\tthis.fragment.bind( this.viewmodel ).render( docFrag );\r\n\r\n\t// if this is a component, its el may not be valid, so find a\r\n\t// target based on the component container\r\n\tif ( component && !component.external ) {\r\n\t\tthis.fragment.findParentNode().insertBefore( docFrag, component.findNextNode() );\r\n\t} else {\r\n\t\tthis.el.insertBefore( docFrag, this.anchor );\r\n\t}\r\n\r\n\trunloop.end();\r\n\r\n\tthis.transitionsEnabled = transitionsEnabled;\r\n\r\n\treturn promise;\r\n}\r\n","import { build, set } from '../../shared/set';\n\nexport default function Ractive$set ( keypath, value, options ) {\n\tconst ractive = this;\n\n\tconst opts = typeof keypath === 'object' ? value : options;\n\n\treturn set( ractive, build( ractive, keypath, value, opts && opts.isolated ), opts );\n}\n\n","import add from './shared/add';\r\n\r\nexport default function Ractive$subtract ( keypath, d, options ) {\r\n\tconst num = typeof d === 'number' ? -d : -1;\r\n\tconst opts = typeof d === 'object' ? d : options;\r\n\treturn add( this, keypath, num, opts );\r\n}\r\n","import { badArguments } from '../../config/errors';\nimport { gather, set } from '../../shared/set';\n\nexport default function Ractive$toggle ( keypath, options ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new TypeError( badArguments );\n\t}\n\n\treturn set( this, gather( this, keypath, null, options && options.isolated ).map( m => [ m, !m.get() ] ), options );\n}\n","import { getCSS } from '../../global/css';\r\n\r\nexport default function Ractive$toCSS() {\r\n\tconst cssIds = [ this.cssId, ...this.findAllComponents().map( c => c.cssId ) ];\r\n\tconst uniqueCssIds = Object.keys(cssIds.reduce( ( ids, id ) => (ids[id] = true, ids), {}));\r\n\treturn getCSS( uniqueCssIds );\r\n}\r\n","export default function Ractive$toHTML () {\r\n\treturn this.fragment.toString( true );\r\n}\r\n","export default function toText () {\r\n\treturn this.fragment.toString( false );\r\n}\r\n","import runloop from '../../global/runloop';\r\nimport Transition from '../../view/items/element/Transition';\r\nimport { fatal } from '../../utils/log';\r\nimport { isObject } from '../../utils/is';\r\n\r\nexport default function Ractive$transition ( name, node, params ) {\r\n\r\n\tif ( node instanceof HTMLElement ) {\r\n\t\t// good to go\r\n\t}\r\n\telse if ( isObject( node ) ) {\r\n\t\t// omitted, use event node\r\n\t\tparams = node;\r\n\t}\r\n\r\n\t// if we allow query selector, then it won't work\r\n\t// simple params like \"fast\"\r\n\r\n\t// else if ( typeof node === 'string' ) {\r\n\t// \t// query selector\r\n\t// \tnode = this.find( node )\r\n\t// }\r\n\r\n\tnode = node || this.event.node;\r\n\r\n\tif ( !node || !node._ractive ) {\r\n\t\tfatal( `No node was supplied for transition ${name}` );\r\n\t}\r\n\r\n\tparams = params || {};\r\n\tconst owner = node._ractive.proxy;\r\n\tconst transition = new Transition({ owner, parentFragment: owner.parentFragment, name, params });\r\n\ttransition.bind();\r\n\r\n\tconst promise = runloop.start( this, true );\r\n\trunloop.registerTransition( transition );\r\n\trunloop.end();\r\n\r\n\tpromise.then( () => transition.unbind() );\r\n\treturn promise;\r\n}\r\n","import { splitKeypath } from '../../shared/keypaths';\r\nimport runloop from '../../global/runloop';\r\n\r\nexport default function unlink( here ) {\r\n\tconst promise = runloop.start();\r\n\tthis.viewmodel.joinAll( splitKeypath( here ), { lastLink: false } ).unlink();\r\n\trunloop.end();\r\n\treturn promise;\r\n}\r\n","import Hook from '../../events/Hook';\r\nimport { warnIfDebug } from '../../utils/log';\r\nimport { removeFromArray } from '../../utils/array';\r\nimport runloop from '../../global/runloop';\r\n\r\nconst unrenderHook = new Hook( 'unrender' );\r\n\r\nexport default function Ractive$unrender () {\r\n\tif ( !this.fragment.rendered ) {\r\n\t\twarnIfDebug( 'ractive.unrender() was called on a Ractive instance that was not rendered' );\r\n\t\treturn Promise.resolve();\r\n\t}\r\n\r\n\tthis.unrendering = true;\r\n\tconst promise = runloop.start( this, true );\r\n\r\n\t// If this is a component, and the component isn't marked for destruction,\r\n\t// don't detach nodes from the DOM unnecessarily\r\n\tconst shouldDestroy = !this.component || ( this.component.anchor || {} ).shouldDestroy || this.component.shouldDestroy || this.shouldDestroy;\r\n\tthis.fragment.unrender( shouldDestroy );\r\n\tif ( shouldDestroy ) this.destroyed = true;\r\n\r\n\tremoveFromArray( this.el.__ractive_instances__, this );\r\n\r\n\tunrenderHook.fire( this );\r\n\r\n\trunloop.end();\r\n\tthis.unrendering = false;\r\n\r\n\treturn promise;\r\n}\r\n","import { splitKeypath } from '../../shared/keypaths';\r\nimport runloop from '../../global/runloop';\r\n\r\nexport default function Ractive$updateModel ( keypath, cascade ) {\r\n\tconst promise = runloop.start( this, true );\r\n\r\n\tif ( !keypath ) {\r\n\t\tthis.viewmodel.updateFromBindings( true );\r\n\t} else {\r\n\t\tthis.viewmodel.joinAll( splitKeypath( keypath ) ).updateFromBindings( cascade !== false );\r\n\t}\r\n\r\n\trunloop.end();\r\n\r\n\treturn promise;\r\n}\r\n","import { toPairs } from '../utils/object';\r\nimport config from '../Ractive/config/config';\r\nimport dataConfigurator from '../Ractive/config/custom/data';\r\nimport construct from '../Ractive/construct';\r\nimport initialise from '../Ractive/initialise';\r\nimport Ractive from '../Ractive';\r\n\r\nconst callsSuper = /super\\s\\(|\\.call\\s*\\(\\s*this/;\r\n\r\nexport function extend ( ...options ) {\r\n\tif( !options.length ) {\r\n\t\treturn extendOne( this );\r\n\t} else {\r\n\t\treturn options.reduce( extendOne, this );\r\n\t}\r\n}\r\n\r\nexport function extendWith ( Class, options = {} ) {\r\n\treturn extendOne( this, options, Class );\r\n}\r\n\r\nfunction extendOne ( Parent, options = {}, Target ) {\r\n\tlet proto;\r\n\tlet Child = typeof Target === 'function' && Target;\r\n\r\n\tif ( options.prototype instanceof Ractive ) {\r\n\t\tthrow new Error( `Ractive no longer supports multiple inheritance.` );\r\n\t}\r\n\r\n\tif ( Child ) {\r\n\t\tif ( !( Child.prototype instanceof Parent ) ) {\r\n\t\t\tthrow new Error( `Only classes that inherit the appropriate prototype may be used with extend` );\r\n\t\t}\r\n\t\tif ( !callsSuper.test( Child.toString() ) ) {\r\n\t\t\tthrow new Error( `Only classes that call super in their constructor may be used with extend` );\r\n\t\t}\r\n\r\n\t\tproto = Child.prototype;\r\n\t} else {\r\n\t\tChild = function ( options ) {\r\n\t\t\tif ( !( this instanceof Child ) ) return new Child( options );\r\n\r\n\t\t\tconstruct( this, options || {} );\r\n\t\t\tinitialise( this, options || {}, {} );\r\n\t\t};\r\n\r\n\t\tproto = Object.create( Parent.prototype );\r\n\t\tproto.constructor = Child;\r\n\r\n\t\tChild.prototype = proto;\r\n\t}\r\n\r\n\t// Static properties\r\n\tObject.defineProperties( Child, {\r\n\t\t// alias prototype as defaults\r\n\t\tdefaults: { value: proto },\r\n\r\n\t\t// extendable\r\n\t\textend: { value: extend, writable: true, configurable: true },\r\n\t\textendClass: { value: extendWith, writable: true, configurable: true },\r\n\r\n\t\t// Parent - for IE8, can't use Object.getPrototypeOf\r\n\t\t_Parent: { value: Parent }\r\n\t});\r\n\r\n\t// extend configuration\r\n\tconfig.extend( Parent, proto, options );\r\n\r\n\t// store event and observer registries on the constructor when extending\r\n\tChild._on = ( Parent._on || [] ).concat( toPairs( options.on ) );\r\n\tChild._observe = ( Parent._observe || [] ).concat( toPairs( options.observe ) );\r\n\r\n\t// attribute defs are not inherited, but they need to be stored\r\n\tif ( options.attributes ) {\r\n\t\tlet attrs;\r\n\r\n\t\t// allow an array of optional props or an object with arrays for optional and required props\r\n\t\tif ( Array.isArray( options.attributes ) ) {\r\n\t\t\tattrs = { optional: options.attributes, required: [] };\r\n\t\t} else {\r\n\t\t\tattrs = options.attributes;\r\n\t\t}\r\n\r\n\t\t// make sure the requisite keys actually store arrays\r\n\t\tif ( !Array.isArray( attrs.required ) ) attrs.required = [];\r\n\t\tif ( !Array.isArray( attrs.optional ) ) attrs.optional = [];\r\n\r\n\t\tChild.attributes = attrs;\r\n\t}\r\n\r\n\tdataConfigurator.extend( Parent, proto, options );\r\n\r\n\tif ( options.computed ) {\r\n\t\tproto.computed = Object.assign( Object.create( Parent.prototype.computed ), options.computed );\r\n\t}\r\n\r\n\treturn Child;\r\n}\r\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from '../../shared/keypaths';\r\n\r\nexport function joinKeys ( ...keys ) {\r\n\treturn keys.map( escapeKey ).join( '.' );\r\n}\r\n\r\nexport function splitKeypath ( keypath ) {\r\n\treturn splitKeypathI( keypath ).map( unescapeKey );\r\n}\r\n","import defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport parse from './parse/_parse';\nimport getContext, { getNodeInfo } from './Ractive/static/getContext';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\n\nexport default function Ractive ( options ) {\n\tif ( !( this instanceof Ractive ) ) return new Ractive( options );\n\n\tconstruct( this, options || {} );\n\tinitialise( this, options || {}, {} );\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif ( win && !win.Ractive ) {\n\tlet opts = '';\n\tconst script = document.currentScript || document.querySelector( 'script[data-ractive-options]' );\n\n\tif ( script ) opts = script.getAttribute( 'data-ractive-options' ) || '';\n\n\tif ( ~opts.indexOf( 'ForceGlobal' ) ) win.Ractive = Ractive;\n}\n\nObject.assign( Ractive.prototype, proto, defaults );\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\nObject.defineProperties( Ractive, {\n\n\t// debug flag\n\tDEBUG:          { writable: true, value: true },\n\tDEBUG_PROMISES: { writable: true, value: true },\n\n\t// static methods:\n\textend:         { value: extend },\n\textendWith:     { value: extendWith },\n\tescapeKey:      { value: escapeKey },\n\tgetContext:     { value: getContext },\n\tgetNodeInfo:    { value: getNodeInfo },\n\tjoinKeys:       { value: joinKeys },\n\tparse:          { value: parse },\n\tsplitKeypath:   { value: splitKeypath },\n\tunescapeKey:    { value: unescapeKey },\n\tgetCSS:         { value: getCSS },\n\n\t// support\n\tenhance:        { writable: true, value: false },\n\tsvg:            { value: svg },\n\n\t// version\n\tVERSION:        { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n\t// plugins\n\tadaptors:       { writable: true, value: {} },\n\tcomponents:     { writable: true, value: {} },\n\tdecorators:     { writable: true, value: {} },\n\teasing:         { writable: true, value: easing },\n\tevents:         { writable: true, value: {} },\n\tinterpolators:  { writable: true, value: interpolators },\n\tpartials:       { writable: true, value: {} },\n\ttransitions:    { writable: true, value: {} }\n});\n","var DEFAULTS = {\n\tdelay: 0,\n\tduration: 300,\n\teasing: 'linear'\n};\n\nfunction fade( t, params ) {\n\tvar targetOpacity;\n\n\tparams = t.processParams( params, DEFAULTS );\n\n\tif ( t.isIntro ) {\n\t\ttargetOpacity = t.getStyle( 'opacity' );\n\t\tt.setStyle( 'opacity', 0 );\n\t} else {\n\t\ttargetOpacity = 0;\n\t}\n\n\tt.animateStyle( 'opacity', targetOpacity, params ).then( t.complete );\n}\n\nexport default fade;","import journey from \"lib/journey/journey\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./methods.html\";\r\n\r\nvar methods = {\t\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = createView( options.target );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nfunction createView( target ) {\r\n\r\n\tvar view = new Ractive( {\r\n\r\n\t\tel: target,\r\n\t\ttemplate: template,\r\n\r\n\t\tdata: {\r\n\t\t\titems: [\r\n\t\t\t\t{ name: 'Item 1' },\r\n\t\t\t\t{ name: 'Item 2' },\r\n\t\t\t\t{ name: 'Item 3' },\r\n\t\t\t]\r\n\t\t},\r\n\r\n\t\ttest: function ( ) {\r\n\t\t\tconsole.log( \"test() invoked!\" );\r\n\t\t\treturn false; //returning false cancels the original event, the link that was clicked\r\n\t\t},\r\n\r\n\t\ttestThis: function ( ) {\r\n\t\t\t// 'this' refers to the Ractive instance\r\n\t\t\tconsole.log( \"testThis invoked!\" );\r\n\t\t\tconsole.log( \"\t[ractive instance]:\", this );\r\n\t\t\t// 'this.event' refers to the Ractive event, see: http://docs.ractivejs.org/latest/proxy-events\r\n\t\t\tconsole.log( \"\t[ractive event]:\", this.event );\r\n\t\t\t// 'this.event.original' refers to the DOM event, the link that was clicked\r\n\t\t\tconsole.log( \"\t[DOM 'click' event]:\", this.event.original );\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\ttestArgs: function ( currentInstance, event, str, bool, obj ) {\r\n\t\t\tconsole.log( \"arg currentInstance\", currentInstance );\r\n\t\t\tconsole.log( \"arg event\", event );\r\n\t\t\tconsole.log( \"arg str\", str );\r\n\t\t\tconsole.log( \"arg bool\", bool );\r\n\t\t\tconsole.log( \"arg object\", obj );\r\n\t\t\treturn false;\r\n\t\t}\r\n\t} );\r\n\treturn view;\r\n}\r\n\r\n\r\nexport default methods;\r\n","import Ractive from \"Ractive.js\";\r\nimport template from  \"./binding.html\";\r\n\r\nvar binding = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = createView( options.target );\r\n\t},\r\n\t\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown( );\r\n\t}\r\n};\r\n\r\nfunction createView( target ){\r\n\r\n\tvar view = new Ractive( {\r\n\t\tel: target,\r\n\t\ttemplate: template,\r\n\r\n\t\tdata: { \"name\": \"World!\" },\r\n\t\tresetData: function ( ) {\r\n\t\t\tthis.set( \"name\", \"World!\" );\r\n\t\t}\r\n\t} );\r\n\treturn view;\r\n}\r\n\r\nexport default binding;\r\n\r\n\r\n","/*!\r\n* Parsley.js\r\n* Version 2.7.0 - built Wed, Mar 1st 2017, 3:53 pm\r\n* http://parsleyjs.org\r\n* Guillaume Potier - <guillaume@wisembly.com>\r\n* Marc-Andre Lafortune - <petroselinum@marc-andre.ca>\r\n* MIT Licensed\r\n*/\r\n\r\n// The source code below is generated by babel as\r\n// Parsley is written in ECMAScript 6\r\n//\r\nvar _slice = Array.prototype.slice;\r\n\r\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\r\n\r\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i]; return arr2; } else { return Array.from(arr); } }\r\n\r\n(function (global, factory) {\r\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('jquery')) : typeof define === 'function' && define.amd ? define(['jquery'], factory) : global.parsley = factory(global.jQuery);\r\n})(this || window, function ($) {\r\n  'use strict';\r\n\r\n  var globalID = 1;\r\n  var pastWarnings = {};\r\n\r\n  var Utils__Utils = {\r\n    // Parsley DOM-API\r\n    // returns object from dom attributes and values\r\n    attr: function attr($element, namespace, obj) {\r\n      var i;\r\n      var attribute;\r\n      var attributes;\r\n      var regex = new RegExp('^' + namespace, 'i');\r\n\r\n      if ('undefined' === typeof obj) obj = {};else {\r\n        // Clear all own properties. This won't affect prototype's values\r\n        for (i in obj) {\r\n          if (obj.hasOwnProperty(i)) delete obj[i];\r\n        }\r\n      }\r\n\r\n      if ('undefined' === typeof $element || 'undefined' === typeof $element[0]) return obj;\r\n\r\n      attributes = $element[0].attributes;\r\n      for (i = attributes.length; i--;) {\r\n        attribute = attributes[i];\r\n\r\n        if (attribute && attribute.specified && regex.test(attribute.name)) {\r\n          obj[this.camelize(attribute.name.slice(namespace.length))] = this.deserializeValue(attribute.value);\r\n        }\r\n      }\r\n\r\n      return obj;\r\n    },\r\n\r\n    checkAttr: function checkAttr($element, namespace, _checkAttr) {\r\n      return $element.is('[' + namespace + _checkAttr + ']');\r\n    },\r\n\r\n    setAttr: function setAttr($element, namespace, attr, value) {\r\n      $element[0].setAttribute(this.dasherize(namespace + attr), String(value));\r\n    },\r\n\r\n    generateID: function generateID() {\r\n      return '' + globalID++;\r\n    },\r\n\r\n    /** Third party functions **/\r\n    // Zepto deserialize function\r\n    deserializeValue: function deserializeValue(value) {\r\n      var num;\r\n\r\n      try {\r\n        return value ? value == \"true\" || (value == \"false\" ? false : value == \"null\" ? null : !isNaN(num = Number(value)) ? num : /^[\\[\\{]/.test(value) ? $.parseJSON(value) : value) : value;\r\n      } catch (e) {\r\n        return value;\r\n      }\r\n    },\r\n\r\n    // Zepto camelize function\r\n    camelize: function camelize(str) {\r\n      return str.replace(/-+(.)?/g, function (match, chr) {\r\n        return chr ? chr.toUpperCase() : '';\r\n      });\r\n    },\r\n\r\n    // Zepto dasherize function\r\n    dasherize: function dasherize(str) {\r\n      return str.replace(/::/g, '/').replace(/([A-Z]+)([A-Z][a-z])/g, '$1_$2').replace(/([a-z\\d])([A-Z])/g, '$1_$2').replace(/_/g, '-').toLowerCase();\r\n    },\r\n\r\n    warn: function warn() {\r\n      var _window$console;\r\n\r\n      if (window.console && 'function' === typeof window.console.warn) (_window$console = window.console).warn.apply(_window$console, arguments);\r\n    },\r\n\r\n    warnOnce: function warnOnce(msg) {\r\n      if (!pastWarnings[msg]) {\r\n        pastWarnings[msg] = true;\r\n        this.warn.apply(this, arguments);\r\n      }\r\n    },\r\n\r\n    _resetWarnings: function _resetWarnings() {\r\n      pastWarnings = {};\r\n    },\r\n\r\n    trimString: function trimString(string) {\r\n      return string.replace(/^\\s+|\\s+$/g, '');\r\n    },\r\n\r\n    parse: {\r\n      date: function date(string) {\r\n        var parsed = string.match(/^(\\d{4,})-(\\d\\d)-(\\d\\d)$/);\r\n        if (!parsed) return null;\r\n\r\n        var _parsed$map = parsed.map(function (x) {\r\n          return parseInt(x, 10);\r\n        });\r\n\r\n        var _parsed$map2 = _slicedToArray(_parsed$map, 4);\r\n\r\n        var _ = _parsed$map2[0];\r\n        var year = _parsed$map2[1];\r\n        var month = _parsed$map2[2];\r\n        var day = _parsed$map2[3];\r\n\r\n        var date = new Date(year, month - 1, day);\r\n        if (date.getFullYear() !== year || date.getMonth() + 1 !== month || date.getDate() !== day) return null;\r\n        return date;\r\n      },\r\n      string: function string(_string) {\r\n        return _string;\r\n      },\r\n      integer: function integer(string) {\r\n        if (isNaN(string)) return null;\r\n        return parseInt(string, 10);\r\n      },\r\n      number: function number(string) {\r\n        if (isNaN(string)) throw null;\r\n        return parseFloat(string);\r\n      },\r\n      'boolean': function _boolean(string) {\r\n        return !/^\\s*false\\s*$/i.test(string);\r\n      },\r\n      object: function object(string) {\r\n        return Utils__Utils.deserializeValue(string);\r\n      },\r\n      regexp: function regexp(_regexp) {\r\n        var flags = '';\r\n\r\n        // Test if RegExp is literal, if not, nothing to be done, otherwise, we need to isolate flags and pattern\r\n        if (/^\\/.*\\/(?:[gimy]*)$/.test(_regexp)) {\r\n          // Replace the regexp literal string with the first match group: ([gimy]*)\r\n          // If no flag is present, this will be a blank string\r\n          flags = _regexp.replace(/.*\\/([gimy]*)$/, '$1');\r\n          // Again, replace the regexp literal string with the first match group:\r\n          // everything excluding the opening and closing slashes and the flags\r\n          _regexp = _regexp.replace(new RegExp('^/(.*?)/' + flags + '$'), '$1');\r\n        } else {\r\n          // Anchor regexp:\r\n          _regexp = '^' + _regexp + '$';\r\n        }\r\n        return new RegExp(_regexp, flags);\r\n      }\r\n    },\r\n\r\n    parseRequirement: function parseRequirement(requirementType, string) {\r\n      var converter = this.parse[requirementType || 'string'];\r\n      if (!converter) throw 'Unknown requirement specification: \"' + requirementType + '\"';\r\n      var converted = converter(string);\r\n      if (converted === null) throw 'Requirement is not a ' + requirementType + ': \"' + string + '\"';\r\n      return converted;\r\n    },\r\n\r\n    namespaceEvents: function namespaceEvents(events, namespace) {\r\n      events = this.trimString(events || '').split(/\\s+/);\r\n      if (!events[0]) return '';\r\n      return $.map(events, function (evt) {\r\n        return evt + '.' + namespace;\r\n      }).join(' ');\r\n    },\r\n\r\n    difference: function difference(array, remove) {\r\n      // This is O(N^2), should be optimized\r\n      var result = [];\r\n      $.each(array, function (_, elem) {\r\n        if (remove.indexOf(elem) == -1) result.push(elem);\r\n      });\r\n      return result;\r\n    },\r\n\r\n    // Alter-ego to native Promise.all, but for jQuery\r\n    all: function all(promises) {\r\n      // jQuery treats $.when() and $.when(singlePromise) differently; let's avoid that and add spurious elements\r\n      return $.when.apply($, _toConsumableArray(promises).concat([42, 42]));\r\n    },\r\n\r\n    // Object.create polyfill, see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create#Polyfill\r\n    objectCreate: Object.create || (function () {\r\n      var Object = function Object() {};\r\n      return function (prototype) {\r\n        if (arguments.length > 1) {\r\n          throw Error('Second argument not supported');\r\n        }\r\n        if (typeof prototype != 'object') {\r\n          throw TypeError('Argument must be an object');\r\n        }\r\n        Object.prototype = prototype;\r\n        var result = new Object();\r\n        Object.prototype = null;\r\n        return result;\r\n      };\r\n    })(),\r\n\r\n    _SubmitSelector: 'input[type=\"submit\"], button:submit'\r\n  };\r\n\r\n  var Utils__default = Utils__Utils;\r\n\r\n  // All these options could be overriden and specified directly in DOM using\r\n  // `data-parsley-` default DOM-API\r\n  // eg: `inputs` can be set in DOM using `data-parsley-inputs=\"input, textarea\"`\r\n  // eg: `data-parsley-stop-on-first-failing-constraint=\"false\"`\r\n\r\n  var Defaults = {\r\n    // ### General\r\n\r\n    // Default data-namespace for DOM API\r\n    namespace: 'data-parsley-',\r\n\r\n    // Supported inputs by default\r\n    inputs: 'input, textarea, select',\r\n\r\n    // Excluded inputs by default\r\n    excluded: 'input[type=button], input[type=submit], input[type=reset], input[type=hidden]',\r\n\r\n    // Stop validating field on highest priority failing constraint\r\n    priorityEnabled: true,\r\n\r\n    // ### Field only\r\n\r\n    // identifier used to group together inputs (e.g. radio buttons...)\r\n    multiple: null,\r\n\r\n    // identifier (or array of identifiers) used to validate only a select group of inputs\r\n    group: null,\r\n\r\n    // ### UI\r\n    // Enable\\Disable error messages\r\n    uiEnabled: true,\r\n\r\n    // Key events threshold before validation\r\n    validationThreshold: 3,\r\n\r\n    // Focused field on form validation error. 'first'|'last'|'none'\r\n    focus: 'first',\r\n\r\n    // event(s) that will trigger validation before first failure. eg: `input`...\r\n    trigger: false,\r\n\r\n    // event(s) that will trigger validation after first failure.\r\n    triggerAfterFailure: 'input',\r\n\r\n    // Class that would be added on every failing validation Parsley field\r\n    errorClass: 'parsley-error',\r\n\r\n    // Same for success validation\r\n    successClass: 'parsley-success',\r\n\r\n    // Return the `$element` that will receive these above success or error classes\r\n    // Could also be (and given directly from DOM) a valid selector like `'#div'`\r\n    classHandler: function classHandler(Field) {},\r\n\r\n    // Return the `$element` where errors will be appended\r\n    // Could also be (and given directly from DOM) a valid selector like `'#div'`\r\n    errorsContainer: function errorsContainer(Field) {},\r\n\r\n    // ul elem that would receive errors' list\r\n    errorsWrapper: '<ul class=\"parsley-errors-list\"></ul>',\r\n\r\n    // li elem that would receive error message\r\n    errorTemplate: '<li></li>'\r\n  };\r\n\r\n  var Base = function Base() {\r\n    this.__id__ = Utils__default.generateID();\r\n  };\r\n\r\n  Base.prototype = {\r\n    asyncSupport: true, // Deprecated\r\n\r\n    _pipeAccordingToValidationResult: function _pipeAccordingToValidationResult() {\r\n      var _this = this;\r\n\r\n      var pipe = function pipe() {\r\n        var r = $.Deferred();\r\n        if (true !== _this.validationResult) r.reject();\r\n        return r.resolve().promise();\r\n      };\r\n      return [pipe, pipe];\r\n    },\r\n\r\n    actualizeOptions: function actualizeOptions() {\r\n      Utils__default.attr(this.$element, this.options.namespace, this.domOptions);\r\n      if (this.parent && this.parent.actualizeOptions) this.parent.actualizeOptions();\r\n      return this;\r\n    },\r\n\r\n    _resetOptions: function _resetOptions(initOptions) {\r\n      this.domOptions = Utils__default.objectCreate(this.parent.options);\r\n      this.options = Utils__default.objectCreate(this.domOptions);\r\n      // Shallow copy of ownProperties of initOptions:\r\n      for (var i in initOptions) {\r\n        if (initOptions.hasOwnProperty(i)) this.options[i] = initOptions[i];\r\n      }\r\n      this.actualizeOptions();\r\n    },\r\n\r\n    _listeners: null,\r\n\r\n    // Register a callback for the given event name\r\n    // Callback is called with context as the first argument and the `this`\r\n    // The context is the current parsley instance, or window.Parsley if global\r\n    // A return value of `false` will interrupt the calls\r\n    on: function on(name, fn) {\r\n      this._listeners = this._listeners || {};\r\n      var queue = this._listeners[name] = this._listeners[name] || [];\r\n      queue.push(fn);\r\n\r\n      return this;\r\n    },\r\n\r\n    // Deprecated. Use `on` instead\r\n    subscribe: function subscribe(name, fn) {\r\n      $.listenTo(this, name.toLowerCase(), fn);\r\n    },\r\n\r\n    // Unregister a callback (or all if none is given) for the given event name\r\n    off: function off(name, fn) {\r\n      var queue = this._listeners && this._listeners[name];\r\n      if (queue) {\r\n        if (!fn) {\r\n          delete this._listeners[name];\r\n        } else {\r\n          for (var i = queue.length; i--;) if (queue[i] === fn) queue.splice(i, 1);\r\n        }\r\n      }\r\n      return this;\r\n    },\r\n\r\n    // Deprecated. Use `off`\r\n    unsubscribe: function unsubscribe(name, fn) {\r\n      $.unsubscribeTo(this, name.toLowerCase());\r\n    },\r\n\r\n    // Trigger an event of the given name\r\n    // A return value of `false` interrupts the callback chain\r\n    // Returns false if execution was interrupted\r\n    trigger: function trigger(name, target, extraArg) {\r\n      target = target || this;\r\n      var queue = this._listeners && this._listeners[name];\r\n      var result;\r\n      var parentResult;\r\n      if (queue) {\r\n        for (var i = queue.length; i--;) {\r\n          result = queue[i].call(target, target, extraArg);\r\n          if (result === false) return result;\r\n        }\r\n      }\r\n      if (this.parent) {\r\n        return this.parent.trigger(name, target, extraArg);\r\n      }\r\n      return true;\r\n    },\r\n\r\n    asyncIsValid: function asyncIsValid(group, force) {\r\n      Utils__default.warnOnce(\"asyncIsValid is deprecated; please use whenValid instead\");\r\n      return this.whenValid({ group: group, force: force });\r\n    },\r\n\r\n    _findRelated: function _findRelated() {\r\n      return this.options.multiple ? this.parent.$element.find('[' + this.options.namespace + 'multiple=\"' + this.options.multiple + '\"]') : this.$element;\r\n    }\r\n  };\r\n\r\n  var convertArrayRequirement = function convertArrayRequirement(string, length) {\r\n    var m = string.match(/^\\s*\\[(.*)\\]\\s*$/);\r\n    if (!m) throw 'Requirement is not an array: \"' + string + '\"';\r\n    var values = m[1].split(',').map(Utils__default.trimString);\r\n    if (values.length !== length) throw 'Requirement has ' + values.length + ' values when ' + length + ' are needed';\r\n    return values;\r\n  };\r\n\r\n  var convertExtraOptionRequirement = function convertExtraOptionRequirement(requirementSpec, string, extraOptionReader) {\r\n    var main = null;\r\n    var extra = {};\r\n    for (var key in requirementSpec) {\r\n      if (key) {\r\n        var value = extraOptionReader(key);\r\n        if ('string' === typeof value) value = Utils__default.parseRequirement(requirementSpec[key], value);\r\n        extra[key] = value;\r\n      } else {\r\n        main = Utils__default.parseRequirement(requirementSpec[key], string);\r\n      }\r\n    }\r\n    return [main, extra];\r\n  };\r\n\r\n  // A Validator needs to implement the methods `validate` and `parseRequirements`\r\n\r\n  var Validator = function Validator(spec) {\r\n    $.extend(true, this, spec);\r\n  };\r\n\r\n  Validator.prototype = {\r\n    // Returns `true` iff the given `value` is valid according the given requirements.\r\n    validate: function validate(value, requirementFirstArg) {\r\n      if (this.fn) {\r\n        // Legacy style validator\r\n\r\n        if (arguments.length > 3) // If more args then value, requirement, instance...\r\n          requirementFirstArg = [].slice.call(arguments, 1, -1); // Skip first arg (value) and last (instance), combining the rest\r\n        return this.fn(value, requirementFirstArg);\r\n      }\r\n\r\n      if ($.isArray(value)) {\r\n        if (!this.validateMultiple) throw 'Validator `' + this.name + '` does not handle multiple values';\r\n        return this.validateMultiple.apply(this, arguments);\r\n      } else {\r\n        var instance = arguments[arguments.length - 1];\r\n        if (this.validateDate && instance._isDateInput()) {\r\n          arguments[0] = Utils__default.parse.date(arguments[0]);\r\n          if (arguments[0] === null) return false;\r\n          return this.validateDate.apply(this, arguments);\r\n        }\r\n        if (this.validateNumber) {\r\n          if (isNaN(value)) return false;\r\n          arguments[0] = parseFloat(arguments[0]);\r\n          return this.validateNumber.apply(this, arguments);\r\n        }\r\n        if (this.validateString) {\r\n          return this.validateString.apply(this, arguments);\r\n        }\r\n        throw 'Validator `' + this.name + '` only handles multiple values';\r\n      }\r\n    },\r\n\r\n    // Parses `requirements` into an array of arguments,\r\n    // according to `this.requirementType`\r\n    parseRequirements: function parseRequirements(requirements, extraOptionReader) {\r\n      if ('string' !== typeof requirements) {\r\n        // Assume requirement already parsed\r\n        // but make sure we return an array\r\n        return $.isArray(requirements) ? requirements : [requirements];\r\n      }\r\n      var type = this.requirementType;\r\n      if ($.isArray(type)) {\r\n        var values = convertArrayRequirement(requirements, type.length);\r\n        for (var i = 0; i < values.length; i++) values[i] = Utils__default.parseRequirement(type[i], values[i]);\r\n        return values;\r\n      } else if ($.isPlainObject(type)) {\r\n        return convertExtraOptionRequirement(type, requirements, extraOptionReader);\r\n      } else {\r\n        return [Utils__default.parseRequirement(type, requirements)];\r\n      }\r\n    },\r\n    // Defaults:\r\n    requirementType: 'string',\r\n\r\n    priority: 2\r\n\r\n  };\r\n\r\n  var ValidatorRegistry = function ValidatorRegistry(validators, catalog) {\r\n    this.__class__ = 'ValidatorRegistry';\r\n\r\n    // Default Parsley locale is en\r\n    this.locale = 'en';\r\n\r\n    this.init(validators || {}, catalog || {});\r\n  };\r\n\r\n  var typeTesters = {\r\n    email: /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i,\r\n\r\n    // Follow https://www.w3.org/TR/html5/infrastructure.html#floating-point-numbers\r\n    number: /^-?(\\d*\\.)?\\d+(e[-+]?\\d+)?$/i,\r\n\r\n    integer: /^-?\\d+$/,\r\n\r\n    digits: /^\\d+$/,\r\n\r\n    alphanum: /^\\w+$/i,\r\n\r\n    date: {\r\n      test: function test(value) {\r\n        return Utils__default.parse.date(value) !== null;\r\n      }\r\n    },\r\n\r\n    url: new RegExp(\"^\" +\r\n    // protocol identifier\r\n    \"(?:(?:https?|ftp)://)?\" + // ** mod: make scheme optional\r\n    // user:pass authentication\r\n    \"(?:\\\\S+(?::\\\\S*)?@)?\" + \"(?:\" +\r\n    // IP address exclusion\r\n    // private & local networks\r\n    // \"(?!(?:10|127)(?:\\\\.\\\\d{1,3}){3})\" +   // ** mod: allow local networks\r\n    // \"(?!(?:169\\\\.254|192\\\\.168)(?:\\\\.\\\\d{1,3}){2})\" +  // ** mod: allow local networks\r\n    // \"(?!172\\\\.(?:1[6-9]|2\\\\d|3[0-1])(?:\\\\.\\\\d{1,3}){2})\" +  // ** mod: allow local networks\r\n    // IP address dotted notation octets\r\n    // excludes loopback network 0.0.0.0\r\n    // excludes reserved space >= 224.0.0.0\r\n    // excludes network & broacast addresses\r\n    // (first & last IP address of each class)\r\n    \"(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])\" + \"(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}\" + \"(?:\\\\.(?:[1-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))\" + \"|\" +\r\n    // host name\r\n    '(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)' +\r\n    // domain name\r\n    '(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)*' +\r\n    // TLD identifier\r\n    '(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,}))' + \")\" +\r\n    // port number\r\n    \"(?::\\\\d{2,5})?\" +\r\n    // resource path\r\n    \"(?:/\\\\S*)?\" + \"$\", 'i')\r\n  };\r\n  typeTesters.range = typeTesters.number;\r\n\r\n  // See http://stackoverflow.com/a/10454560/8279\r\n  var decimalPlaces = function decimalPlaces(num) {\r\n    var match = ('' + num).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\r\n    if (!match) {\r\n      return 0;\r\n    }\r\n    return Math.max(0,\r\n    // Number of digits right of decimal point.\r\n    (match[1] ? match[1].length : 0) - (\r\n    // Adjust for scientific notation.\r\n    match[2] ? +match[2] : 0));\r\n  };\r\n\r\n  // parseArguments('number', ['1', '2']) => [1, 2]\r\n  var ValidatorRegistry__parseArguments = function ValidatorRegistry__parseArguments(type, args) {\r\n    return args.map(Utils__default.parse[type]);\r\n  };\r\n  // operatorToValidator returns a validating function for an operator function, applied to the given type\r\n  var ValidatorRegistry__operatorToValidator = function ValidatorRegistry__operatorToValidator(type, operator) {\r\n    return function (value) {\r\n      for (var _len = arguments.length, requirementsAndInput = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\r\n        requirementsAndInput[_key - 1] = arguments[_key];\r\n      }\r\n\r\n      requirementsAndInput.pop(); // Get rid of `input` argument\r\n      return operator.apply(undefined, [value].concat(_toConsumableArray(ValidatorRegistry__parseArguments(type, requirementsAndInput))));\r\n    };\r\n  };\r\n\r\n  var ValidatorRegistry__comparisonOperator = function ValidatorRegistry__comparisonOperator(operator) {\r\n    return {\r\n      validateDate: ValidatorRegistry__operatorToValidator('date', operator),\r\n      validateNumber: ValidatorRegistry__operatorToValidator('number', operator),\r\n      requirementType: operator.length <= 2 ? 'string' : ['string', 'string'], // Support operators with a 1 or 2 requirement(s)\r\n      priority: 30\r\n    };\r\n  };\r\n\r\n  ValidatorRegistry.prototype = {\r\n    init: function init(validators, catalog) {\r\n      this.catalog = catalog;\r\n      // Copy prototype's validators:\r\n      this.validators = $.extend({}, this.validators);\r\n\r\n      for (var name in validators) this.addValidator(name, validators[name].fn, validators[name].priority);\r\n\r\n      window.Parsley.trigger('parsley:validator:init');\r\n    },\r\n\r\n    // Set new messages locale if we have dictionary loaded in ParsleyConfig.i18n\r\n    setLocale: function setLocale(locale) {\r\n      if ('undefined' === typeof this.catalog[locale]) throw new Error(locale + ' is not available in the catalog');\r\n\r\n      this.locale = locale;\r\n\r\n      return this;\r\n    },\r\n\r\n    // Add a new messages catalog for a given locale. Set locale for this catalog if set === `true`\r\n    addCatalog: function addCatalog(locale, messages, set) {\r\n      if ('object' === typeof messages) this.catalog[locale] = messages;\r\n\r\n      if (true === set) return this.setLocale(locale);\r\n\r\n      return this;\r\n    },\r\n\r\n    // Add a specific message for a given constraint in a given locale\r\n    addMessage: function addMessage(locale, name, message) {\r\n      if ('undefined' === typeof this.catalog[locale]) this.catalog[locale] = {};\r\n\r\n      this.catalog[locale][name] = message;\r\n\r\n      return this;\r\n    },\r\n\r\n    // Add messages for a given locale\r\n    addMessages: function addMessages(locale, nameMessageObject) {\r\n      for (var name in nameMessageObject) this.addMessage(locale, name, nameMessageObject[name]);\r\n\r\n      return this;\r\n    },\r\n\r\n    // Add a new validator\r\n    //\r\n    //    addValidator('custom', {\r\n    //        requirementType: ['integer', 'integer'],\r\n    //        validateString: function(value, from, to) {},\r\n    //        priority: 22,\r\n    //        messages: {\r\n    //          en: \"Hey, that's no good\",\r\n    //          fr: \"Aye aye, pas bon du tout\",\r\n    //        }\r\n    //    })\r\n    //\r\n    // Old API was addValidator(name, function, priority)\r\n    //\r\n    addValidator: function addValidator(name, arg1, arg2) {\r\n      if (this.validators[name]) Utils__default.warn('Validator \"' + name + '\" is already defined.');else if (Defaults.hasOwnProperty(name)) {\r\n        Utils__default.warn('\"' + name + '\" is a restricted keyword and is not a valid validator name.');\r\n        return;\r\n      }\r\n      return this._setValidator.apply(this, arguments);\r\n    },\r\n\r\n    updateValidator: function updateValidator(name, arg1, arg2) {\r\n      if (!this.validators[name]) {\r\n        Utils__default.warn('Validator \"' + name + '\" is not already defined.');\r\n        return this.addValidator.apply(this, arguments);\r\n      }\r\n      return this._setValidator.apply(this, arguments);\r\n    },\r\n\r\n    removeValidator: function removeValidator(name) {\r\n      if (!this.validators[name]) Utils__default.warn('Validator \"' + name + '\" is not defined.');\r\n\r\n      delete this.validators[name];\r\n\r\n      return this;\r\n    },\r\n\r\n    _setValidator: function _setValidator(name, validator, priority) {\r\n      if ('object' !== typeof validator) {\r\n        // Old style validator, with `fn` and `priority`\r\n        validator = {\r\n          fn: validator,\r\n          priority: priority\r\n        };\r\n      }\r\n      if (!validator.validate) {\r\n        validator = new Validator(validator);\r\n      }\r\n      this.validators[name] = validator;\r\n\r\n      for (var locale in validator.messages || {}) this.addMessage(locale, name, validator.messages[locale]);\r\n\r\n      return this;\r\n    },\r\n\r\n    getErrorMessage: function getErrorMessage(constraint) {\r\n      var message;\r\n\r\n      // Type constraints are a bit different, we have to match their requirements too to find right error message\r\n      if ('type' === constraint.name) {\r\n        var typeMessages = this.catalog[this.locale][constraint.name] || {};\r\n        message = typeMessages[constraint.requirements];\r\n      } else message = this.formatMessage(this.catalog[this.locale][constraint.name], constraint.requirements);\r\n\r\n      return message || this.catalog[this.locale].defaultMessage || this.catalog.en.defaultMessage;\r\n    },\r\n\r\n    // Kind of light `sprintf()` implementation\r\n    formatMessage: function formatMessage(string, parameters) {\r\n      if ('object' === typeof parameters) {\r\n        for (var i in parameters) string = this.formatMessage(string, parameters[i]);\r\n\r\n        return string;\r\n      }\r\n\r\n      return 'string' === typeof string ? string.replace(/%s/i, parameters) : '';\r\n    },\r\n\r\n    // Here is the Parsley default validators list.\r\n    // A validator is an object with the following key values:\r\n    //  - priority: an integer\r\n    //  - requirement: 'string' (default), 'integer', 'number', 'regexp' or an Array of these\r\n    //  - validateString, validateMultiple, validateNumber: functions returning `true`, `false` or a promise\r\n    // Alternatively, a validator can be a function that returns such an object\r\n    //\r\n    validators: {\r\n      notblank: {\r\n        validateString: function validateString(value) {\r\n          return (/\\S/.test(value)\r\n          );\r\n        },\r\n        priority: 2\r\n      },\r\n      required: {\r\n        validateMultiple: function validateMultiple(values) {\r\n          return values.length > 0;\r\n        },\r\n        validateString: function validateString(value) {\r\n          return (/\\S/.test(value)\r\n          );\r\n        },\r\n        priority: 512\r\n      },\r\n      type: {\r\n        validateString: function validateString(value, type) {\r\n          var _ref = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\r\n\r\n          var _ref$step = _ref.step;\r\n          var step = _ref$step === undefined ? 'any' : _ref$step;\r\n          var _ref$base = _ref.base;\r\n          var base = _ref$base === undefined ? 0 : _ref$base;\r\n\r\n          var tester = typeTesters[type];\r\n          if (!tester) {\r\n            throw new Error('validator type `' + type + '` is not supported');\r\n          }\r\n          if (!tester.test(value)) return false;\r\n          if ('number' === type) {\r\n            if (!/^any$/i.test(step || '')) {\r\n              var nb = Number(value);\r\n              var decimals = Math.max(decimalPlaces(step), decimalPlaces(base));\r\n              if (decimalPlaces(nb) > decimals) // Value can't have too many decimals\r\n                return false;\r\n              // Be careful of rounding errors by using integers.\r\n              var toInt = function toInt(f) {\r\n                return Math.round(f * Math.pow(10, decimals));\r\n              };\r\n              if ((toInt(nb) - toInt(base)) % toInt(step) != 0) return false;\r\n            }\r\n          }\r\n          return true;\r\n        },\r\n        requirementType: {\r\n          '': 'string',\r\n          step: 'string',\r\n          base: 'number'\r\n        },\r\n        priority: 256\r\n      },\r\n      pattern: {\r\n        validateString: function validateString(value, regexp) {\r\n          return regexp.test(value);\r\n        },\r\n        requirementType: 'regexp',\r\n        priority: 64\r\n      },\r\n      minlength: {\r\n        validateString: function validateString(value, requirement) {\r\n          return value.length >= requirement;\r\n        },\r\n        requirementType: 'integer',\r\n        priority: 30\r\n      },\r\n      maxlength: {\r\n        validateString: function validateString(value, requirement) {\r\n          return value.length <= requirement;\r\n        },\r\n        requirementType: 'integer',\r\n        priority: 30\r\n      },\r\n      length: {\r\n        validateString: function validateString(value, min, max) {\r\n          return value.length >= min && value.length <= max;\r\n        },\r\n        requirementType: ['integer', 'integer'],\r\n        priority: 30\r\n      },\r\n      mincheck: {\r\n        validateMultiple: function validateMultiple(values, requirement) {\r\n          return values.length >= requirement;\r\n        },\r\n        requirementType: 'integer',\r\n        priority: 30\r\n      },\r\n      maxcheck: {\r\n        validateMultiple: function validateMultiple(values, requirement) {\r\n          return values.length <= requirement;\r\n        },\r\n        requirementType: 'integer',\r\n        priority: 30\r\n      },\r\n      check: {\r\n        validateMultiple: function validateMultiple(values, min, max) {\r\n          return values.length >= min && values.length <= max;\r\n        },\r\n        requirementType: ['integer', 'integer'],\r\n        priority: 30\r\n      },\r\n      min: ValidatorRegistry__comparisonOperator(function (value, requirement) {\r\n        return value >= requirement;\r\n      }),\r\n      max: ValidatorRegistry__comparisonOperator(function (value, requirement) {\r\n        return value <= requirement;\r\n      }),\r\n      range: ValidatorRegistry__comparisonOperator(function (value, min, max) {\r\n        return value >= min && value <= max;\r\n      }),\r\n      equalto: {\r\n        validateString: function validateString(value, refOrValue) {\r\n          var $reference = $(refOrValue);\r\n          if ($reference.length) return value === $reference.val();else return value === refOrValue;\r\n        },\r\n        priority: 256\r\n      }\r\n    }\r\n  };\r\n\r\n  var UI = {};\r\n\r\n  var diffResults = function diffResults(newResult, oldResult, deep) {\r\n    var added = [];\r\n    var kept = [];\r\n\r\n    for (var i = 0; i < newResult.length; i++) {\r\n      var found = false;\r\n\r\n      for (var j = 0; j < oldResult.length; j++) if (newResult[i].assert.name === oldResult[j].assert.name) {\r\n        found = true;\r\n        break;\r\n      }\r\n\r\n      if (found) kept.push(newResult[i]);else added.push(newResult[i]);\r\n    }\r\n\r\n    return {\r\n      kept: kept,\r\n      added: added,\r\n      removed: !deep ? diffResults(oldResult, newResult, true).added : []\r\n    };\r\n  };\r\n\r\n  UI.Form = {\r\n\r\n    _actualizeTriggers: function _actualizeTriggers() {\r\n      var _this2 = this;\r\n\r\n      this.$element.on('submit.Parsley', function (evt) {\r\n        _this2.onSubmitValidate(evt);\r\n      });\r\n      this.$element.on('click.Parsley', Utils__default._SubmitSelector, function (evt) {\r\n        _this2.onSubmitButton(evt);\r\n      });\r\n\r\n      // UI could be disabled\r\n      if (false === this.options.uiEnabled) return;\r\n\r\n      this.$element.attr('novalidate', '');\r\n    },\r\n\r\n    focus: function focus() {\r\n      this._focusedField = null;\r\n\r\n      if (true === this.validationResult || 'none' === this.options.focus) return null;\r\n\r\n      for (var i = 0; i < this.fields.length; i++) {\r\n        var field = this.fields[i];\r\n        if (true !== field.validationResult && field.validationResult.length > 0 && 'undefined' === typeof field.options.noFocus) {\r\n          this._focusedField = field.$element;\r\n          if ('first' === this.options.focus) break;\r\n        }\r\n      }\r\n\r\n      if (null === this._focusedField) return null;\r\n\r\n      return this._focusedField.focus();\r\n    },\r\n\r\n    _destroyUI: function _destroyUI() {\r\n      // Reset all event listeners\r\n      this.$element.off('.Parsley');\r\n    }\r\n\r\n  };\r\n\r\n  UI.Field = {\r\n\r\n    _reflowUI: function _reflowUI() {\r\n      this._buildUI();\r\n\r\n      // If this field doesn't have an active UI don't bother doing something\r\n      if (!this._ui) return;\r\n\r\n      // Diff between two validation results\r\n      var diff = diffResults(this.validationResult, this._ui.lastValidationResult);\r\n\r\n      // Then store current validation result for next reflow\r\n      this._ui.lastValidationResult = this.validationResult;\r\n\r\n      // Handle valid / invalid / none field class\r\n      this._manageStatusClass();\r\n\r\n      // Add, remove, updated errors messages\r\n      this._manageErrorsMessages(diff);\r\n\r\n      // Triggers impl\r\n      this._actualizeTriggers();\r\n\r\n      // If field is not valid for the first time, bind keyup trigger to ease UX and quickly inform user\r\n      if ((diff.kept.length || diff.added.length) && !this._failedOnce) {\r\n        this._failedOnce = true;\r\n        this._actualizeTriggers();\r\n      }\r\n    },\r\n\r\n    // Returns an array of field's error message(s)\r\n    getErrorsMessages: function getErrorsMessages() {\r\n      // No error message, field is valid\r\n      if (true === this.validationResult) return [];\r\n\r\n      var messages = [];\r\n\r\n      for (var i = 0; i < this.validationResult.length; i++) messages.push(this.validationResult[i].errorMessage || this._getErrorMessage(this.validationResult[i].assert));\r\n\r\n      return messages;\r\n    },\r\n\r\n    // It's a goal of Parsley that this method is no longer required [#1073]\r\n    addError: function addError(name) {\r\n      var _ref2 = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\r\n\r\n      var message = _ref2.message;\r\n      var assert = _ref2.assert;\r\n      var _ref2$updateClass = _ref2.updateClass;\r\n      var updateClass = _ref2$updateClass === undefined ? true : _ref2$updateClass;\r\n\r\n      this._buildUI();\r\n      this._addError(name, { message: message, assert: assert });\r\n\r\n      if (updateClass) this._errorClass();\r\n    },\r\n\r\n    // It's a goal of Parsley that this method is no longer required [#1073]\r\n    updateError: function updateError(name) {\r\n      var _ref3 = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\r\n\r\n      var message = _ref3.message;\r\n      var assert = _ref3.assert;\r\n      var _ref3$updateClass = _ref3.updateClass;\r\n      var updateClass = _ref3$updateClass === undefined ? true : _ref3$updateClass;\r\n\r\n      this._buildUI();\r\n      this._updateError(name, { message: message, assert: assert });\r\n\r\n      if (updateClass) this._errorClass();\r\n    },\r\n\r\n    // It's a goal of Parsley that this method is no longer required [#1073]\r\n    removeError: function removeError(name) {\r\n      var _ref4 = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\r\n\r\n      var _ref4$updateClass = _ref4.updateClass;\r\n      var updateClass = _ref4$updateClass === undefined ? true : _ref4$updateClass;\r\n\r\n      this._buildUI();\r\n      this._removeError(name);\r\n\r\n      // edge case possible here: remove a standard Parsley error that is still failing in this.validationResult\r\n      // but highly improbable cuz' manually removing a well Parsley handled error makes no sense.\r\n      if (updateClass) this._manageStatusClass();\r\n    },\r\n\r\n    _manageStatusClass: function _manageStatusClass() {\r\n      if (this.hasConstraints() && this.needsValidation() && true === this.validationResult) this._successClass();else if (this.validationResult.length > 0) this._errorClass();else this._resetClass();\r\n    },\r\n\r\n    _manageErrorsMessages: function _manageErrorsMessages(diff) {\r\n      if ('undefined' !== typeof this.options.errorsMessagesDisabled) return;\r\n\r\n      // Case where we have errorMessage option that configure an unique field error message, regardless failing validators\r\n      if ('undefined' !== typeof this.options.errorMessage) {\r\n        if (diff.added.length || diff.kept.length) {\r\n          this._insertErrorWrapper();\r\n\r\n          if (0 === this._ui.$errorsWrapper.find('.parsley-custom-error-message').length) this._ui.$errorsWrapper.append($(this.options.errorTemplate).addClass('parsley-custom-error-message'));\r\n\r\n          return this._ui.$errorsWrapper.addClass('filled').find('.parsley-custom-error-message').html(this.options.errorMessage);\r\n        }\r\n\r\n        return this._ui.$errorsWrapper.removeClass('filled').find('.parsley-custom-error-message').remove();\r\n      }\r\n\r\n      // Show, hide, update failing constraints messages\r\n      for (var i = 0; i < diff.removed.length; i++) this._removeError(diff.removed[i].assert.name);\r\n\r\n      for (i = 0; i < diff.added.length; i++) this._addError(diff.added[i].assert.name, { message: diff.added[i].errorMessage, assert: diff.added[i].assert });\r\n\r\n      for (i = 0; i < diff.kept.length; i++) this._updateError(diff.kept[i].assert.name, { message: diff.kept[i].errorMessage, assert: diff.kept[i].assert });\r\n    },\r\n\r\n    _addError: function _addError(name, _ref5) {\r\n      var message = _ref5.message;\r\n      var assert = _ref5.assert;\r\n\r\n      this._insertErrorWrapper();\r\n      this._ui.$errorsWrapper.addClass('filled').append($(this.options.errorTemplate).addClass('parsley-' + name).html(message || this._getErrorMessage(assert)));\r\n    },\r\n\r\n    _updateError: function _updateError(name, _ref6) {\r\n      var message = _ref6.message;\r\n      var assert = _ref6.assert;\r\n\r\n      this._ui.$errorsWrapper.addClass('filled').find('.parsley-' + name).html(message || this._getErrorMessage(assert));\r\n    },\r\n\r\n    _removeError: function _removeError(name) {\r\n      this._ui.$errorsWrapper.removeClass('filled').find('.parsley-' + name).remove();\r\n    },\r\n\r\n    _getErrorMessage: function _getErrorMessage(constraint) {\r\n      var customConstraintErrorMessage = constraint.name + 'Message';\r\n\r\n      if ('undefined' !== typeof this.options[customConstraintErrorMessage]) return window.Parsley.formatMessage(this.options[customConstraintErrorMessage], constraint.requirements);\r\n\r\n      return window.Parsley.getErrorMessage(constraint);\r\n    },\r\n\r\n    _buildUI: function _buildUI() {\r\n      // UI could be already built or disabled\r\n      if (this._ui || false === this.options.uiEnabled) return;\r\n\r\n      var _ui = {};\r\n\r\n      // Give field its Parsley id in DOM\r\n      this.$element.attr(this.options.namespace + 'id', this.__id__);\r\n\r\n      /** Generate important UI elements and store them in this **/\r\n      // $errorClassHandler is the $element that woul have parsley-error and parsley-success classes\r\n      _ui.$errorClassHandler = this._manageClassHandler();\r\n\r\n      // $errorsWrapper is a div that would contain the various field errors, it will be appended into $errorsContainer\r\n      _ui.errorsWrapperId = 'parsley-id-' + (this.options.multiple ? 'multiple-' + this.options.multiple : this.__id__);\r\n      _ui.$errorsWrapper = $(this.options.errorsWrapper).attr('id', _ui.errorsWrapperId);\r\n\r\n      // ValidationResult UI storage to detect what have changed bwt two validations, and update DOM accordingly\r\n      _ui.lastValidationResult = [];\r\n      _ui.validationInformationVisible = false;\r\n\r\n      // Store it in this for later\r\n      this._ui = _ui;\r\n    },\r\n\r\n    // Determine which element will have `parsley-error` and `parsley-success` classes\r\n    _manageClassHandler: function _manageClassHandler() {\r\n      // An element selector could be passed through DOM with `data-parsley-class-handler=#foo`\r\n      if ('string' === typeof this.options.classHandler && $(this.options.classHandler).length) return $(this.options.classHandler);\r\n\r\n      // Class handled could also be determined by function given in Parsley options\r\n      var $handler = this.options.classHandler.call(this, this);\r\n\r\n      // If this function returned a valid existing DOM element, go for it\r\n      if ('undefined' !== typeof $handler && $handler.length) return $handler;\r\n\r\n      return this._inputHolder();\r\n    },\r\n\r\n    _inputHolder: function _inputHolder() {\r\n      // if simple element (input, texatrea, select...) it will perfectly host the classes and precede the error container\r\n      if (!this.options.multiple || this.$element.is('select')) return this.$element;\r\n\r\n      // But if multiple element (radio, checkbox), that would be their parent\r\n      return this.$element.parent();\r\n    },\r\n\r\n    _insertErrorWrapper: function _insertErrorWrapper() {\r\n      var $errorsContainer;\r\n\r\n      // Nothing to do if already inserted\r\n      if (0 !== this._ui.$errorsWrapper.parent().length) return this._ui.$errorsWrapper.parent();\r\n\r\n      if ('string' === typeof this.options.errorsContainer) {\r\n        if ($(this.options.errorsContainer).length) return $(this.options.errorsContainer).append(this._ui.$errorsWrapper);else Utils__default.warn('The errors container `' + this.options.errorsContainer + '` does not exist in DOM');\r\n      } else if ('function' === typeof this.options.errorsContainer) $errorsContainer = this.options.errorsContainer.call(this, this);\r\n\r\n      if ('undefined' !== typeof $errorsContainer && $errorsContainer.length) return $errorsContainer.append(this._ui.$errorsWrapper);\r\n\r\n      return this._inputHolder().after(this._ui.$errorsWrapper);\r\n    },\r\n\r\n    _actualizeTriggers: function _actualizeTriggers() {\r\n      var _this3 = this;\r\n\r\n      var $toBind = this._findRelated();\r\n      var trigger;\r\n\r\n      // Remove Parsley events already bound on this field\r\n      $toBind.off('.Parsley');\r\n      if (this._failedOnce) $toBind.on(Utils__default.namespaceEvents(this.options.triggerAfterFailure, 'Parsley'), function () {\r\n        _this3._validateIfNeeded();\r\n      });else if (trigger = Utils__default.namespaceEvents(this.options.trigger, 'Parsley')) {\r\n        $toBind.on(trigger, function (event) {\r\n          _this3._validateIfNeeded(event);\r\n        });\r\n      }\r\n    },\r\n\r\n    _validateIfNeeded: function _validateIfNeeded(event) {\r\n      var _this4 = this;\r\n\r\n      // For keyup, keypress, keydown, input... events that could be a little bit obstrusive\r\n      // do not validate if val length < min threshold on first validation. Once field have been validated once and info\r\n      // about success or failure have been displayed, always validate with this trigger to reflect every yalidation change.\r\n      if (event && /key|input/.test(event.type)) if (!(this._ui && this._ui.validationInformationVisible) && this.getValue().length <= this.options.validationThreshold) return;\r\n\r\n      if (this.options.debounce) {\r\n        window.clearTimeout(this._debounced);\r\n        this._debounced = window.setTimeout(function () {\r\n          return _this4.validate();\r\n        }, this.options.debounce);\r\n      } else this.validate();\r\n    },\r\n\r\n    _resetUI: function _resetUI() {\r\n      // Reset all event listeners\r\n      this._failedOnce = false;\r\n      this._actualizeTriggers();\r\n\r\n      // Nothing to do if UI never initialized for this field\r\n      if ('undefined' === typeof this._ui) return;\r\n\r\n      // Reset all errors' li\r\n      this._ui.$errorsWrapper.removeClass('filled').children().remove();\r\n\r\n      // Reset validation class\r\n      this._resetClass();\r\n\r\n      // Reset validation flags and last validation result\r\n      this._ui.lastValidationResult = [];\r\n      this._ui.validationInformationVisible = false;\r\n    },\r\n\r\n    _destroyUI: function _destroyUI() {\r\n      this._resetUI();\r\n\r\n      if ('undefined' !== typeof this._ui) this._ui.$errorsWrapper.remove();\r\n\r\n      delete this._ui;\r\n    },\r\n\r\n    _successClass: function _successClass() {\r\n      this._ui.validationInformationVisible = true;\r\n      this._ui.$errorClassHandler.removeClass(this.options.errorClass).addClass(this.options.successClass);\r\n    },\r\n    _errorClass: function _errorClass() {\r\n      this._ui.validationInformationVisible = true;\r\n      this._ui.$errorClassHandler.removeClass(this.options.successClass).addClass(this.options.errorClass);\r\n    },\r\n    _resetClass: function _resetClass() {\r\n      this._ui.$errorClassHandler.removeClass(this.options.successClass).removeClass(this.options.errorClass);\r\n    }\r\n  };\r\n\r\n  var Form = function Form(element, domOptions, options) {\r\n    this.__class__ = 'Form';\r\n\r\n    this.$element = $(element);\r\n    this.domOptions = domOptions;\r\n    this.options = options;\r\n    this.parent = window.Parsley;\r\n\r\n    this.fields = [];\r\n    this.validationResult = null;\r\n  };\r\n\r\n  var Form__statusMapping = { pending: null, resolved: true, rejected: false };\r\n\r\n  Form.prototype = {\r\n    onSubmitValidate: function onSubmitValidate(event) {\r\n      var _this5 = this;\r\n\r\n      // This is a Parsley generated submit event, do not validate, do not prevent, simply exit and keep normal behavior\r\n      if (true === event.parsley) return;\r\n\r\n      // If we didn't come here through a submit button, use the first one in the form\r\n      var $submitSource = this._$submitSource || this.$element.find(Utils__default._SubmitSelector).first();\r\n      this._$submitSource = null;\r\n      this.$element.find('.parsley-synthetic-submit-button').prop('disabled', true);\r\n      if ($submitSource.is('[formnovalidate]')) return;\r\n\r\n      var promise = this.whenValidate({ event: event });\r\n\r\n      if ('resolved' === promise.state() && false !== this._trigger('submit')) {\r\n        // All good, let event go through. We make this distinction because browsers\r\n        // differ in their handling of `submit` being called from inside a submit event [#1047]\r\n      } else {\r\n          // Rejected or pending: cancel this submit\r\n          event.stopImmediatePropagation();\r\n          event.preventDefault();\r\n          if ('pending' === promise.state()) promise.done(function () {\r\n            _this5._submit($submitSource);\r\n          });\r\n        }\r\n    },\r\n\r\n    onSubmitButton: function onSubmitButton(event) {\r\n      this._$submitSource = $(event.currentTarget);\r\n    },\r\n    // internal\r\n    // _submit submits the form, this time without going through the validations.\r\n    // Care must be taken to \"fake\" the actual submit button being clicked.\r\n    _submit: function _submit($submitSource) {\r\n      if (false === this._trigger('submit')) return;\r\n      // Add submit button's data\r\n      if ($submitSource) {\r\n        var $synthetic = this.$element.find('.parsley-synthetic-submit-button').prop('disabled', false);\r\n        if (0 === $synthetic.length) $synthetic = $('<input class=\"parsley-synthetic-submit-button\" type=\"hidden\">').appendTo(this.$element);\r\n        $synthetic.attr({\r\n          name: $submitSource.attr('name'),\r\n          value: $submitSource.attr('value')\r\n        });\r\n      }\r\n\r\n      this.$element.trigger($.extend($.Event('submit'), { parsley: true }));\r\n    },\r\n\r\n    // Performs validation on fields while triggering events.\r\n    // @returns `true` if all validations succeeds, `false`\r\n    // if a failure is immediately detected, or `null`\r\n    // if dependant on a promise.\r\n    // Consider using `whenValidate` instead.\r\n    validate: function validate(options) {\r\n      if (arguments.length >= 1 && !$.isPlainObject(options)) {\r\n        Utils__default.warnOnce('Calling validate on a parsley form without passing arguments as an object is deprecated.');\r\n\r\n        var _arguments = _slice.call(arguments);\r\n\r\n        var group = _arguments[0];\r\n        var force = _arguments[1];\r\n        var event = _arguments[2];\r\n\r\n        options = { group: group, force: force, event: event };\r\n      }\r\n      return Form__statusMapping[this.whenValidate(options).state()];\r\n    },\r\n\r\n    whenValidate: function whenValidate() {\r\n      var _Utils__default$all$done$fail$always,\r\n          _this6 = this;\r\n\r\n      var _ref7 = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\r\n\r\n      var group = _ref7.group;\r\n      var force = _ref7.force;\r\n      var event = _ref7.event;\r\n\r\n      this.submitEvent = event;\r\n      if (event) {\r\n        this.submitEvent = $.extend({}, event, { preventDefault: function preventDefault() {\r\n            Utils__default.warnOnce(\"Using `this.submitEvent.preventDefault()` is deprecated; instead, call `this.validationResult = false`\");\r\n            _this6.validationResult = false;\r\n          } });\r\n      }\r\n      this.validationResult = true;\r\n\r\n      // fire validate event to eventually modify things before every validation\r\n      this._trigger('validate');\r\n\r\n      // Refresh form DOM options and form's fields that could have changed\r\n      this._refreshFields();\r\n\r\n      var promises = this._withoutReactualizingFormOptions(function () {\r\n        return $.map(_this6.fields, function (field) {\r\n          return field.whenValidate({ force: force, group: group });\r\n        });\r\n      });\r\n\r\n      return (_Utils__default$all$done$fail$always = Utils__default.all(promises).done(function () {\r\n        _this6._trigger('success');\r\n      }).fail(function () {\r\n        _this6.validationResult = false;\r\n        _this6.focus();\r\n        _this6._trigger('error');\r\n      }).always(function () {\r\n        _this6._trigger('validated');\r\n      })).pipe.apply(_Utils__default$all$done$fail$always, _toConsumableArray(this._pipeAccordingToValidationResult()));\r\n    },\r\n\r\n    // Iterate over refreshed fields, and stop on first failure.\r\n    // Returns `true` if all fields are valid, `false` if a failure is detected\r\n    // or `null` if the result depends on an unresolved promise.\r\n    // Prefer using `whenValid` instead.\r\n    isValid: function isValid(options) {\r\n      if (arguments.length >= 1 && !$.isPlainObject(options)) {\r\n        Utils__default.warnOnce('Calling isValid on a parsley form without passing arguments as an object is deprecated.');\r\n\r\n        var _arguments2 = _slice.call(arguments);\r\n\r\n        var group = _arguments2[0];\r\n        var force = _arguments2[1];\r\n\r\n        options = { group: group, force: force };\r\n      }\r\n      return Form__statusMapping[this.whenValid(options).state()];\r\n    },\r\n\r\n    // Iterate over refreshed fields and validate them.\r\n    // Returns a promise.\r\n    // A validation that immediately fails will interrupt the validations.\r\n    whenValid: function whenValid() {\r\n      var _this7 = this;\r\n\r\n      var _ref8 = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\r\n\r\n      var group = _ref8.group;\r\n      var force = _ref8.force;\r\n\r\n      this._refreshFields();\r\n\r\n      var promises = this._withoutReactualizingFormOptions(function () {\r\n        return $.map(_this7.fields, function (field) {\r\n          return field.whenValid({ group: group, force: force });\r\n        });\r\n      });\r\n      return Utils__default.all(promises);\r\n    },\r\n\r\n    // Reset UI\r\n    reset: function reset() {\r\n      // Form case: emit a reset event for each field\r\n      for (var i = 0; i < this.fields.length; i++) this.fields[i].reset();\r\n\r\n      this._trigger('reset');\r\n    },\r\n\r\n    // Destroy Parsley instance (+ UI)\r\n    destroy: function destroy() {\r\n      // Field case: emit destroy event to clean UI and then destroy stored instance\r\n      this._destroyUI();\r\n\r\n      // Form case: destroy all its fields and then destroy stored instance\r\n      for (var i = 0; i < this.fields.length; i++) this.fields[i].destroy();\r\n\r\n      this.$element.removeData('Parsley');\r\n      this._trigger('destroy');\r\n    },\r\n\r\n    _refreshFields: function _refreshFields() {\r\n      return this.actualizeOptions()._bindFields();\r\n    },\r\n\r\n    _bindFields: function _bindFields() {\r\n      var _this8 = this;\r\n\r\n      var oldFields = this.fields;\r\n\r\n      this.fields = [];\r\n      this.fieldsMappedById = {};\r\n\r\n      this._withoutReactualizingFormOptions(function () {\r\n        _this8.$element.find(_this8.options.inputs).not(_this8.options.excluded).each(function (_, element) {\r\n          var fieldInstance = new window.Parsley.Factory(element, {}, _this8);\r\n\r\n          // Only add valid and not excluded `Field` and `FieldMultiple` children\r\n          if (('Field' === fieldInstance.__class__ || 'FieldMultiple' === fieldInstance.__class__) && true !== fieldInstance.options.excluded) {\r\n            var uniqueId = fieldInstance.__class__ + '-' + fieldInstance.__id__;\r\n            if ('undefined' === typeof _this8.fieldsMappedById[uniqueId]) {\r\n              _this8.fieldsMappedById[uniqueId] = fieldInstance;\r\n              _this8.fields.push(fieldInstance);\r\n            }\r\n          }\r\n        });\r\n\r\n        $.each(Utils__default.difference(oldFields, _this8.fields), function (_, field) {\r\n          field.reset();\r\n        });\r\n      });\r\n      return this;\r\n    },\r\n\r\n    // Internal only.\r\n    // Looping on a form's fields to do validation or similar\r\n    // will trigger reactualizing options on all of them, which\r\n    // in turn will reactualize the form's options.\r\n    // To avoid calling actualizeOptions so many times on the form\r\n    // for nothing, _withoutReactualizingFormOptions temporarily disables\r\n    // the method actualizeOptions on this form while `fn` is called.\r\n    _withoutReactualizingFormOptions: function _withoutReactualizingFormOptions(fn) {\r\n      var oldActualizeOptions = this.actualizeOptions;\r\n      this.actualizeOptions = function () {\r\n        return this;\r\n      };\r\n      var result = fn();\r\n      this.actualizeOptions = oldActualizeOptions;\r\n      return result;\r\n    },\r\n\r\n    // Internal only.\r\n    // Shortcut to trigger an event\r\n    // Returns true iff event is not interrupted and default not prevented.\r\n    _trigger: function _trigger(eventName) {\r\n      return this.trigger('form:' + eventName);\r\n    }\r\n\r\n  };\r\n\r\n  var Constraint = function Constraint(parsleyField, name, requirements, priority, isDomConstraint) {\r\n    var validatorSpec = window.Parsley._validatorRegistry.validators[name];\r\n    var validator = new Validator(validatorSpec);\r\n\r\n    $.extend(this, {\r\n      validator: validator,\r\n      name: name,\r\n      requirements: requirements,\r\n      priority: priority || parsleyField.options[name + 'Priority'] || validator.priority,\r\n      isDomConstraint: true === isDomConstraint\r\n    });\r\n    this._parseRequirements(parsleyField.options);\r\n  };\r\n\r\n  var capitalize = function capitalize(str) {\r\n    var cap = str[0].toUpperCase();\r\n    return cap + str.slice(1);\r\n  };\r\n\r\n  Constraint.prototype = {\r\n    validate: function validate(value, instance) {\r\n      var _validator;\r\n\r\n      return (_validator = this.validator).validate.apply(_validator, [value].concat(_toConsumableArray(this.requirementList), [instance]));\r\n    },\r\n\r\n    _parseRequirements: function _parseRequirements(options) {\r\n      var _this9 = this;\r\n\r\n      this.requirementList = this.validator.parseRequirements(this.requirements, function (key) {\r\n        return options[_this9.name + capitalize(key)];\r\n      });\r\n    }\r\n  };\r\n\r\n  var Field = function Field(field, domOptions, options, parsleyFormInstance) {\r\n    this.__class__ = 'Field';\r\n\r\n    this.$element = $(field);\r\n\r\n    // Set parent if we have one\r\n    if ('undefined' !== typeof parsleyFormInstance) {\r\n      this.parent = parsleyFormInstance;\r\n    }\r\n\r\n    this.options = options;\r\n    this.domOptions = domOptions;\r\n\r\n    // Initialize some properties\r\n    this.constraints = [];\r\n    this.constraintsByName = {};\r\n    this.validationResult = true;\r\n\r\n    // Bind constraints\r\n    this._bindConstraints();\r\n  };\r\n\r\n  var parsley_field__statusMapping = { pending: null, resolved: true, rejected: false };\r\n\r\n  Field.prototype = {\r\n    // # Public API\r\n    // Validate field and trigger some events for mainly `UI`\r\n    // @returns `true`, an array of the validators that failed, or\r\n    // `null` if validation is not finished. Prefer using whenValidate\r\n    validate: function validate(options) {\r\n      if (arguments.length >= 1 && !$.isPlainObject(options)) {\r\n        Utils__default.warnOnce('Calling validate on a parsley field without passing arguments as an object is deprecated.');\r\n        options = { options: options };\r\n      }\r\n      var promise = this.whenValidate(options);\r\n      if (!promise) // If excluded with `group` option\r\n        return true;\r\n      switch (promise.state()) {\r\n        case 'pending':\r\n          return null;\r\n        case 'resolved':\r\n          return true;\r\n        case 'rejected':\r\n          return this.validationResult;\r\n      }\r\n    },\r\n\r\n    // Validate field and trigger some events for mainly `UI`\r\n    // @returns a promise that succeeds only when all validations do\r\n    // or `undefined` if field is not in the given `group`.\r\n    whenValidate: function whenValidate() {\r\n      var _whenValid$always$done$fail$always,\r\n          _this10 = this;\r\n\r\n      var _ref9 = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\r\n\r\n      var force = _ref9.force;\r\n      var group = _ref9.group;\r\n\r\n      // do not validate a field if not the same as given validation group\r\n      this.refreshConstraints();\r\n      if (group && !this._isInGroup(group)) return;\r\n\r\n      this.value = this.getValue();\r\n\r\n      // Field Validate event. `this.value` could be altered for custom needs\r\n      this._trigger('validate');\r\n\r\n      return (_whenValid$always$done$fail$always = this.whenValid({ force: force, value: this.value, _refreshed: true }).always(function () {\r\n        _this10._reflowUI();\r\n      }).done(function () {\r\n        _this10._trigger('success');\r\n      }).fail(function () {\r\n        _this10._trigger('error');\r\n      }).always(function () {\r\n        _this10._trigger('validated');\r\n      })).pipe.apply(_whenValid$always$done$fail$always, _toConsumableArray(this._pipeAccordingToValidationResult()));\r\n    },\r\n\r\n    hasConstraints: function hasConstraints() {\r\n      return 0 !== this.constraints.length;\r\n    },\r\n\r\n    // An empty optional field does not need validation\r\n    needsValidation: function needsValidation(value) {\r\n      if ('undefined' === typeof value) value = this.getValue();\r\n\r\n      // If a field is empty and not required, it is valid\r\n      // Except if `data-parsley-validate-if-empty` explicitely added, useful for some custom validators\r\n      if (!value.length && !this._isRequired() && 'undefined' === typeof this.options.validateIfEmpty) return false;\r\n\r\n      return true;\r\n    },\r\n\r\n    _isInGroup: function _isInGroup(group) {\r\n      if ($.isArray(this.options.group)) return -1 !== $.inArray(group, this.options.group);\r\n      return this.options.group === group;\r\n    },\r\n\r\n    // Just validate field. Do not trigger any event.\r\n    // Returns `true` iff all constraints pass, `false` if there are failures,\r\n    // or `null` if the result can not be determined yet (depends on a promise)\r\n    // See also `whenValid`.\r\n    isValid: function isValid(options) {\r\n      if (arguments.length >= 1 && !$.isPlainObject(options)) {\r\n        Utils__default.warnOnce('Calling isValid on a parsley field without passing arguments as an object is deprecated.');\r\n\r\n        var _arguments3 = _slice.call(arguments);\r\n\r\n        var force = _arguments3[0];\r\n        var value = _arguments3[1];\r\n\r\n        options = { force: force, value: value };\r\n      }\r\n      var promise = this.whenValid(options);\r\n      if (!promise) // Excluded via `group`\r\n        return true;\r\n      return parsley_field__statusMapping[promise.state()];\r\n    },\r\n\r\n    // Just validate field. Do not trigger any event.\r\n    // @returns a promise that succeeds only when all validations do\r\n    // or `undefined` if the field is not in the given `group`.\r\n    // The argument `force` will force validation of empty fields.\r\n    // If a `value` is given, it will be validated instead of the value of the input.\r\n    whenValid: function whenValid() {\r\n      var _this11 = this;\r\n\r\n      var _ref10 = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\r\n\r\n      var _ref10$force = _ref10.force;\r\n      var force = _ref10$force === undefined ? false : _ref10$force;\r\n      var value = _ref10.value;\r\n      var group = _ref10.group;\r\n      var _refreshed = _ref10._refreshed;\r\n\r\n      // Recompute options and rebind constraints to have latest changes\r\n      if (!_refreshed) this.refreshConstraints();\r\n      // do not validate a field if not the same as given validation group\r\n      if (group && !this._isInGroup(group)) return;\r\n\r\n      this.validationResult = true;\r\n\r\n      // A field without constraint is valid\r\n      if (!this.hasConstraints()) return $.when();\r\n\r\n      // Value could be passed as argument, needed to add more power to 'field:validate'\r\n      if ('undefined' === typeof value || null === value) value = this.getValue();\r\n\r\n      if (!this.needsValidation(value) && true !== force) return $.when();\r\n\r\n      var groupedConstraints = this._getGroupedConstraints();\r\n      var promises = [];\r\n      $.each(groupedConstraints, function (_, constraints) {\r\n        // Process one group of constraints at a time, we validate the constraints\r\n        // and combine the promises together.\r\n        var promise = Utils__default.all($.map(constraints, function (constraint) {\r\n          return _this11._validateConstraint(value, constraint);\r\n        }));\r\n        promises.push(promise);\r\n        if (promise.state() === 'rejected') return false; // Interrupt processing if a group has already failed\r\n      });\r\n      return Utils__default.all(promises);\r\n    },\r\n\r\n    // @returns a promise\r\n    _validateConstraint: function _validateConstraint(value, constraint) {\r\n      var _this12 = this;\r\n\r\n      var result = constraint.validate(value, this);\r\n      // Map false to a failed promise\r\n      if (false === result) result = $.Deferred().reject();\r\n      // Make sure we return a promise and that we record failures\r\n      return Utils__default.all([result]).fail(function (errorMessage) {\r\n        if (!(_this12.validationResult instanceof Array)) _this12.validationResult = [];\r\n        _this12.validationResult.push({\r\n          assert: constraint,\r\n          errorMessage: 'string' === typeof errorMessage && errorMessage\r\n        });\r\n      });\r\n    },\r\n\r\n    // @returns Parsley field computed value that could be overrided or configured in DOM\r\n    getValue: function getValue() {\r\n      var value;\r\n\r\n      // Value could be overriden in DOM or with explicit options\r\n      if ('function' === typeof this.options.value) value = this.options.value(this);else if ('undefined' !== typeof this.options.value) value = this.options.value;else value = this.$element.val();\r\n\r\n      // Handle wrong DOM or configurations\r\n      if ('undefined' === typeof value || null === value) return '';\r\n\r\n      return this._handleWhitespace(value);\r\n    },\r\n\r\n    // Reset UI\r\n    reset: function reset() {\r\n      this._resetUI();\r\n      return this._trigger('reset');\r\n    },\r\n\r\n    // Destroy Parsley instance (+ UI)\r\n    destroy: function destroy() {\r\n      // Field case: emit destroy event to clean UI and then destroy stored instance\r\n      this._destroyUI();\r\n      this.$element.removeData('Parsley');\r\n      this.$element.removeData('FieldMultiple');\r\n      this._trigger('destroy');\r\n    },\r\n\r\n    // Actualize options that could have change since previous validation\r\n    // Re-bind accordingly constraints (could be some new, removed or updated)\r\n    refreshConstraints: function refreshConstraints() {\r\n      return this.actualizeOptions()._bindConstraints();\r\n    },\r\n\r\n    /**\r\n    * Add a new constraint to a field\r\n    *\r\n    * @param {String}   name\r\n    * @param {Mixed}    requirements      optional\r\n    * @param {Number}   priority          optional\r\n    * @param {Boolean}  isDomConstraint   optional\r\n    */\r\n    addConstraint: function addConstraint(name, requirements, priority, isDomConstraint) {\r\n\r\n      if (window.Parsley._validatorRegistry.validators[name]) {\r\n        var constraint = new Constraint(this, name, requirements, priority, isDomConstraint);\r\n\r\n        // if constraint already exist, delete it and push new version\r\n        if ('undefined' !== this.constraintsByName[constraint.name]) this.removeConstraint(constraint.name);\r\n\r\n        this.constraints.push(constraint);\r\n        this.constraintsByName[constraint.name] = constraint;\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    // Remove a constraint\r\n    removeConstraint: function removeConstraint(name) {\r\n      for (var i = 0; i < this.constraints.length; i++) if (name === this.constraints[i].name) {\r\n        this.constraints.splice(i, 1);\r\n        break;\r\n      }\r\n      delete this.constraintsByName[name];\r\n      return this;\r\n    },\r\n\r\n    // Update a constraint (Remove + re-add)\r\n    updateConstraint: function updateConstraint(name, parameters, priority) {\r\n      return this.removeConstraint(name).addConstraint(name, parameters, priority);\r\n    },\r\n\r\n    // # Internals\r\n\r\n    // Internal only.\r\n    // Bind constraints from config + options + DOM\r\n    _bindConstraints: function _bindConstraints() {\r\n      var constraints = [];\r\n      var constraintsByName = {};\r\n\r\n      // clean all existing DOM constraints to only keep javascript user constraints\r\n      for (var i = 0; i < this.constraints.length; i++) if (false === this.constraints[i].isDomConstraint) {\r\n        constraints.push(this.constraints[i]);\r\n        constraintsByName[this.constraints[i].name] = this.constraints[i];\r\n      }\r\n\r\n      this.constraints = constraints;\r\n      this.constraintsByName = constraintsByName;\r\n\r\n      // then re-add Parsley DOM-API constraints\r\n      for (var name in this.options) this.addConstraint(name, this.options[name], undefined, true);\r\n\r\n      // finally, bind special HTML5 constraints\r\n      return this._bindHtml5Constraints();\r\n    },\r\n\r\n    // Internal only.\r\n    // Bind specific HTML5 constraints to be HTML5 compliant\r\n    _bindHtml5Constraints: function _bindHtml5Constraints() {\r\n      // html5 required\r\n      if (this.$element.attr('required')) this.addConstraint('required', true, undefined, true);\r\n\r\n      // html5 pattern\r\n      if ('string' === typeof this.$element.attr('pattern')) this.addConstraint('pattern', this.$element.attr('pattern'), undefined, true);\r\n\r\n      // range\r\n      if ('undefined' !== typeof this.$element.attr('min') && 'undefined' !== typeof this.$element.attr('max')) this.addConstraint('range', [this.$element.attr('min'), this.$element.attr('max')], undefined, true);\r\n\r\n      // HTML5 min\r\n      else if ('undefined' !== typeof this.$element.attr('min')) this.addConstraint('min', this.$element.attr('min'), undefined, true);\r\n\r\n        // HTML5 max\r\n        else if ('undefined' !== typeof this.$element.attr('max')) this.addConstraint('max', this.$element.attr('max'), undefined, true);\r\n\r\n      // length\r\n      if ('undefined' !== typeof this.$element.attr('minlength') && 'undefined' !== typeof this.$element.attr('maxlength')) this.addConstraint('length', [this.$element.attr('minlength'), this.$element.attr('maxlength')], undefined, true);\r\n\r\n      // HTML5 minlength\r\n      else if ('undefined' !== typeof this.$element.attr('minlength')) this.addConstraint('minlength', this.$element.attr('minlength'), undefined, true);\r\n\r\n        // HTML5 maxlength\r\n        else if ('undefined' !== typeof this.$element.attr('maxlength')) this.addConstraint('maxlength', this.$element.attr('maxlength'), undefined, true);\r\n\r\n      // html5 types\r\n      var type = this.$element.attr('type');\r\n\r\n      if ('undefined' === typeof type) return this;\r\n\r\n      // Small special case here for HTML5 number: integer validator if step attribute is undefined or an integer value, number otherwise\r\n      if ('number' === type) {\r\n        return this.addConstraint('type', ['number', {\r\n          step: this.$element.attr('step') || '1',\r\n          base: this.$element.attr('min') || this.$element.attr('value')\r\n        }], undefined, true);\r\n        // Regular other HTML5 supported types\r\n      } else if (/^(email|url|range|date)$/i.test(type)) {\r\n          return this.addConstraint('type', type, undefined, true);\r\n        }\r\n      return this;\r\n    },\r\n\r\n    // Internal only.\r\n    // Field is required if have required constraint without `false` value\r\n    _isRequired: function _isRequired() {\r\n      if ('undefined' === typeof this.constraintsByName.required) return false;\r\n\r\n      return false !== this.constraintsByName.required.requirements;\r\n    },\r\n\r\n    // Internal only.\r\n    // Shortcut to trigger an event\r\n    _trigger: function _trigger(eventName) {\r\n      return this.trigger('field:' + eventName);\r\n    },\r\n\r\n    // Internal only\r\n    // Handles whitespace in a value\r\n    // Use `data-parsley-whitespace=\"squish\"` to auto squish input value\r\n    // Use `data-parsley-whitespace=\"trim\"` to auto trim input value\r\n    _handleWhitespace: function _handleWhitespace(value) {\r\n      if (true === this.options.trimValue) Utils__default.warnOnce('data-parsley-trim-value=\"true\" is deprecated, please use data-parsley-whitespace=\"trim\"');\r\n\r\n      if ('squish' === this.options.whitespace) value = value.replace(/\\s{2,}/g, ' ');\r\n\r\n      if ('trim' === this.options.whitespace || 'squish' === this.options.whitespace || true === this.options.trimValue) value = Utils__default.trimString(value);\r\n\r\n      return value;\r\n    },\r\n\r\n    _isDateInput: function _isDateInput() {\r\n      var c = this.constraintsByName.type;\r\n      return c && c.requirements === 'date';\r\n    },\r\n\r\n    // Internal only.\r\n    // Returns the constraints, grouped by descending priority.\r\n    // The result is thus an array of arrays of constraints.\r\n    _getGroupedConstraints: function _getGroupedConstraints() {\r\n      if (false === this.options.priorityEnabled) return [this.constraints];\r\n\r\n      var groupedConstraints = [];\r\n      var index = {};\r\n\r\n      // Create array unique of priorities\r\n      for (var i = 0; i < this.constraints.length; i++) {\r\n        var p = this.constraints[i].priority;\r\n        if (!index[p]) groupedConstraints.push(index[p] = []);\r\n        index[p].push(this.constraints[i]);\r\n      }\r\n      // Sort them by priority DESC\r\n      groupedConstraints.sort(function (a, b) {\r\n        return b[0].priority - a[0].priority;\r\n      });\r\n\r\n      return groupedConstraints;\r\n    }\r\n\r\n  };\r\n\r\n  var parsley_field = Field;\r\n\r\n  var Multiple = function Multiple() {\r\n    this.__class__ = 'FieldMultiple';\r\n  };\r\n\r\n  Multiple.prototype = {\r\n    // Add new `$element` sibling for multiple field\r\n    addElement: function addElement($element) {\r\n      this.$elements.push($element);\r\n\r\n      return this;\r\n    },\r\n\r\n    // See `Field.refreshConstraints()`\r\n    refreshConstraints: function refreshConstraints() {\r\n      var fieldConstraints;\r\n\r\n      this.constraints = [];\r\n\r\n      // Select multiple special treatment\r\n      if (this.$element.is('select')) {\r\n        this.actualizeOptions()._bindConstraints();\r\n\r\n        return this;\r\n      }\r\n\r\n      // Gather all constraints for each input in the multiple group\r\n      for (var i = 0; i < this.$elements.length; i++) {\r\n\r\n        // Check if element have not been dynamically removed since last binding\r\n        if (!$('html').has(this.$elements[i]).length) {\r\n          this.$elements.splice(i, 1);\r\n          continue;\r\n        }\r\n\r\n        fieldConstraints = this.$elements[i].data('FieldMultiple').refreshConstraints().constraints;\r\n\r\n        for (var j = 0; j < fieldConstraints.length; j++) this.addConstraint(fieldConstraints[j].name, fieldConstraints[j].requirements, fieldConstraints[j].priority, fieldConstraints[j].isDomConstraint);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    // See `Field.getValue()`\r\n    getValue: function getValue() {\r\n      // Value could be overriden in DOM\r\n      if ('function' === typeof this.options.value) return this.options.value(this);else if ('undefined' !== typeof this.options.value) return this.options.value;\r\n\r\n      // Radio input case\r\n      if (this.$element.is('input[type=radio]')) return this._findRelated().filter(':checked').val() || '';\r\n\r\n      // checkbox input case\r\n      if (this.$element.is('input[type=checkbox]')) {\r\n        var values = [];\r\n\r\n        this._findRelated().filter(':checked').each(function () {\r\n          values.push($(this).val());\r\n        });\r\n\r\n        return values;\r\n      }\r\n\r\n      // Select multiple case\r\n      if (this.$element.is('select') && null === this.$element.val()) return [];\r\n\r\n      // Default case that should never happen\r\n      return this.$element.val();\r\n    },\r\n\r\n    _init: function _init() {\r\n      this.$elements = [this.$element];\r\n\r\n      return this;\r\n    }\r\n  };\r\n\r\n  var Factory = function Factory(element, options, parsleyFormInstance) {\r\n    this.$element = $(element);\r\n\r\n    // If the element has already been bound, returns its saved Parsley instance\r\n    var savedparsleyFormInstance = this.$element.data('Parsley');\r\n    if (savedparsleyFormInstance) {\r\n\r\n      // If the saved instance has been bound without a Form parent and there is one given in this call, add it\r\n      if ('undefined' !== typeof parsleyFormInstance && savedparsleyFormInstance.parent === window.Parsley) {\r\n        savedparsleyFormInstance.parent = parsleyFormInstance;\r\n        savedparsleyFormInstance._resetOptions(savedparsleyFormInstance.options);\r\n      }\r\n\r\n      if ('object' === typeof options) {\r\n        $.extend(savedparsleyFormInstance.options, options);\r\n      }\r\n\r\n      return savedparsleyFormInstance;\r\n    }\r\n\r\n    // Parsley must be instantiated with a DOM element or jQuery $element\r\n    if (!this.$element.length) throw new Error('You must bind Parsley on an existing element.');\r\n\r\n    if ('undefined' !== typeof parsleyFormInstance && 'Form' !== parsleyFormInstance.__class__) throw new Error('Parent instance must be a Form instance');\r\n\r\n    this.parent = parsleyFormInstance || window.Parsley;\r\n    return this.init(options);\r\n  };\r\n\r\n  Factory.prototype = {\r\n    init: function init(options) {\r\n      this.__class__ = 'Parsley';\r\n      this.__version__ = '2.7.0';\r\n      this.__id__ = Utils__default.generateID();\r\n\r\n      // Pre-compute options\r\n      this._resetOptions(options);\r\n\r\n      // A Form instance is obviously a `<form>` element but also every node that is not an input and has the `data-parsley-validate` attribute\r\n      if (this.$element.is('form') || Utils__default.checkAttr(this.$element, this.options.namespace, 'validate') && !this.$element.is(this.options.inputs)) return this.bind('parsleyForm');\r\n\r\n      // Every other element is bound as a `Field` or `FieldMultiple`\r\n      return this.isMultiple() ? this.handleMultiple() : this.bind('parsleyField');\r\n    },\r\n\r\n    isMultiple: function isMultiple() {\r\n      return this.$element.is('input[type=radio], input[type=checkbox]') || this.$element.is('select') && 'undefined' !== typeof this.$element.attr('multiple');\r\n    },\r\n\r\n    // Multiples fields are a real nightmare :(\r\n    // Maybe some refactoring would be appreciated here...\r\n    handleMultiple: function handleMultiple() {\r\n      var _this13 = this;\r\n\r\n      var name;\r\n      var multiple;\r\n      var parsleyMultipleInstance;\r\n\r\n      // Handle multiple name\r\n      if (this.options.multiple) ; // We already have our 'multiple' identifier\r\n      else if ('undefined' !== typeof this.$element.attr('name') && this.$element.attr('name').length) this.options.multiple = name = this.$element.attr('name');else if ('undefined' !== typeof this.$element.attr('id') && this.$element.attr('id').length) this.options.multiple = this.$element.attr('id');\r\n\r\n      // Special select multiple input\r\n      if (this.$element.is('select') && 'undefined' !== typeof this.$element.attr('multiple')) {\r\n        this.options.multiple = this.options.multiple || this.__id__;\r\n        return this.bind('parsleyFieldMultiple');\r\n\r\n        // Else for radio / checkboxes, we need a `name` or `data-parsley-multiple` to properly bind it\r\n      } else if (!this.options.multiple) {\r\n          Utils__default.warn('To be bound by Parsley, a radio, a checkbox and a multiple select input must have either a name or a multiple option.', this.$element);\r\n          return this;\r\n        }\r\n\r\n      // Remove special chars\r\n      this.options.multiple = this.options.multiple.replace(/(:|\\.|\\[|\\]|\\{|\\}|\\$)/g, '');\r\n\r\n      // Add proper `data-parsley-multiple` to siblings if we have a valid multiple name\r\n      if ('undefined' !== typeof name) {\r\n        $('input[name=\"' + name + '\"]').each(function (i, input) {\r\n          if ($(input).is('input[type=radio], input[type=checkbox]')) $(input).attr(_this13.options.namespace + 'multiple', _this13.options.multiple);\r\n        });\r\n      }\r\n\r\n      // Check here if we don't already have a related multiple instance saved\r\n      var $previouslyRelated = this._findRelated();\r\n      for (var i = 0; i < $previouslyRelated.length; i++) {\r\n        parsleyMultipleInstance = $($previouslyRelated.get(i)).data('Parsley');\r\n        if ('undefined' !== typeof parsleyMultipleInstance) {\r\n\r\n          if (!this.$element.data('FieldMultiple')) {\r\n            parsleyMultipleInstance.addElement(this.$element);\r\n          }\r\n\r\n          break;\r\n        }\r\n      }\r\n\r\n      // Create a secret Field instance for every multiple field. It will be stored in `data('FieldMultiple')`\r\n      // And will be useful later to access classic `Field` stuff while being in a `FieldMultiple` instance\r\n      this.bind('parsleyField', true);\r\n\r\n      return parsleyMultipleInstance || this.bind('parsleyFieldMultiple');\r\n    },\r\n\r\n    // Return proper `Form`, `Field` or `FieldMultiple`\r\n    bind: function bind(type, doNotStore) {\r\n      var parsleyInstance;\r\n\r\n      switch (type) {\r\n        case 'parsleyForm':\r\n          parsleyInstance = $.extend(new Form(this.$element, this.domOptions, this.options), new Base(), window.ParsleyExtend)._bindFields();\r\n          break;\r\n        case 'parsleyField':\r\n          parsleyInstance = $.extend(new parsley_field(this.$element, this.domOptions, this.options, this.parent), new Base(), window.ParsleyExtend);\r\n          break;\r\n        case 'parsleyFieldMultiple':\r\n          parsleyInstance = $.extend(new parsley_field(this.$element, this.domOptions, this.options, this.parent), new Multiple(), new Base(), window.ParsleyExtend)._init();\r\n          break;\r\n        default:\r\n          throw new Error(type + 'is not a supported Parsley type');\r\n      }\r\n\r\n      if (this.options.multiple) Utils__default.setAttr(this.$element, this.options.namespace, 'multiple', this.options.multiple);\r\n\r\n      if ('undefined' !== typeof doNotStore) {\r\n        this.$element.data('FieldMultiple', parsleyInstance);\r\n\r\n        return parsleyInstance;\r\n      }\r\n\r\n      // Store the freshly bound instance in a DOM element for later access using jQuery `data()`\r\n      this.$element.data('Parsley', parsleyInstance);\r\n\r\n      // Tell the world we have a new Form or Field instance!\r\n      parsleyInstance._actualizeTriggers();\r\n      parsleyInstance._trigger('init');\r\n\r\n      return parsleyInstance;\r\n    }\r\n  };\r\n\r\n  var vernums = $.fn.jquery.split('.');\r\n  if (parseInt(vernums[0]) <= 1 && parseInt(vernums[1]) < 8) {\r\n    throw \"The loaded version of jQuery is too old. Please upgrade to 1.8.x or better.\";\r\n  }\r\n  if (!vernums.forEach) {\r\n    Utils__default.warn('Parsley requires ES5 to run properly. Please include https://github.com/es-shims/es5-shim');\r\n  }\r\n  // Inherit `on`, `off` & `trigger` to Parsley:\r\n  var Parsley = $.extend(new Base(), {\r\n    $element: $(document),\r\n    actualizeOptions: null,\r\n    _resetOptions: null,\r\n    Factory: Factory,\r\n    version: '2.7.0'\r\n  });\r\n\r\n  // Supplement Field and Form with Base\r\n  // This way, the constructors will have access to those methods\r\n  $.extend(parsley_field.prototype, UI.Field, Base.prototype);\r\n  $.extend(Form.prototype, UI.Form, Base.prototype);\r\n  // Inherit actualizeOptions and _resetOptions:\r\n  $.extend(Factory.prototype, Base.prototype);\r\n\r\n  // ### jQuery API\r\n  // `$('.elem').parsley(options)` or `$('.elem').psly(options)`\r\n  $.fn.parsley = $.fn.psly = function (options) {\r\n    if (this.length > 1) {\r\n      var instances = [];\r\n\r\n      this.each(function () {\r\n        instances.push($(this).parsley(options));\r\n      });\r\n\r\n      return instances;\r\n    }\r\n\r\n    // Return undefined if applied to non existing DOM element\r\n    if (!$(this).length) {\r\n      Utils__default.warn('You must bind Parsley on an existing element.');\r\n\r\n      return;\r\n    }\r\n\r\n    return new Factory(this, options);\r\n  };\r\n\r\n  // ### Field and Form extension\r\n  // Ensure the extension is now defined if it wasn't previously\r\n  if ('undefined' === typeof window.ParsleyExtend) window.ParsleyExtend = {};\r\n\r\n  // ### Parsley config\r\n  // Inherit from ParsleyDefault, and copy over any existing values\r\n  Parsley.options = $.extend(Utils__default.objectCreate(Defaults), window.ParsleyConfig);\r\n  window.ParsleyConfig = Parsley.options; // Old way of accessing global options\r\n\r\n  // ### Globals\r\n  window.Parsley = window.psly = Parsley;\r\n  Parsley.Utils = Utils__default;\r\n  window.ParsleyUtils = {};\r\n  $.each(Utils__default, function (key, value) {\r\n    if ('function' === typeof value) {\r\n      window.ParsleyUtils[key] = function () {\r\n        Utils__default.warnOnce('Accessing `window.ParsleyUtils` is deprecated. Use `window.Parsley.Utils` instead.');\r\n        return Utils__default[key].apply(Utils__default, arguments);\r\n      };\r\n    }\r\n  });\r\n\r\n  // ### Define methods that forward to the registry, and deprecate all access except through window.Parsley\r\n  var registry = window.Parsley._validatorRegistry = new ValidatorRegistry(window.ParsleyConfig.validators, window.ParsleyConfig.i18n);\r\n  window.ParsleyValidator = {};\r\n  $.each('setLocale addCatalog addMessage addMessages getErrorMessage formatMessage addValidator updateValidator removeValidator'.split(' '), function (i, method) {\r\n    window.Parsley[method] = $.proxy(registry, method);\r\n    window.ParsleyValidator[method] = function () {\r\n      var _window$Parsley;\r\n\r\n      Utils__default.warnOnce('Accessing the method \\'' + method + '\\' through Validator is deprecated. Simply call \\'window.Parsley.' + method + '(...)\\'');\r\n      return (_window$Parsley = window.Parsley)[method].apply(_window$Parsley, arguments);\r\n    };\r\n  });\r\n\r\n  // ### UI\r\n  // Deprecated global object\r\n  window.Parsley.UI = UI;\r\n  window.ParsleyUI = {\r\n    removeError: function removeError(instance, name, doNotUpdateClass) {\r\n      var updateClass = true !== doNotUpdateClass;\r\n      Utils__default.warnOnce('Accessing UI is deprecated. Call \\'removeError\\' on the instance directly. Please comment in issue 1073 as to your need to call this method.');\r\n      return instance.removeError(name, { updateClass: updateClass });\r\n    },\r\n    getErrorsMessages: function getErrorsMessages(instance) {\r\n      Utils__default.warnOnce('Accessing UI is deprecated. Call \\'getErrorsMessages\\' on the instance directly.');\r\n      return instance.getErrorsMessages();\r\n    }\r\n  };\r\n  $.each('addError updateError'.split(' '), function (i, method) {\r\n    window.ParsleyUI[method] = function (instance, name, message, assert, doNotUpdateClass) {\r\n      var updateClass = true !== doNotUpdateClass;\r\n      Utils__default.warnOnce('Accessing UI is deprecated. Call \\'' + method + '\\' on the instance directly. Please comment in issue 1073 as to your need to call this method.');\r\n      return instance[method](name, { message: message, assert: assert, updateClass: updateClass });\r\n    };\r\n  });\r\n\r\n  // ### PARSLEY auto-binding\r\n  // Prevent it by setting `ParsleyConfig.autoBind` to `false`\r\n  if (false !== window.ParsleyConfig.autoBind) {\r\n    $(function () {\r\n      // Works only on `data-parsley-validate`.\r\n      if ($('[data-parsley-validate]').length) $('[data-parsley-validate]').parsley();\r\n    });\r\n  }\r\n\r\n  var o = $({});\r\n  var deprecated = function deprecated() {\r\n    Utils__default.warnOnce(\"Parsley's pubsub module is deprecated; use the 'on' and 'off' methods on parsley instances or window.Parsley\");\r\n  };\r\n\r\n  // Returns an event handler that calls `fn` with the arguments it expects\r\n  function adapt(fn, context) {\r\n    // Store to allow unbinding\r\n    if (!fn.parsleyAdaptedCallback) {\r\n      fn.parsleyAdaptedCallback = function () {\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n        args.unshift(this);\r\n        fn.apply(context || o, args);\r\n      };\r\n    }\r\n    return fn.parsleyAdaptedCallback;\r\n  }\r\n\r\n  var eventPrefix = 'parsley:';\r\n  // Converts 'parsley:form:validate' into 'form:validate'\r\n  function eventName(name) {\r\n    if (name.lastIndexOf(eventPrefix, 0) === 0) return name.substr(eventPrefix.length);\r\n    return name;\r\n  }\r\n\r\n  // $.listen is deprecated. Use Parsley.on instead.\r\n  $.listen = function (name, callback) {\r\n    var context;\r\n    deprecated();\r\n    if ('object' === typeof arguments[1] && 'function' === typeof arguments[2]) {\r\n      context = arguments[1];\r\n      callback = arguments[2];\r\n    }\r\n\r\n    if ('function' !== typeof callback) throw new Error('Wrong parameters');\r\n\r\n    window.Parsley.on(eventName(name), adapt(callback, context));\r\n  };\r\n\r\n  $.listenTo = function (instance, name, fn) {\r\n    deprecated();\r\n    if (!(instance instanceof parsley_field) && !(instance instanceof Form)) throw new Error('Must give Parsley instance');\r\n\r\n    if ('string' !== typeof name || 'function' !== typeof fn) throw new Error('Wrong parameters');\r\n\r\n    instance.on(eventName(name), adapt(fn));\r\n  };\r\n\r\n  $.unsubscribe = function (name, fn) {\r\n    deprecated();\r\n    if ('string' !== typeof name || 'function' !== typeof fn) throw new Error('Wrong arguments');\r\n    window.Parsley.off(eventName(name), fn.parsleyAdaptedCallback);\r\n  };\r\n\r\n  $.unsubscribeTo = function (instance, name) {\r\n    deprecated();\r\n    if (!(instance instanceof parsley_field) && !(instance instanceof Form)) throw new Error('Must give Parsley instance');\r\n    instance.off(eventName(name));\r\n  };\r\n\r\n  $.unsubscribeAll = function (name) {\r\n    deprecated();\r\n    window.Parsley.off(eventName(name));\r\n    $('form,input,textarea,select').each(function () {\r\n      var instance = $(this).data('Parsley');\r\n      if (instance) {\r\n        instance.off(eventName(name));\r\n      }\r\n    });\r\n  };\r\n\r\n  // $.emit is deprecated. Use jQuery events instead.\r\n  $.emit = function (name, instance) {\r\n    var _instance;\r\n\r\n    deprecated();\r\n    var instanceGiven = instance instanceof parsley_field || instance instanceof Form;\r\n    var args = Array.prototype.slice.call(arguments, instanceGiven ? 2 : 1);\r\n    args.unshift(eventName(name));\r\n    if (!instanceGiven) {\r\n      instance = window.Parsley;\r\n    }\r\n    (_instance = instance).trigger.apply(_instance, _toConsumableArray(args));\r\n  };\r\n\r\n  var pubsub = {};\r\n\r\n  $.extend(true, Parsley, {\r\n    asyncValidators: {\r\n      'default': {\r\n        fn: function fn(xhr) {\r\n          // By default, only status 2xx are deemed successful.\r\n          // Note: we use status instead of state() because responses with status 200\r\n          // but invalid messages (e.g. an empty body for content type set to JSON) will\r\n          // result in state() === 'rejected'.\r\n          return xhr.status >= 200 && xhr.status < 300;\r\n        },\r\n        url: false\r\n      },\r\n      reverse: {\r\n        fn: function fn(xhr) {\r\n          // If reverse option is set, a failing ajax request is considered successful\r\n          return xhr.status < 200 || xhr.status >= 300;\r\n        },\r\n        url: false\r\n      }\r\n    },\r\n\r\n    addAsyncValidator: function addAsyncValidator(name, fn, url, options) {\r\n      Parsley.asyncValidators[name] = {\r\n        fn: fn,\r\n        url: url || false,\r\n        options: options || {}\r\n      };\r\n\r\n      return this;\r\n    }\r\n\r\n  });\r\n\r\n  Parsley.addValidator('remote', {\r\n    requirementType: {\r\n      '': 'string',\r\n      'validator': 'string',\r\n      'reverse': 'boolean',\r\n      'options': 'object'\r\n    },\r\n\r\n    validateString: function validateString(value, url, options, instance) {\r\n      var data = {};\r\n      var ajaxOptions;\r\n      var csr;\r\n      var validator = options.validator || (true === options.reverse ? 'reverse' : 'default');\r\n\r\n      if ('undefined' === typeof Parsley.asyncValidators[validator]) throw new Error('Calling an undefined async validator: `' + validator + '`');\r\n\r\n      url = Parsley.asyncValidators[validator].url || url;\r\n\r\n      // Fill current value\r\n      if (url.indexOf('{value}') > -1) {\r\n        url = url.replace('{value}', encodeURIComponent(value));\r\n      } else {\r\n        data[instance.$element.attr('name') || instance.$element.attr('id')] = value;\r\n      }\r\n\r\n      // Merge options passed in from the function with the ones in the attribute\r\n      var remoteOptions = $.extend(true, options.options || {}, Parsley.asyncValidators[validator].options);\r\n\r\n      // All `$.ajax(options)` could be overridden or extended directly from DOM in `data-parsley-remote-options`\r\n      ajaxOptions = $.extend(true, {}, {\r\n        url: url,\r\n        data: data,\r\n        type: 'GET'\r\n      }, remoteOptions);\r\n\r\n      // Generate store key based on ajax options\r\n      instance.trigger('field:ajaxoptions', instance, ajaxOptions);\r\n\r\n      csr = $.param(ajaxOptions);\r\n\r\n      // Initialise querry cache\r\n      if ('undefined' === typeof Parsley._remoteCache) Parsley._remoteCache = {};\r\n\r\n      // Try to retrieve stored xhr\r\n      var xhr = Parsley._remoteCache[csr] = Parsley._remoteCache[csr] || $.ajax(ajaxOptions);\r\n\r\n      var handleXhr = function handleXhr() {\r\n        var result = Parsley.asyncValidators[validator].fn.call(instance, xhr, url, options);\r\n        if (!result) // Map falsy results to rejected promise\r\n          result = $.Deferred().reject();\r\n        return $.when(result);\r\n      };\r\n\r\n      return xhr.then(handleXhr, handleXhr);\r\n    },\r\n\r\n    priority: -1\r\n  });\r\n\r\n  Parsley.on('form:submit', function () {\r\n    Parsley._remoteCache = {};\r\n  });\r\n\r\n  window.ParsleyExtend.addAsyncValidator = function () {\r\n    Utils.warnOnce('Accessing the method `addAsyncValidator` through an instance is deprecated. Simply call `Parsley.addAsyncValidator(...)`');\r\n    return Parsley.addAsyncValidator.apply(Parsley, arguments);\r\n  };\r\n\r\n  // This is included with the Parsley library itself,\r\n  // thus there is no use in adding it to your project.\r\n  Parsley.addMessages('en', {\r\n    defaultMessage: \"This value seems to be invalid.\",\r\n    type: {\r\n      email: \"This value should be a valid email.\",\r\n      url: \"This value should be a valid url.\",\r\n      number: \"This value should be a valid number.\",\r\n      integer: \"This value should be a valid integer.\",\r\n      digits: \"This value should be digits.\",\r\n      alphanum: \"This value should be alphanumeric.\"\r\n    },\r\n    notblank: \"This value should not be blank.\",\r\n    required: \"This value is required.\",\r\n    pattern: \"This value seems to be invalid.\",\r\n    min: \"This value should be greater than or equal to %s.\",\r\n    max: \"This value should be lower than or equal to %s.\",\r\n    range: \"This value should be between %s and %s.\",\r\n    minlength: \"This value is too short. It should have %s characters or more.\",\r\n    maxlength: \"This value is too long. It should have %s characters or fewer.\",\r\n    length: \"This value length is invalid. It should be between %s and %s characters long.\",\r\n    mincheck: \"You must select at least %s choices.\",\r\n    maxcheck: \"You must select %s choices or fewer.\",\r\n    check: \"You must select between %s and %s choices.\",\r\n    equalto: \"This value should be the same.\"\r\n  });\r\n\r\n  Parsley.setLocale('en');\r\n\r\n  /**\r\n   * inputevent - Alleviate browser bugs for input events\r\n   * https://github.com/marcandre/inputevent\r\n   * @version v0.0.3 - (built Thu, Apr 14th 2016, 5:58 pm)\r\n   * @author Marc-Andre Lafortune <github@marc-andre.ca>\r\n   * @license MIT\r\n   */\r\n\r\n  function InputEvent() {\r\n    var _this14 = this;\r\n\r\n    var globals = window || global;\r\n\r\n    // Slightly odd way construct our object. This way methods are force bound.\r\n    // Used to test for duplicate library.\r\n    $.extend(this, {\r\n\r\n      // For browsers that do not support isTrusted, assumes event is native.\r\n      isNativeEvent: function isNativeEvent(evt) {\r\n        return evt.originalEvent && evt.originalEvent.isTrusted !== false;\r\n      },\r\n\r\n      fakeInputEvent: function fakeInputEvent(evt) {\r\n        if (_this14.isNativeEvent(evt)) {\r\n          $(evt.target).trigger('input');\r\n        }\r\n      },\r\n\r\n      misbehaves: function misbehaves(evt) {\r\n        if (_this14.isNativeEvent(evt)) {\r\n          _this14.behavesOk(evt);\r\n          $(document).on('change.inputevent', evt.data.selector, _this14.fakeInputEvent);\r\n          _this14.fakeInputEvent(evt);\r\n        }\r\n      },\r\n\r\n      behavesOk: function behavesOk(evt) {\r\n        if (_this14.isNativeEvent(evt)) {\r\n          $(document) // Simply unbinds the testing handler\r\n          .off('input.inputevent', evt.data.selector, _this14.behavesOk).off('change.inputevent', evt.data.selector, _this14.misbehaves);\r\n        }\r\n      },\r\n\r\n      // Bind the testing handlers\r\n      install: function install() {\r\n        if (globals.inputEventPatched) {\r\n          return;\r\n        }\r\n        globals.inputEventPatched = '0.0.3';\r\n        var _arr = ['select', 'input[type=\"checkbox\"]', 'input[type=\"radio\"]', 'input[type=\"file\"]'];\r\n        for (var _i = 0; _i < _arr.length; _i++) {\r\n          var selector = _arr[_i];\r\n          $(document).on('input.inputevent', selector, { selector: selector }, _this14.behavesOk).on('change.inputevent', selector, { selector: selector }, _this14.misbehaves);\r\n        }\r\n      },\r\n\r\n      uninstall: function uninstall() {\r\n        delete globals.inputEventPatched;\r\n        $(document).off('.inputevent');\r\n      }\r\n\r\n    });\r\n  };\r\n\r\n  var inputevent = new InputEvent();\r\n\r\n  inputevent.install();\r\n\r\n  var parsley = Parsley;\r\n\r\n  return parsley;\r\n});\r\n//# sourceMappingURL=parsley.js.map\r\n","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./validatingForm.html\";\r\nimport \"lib/parsley.js\";\r\n\r\nlet parsley;\r\n\r\nvar validatingForm = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = new Ractive( {\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template,\r\n\t\t\t\r\n\t\t\toncomplete: function() {\r\n\t\t\t\tconsole.log(\"FORM: oncomplete!\")\r\n\t\t\t\tsetupParsley();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tonteardown: function() {\r\n\t\t\t\tconsole.log(\"FORM: onteardown!\")\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tondestruct: function() {\r\n\t\t\t\tconsole.log(\"FORM: ondestruct!\")\r\n\t\t\t},\r\n\r\n\t\t\tsubmit: function () {\r\n\t\t\t\tvar valid = parsley.validate();\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tresetData: function () {\r\n\t\t\t\t$( '.bs-callout-info' ).addClass( 'hidden' );\r\n\t\t\t\t$( '.bs-callout-warning' ).addClass( 'hidden' );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nexport default validatingForm\r\n\r\n\r\n//\r\n//define( function ( require ) {\r\n//var $ = require( \"jquery\" );\r\n//\t\tvar kudu = require( \"kudu\" );\r\n//\t\tvar parsley = require( \"parsley\" );\r\n//\t\tvar template = require( \"rvc!./validating-form\" );\r\n//\t\tfunction ValidatingForm( ) {\r\n//\r\n//\t\tvar that = {};\r\n//\t\t\t\tvar parsley;\r\n//\t\t\t\t/*\r\n//\t\t\t\t that.onInit = function (options) {\r\n//\t\t\t\t var view = createView();\r\n//\t\t\t\t return view;\r\n//\t\t\t\t };\r\n//\t\t\t\t \r\n//\t\t\t\t that.onRender = function (options) {\r\n//\t\t\t\t parsley = $('form').parsley({\r\n//\t\t\t\t /*\r\n//\t\t\t\t // This comment shows how to use bootstrap's error highlighting\r\n//\t\t\t\t }\r\n//\t\t\t\t successClass: \"has-success\",\r\n//\t\t\t\t errorClass: \"has-error\",\r\n//\t\t\t\t classHandler: function (field) {\r\n//\t\t\t\t return field.$element.closest(\".form-group\");\r\n//\t\t\t\t },\r\n//\t\t\t\t errorsWrapper: \"<span class='help-block parsley-errors-list'></span>\",\r\n//\t\t\t\t errorTemplate: \"<span></span>\"\r\n//\t\t\t\t */\r\n//\t\t} );\r\n//\t\tparsley.on( 'form:validated', function ( form ) {\r\n//\r\n//\t\t// If you want all fields automatically tracked for errors after form submission, uncomment line below\r\n//\t\t//setFieldsInvalid(form);\r\n//\t\tshowFormValidationFeedback( form );\r\n//\t\t} );\r\n//\t\tparsley.on( 'field:validated', function ( field ) {\r\n//\t\tshowFormValidationFeedback( field.parent );\r\n//\t\t} );\r\n//}; \r\n//\t\t\r\n\t\tfunction setupParsley( ) {\r\n\t\tparsley = $( 'form' ).parsley( {\r\n\t\t/*\r\n\t\t // This comment shows how to use bootstrap's error highlighting\r\n\t\t }\r\n\t\t successClass: \"has-success\",\r\n\t\t errorClass: \"has-error\",\r\n\t\t classHandler: function (field) {\r\n\t\t return field.$element.closest(\".form-group\");\r\n\t\t },\r\n\t\t errorsWrapper: \"<span class='help-block parsley-errors-list'></span>\",\r\n\t\t errorTemplate: \"<span></span>\"\r\n\t\t */\r\n\t\t} );\r\n\t\t\t\tparsley.on( 'form:validated', function ( form ) {\r\n\r\n\t\t\t\t// If you want all fields automatically tracked for errors after form submission, uncomment line below\r\n\t\t\t\t//setFieldsInvalid(form);\r\n\t\t\t\tshowFormValidationFeedback( form );\r\n\t\t\t\t} );\r\n\t\t\t\tparsley.on( 'field:validated', function ( field ) {\r\n\t\t\t\tshowFormValidationFeedback( field.parent );\r\n\t\t\t\t} );\r\n\t\t}\r\n\r\nfunction setFieldsInvalid( form ) {\r\nfor ( var n = 0; n < form.fields.length; n++ ) {\r\nvar field = form.fields[n];\r\n\t\tParsleyUI.manageFailingFieldTrigger( field );\r\n}\r\n}\r\n\r\nfunction showFormValidationFeedback( form ) {\r\nvar ok = form.isValid( );\r\n\t\t$( '.bs-callout-info' ).toggleClass( 'hidden', !ok );\r\n\t\t$( '.bs-callout-warning' ).toggleClass( 'hidden', ok );\r\n}\r\n","import journey from \"lib/journey/journey.js\";\r\nimport events from \"lib/journey/utils/events\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./events.html\";\r\n\r\nlet isListening = false;\r\n\r\nlet view;\r\n\r\nvar lifecycleEvents = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\r\n\t\t// example of a Ractive instance events (oninit and onrender)\r\n\t\tview = route.view = new Ractive( {\r\n\t\t\ttemplate: template,\r\n\t\t\tel: options.target,\r\n\t\t\tjourney: journey,\r\n\r\n\t\t\tdata: { isListening: isListening },\r\n\r\n\t\t\tupdateView: function () {\r\n\t\t\t\tvar random = Math.random() * 1000;\r\n\t\t\t\tjourney.goto( \"/events?random=\" + random );\r\n\t\t\t},\r\n\r\n\t\t\tonrender: function () {\r\n\t\t\t\t// apply code highlighting as soon as DOM is ready, before animation finish\r\n\t\t\t\tPrism.highlightAll();\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\r\n\t\troute.view.observe( \"isListening\", function ( newValue, oldValue, keypath ) {\r\n\t\t\tisListening = newValue;\r\n\t\t\tisListening ? startListening() : stopListening();\r\n\t\t}, { init: false } );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\treturn route.view.teardown();\r\n\t},\r\n\r\n\tbeforeenter: function ( route, prevRoute, options ) {\r\n\t\t// Noop method for demo purposes\r\n\t},\r\n\r\n\tupdate: function ( route, options ) {\r\n\t\t// Noop method for demo purposes\r\n\t\tconsole.log(\"View updated with :\", route.query);\r\n\t}\r\n};\r\n\r\nfunction startListening() {\r\n\r\n\tjourney.on( events.BEFORE_ENTER, function ( options ) {\r\n\t\tconsole.log( \"onBeforeenter\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.BEFORE_ENTER_COMPLETE, function ( options ) {\r\n\t\tconsole.log( \"onBeforeenterComplete\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.ENTER, function ( options ) {\r\n\t\tconsole.log( \"onEnter:\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.ENTERED, function ( options ) {\r\n\t\tconsole.log( \"onEntered\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.UPDATE, function ( options ) {\r\n\t\tconsole.log( \"onUpdate\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.UPDATED, function ( options ) {\r\n\t\tconsole.log( \"onUpdated\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.LEAVE, function ( options ) {\r\n\t\tconsole.log( \"onLeave\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.LEFT, function ( options ) {\r\n\t\tconsole.log( \"onLeft\", options );\r\n\t} );\r\n\r\n\tjourney.on( events.ERROR, function ( options ) {\r\n\t\tconsole.log( \"onError\", options );\r\n\t} );\r\n}\r\n\r\nfunction stopListening() {\r\n\tjourney.off( events.BEFORE_ENTER );\r\n\tjourney.off( events.BEFORE_ENTER_COMLETE );\r\n\tjourney.off( events.ENTER );\r\n\tjourney.off( events.ENTERED );\r\n\tjourney.off( events.UPDATE );\r\n\tjourney.off( events.UPDATED );\r\n\tjourney.off( events.LEAVE );\r\n\tjourney.off( events.LEFT );\r\n\tjourney.off( events.ERROR );\r\n}\r\n\r\n\r\nexport default lifecycleEvents;","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./basicAjax.html\";\r\n\r\nlet config;\r\n\r\nlet rejectRequest = false;\r\n\r\nvar basicAjax = {\r\n\t\r\n\tbeforeenter: function ( route, prevRoute, options ) {\r\n\t\t// Return promise for beforeenter\r\n\t\treturn $.getJSON( \"data/hello.json?delay=2000&reject=\" + rejectRequest ).then( function ( response ) {\r\n\t\t\treturn route.data = JSON.stringify( response );\r\n\r\n\t\t} ).catch( ( err ) => {\r\n\t\t\treturn route.data = \"Could not load data for BasicAjax: [\" + err.status + \":\" + err.statusText + \"]\";\r\n\t\t} );\r\n\t},\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\tconfig = options;\r\n\r\n\t\troute.view = createView( route.data );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown( );\r\n\t}\r\n};\r\n\r\nfunction createView( json ) {\r\n\r\n\t// Convert the JSON data object to a string representation\r\n\tvar view = new Ractive( {\r\n\t\tel: config.target,\r\n\t\tdata: { response: json },\r\n\t\ttemplate: template,\r\n\t\treload: function ( ) {\r\n\t\t\tjourney.goto( \"/basicAjax\", {forceReload: true} );\r\n\t\t}\r\n\t} );\r\n\r\n\treturn view;\r\n}\r\n\r\nexport default basicAjax;","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./upload.html\";\r\n\r\nlet config;\r\n\r\nlet view;\r\n\r\nvar upload = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\tconfig = options;\r\n\t\t/*%injectPath%*/\r\n\r\n\t\troute.view = createView( route.data );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown( );\r\n\t}\r\n};\r\n\r\nfunction createView( json ) {\r\n\r\n\t// Convert the JSON data objectr to a string representation\r\n\tview = new Ractive( {\r\n\t\tel: config.target,\r\n\t\tdata: { response: json, msg: \"Upload a file\" },\r\n\t\ttemplate: template,\r\n\t\tsubmit: function ( ) {\r\n\t\t\tsubmitForm();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t} );\r\n\r\n\treturn view;\r\n}\r\n\r\nfunction submitForm( ) {\r\n\tview.set(\"display\", false);\r\n\tview.set(\"msg\", \"Busy uploading...\");\r\n\r\n\tlet files = $( \"#file\" )[0].files;\r\n\tif (files.length === 0) {\r\n\t\tview.set(\"msg\", \"Please select a file\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet data = new FormData();\r\n\r\n\t$.each( files, function ( key, value ) {\r\n\t\tdata.append( key, value );\r\n\t} );\r\n\r\n\tlet promise = $.ajax( {\r\n\t\turl: 'data/submitForm?delay=2000',\r\n\t\ttype: 'POST',\r\n\t\tdata: data,\r\n\t\tcache: false,\r\n\t\tdataType: 'json',\r\n\t\tprocessData: false, // Don't process the files\r\n\t\tcontentType: false // Set content type to false as jQuery will tell the server its a query string request\r\n\t} );\r\n\r\n\tpromise.then( ( data, textStatus, jqXHR ) => {\r\n\t\tview.set(\"display\", true);\r\n\t\tview.set(\"response\", data.msg);\r\n\r\n\t} ).catch( ( jqXHR, textStatus, errorThrown ) => {\r\n\t\tview.set(\"display\", true);\r\n\t\tview.set(\"response\", errorThrown);\r\n\t} );\r\n}\r\n\r\nexport default upload;","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./basicComp.html\";\r\n\r\nvar basicComp = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = createView( options );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nfunction createView( options ) {\r\n\r\n\tvar component = Ractive.extend( {\r\n\t\ttemplate: '<div on-click=\"@.activate()\" class=\"comp\" style=\"cursor: pointer\">{{message}}</div>',\r\n\r\n\t\tactivate () {\r\n\t\t\t// We reference the parent ractive instance through \"comp.parent\" and set the parent data variables, hidden and feedback\r\n\t\t\tthis.root.set( \"hidden\", false );\r\n\t\t\tthis.root.set( \"feedback\", \"Component clicked!\" );\r\n\t\t}\r\n\t} );\r\n\r\n\tvar view = new Ractive( {\r\n\t\tel: options.target,\r\n\t\ttemplate: template,\r\n\t\tdata: { hidden: true },\r\n\r\n\t\t// We register our component as \"simple\"\r\n\t\tcomponents: {\r\n\t\t\tsimple: component\r\n\t\t}\r\n\t} );\r\n\t\r\n\t//view.attachChild(component, {target: \"simple\"});\r\n\r\n\treturn view;\r\n}\r\n\r\nexport default basicComp;\r\n","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./multipleComp.html\";\r\n\r\nvar multipleComp = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\r\n\t\troute.view = createView( options );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nfunction createView( options ) {\r\n\r\n\tvar compA = new Ractive( {\r\n\t\ttemplate: '<div class=\"comp\">I am component A</div>'\r\n\t} );\r\n\r\n\tvar compB = new Ractive( {\r\n\t\ttemplate: '<div class=\"comp compB\">I am component B</div>'\r\n\t} );\r\n\r\n\tlet components = {\r\n\t\t\"compA\": compA,\r\n\t\t\"compB\": compB\r\n\t};\r\n\t\r\n\tlet comp;\r\n\r\n\tvar view = new Ractive( {\r\n\t\tel: options.target,\r\n\t\ttemplate: template,\r\n\r\n\t\tswap( name ) {\r\n\r\n\t\t\tif (comp) this.detachChild( comp );\r\n\t\t\tcomp = components[name];\r\n\t\t\tthis.attachChild( comp, { target: \"components\", insertAt: 0 } );\r\n\t\t}\r\n\t} );\r\n\r\n\treturn view;\r\n}\r\n\r\nexport default multipleComp;","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./compPubSub.html\";\r\nimport gridComponent from \"./grid.js\";\r\n\r\nvar compPubSub = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = createView( options );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\n\r\nfunction createView(options) {\r\n\r\n\tvar view = new Ractive( {\r\n\t\tel: options.target,\r\n\t\ttemplate: template,\r\n\t\tcomponents: {\r\n\t\t\tgrid: gridComponent\r\n\t\t},\r\n\t\thandleAdd: function ( row ) {\r\n\t\t\t// handleAddRow is called from the template as: on-public.add=\"handleAdd($1)\r\n\t\t\t// $1 is a mapping to the first argument that the grid component 'public.add' event passed along\r\n\t\t\t// Other arguments would be mapped as $2, $3 or all with (...arguments)\r\n\t\t\tconsole.log( \"[parent] <grid on-public.add=\\\"handleAddRow($1)\\>: invoked with arguments:\", row );\r\n\r\n\t\t\t// If we want to invoke API on the grid, we can get a reference to the\r\n\t\t\t// component as follows:\r\n\t\t\tvar comp = this.findComponent( \"grid\" );\r\n\t\t}\r\n\t} );\r\n\r\n\t// Subscribe to the public.remove event fired by the Grid component, note we use the 'grid.' namespace to\r\n\t// listen to the public.remove event of the grid component\r\n\tview.on( \"grid.public.remove\", function ( ctx, id, index ) {\r\n\t\tconsole.log( \"[parent] on('grid.public.remove') invoked with arguments, id:\", id, \"index:\", index );\r\n\t} );\r\n\r\n\t// We can also subsribe to all public.remove events from all components using the '*.' notation.\r\n\tview.on( \"*.public.remove\", function ( ctx, id, index ) {\r\n\t\tconsole.log( \"[parent] on('*.public.remove') invoked with arguments:, id:\", id, \"index:\", index );\r\n\t} );\r\n\r\n\r\n\treturn view;\r\n}\r\n\r\nexport default compPubSub;\r\n","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./sidePanel.html\";\r\nimport 'lib/prism.js';\r\n\r\nlet panel;\r\n\r\nfunction sidePanel( target ) {\r\n\r\n\tpanel = new Ractive( {\r\n\r\n\t\tel: target,\r\n\r\n\t\ttemplate: template,\r\n\r\n\t\tclose: function () {\r\n\t\t\tvar event = this.event.original;\r\n\t\t\tclose( event );\r\n\t\t\treturn false;\r\n\t\t}\r\n\t} );\r\n\r\n\t$( \"body\" ).off( \"click\", handleBodyClick );\r\n\t$( \"body\" ).on( \"click\", handleBodyClick );\r\n\r\n\t// Public \r\n\tpanel.show = function ( options ) {\r\n\t\tshow(options);\r\n\t};\r\n\r\n\treturn panel;\r\n}\r\n\r\nfunction show( options = {} ) {\r\n\tvar path = options.path || getUrlPath();\r\n\tvar ext = options.ext || \"\";\r\n\tpanel.set( \"visible\", true );\r\n\r\n\tpanel.set( \"code\", path + \".\" + ext );\r\n\tpanel.set( \"title\", path + \".\" + ext );\r\n\tPrism.fileHighlight();\r\n\tlet $element = $( '.cd-panel-content' );\r\n\t//Prism.highlightElement( $element[0] );\r\n}\r\n\r\nfunction close( event ) {\r\n\tif ( $( event.target ).is( '.cd-panel' ) || $( event.target ).is( '.cd-panel-close' ) ) {\r\n\t\tpanel.set( \"visible\", false );\r\n\t}\r\n}\r\n\r\nfunction getUrlPath() {\r\n\tvar route = journey.getCurrentRoute();\r\n\treturn route.path;\r\n}\r\n\r\n// Private \r\nfunction handleBodyClick( e ) {\r\n\tif ( panel.get( \"visible\" ) === true ) {\r\n\r\n\t\tif ( $( e.target ).is( 'a' ) ) {\r\n\t\t\tpanel.set( \"visible\", false );\r\n\r\n\t\t\t$( \".cd-panel\" ).css( \"transitionProperty\", \"none\" );\r\n\t\t\tsetTimeout( function () {\r\n\t\t\t\t$( \".cd-panel\" ).css( \"transitionProperty\", \"all\" );\r\n\t\t\t} );\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default sidePanel;","import journey from \"lib/journey/journey.js\";\nimport 'lib/prism.js';\n\nlet windowResizeTimeoutId;\n\nlet menuSlider = {\n\n\tinit( options ) {\n\t\tsetupWindowResizeListener();\n\n\t\tsetupMenuListener();\n\t\t/*\n\t\t let $fallbackMenu = $( options.fallbackMenu );\n\t\t let $initialLi = $fallbackMenu.parent();\n\t\t setSliderOnActiveMenu( $initialLi );*/\n\t},\n\n\tupdateSlider( $li ) {\n\t\t// Parent dropdown menus should be skipped and handled by the child menu when selected\n\t\tif ( $li.length == 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tupdateMenu( $li );\n\n\t\tslideToMenu( $li );\n\t}\n};\n\nfunction setupMenuListener() {\n\n\tjourney.on( \"entered\", options => {\n\t\tlet viewName = getViewName( options );\n\t\tconsole.log( \"viewname:\", viewName );\n\n\t\tlet $li = getMenu( viewName );\n\n\t\tif ( hasActiveMenu() ) {\n\t\t\tmenuSlider.updateSlider( $li );\n\n\t\t} else {\n\t\t\tupdateMenu( $li );\t\t\t\t\t\t\n\t\t\tinitializeSlider( $li );\n\t\t}\n\t} );\n\n//\t$( '.navbar li' ).click( function ( e ) {\n//\t\tvar $li = $( this );\n//\n//\t\tmenuSlider.updateSlider( $li );\n//\t} );\n}\n\nfunction updateMenu( $li ) {\n\n\tif ( hasParent( $li ) ) {\n\t\tlet $parent = getParent( $li );\n\t\tupdateChild( $parent, $li );\n\t\t//slideToActiveMenu( $parent );\n\n\t} else {\n\t\tupdateLeaf( $li );\n\t\t//slideToActiveMenu( $li );\n\t}\n\t//}\n\n\treturn $li;\n}\n\nfunction updateLeaf( $li ) {\n\t$( '.navbar li.active' ).removeClass( 'active' );\n\t$li.addClass( 'active' );\n}\n\nfunction updateChild( $parent, $leaf ) {\n\t$( '.navbar li.active' ).removeClass( 'active' );\n\t$parent.addClass( 'active' );\n\n\t$( \"#navbar .sub-active\" ).removeClass( \"sub-active\" );\n\t$leaf.addClass( \"sub-active\" );\n}\n\nfunction slideToMenu( $li ) {\n\tif ( hasParent( $li ) ) {\n\t\t$li = getParent( $li );\n\t}\n\n\tif ( $( \"#nav-ind\" ).is( \":visible\" ) ) {\n\t\t// Only navigate to the menu if the menu has not collapsed yet ie is less than 768px\n\t\tvar location = getActiveMenuLocation( $li );\n\t\t$( '#nav-ind' ).animate( location, 'fast', 'linear' );\n\t}\n}\n\nfunction initializeSlider( $li ) {\n\tif ( hasParent( $li ) ) {\n\t\t$li = getParent( $li );\n\t}\n\t//$liItem.addClass( \"active\" );\n\tvar loc = getActiveMenuLocation( $li );\n\t$( '#nav-ind' ).css( loc );\n}\n\nfunction hasActiveMenu() {\n\tlet $li = $( \".navbar li.active\" );\n\treturn $li.length > 0;\n}\n\nfunction setupWindowResizeListener() {\n\t$( window ).resize( function () {\n\t\tclearTimeout( windowResizeTimeoutId );\n\t\twindowResizeTimeoutId = setTimeout( windowResized, 0 );\n\t} );\n\n\twindowResized();\n}\n\nfunction windowResized() {\n\tif ( window.matchMedia( '(min-width: 768px)' ).matches ) {\n\t\tvar $activeMenu = $( \"#navbar li.active\" );\n\t\tif ( $activeMenu.length > 0 ) {\n\t\t\tvar location = getActiveMenuLocation( $activeMenu );\n\t\t\t$( '#nav-ind' ).css( location );\n\t\t}\n\t}\n}\n\nfunction getActiveMenuLocation( $li ) {\n\tvar offsetTop = 60;\n\tvar offsetLeft = 0;\n\tvar offsetLeft = 0;\n\tif ( $li.length ) {\n\t\tlet $navbar = $( '#navbar' );\n\t\tlet navbarOffset = $navbar.offset();\n\t\tlet itemOffset = $li.offset();\n\t\toffsetLeft = itemOffset.left - navbarOffset.left;\n\t}\n\n\tvar width = $( '#navbar' ).width();\n\tvar liWidth = $( $li ).width();\n\tlet navbarHeight = $( '#navbar' ).height();\n\tlet liHeight = $li.height();\n\n\tvar location = {\n\t\ttop: offsetTop,\n\t\tleft: offsetLeft,\n\t\tright: width - liWidth - offsetLeft,\n\t\tbottom: navbarHeight - liHeight - offsetTop\n\t};\n\treturn location;\n}\n\nfunction isParent( $li ) {\n\tif ( $li.hasClass( \"dropdown\" ) ) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction isLeaf( $li ) {\n\treturn ! isParent( $li );\n}\n\nfunction getParent( $li ) {\n\tlet $parent = $li.closest( '.dropdown' );\n\treturn $parent;\n}\n\nfunction hasParent( $li ) {\n\tlet $parent = getParent( $li );\n\tif ( $parent.length == 1 ) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction getViewName( options ) {\n\tlet route = options.to;\n\tlet path = route.path;\n\tif ( path == null ) {\n\t\treturn \"\";\n\t}\n\n\tlet start = path.lastIndexOf( \"/\" );\n\tlet name = path.slice( start + 1 );\n\treturn name;\n}\n\nfunction getMenu( viewName ) {\n\t\n\tlet selector = \"#menu-\" + viewName;\n\tlet $li = $( selector ).parent();\n\n\tif ( $li.length == 0 ) {\n\t\t$li = $( \".navbar [href='/\" + viewName + \"'], .navbar [href='#\" + viewName + \"'], .navbar [href='\" + viewName + \"']\" ).parent( );\n\t}\n\treturn $li;\n}\n\nexport default menuSlider;","export default ( typeof window !== 'undefined' ? window : null );","import config from \"./config.js\";\r\nimport window from './window.js';\r\n\r\nlet listener;\r\n\r\nlet watchHistory = {\r\n\r\n\t_ignoreHashChange: false,\r\n\r\n\tuseOnHashChange: false,\r\n\r\n\tsupportHistory:   !!(window.history && window.history.pushState),\r\n\r\n\tnoop() {},\r\n\r\n\tstart( options = {} ) {\r\n\r\n\t\twatchHistory.useOnHashChange = watchHistory.shouldUseOnHashChange(options.useOnHashChange || false);\r\n\t\twatchHistory.listener = watchHistory.noop;\r\n\r\n\t\twatchHistory.startListening();\r\n\t},\r\n\r\n\tstartListening() {\r\n\r\n\t\tif (watchHistory.useOnHashChange) {\r\n\t\t\twindow.addEventListener( 'hashchange', watchHistory.hashchangeEventLisener, false );\r\n\r\n\t\t} else {\r\n\t\t\twindow.addEventListener( 'popstate', watchHistory.popstateEventLisener, false );\r\n\t\t}\r\n\t},\r\n\t\r\n\tshouldUseOnHashChange(value) {\r\n\t\t// Use override if present\r\n\t\tif (value) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t if (watchHistory.supportHistory) {\r\n\t\t\t return false;\r\n\t\t }\r\n\t\t return true;\r\n\t},\r\n\r\n\tpopstateEventLisener( e ) {\r\n\t\tif ( e.state == null ) return; // hashchange, or otherwise outside roadtrip's control\r\n\r\n\t\t//let url = location.pathname;\r\n\t\tlet url = config.useHash ? window.location.hash : window.location.pathname;\r\n\t\tlet options = {\r\n\t\t\turl: url,\r\n\t\t\tpopEvent: e,\r\n\t\t\tpopState: true // so we know not to update the url and create another history entry\r\n\t\t};\r\n\t\tlistener(options);\r\n\t},\r\n\r\n\thashchangeEventLisener( e ) {\r\n\t\tif (watchHistory._ignoreHashChange) {\r\n\t\t\twatchHistory._ignoreHashChange = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet url = location.hash;\r\n\t\t\r\n\t\tlet options = {\r\n\t\t\turl: url,\r\n\t\t\thashEvent: e,\r\n\t\t\thashChange: true // so we know not to update the url and create another history entry\r\n\t\t};\r\n\t\t\r\n\t\tlistener(options);\r\n\t},\r\n\r\n\tsetListener( callback ) {\r\n\t\tlistener = callback;\r\n\t},\r\n\t\r\n\tsetHash(hash, options) {\r\n\r\n\t\thash = options.invisible ? window.location.hash : hash;\r\n\r\n\t\tif (options.replace) {\r\n\t\t\tlocation.replace(hash);\r\n\r\n\t\t} else {\r\n\t\t\t// updating the hash will fire a hashchange event but we only want to respond to hashchange events when the history pops, not pushed\r\n\t\t\twatchHistory._ignoreHashChange = true;\r\n\t\t\twindow.location.hash = hash;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default watchHistory;\r\n","import window from './window.js';\n\nvar util = {\n\n\tstripSearch: str => {\n\t\tlet start = str.indexOf( '?' );\n\n\t\tif ( start >= 0 ) {\n\t\t\tstr = str.substring( 0, start );\n\t\t}\n\t\treturn str;\n\t},\n\n\tisUrl: ( str ) => {\n\t\tif ( str.indexOf( \"://\" ) >= 0 ) {\n\t\t\treturn true;\n\t\t}\n\t},\n\n\tprefixWithBase: ( str, base ) => {\n\n\t\t// Cannot prefix a url with the base value: http://moo will become refixhttp://moo\n\t\tif ( util.isUrl( str ) ) {\n\t\t\treturn str;\n\t\t}\n\n\t\tlet index = str.indexOf( base );\n\t\tif ( index === 0 ) {\n\t\t\treturn str;\n\t\t}\n\n\t\t// Guard against double '/' when base ends with '/' and str starts with '/'\n\t\tif ( base[base.length - 1] === '/' && str[0] === '/' ) {\n\t\t\tstr = str.slice( 1 );\n\t\t}\n\n\t\tstr = base + str;\n\t\treturn str;\n\t},\n\n\tstripBase: ( str, base ) => {\n\t\tif ( str.indexOf( base ) === 0 ) {\n\t\t\tstr = str.substr( base.length );\n\t\t}\n\n\t\tif ( str === '' ) {\n\t\t\t// Don't return an empty str, return '/' which is generally mapped\n\t\t\treturn '/';\n\t\t}\n\t\treturn str;\n\t},\n\n\tgetLocationAsRelativeUrl: () => {\n\t\tlet relUrl = window.location.pathname + window.location.search + window.location.hash || '';\n\t\treturn relUrl;\n\t},\n\n\tuseDefaultRoute: ( path ) => {\n\t\tif ( path == null )\n\t\t\treturn true;\n\n\t\tif ( path.length == 1 ) {\n\n\t\t\tif ( path[0] == '/' || path[0] == '#' ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\n\textend: function ( out ) {\n\t\tout = out || { };\n\t\tfor ( var i = 1; i < arguments.length; i ++ ) {\n\t\t\tif ( ! arguments[i] )\n\t\t\t\tcontinue;\n\t\t\tfor ( var key in arguments[i] ) {\n\t\t\t\tif ( arguments[i].hasOwnProperty( key ) )\n\t\t\t\t\tout[key] = arguments[i][key];\n\t\t\t}\n\t\t}\n\n\t\treturn out;\n\t}\n};\n\nexport default util;","let config = {\n\tfallback: null,\n\t\n\tbase: '',\n\n\tuseHash: false,\n\t\n\tuseOnHashChange: false,\n\n\thash: '#',\n\t\n\tdefaultRoute: null\n};\n\nexport default config;","import util from \"./util.js\";\nimport config from \"./config.js\";\nimport window from './window.js';\n\nlet pathHelper = {\n\n\tgetGotoPath: href => {\n\t\tif ( config.useHash ) {\n\t\t\treturn href;\n\t\t}\n\t\t\n\t\thref = pathHelper.stripSlashOrHashPrefix( href );\n\t\treturn href;\n\t},\n\n\tgetInitialPath: () => {\n\t\tlet relUrl = config.useHash ? window.location.hash : util.getLocationAsRelativeUrl();\n\t\tlet path = util.stripBase( relUrl, config.base );\n\n\t\tif ( config.defaultRoute && util.useDefaultRoute( path ) ) {\n\t\t\tpath = config.defaultRoute || path;\n\t\t}\n\n\t\tif ( ! config.useHash ) {\n\t\t\tpath = pathHelper.stripSlashOrHashPrefix( path );\n\t\t}\n\n\t\treturn path;\n\t},\n\n\tstripSlashOrHashPrefix: str => {\n\n\t\tif ( str == null )\n\t\t\treturn str;\n\t\tstr = str.trim( );\n\t\tif ( str[0] === '/' ) {\n\t\t\tstr = str.slice( 1 );\n\t\t}\n\n\t\tif ( str.startsWith( config.hash ) ) {\n\t\t\treturn str.slice( config.hash.length );\n\t\t}\n\n\t\tif ( str[0] === '#' ) {\n\t\t\tstr = str.slice( 1 );\n\t\t}\n\n\t\treturn str;\n\t},\n\tprefixWithHash: str => {\n\t\tif ( str.startsWith( config.hash ) ) {\n\t\t\treturn str;\n\t\t}\n\n\t\tstr = pathHelper.stripSlashOrHashPrefix( str );\n\t\tstr = config.hash + str;\n\t\treturn str;\n\t},\n\tprefixWithSlash( str ) {\n// Cannot prefix a url with '/' else http://moo will become /http://moo\n\t\tif ( util.isUrl( str ) ) {\n\t\t\treturn str;\n\t\t}\n\n\t\tif ( str[0] === '/' ) {\n\t\t\treturn str;\n\t\t} else {\n\t\t\tstr = pathHelper.stripSlashOrHashPrefix( str );\n\t\t}\n\t\tstr = '/' + str;\n\t\treturn str;\n\t}\n}\n\nexport default pathHelper;","export default [];\n","// from https://developer.mozilla.org/en/docs/Web/API/WindowEventHandlers/onhashchange\nif ( ! window.HashChangeEvent )\n\t( function () {\n\n\t\tvar lastURL = document.URL;\n\n\t\twindow.addEventListener( \"hashchange\", function ( event ) {\n\t\t\tObject.defineProperty( event, \"oldURL\", { enumerable: true, configurable: true, value: lastURL } );\n\t\t\tObject.defineProperty( event, \"newURL\", { enumerable: true, configurable: true, value: document.URL } );\n\n\t\t\tlastURL = document.URL;\n\t\t} );\n\t}() );\n\n\nif ( ! String.prototype.startsWith ) {\n\tString.prototype.startsWith = function ( searchString, position ) {\n\t\tposition = position || 0;\n\t\treturn this.substr( position, searchString.length ) === searchString;\n\t};\n}\n\nif ( ! String.prototype.endsWith ) {\n\tString.prototype.endsWith = function ( searchString, position ) {\n\t\tvar subjectString = this.toString();\n\t\tif ( typeof position !== 'number' || ! isFinite( position ) || Math.floor( position ) !== position || position > subjectString.length ) {\n\t\t\tposition = subjectString.length;\n\t\t}\n\t\tposition -= searchString.length;\n\t\tvar lastIndex = subjectString.lastIndexOf( searchString, position );\n\t\treturn lastIndex !== - 1 && lastIndex === position;\n\t};\n}","import EventEmitter from  \"../EventEmitter\";\n\nvar eventer = new EventEmitter();\n\nvar journey;\n\nvar origEmit = eventer.emit;\n\neventer.emit = function ( that ) {\n\tif ( typeof that === 'string' ) {\n\t\tvar args = Array.prototype.slice.call( arguments );\n\t\targs.unshift( journey );\n\t\treturn origEmit.apply( this, args );\n\t}\n\torigEmit.apply( this, arguments );\n};\n\n\neventer.init = ( arg ) => {\n\tjourney = arg;\n\n\tjourney.on = ( event, listener ) => {\n\t\t//eventer.on.call( journey, event, listener );\n\t\teventer.on( event, listener );\n\t};\n\t\n\tjourney.off = ( event, listener ) => {\n\t\teventer.off( event, listener );\n\t};\n\t\njourney.once = ( event, listener ) => {\n\t\teventer.off( event, listener );\n\t};\n\t\n\tjourney.emit = function () {\n\t\teventer.emit.apply( eventer, arguments );\n\t};\n\n\tjourney.emitEvent = function () {\n\t\teventer.emitEvent.apply( eventer, arguments );\n\t};\n};\n\nexport default eventer;","var mode = {\r\n\tDEBUG: null\r\n};\r\n\r\nexport default mode;\r\n\r\n","const events = {\n\tBEFORE_ENTER: \"beforeenter\",\n\tBEFORE_ENTER_COMPLETE: \"beforeenterComplete\",\n\tENTER: \"enter\",\t\n\tENTERED: \"entered\",\n\tUPDATE: \"update\",\n\tUPDATED: \"updated\",\n\tLEAVE: \"leave\",\n\tLEFT: \"left\",\n\tERROR: \"error\"\n};\n\nexport default events;","var config = {\r\n\ttarget: null,\r\n\tdebug: true\r\n};\r\n\r\nexport default config;","export default {\r\n\t// render placement:\r\n\tel:                     void 0,\r\n\tappend:                 false,\r\n\tdelegate:               true,\r\n\r\n\t// template:\r\n\ttemplate:               null,\r\n\r\n\t// parse:\r\n\tdelimiters:             [ '{{', '}}' ],\r\n\ttripleDelimiters:       [ '{{{', '}}}' ],\r\n\tstaticDelimiters:       [ '[[', ']]' ],\r\n\tstaticTripleDelimiters: [ '[[[', ']]]' ],\r\n\tcsp:                    true,\r\n\tinterpolate:            false,\r\n\tpreserveWhitespace:     false,\r\n\tsanitize:               false,\r\n\tstripComments:          true,\r\n\tcontextLines:           0,\r\n\tparserTransforms:       [],\r\n\r\n\t// data & binding:\r\n\tdata:                   {},\r\n\tcomputed:               {},\r\n\tsyncComputedChildren:   false,\r\n\tresolveInstanceMembers: true,\r\n\twarnAboutAmbiguity:     false,\r\n\tadapt:                  [],\r\n\tisolated:               true,\r\n\ttwoway:                 true,\r\n\tlazy:                   false,\r\n\r\n\t// transitions:\r\n\tnoIntro:                false,\r\n\tnoOutro:                false,\r\n\ttransitionsEnabled:     true,\r\n\tcomplete:               void 0,\r\n\tnestedTransitions:      true,\r\n\r\n\t// css:\r\n\tcss:                    null,\r\n\tnoCssTransform:         false\r\n};\r\n","// These are a subset of the easing equations found at\r\n// https://raw.github.com/danro/easing-js - license info\r\n// follows:\r\n\r\n// --------------------------------------------------\r\n// easing.js v0.5.4\r\n// Generic set of easing functions with AMD support\r\n// https://github.com/danro/easing-js\r\n// This code may be freely distributed under the MIT license\r\n// http://danro.mit-license.org/\r\n// --------------------------------------------------\r\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\r\n// Easing Equations (c) 2003 Robert Penner, BSD license\r\n// https://raw.github.com/danro/easing-js/master/LICENSE\r\n// --------------------------------------------------\r\n\r\n// In that library, the functions named easeIn, easeOut, and\r\n// easeInOut below are named easeInCubic, easeOutCubic, and\r\n// (you guessed it) easeInOutCubic.\r\n//\r\n// You can add additional easing functions to this list, and they\r\n// will be globally available.\r\n\r\n\r\nexport default {\r\n\tlinear ( pos ) { return pos; },\r\n\teaseIn ( pos ) { return Math.pow( pos, 3 ); },\r\n\teaseOut ( pos ) { return ( Math.pow( ( pos - 1 ), 3 ) + 1 ); },\r\n\teaseInOut ( pos ) {\r\n\t\tif ( ( pos /= 0.5 ) < 1 ) { return ( 0.5 * Math.pow( pos, 3 ) ); }\r\n\t\treturn ( 0.5 * ( Math.pow( ( pos - 2 ), 3 ) + 2 ) );\r\n\t}\r\n};\r\n","/* eslint no-console:\"off\" */\r\nconst win = typeof window !== 'undefined' ? window : null;\r\nconst doc = win ? document : null;\r\nconst isClient = !!doc;\r\nconst hasConsole = ( typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function' );\r\n\r\nconst svg = doc ?\r\n\tdoc.implementation.hasFeature( 'http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1' ) :\r\n\tfalse;\r\n\r\nconst vendors = [ 'o', 'ms', 'moz', 'webkit' ];\r\n\r\nexport { win, doc, isClient, hasConsole, svg, vendors };\r\n","export default function () {}\r\n","// Error messages that are used (or could be) in multiple places\r\nexport const badArguments = 'Bad arguments';\r\nexport const noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\r\nexport const missingPlugin = ( name, type ) => `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#${type}s`;\r\n","import { addToArray, removeFromArray } from '../../utils/array';\r\nimport { unescapeKey } from '../../shared/keypaths';\r\nimport { capture } from '../../global/capture';\r\nimport noop from '../../utils/noop';\r\n\r\nexport default class KeyModel {\r\n\tconstructor ( key, parent ) {\r\n\t\tthis.value = key;\r\n\t\tthis.isReadonly = this.isKey = true;\r\n\t\tthis.deps = [];\r\n\t\tthis.links = [];\r\n\t\tthis.parent = parent;\r\n\t}\r\n\r\n\tget ( shouldCapture ) {\r\n\t\tif ( shouldCapture ) capture( this );\r\n\t\treturn unescapeKey( this.value );\r\n\t}\r\n\r\n\tgetKeypath () {\r\n\t\treturn unescapeKey( this.value );\r\n\t}\r\n\r\n\trebind ( next, previous ) {\r\n\t\tlet i = this.deps.length;\r\n\t\twhile ( i-- ) this.deps[i].rebind( next, previous, false );\r\n\r\n\t\ti = this.links.length;\r\n\t\twhile ( i-- ) this.links[i].rebind( next, previous, false );\r\n\t}\r\n\r\n\tregister ( dependant ) {\r\n\t\tthis.deps.push( dependant );\r\n\t}\r\n\r\n\tregisterLink ( link ) {\r\n\t\taddToArray( this.links, link );\r\n\t}\r\n\r\n\tunregister ( dependant ) {\r\n\t\tremoveFromArray( this.deps, dependant );\r\n\t}\r\n\r\n\tunregisterLink ( link ) {\r\n\t\tremoveFromArray( this.links, link );\r\n\t}\r\n}\r\n\r\nKeyModel.prototype.reference = noop;\r\nKeyModel.prototype.unreference = noop;\r\n","import { removeFromArray } from '../../utils/array';\r\nimport { handleChange } from '../../shared/methodCallers';\r\nimport { capture } from '../../global/capture';\r\nimport noop from '../../utils/noop';\r\n\r\nexport default class KeypathModel {\r\n\tconstructor ( parent, ractive ) {\r\n\t\tthis.parent = parent;\r\n\t\tthis.ractive = ractive;\r\n\t\tthis.value = ractive ? parent.getKeypath( ractive ) : parent.getKeypath();\r\n\t\tthis.deps = [];\r\n\t\tthis.children = {};\r\n\t\tthis.isReadonly = this.isKeypath = true;\r\n\t}\r\n\r\n\tget ( shouldCapture ) {\r\n\t\tif ( shouldCapture ) capture( this );\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\tgetChild ( ractive ) {\r\n\t\tif ( !( ractive._guid in this.children ) ) {\r\n\t\t\tconst model = new KeypathModel( this.parent, ractive );\r\n\t\t\tthis.children[ ractive._guid ] = model;\r\n\t\t\tmodel.owner = this;\r\n\t\t}\r\n\t\treturn this.children[ ractive._guid ];\r\n\t}\r\n\r\n\tgetKeypath () {\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tconst keys = Object.keys( this.children );\r\n\t\tlet i = keys.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tthis.children[ keys[i] ].handleChange();\r\n\t\t}\r\n\r\n\t\tthis.deps.forEach( handleChange );\r\n\t}\r\n\r\n\trebindChildren ( next ) {\r\n\t\tconst keys = Object.keys( this.children );\r\n\t\tlet i = keys.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst child = this.children[keys[i]];\r\n\t\t\tchild.value = next.getKeypath( child.ractive );\r\n\t\t\tchild.handleChange();\r\n\t\t}\r\n\t}\r\n\r\n\trebind ( next, previous ) {\r\n\t\tconst model = next ? next.getKeypathModel( this.ractive ) : undefined;\r\n\r\n\t\tconst keys = Object.keys( this.children );\r\n\t\tlet i = keys.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tthis.children[ keys[i] ].rebind( next, previous, false );\r\n\t\t}\r\n\r\n\t\ti = this.deps.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tthis.deps[i].rebind( model, this, false );\r\n\t\t}\r\n\t}\r\n\r\n\tregister ( dep ) {\r\n\t\tthis.deps.push( dep );\r\n\t}\r\n\r\n\tremoveChild( model ) {\r\n\t\tif ( model.ractive ) delete this.children[ model.ractive._guid ];\r\n\t}\r\n\r\n\tteardown () {\r\n\t\tif ( this.owner ) this.owner.removeChild( this );\r\n\r\n\t\tconst keys = Object.keys( this.children );\r\n\t\tlet i = keys.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tthis.children[ keys[i] ].teardown();\r\n\t\t}\r\n\t}\r\n\r\n\tunregister ( dep ) {\r\n\t\tremoveFromArray( this.deps, dep );\r\n\t\tif ( !this.deps.length ) this.teardown();\r\n\t}\r\n}\r\n\r\nKeypathModel.prototype.reference = noop;\r\nKeypathModel.prototype.unreference = noop;\r\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\r\nimport KeypathModel from './specials/KeypathModel';\r\nimport { capture } from '../global/capture';\r\nimport { handleChange, marked, markedAll, teardown } from '../shared/methodCallers';\r\nimport { rebindMatch } from '../shared/rebind';\r\nimport resolveReference from '../view/resolvers/resolveReference';\r\nimport noop from '../utils/noop';\r\n\r\n// temporary placeholder target for detached implicit links\r\nexport const Missing = {\r\n\tkey: '@missing',\r\n\tanimate: noop,\r\n\tapplyValue: noop,\r\n\tget: noop,\r\n\tgetKeypath () { return this.key; },\r\n\tjoinAll () { return this; },\r\n\tjoinKey () { return this; },\r\n\tmark: noop,\r\n\tregisterLink: noop,\r\n\tshufle: noop,\r\n\tset: noop,\r\n\tunregisterLink: noop\r\n};\r\nMissing.parent = Missing;\r\n\r\nexport default class LinkModel extends ModelBase {\r\n\tconstructor ( parent, owner, target, key ) {\r\n\t\tsuper( parent );\r\n\r\n\t\tthis.owner = owner;\r\n\t\tthis.target = target;\r\n\t\tthis.key = key === undefined ? owner.key : key;\r\n\t\tif ( owner.isLink ) this.sourcePath = `${owner.sourcePath}.${this.key}`;\r\n\r\n\t\ttarget.registerLink( this );\r\n\r\n\t\tif ( parent ) this.isReadonly = parent.isReadonly;\r\n\r\n\t\tthis.isLink = true;\r\n\t}\r\n\r\n\tanimate ( from, to, options, interpolator ) {\r\n\t\treturn this.target.animate( from, to, options, interpolator );\r\n\t}\r\n\r\n\tapplyValue ( value ) {\r\n\t\tif ( this.boundValue ) this.boundValue = null;\r\n\t\tthis.target.applyValue( value );\r\n\t}\r\n\r\n\tattach ( fragment ) {\r\n\t\tconst model = resolveReference( fragment, this.key );\r\n\t\tif ( model ) {\r\n\t\t\tthis.relinking( model, false );\r\n\t\t} else { // if there is no link available, move everything here to real models\r\n\t\t\tthis.owner.unlink();\r\n\t\t}\r\n\t}\r\n\r\n\tdetach () {\r\n\t\tthis.relinking( Missing, false );\r\n\t}\r\n\r\n\tget ( shouldCapture, opts = {} ) {\r\n\t\tif ( shouldCapture ) {\r\n\t\t\tcapture( this );\r\n\r\n\t\t\t// may need to tell the target to unwrap\r\n\t\t\topts.unwrap = true;\r\n\t\t}\r\n\r\n\t\tconst bind = 'shouldBind' in opts ? opts.shouldBind : true;\r\n\t\topts.shouldBind = false;\r\n\r\n\t\treturn maybeBind( this, this.target.get( false, opts ), bind );\r\n\t}\r\n\r\n\tgetKeypath ( ractive ) {\r\n\t\tif ( ractive && ractive !== this.root.ractive ) return this.target.getKeypath( ractive );\r\n\r\n\t\treturn super.getKeypath( ractive );\r\n\t}\r\n\r\n\tgetKeypathModel ( ractive ) {\r\n\t\tif ( !this.keypathModel ) this.keypathModel = new KeypathModel( this );\r\n\t\tif ( ractive && ractive !== this.root.ractive ) return this.keypathModel.getChild( ractive );\r\n\t\treturn this.keypathModel;\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tthis.deps.forEach( handleChange );\r\n\t\tthis.links.forEach( handleChange );\r\n\t\tthis.notifyUpstream();\r\n\t}\r\n\r\n\tisDetached () { return this.virtual && this.target === Missing; }\r\n\r\n\tjoinKey ( key ) {\r\n\t\t// TODO: handle nested links\r\n\t\tif ( key === undefined || key === '' ) return this;\r\n\r\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\r\n\t\t\tconst child = new LinkModel( this, this, this.target.joinKey( key ), key );\r\n\t\t\tthis.children.push( child );\r\n\t\t\tthis.childByKey[ key ] = child;\r\n\t\t}\r\n\r\n\t\treturn this.childByKey[ key ];\r\n\t}\r\n\r\n\tmark ( force ) {\r\n\t\tthis.target.mark( force );\r\n\t}\r\n\r\n\tmarked () {\r\n\t\tif ( this.boundValue ) this.boundValue = null;\r\n\r\n\t\tthis.links.forEach( marked );\r\n\r\n\t\tthis.deps.forEach( handleChange );\r\n\t}\r\n\r\n\tmarkedAll () {\r\n\t\tthis.children.forEach( markedAll );\r\n\t\tthis.marked();\r\n\t}\r\n\r\n\tnotifiedUpstream ( startPath, root ) {\r\n\t\tthis.links.forEach( l => l.notifiedUpstream( startPath, this.root ) );\r\n\t\tthis.deps.forEach( handleChange );\r\n\t\tif ( startPath && this.rootLink && this.root !== root ) {\r\n\t\t\tconst path = startPath.slice( 1 );\r\n\t\t\tpath.unshift( this.key );\r\n\t\t\tthis.notifyUpstream( path );\r\n\t\t}\r\n\t}\r\n\r\n\trelinked () {\r\n\t\tthis.target.registerLink( this );\r\n\t\tthis.children.forEach( c => c.relinked() );\r\n\t}\r\n\r\n\trelinking ( target, safe ) {\r\n\t\tif ( this.rootLink && this.sourcePath ) target = rebindMatch( this.sourcePath, target, this.target );\r\n\t\tif ( !target || this.target === target ) return;\r\n\r\n\t\tthis.target.unregisterLink( this );\r\n\t\tif ( this.keypathModel ) this.keypathModel.rebindChildren( target );\r\n\r\n\t\tthis.target = target;\r\n\t\tthis.children.forEach( c => {\r\n\t\t\tc.relinking( target.joinKey( c.key ), safe );\r\n\t\t});\r\n\r\n\t\tif ( this.rootLink ) this.addShuffleTask( () => {\r\n\t\t\tthis.relinked();\r\n\t\t\tif ( !safe ) this.notifyUpstream();\r\n\t\t});\r\n\t}\r\n\r\n\tset ( value ) {\r\n\t\tif ( this.boundValue ) this.boundValue = null;\r\n\t\tthis.target.set( value );\r\n\t}\r\n\r\n\tshuffle ( newIndices ) {\r\n\t\t// watch for extra shuffles caused by a shuffle in a downstream link\r\n\t\tif ( this.shuffling ) return;\r\n\r\n\t\t// let the real model handle firing off shuffles\r\n\t\tif ( !this.target.shuffling ) {\r\n\t\t\tthis.target.shuffle( newIndices );\r\n\t\t} else {\r\n\t\t\tshuffle( this, newIndices, true );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsource () {\r\n\t\tif ( this.target.source ) return this.target.source();\r\n\t\telse return this.target;\r\n\t}\r\n\r\n\tteardown () {\r\n\t\tif ( this._link ) this._link.teardown();\r\n\t\tthis.target.unregisterLink( this );\r\n\t\tthis.children.forEach( teardown );\r\n\t}\r\n}\r\n\r\nModelBase.prototype.link = function link ( model, keypath, options ) {\r\n\tconst lnk = this._link || new LinkModel( this.parent, this, model, this.key );\r\n\tlnk.implicit = options && options.implicit;\r\n\tlnk.sourcePath = keypath;\r\n\tlnk.rootLink = true;\r\n\tif ( this._link ) this._link.relinking( model, true, false );\r\n\tthis.rebind( lnk, this, false );\r\n\tfireShuffleTasks();\r\n\r\n\tthis._link = lnk;\r\n\tlnk.markedAll();\r\n\r\n\tthis.notifyUpstream();\r\n\treturn lnk;\r\n};\r\n\r\nModelBase.prototype.unlink = function unlink () {\r\n\tif ( this._link ) {\r\n\t\tconst ln = this._link;\r\n\t\tthis._link = undefined;\r\n\t\tln.rebind( this, this._link );\r\n\t\tfireShuffleTasks();\r\n\t\tln.teardown();\r\n\t\tthis.notifyUpstream();\r\n\t}\r\n};\r\n","/* global global */\r\nimport Model from '../Model';\r\n\r\nconst data = {};\r\n\r\nexport class SharedModel extends Model {\r\n\tconstructor ( value, name ) {\r\n\t\tsuper( null, `@${name}` );\r\n\t\tthis.key = `@${name}`;\r\n\t\tthis.value = value;\r\n\t\tthis.isRoot = true;\r\n\t\tthis.root = this;\r\n\t\tthis.adaptors = [];\r\n\t}\r\n\r\n\tgetKeypath() {\r\n\t\treturn this.key;\r\n\t}\r\n}\r\n\r\nexport default new SharedModel( data, 'shared' );\r\n\r\nexport const GlobalModel = new SharedModel( typeof global !== 'undefined' ? global : window, 'global' );\r\n","import fireEvent from './fireEvent';\r\nimport getRactiveContext from '../shared/getRactiveContext';\r\n\r\nexport default class Hook {\r\n\tconstructor ( event ) {\r\n\t\tthis.event = event;\r\n\t\tthis.method = 'on' + event;\r\n\t}\r\n\r\n\tfire ( ractive, arg ) {\r\n\t\tconst context = getRactiveContext( ractive );\r\n\r\n\t\tif ( ractive[ this.method ] ) {\r\n\t\t\targ ? ractive[ this.method ]( context, arg ) : ractive[ this.method ]( context );\r\n\t\t}\r\n\r\n\t\tfireEvent( ractive, this.event, context, arg ? [ arg, ractive ] : [ ractive ] );\r\n\t}\r\n}\r\n","import { splitKeypath } from '../../../shared/keypaths';\r\nimport runloop from '../../../global/runloop';\r\nimport getNewIndices from '../../../shared/getNewIndices';\r\n\r\nconst arrayProto = Array.prototype;\r\n\r\nexport default function ( methodName ) {\r\n\tfunction path ( keypath, ...args ) {\r\n\t\treturn model( this.viewmodel.joinAll( splitKeypath( keypath ) ), args );\r\n\t}\r\n\r\n\tfunction model ( mdl, args ) {\r\n\t\tlet array = mdl.get();\r\n\r\n\t\tif ( !Array.isArray( array ) ) {\r\n\t\t\tif ( array === undefined ) {\r\n\t\t\t\tarray = [];\r\n\t\t\t\tconst result = arrayProto[ methodName ].apply( array, args );\r\n\t\t\t\tconst promise = runloop.start( this, true ).then( () => result );\r\n\t\t\t\tmdl.set( array );\r\n\t\t\t\trunloop.end();\r\n\t\t\t\treturn promise;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error( `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}` );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst newIndices = getNewIndices( array.length, methodName, args );\r\n\t\tconst result = arrayProto[ methodName ].apply( array, args );\r\n\r\n\t\tconst promise = runloop.start( this, true ).then( () => result );\r\n\t\tpromise.result = result;\r\n\r\n\t\tif ( newIndices ) {\r\n\t\t\tmdl.shuffle( newIndices );\r\n\t\t} else {\r\n\t\t\tmdl.set( result );\r\n\t\t}\r\n\r\n\t\trunloop.end();\r\n\r\n\t\treturn promise;\r\n\t}\r\n\r\n\treturn { path, model };\r\n}\r\n","export const TEXT              = 1;\r\nexport const INTERPOLATOR      = 2;\r\nexport const TRIPLE            = 3;\r\nexport const SECTION           = 4;\r\nexport const INVERTED          = 5;\r\nexport const CLOSING           = 6;\r\nexport const ELEMENT           = 7;\r\nexport const PARTIAL           = 8;\r\nexport const COMMENT           = 9;\r\nexport const DELIMCHANGE       = 10;\r\nexport const ANCHOR            = 11;\r\nexport const ATTRIBUTE         = 13;\r\nexport const CLOSING_TAG       = 14;\r\nexport const COMPONENT         = 15;\r\nexport const YIELDER           = 16;\r\nexport const INLINE_PARTIAL    = 17;\r\nexport const DOCTYPE           = 18;\r\nexport const ALIAS             = 19;\r\n\r\nexport const NUMBER_LITERAL    = 20;\r\nexport const STRING_LITERAL    = 21;\r\nexport const ARRAY_LITERAL     = 22;\r\nexport const OBJECT_LITERAL    = 23;\r\nexport const BOOLEAN_LITERAL   = 24;\r\nexport const REGEXP_LITERAL    = 25;\r\n\r\nexport const GLOBAL            = 26;\r\nexport const KEY_VALUE_PAIR    = 27;\r\n\r\n\r\nexport const REFERENCE         = 30;\r\nexport const REFINEMENT        = 31;\r\nexport const MEMBER            = 32;\r\nexport const PREFIX_OPERATOR   = 33;\r\nexport const BRACKETED         = 34;\r\nexport const CONDITIONAL       = 35;\r\nexport const INFIX_OPERATOR    = 36;\r\n\r\nexport const INVOCATION        = 40;\r\n\r\nexport const SECTION_IF        = 50;\r\nexport const SECTION_UNLESS    = 51;\r\nexport const SECTION_EACH      = 52;\r\nexport const SECTION_WITH      = 53;\r\nexport const SECTION_IF_WITH   = 54;\r\n\r\nexport const ELSE              = 60;\r\nexport const ELSEIF            = 61;\r\n\r\nexport const EVENT             = 70;\r\nexport const DECORATOR         = 71;\r\nexport const TRANSITION        = 72;\r\nexport const BINDING_FLAG      = 73;\r\nexport const DELEGATE_FLAG     = 74;\r\n","export const html   = 'http://www.w3.org/1999/xhtml';\r\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\r\nexport const svg    = 'http://www.w3.org/2000/svg';\r\nexport const xlink  = 'http://www.w3.org/1999/xlink';\r\nexport const xml    = 'http://www.w3.org/XML/1998/namespace';\r\nexport const xmlns  = 'http://www.w3.org/2000/xmlns';\r\n\r\nexport default { html, mathml, svg, xlink, xml, xmlns };\r\n","import { escapeKey } from '../../../shared/keypaths';\r\nimport { removeFromArray } from '../../../utils/array';\r\nimport { isEqual } from '../../../utils/is';\r\nimport runloop from '../../../global/runloop';\r\n\r\nconst star = /\\*+/g;\r\n\r\nexport default class PatternObserver {\r\n\tconstructor ( ractive, baseModel, keys, callback, options ) {\r\n\t\tthis.context = options.context || ractive;\r\n\t\tthis.ractive = ractive;\r\n\t\tthis.baseModel = baseModel;\r\n\t\tthis.keys = keys;\r\n\t\tthis.callback = callback;\r\n\r\n\t\tconst pattern = keys.join( '\\\\.' ).replace( star, '(.+)' );\r\n\t\tconst baseKeypath = this.baseKeypath = baseModel.getKeypath( ractive );\r\n\t\tthis.pattern = new RegExp( `^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$` );\r\n\t\tthis.recursive = keys.length === 1 && keys[0] === '**';\r\n\t\tif ( this.recursive ) this.keys = [ '*' ];\r\n\r\n\t\tthis.oldValues = {};\r\n\t\tthis.newValues = {};\r\n\r\n\t\tthis.defer = options.defer;\r\n\t\tthis.once = options.once;\r\n\t\tthis.strict = options.strict;\r\n\r\n\t\tthis.dirty = false;\r\n\t\tthis.changed = [];\r\n\t\tthis.partial = false;\r\n\t\tthis.links = options.links;\r\n\r\n\t\tconst models = baseModel.findMatches( this.keys );\r\n\r\n\t\tmodels.forEach( model => {\r\n\t\t\tthis.newValues[ model.getKeypath( this.ractive ) ] = model.get();\r\n\t\t});\r\n\r\n\t\tif ( options.init !== false ) {\r\n\t\t\tthis.dispatch();\r\n\t\t} else {\r\n\t\t\tthis.oldValues = this.newValues;\r\n\t\t}\r\n\r\n\t\tbaseModel.registerPatternObserver( this );\r\n\t}\r\n\r\n\tcancel () {\r\n\t\tthis.baseModel.unregisterPatternObserver( this );\r\n\t\tremoveFromArray( this.ractive._observers, this );\r\n\t}\r\n\r\n\tdispatch () {\r\n\t\tconst newValues = this.newValues;\r\n\t\tthis.newValues = {};\r\n\t\tObject.keys( newValues ).forEach( keypath => {\r\n\t\t\tif ( this.newKeys && !this.newKeys[ keypath ] ) return;\r\n\r\n\t\t\tconst newValue = newValues[ keypath ];\r\n\t\t\tconst oldValue = this.oldValues[ keypath ];\r\n\r\n\t\t\tif ( this.strict && newValue === oldValue ) return;\r\n\t\t\tif ( isEqual( newValue, oldValue ) ) return;\r\n\r\n\t\t\tlet args = [ newValue, oldValue, keypath ];\r\n\t\t\tif ( keypath ) {\r\n\t\t\t\tconst wildcards = this.pattern.exec( keypath );\r\n\t\t\t\tif ( wildcards ) {\r\n\t\t\t\t\targs = args.concat( wildcards.slice( 1 ) );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.callback.apply( this.context, args );\r\n\t\t});\r\n\r\n\t\tif ( this.partial ) {\r\n\t\t\tfor ( const k in newValues ) {\r\n\t\t\t\tthis.oldValues[k] = newValues[k];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.oldValues = newValues;\r\n\t\t}\r\n\r\n\t\tthis.newKeys = null;\r\n\t\tthis.dirty = false;\r\n\t}\r\n\r\n\tnotify ( key ) {\r\n\t\tthis.changed.push( key );\r\n\t}\r\n\r\n\tshuffle ( newIndices ) {\r\n\t\tif ( !Array.isArray( this.baseModel.value ) ) return;\r\n\r\n\t\tconst base = this.baseKeypath = this.baseModel.getKeypath( this.ractive );\r\n\t\tconst max = this.baseModel.value.length;\r\n\t\tconst suffix = this.keys.length > 1 ? '.' + this.keys.slice( 1 ).join( '.' ) : '';\r\n\r\n\t\tthis.newKeys = {};\r\n\t\tfor ( let i = 0; i < newIndices.length; i++ ) {\r\n\t\t\tif ( newIndices[ i ] === -1 || newIndices[ i ] === i ) continue;\r\n\t\t\tthis.newKeys[ `${base}.${i}${suffix}` ] = true;\r\n\t\t}\r\n\r\n\t\tfor ( let i = newIndices.touchedFrom; i < max; i++ ) {\r\n\t\t\tthis.newKeys[ `${base}.${i}${suffix}` ] = true;\r\n\t\t}\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tif ( !this.dirty || this.changed.length ) {\r\n\t\t\tif ( !this.dirty ) this.newValues = {};\r\n\r\n\t\t\tif ( !this.changed.length ) {\r\n\t\t\t\tthis.baseModel.findMatches( this.keys ).forEach( model => {\r\n\t\t\t\t\tconst keypath = model.getKeypath( this.ractive );\r\n\t\t\t\t\tthis.newValues[ keypath ] = model.get();\r\n\t\t\t\t});\r\n\t\t\t\tthis.partial = false;\r\n\t\t\t} else {\r\n\t\t\t\tlet count = 0;\r\n\r\n\t\t\t\tif ( this.recursive ) {\r\n\t\t\t\t\tthis.changed.forEach( keys => {\r\n\t\t\t\t\t\tconst model = this.baseModel.joinAll( keys );\r\n\t\t\t\t\t\tif ( model.isLink && !this.links ) return;\r\n\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\tthis.newValues[ model.getKeypath( this.ractive ) ] = model.get();\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst ok = this.baseModel.isRoot ?\r\n\t\t\t\t\t\tthis.changed.map( keys => keys.map( escapeKey ).join( '.' ) ) :\r\n\t\t\t\t\t\tthis.changed.map( keys => this.baseKeypath + '.' + keys.map( escapeKey ).join( '.' ) );\r\n\r\n\t\t\t\t\tthis.baseModel.findMatches( this.keys ).forEach( model => {\r\n\t\t\t\t\t\tconst keypath = model.getKeypath( this.ractive );\r\n\t\t\t\t\t\tconst check = k => {\r\n\t\t\t\t\t\t\treturn ( k.indexOf( keypath ) === 0 && ( k.length === keypath.length || k[ keypath.length ] === '.' ) ) ||\r\n\t\t\t\t\t\t\t\t( keypath.indexOf( k ) === 0 && ( k.length === keypath.length || keypath[ k.length ] === '.' ) );\r\n\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// is this model on a changed keypath?\r\n\t\t\t\t\t\tif ( ok.filter( check ).length ) {\r\n\t\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\t\tthis.newValues[ keypath ] = model.get();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// no valid change triggered, so bail to avoid breakage\r\n\t\t\t\tif ( !count ) return;\r\n\r\n\t\t\t\tthis.partial = true;\r\n\t\t\t}\r\n\r\n\t\t\trunloop.addObserver( this, this.defer );\r\n\t\t\tthis.dirty = true;\r\n\t\t\tthis.changed.length = 0;\r\n\r\n\t\t\tif ( this.once ) this.cancel();\r\n\t\t}\r\n\t}\r\n}\r\n","export default str => str.trim();\r\n","export default str => str !== '';\r\n","import makeArrayMethod from './shared/makeArrayMethod';\r\nexport default makeArrayMethod( 'pop' ).path;\r\n","import makeArrayMethod from './shared/makeArrayMethod';\r\nexport default makeArrayMethod( 'push' ).path;\r\n","import { ensureArray, combine } from '../../../utils/array';\r\n\r\nexport default {\r\n\textend: ( Parent, proto, options ) => {\r\n\t\tproto.adapt = combine( proto.adapt, ensureArray( options.adapt ) );\r\n\t},\r\n\r\n\tinit () {}\r\n};\r\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\r\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\r\nconst value = /\\0(\\d+)/g;\r\n\r\n// Removes comments and strings from the given CSS to make it easier to parse.\r\n// Callback receives the cleaned CSS and a function which can be used to put\r\n// the removed strings back in place after parsing is done.\r\nexport default function ( css, callback, additionalReplaceRules = [] ) {\r\n\tconst values = [];\r\n\tconst reconstruct = css => css.replace( value, ( match, n ) => values[ n ] );\r\n\tcss = css.replace( escape, match => `\\0${values.push( match ) - 1}`).replace( remove, '' );\r\n\r\n\tadditionalReplaceRules.forEach( ( pattern ) => {\r\n\t\tcss = css.replace( pattern, match => `\\0${values.push( match ) - 1}` );\r\n\t});\r\n\r\n\treturn callback( css, reconstruct );\r\n}\r\n","import { addCSS } from '../../../../global/css';\r\nimport transformCss from './transform';\r\nimport { uuid } from '../../../../utils/id';\r\nimport { warnIfDebug } from '../../../../utils/log';\r\nimport { getElement } from '../../../../utils/dom';\r\n\r\nconst hasCurly = /\\{/;\r\nexport default {\r\n\tname: 'css',\r\n\r\n\t// Called when creating a new component definition\r\n\textend: ( Parent, proto, options ) => {\r\n\t\tif ( !options.css ) return;\r\n\t\tlet css = typeof options.css === 'string' && !hasCurly.test( options.css ) ?\r\n\t\t\t( getElement( options.css ) || options.css ) :\r\n\t\t\toptions.css;\r\n\r\n\t\tconst id = options.cssId || uuid();\r\n\r\n\t\tif ( typeof css === 'object' ) {\r\n\t\t\tcss = 'textContent' in css ? css.textContent : css.innerHTML;\r\n\t\t}\r\n\r\n\t\tif ( !css ) return;\r\n\r\n\t\tconst styles = options.noCssTransform ? css : transformCss( css, id );\r\n\r\n\t\tproto.cssId = id;\r\n\r\n\t\taddCSS( { id, styles } );\r\n\t},\r\n\r\n\t// Called when creating a new component instance\r\n\tinit: ( Parent, target, options ) => {\r\n\t\tif ( !options.css ) return;\r\n\r\n\t\twarnIfDebug( `\r\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\r\n\r\nconst Component = Ractive.extend({\r\n\t...\r\n\tcss: '/* your css */',\r\n\t...\r\n});\r\n\r\nconst componentInstance = new Component({ ... })\r\n\t\t` );\r\n\t}\r\n\r\n};\r\n","export const TEMPLATE_VERSION = 4;\r\n","import { warnIfDebug } from '../utils/log';\r\n\r\nconst leadingWhitespace = /^\\s+/;\r\n\r\nconst ParseError = function ( message ) {\r\n\tthis.name = 'ParseError';\r\n\tthis.message = message;\r\n\ttry {\r\n\t\tthrow new Error(message);\r\n\t} catch (e) {\r\n\t\tthis.stack = e.stack;\r\n\t}\r\n};\r\n\r\nParseError.prototype = Error.prototype;\r\n\r\nconst Parser = function ( str, options ) {\r\n\tlet item;\r\n\tlet lineStart = 0;\r\n\r\n\tthis.str = str;\r\n\tthis.options = options || {};\r\n\tthis.pos = 0;\r\n\r\n\tthis.lines = this.str.split( '\\n' );\r\n\tthis.lineEnds = this.lines.map( line => {\r\n\t\tconst lineEnd = lineStart + line.length + 1; // +1 for the newline\r\n\r\n\t\tlineStart = lineEnd;\r\n\t\treturn lineEnd;\r\n\t}, 0 );\r\n\r\n\t// Custom init logic\r\n\tif ( this.init ) this.init( str, options );\r\n\r\n\tconst items = [];\r\n\r\n\twhile ( ( this.pos < this.str.length ) && ( item = this.read() ) ) {\r\n\t\titems.push( item );\r\n\t}\r\n\r\n\tthis.leftover = this.remaining();\r\n\tthis.result = this.postProcess ? this.postProcess( items, options ) : items;\r\n};\r\n\r\nParser.prototype = {\r\n\tread ( converters ) {\r\n\t\tlet i, item;\r\n\r\n\t\tif ( !converters ) converters = this.converters;\r\n\r\n\t\tconst pos = this.pos;\r\n\r\n\t\tconst len = converters.length;\r\n\t\tfor ( i = 0; i < len; i += 1 ) {\r\n\t\t\tthis.pos = pos; // reset for each attempt\r\n\r\n\t\t\tif ( item = converters[i]( this ) ) {\r\n\t\t\t\treturn item;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t},\r\n\r\n\tgetContextMessage ( pos, message ) {\r\n\t\tconst [ lineNum, columnNum ] = this.getLinePos( pos );\r\n\t\tif ( this.options.contextLines === -1 ) {\r\n\t\t\treturn [ lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}` ];\r\n\t\t}\r\n\r\n\t\tconst line = this.lines[ lineNum - 1 ];\r\n\r\n\t\tlet contextUp = '';\r\n\t\tlet contextDown = '';\r\n\t\tif ( this.options.contextLines ) {\r\n\t\t\tconst start = lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\r\n\t\t\tcontextUp = this.lines.slice( start, lineNum - 1 - start ).join( '\\n' ).replace( /\\t/g, '  ' );\r\n\t\t\tcontextDown = this.lines.slice( lineNum, lineNum + this.options.contextLines ).join( '\\n' ).replace( /\\t/g, '  ' );\r\n\t\t\tif ( contextUp ) {\r\n\t\t\t\tcontextUp += '\\n';\r\n\t\t\t}\r\n\t\t\tif ( contextDown ) {\r\n\t\t\t\tcontextDown = '\\n' + contextDown;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet numTabs = 0;\r\n\t\tconst annotation = contextUp + line.replace( /\\t/g, ( match, char ) => {\r\n\t\t\tif ( char < columnNum ) {\r\n\t\t\t\tnumTabs += 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn '  ';\r\n\t\t}) + '\\n' + new Array( columnNum + numTabs ).join( ' ' ) + '^----' + contextDown;\r\n\r\n\t\treturn [ lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}` ];\r\n\t},\r\n\r\n\tgetLinePos ( char ) {\r\n\t\tlet lineNum = 0;\r\n\t\tlet lineStart = 0;\r\n\r\n\t\twhile ( char >= this.lineEnds[ lineNum ] ) {\r\n\t\t\tlineStart = this.lineEnds[ lineNum ];\r\n\t\t\tlineNum += 1;\r\n\t\t}\r\n\r\n\t\tconst columnNum = char - lineStart;\r\n\t\treturn [ lineNum + 1, columnNum + 1, char ]; // line/col should be one-based, not zero-based!\r\n\t},\r\n\r\n\terror ( message ) {\r\n\t\tconst [ lineNum, columnNum, msg ] = this.getContextMessage( this.pos, message );\r\n\r\n\t\tconst error = new ParseError( msg );\r\n\r\n\t\terror.line = lineNum;\r\n\t\terror.character = columnNum;\r\n\t\terror.shortMessage = message;\r\n\r\n\t\tthrow error;\r\n\t},\r\n\r\n\tmatchString ( string ) {\r\n\t\tif ( this.str.substr( this.pos, string.length ) === string ) {\r\n\t\t\tthis.pos += string.length;\r\n\t\t\treturn string;\r\n\t\t}\r\n\t},\r\n\r\n\tmatchPattern ( pattern ) {\r\n\t\tlet match;\r\n\r\n\t\tif ( match = pattern.exec( this.remaining() ) ) {\r\n\t\t\tthis.pos += match[0].length;\r\n\t\t\treturn match[1] || match[0];\r\n\t\t}\r\n\t},\r\n\r\n\tallowWhitespace () {\r\n\t\tthis.matchPattern( leadingWhitespace );\r\n\t},\r\n\r\n\tremaining () {\r\n\t\treturn this.str.substring( this.pos );\r\n\t},\r\n\r\n\tnextChar () {\r\n\t\treturn this.str.charAt( this.pos );\r\n\t},\r\n\r\n\twarn ( message ) {\r\n\t\tconst msg = this.getContextMessage( this.pos, message )[2];\r\n\r\n\t\twarnIfDebug( msg );\r\n\t}\r\n};\r\n\r\nParser.extend = function ( proto ) {\r\n\tconst Parent = this;\r\n\tconst Child = function ( str, options ) {\r\n\t\tParser.call( this, str, options );\r\n\t};\r\n\r\n\tChild.prototype = Object.create( Parent.prototype );\r\n\r\n\tfor ( const key in proto ) {\r\n\t\tif ( proto.hasOwnProperty( key ) ) {\r\n\t\t\tChild.prototype[ key ] = proto[ key ];\r\n\t\t}\r\n\t}\r\n\r\n\tChild.extend = Parser.extend;\r\n\treturn Child;\r\n};\r\n\r\nexport default Parser;\r\n","import { PREFIX_OPERATOR } from '../../../config/types';\r\nimport { expectedExpression } from './shared/errors';\r\nimport readMemberOrInvocation from './readMemberOrInvocation';\r\nimport readExpression from '../readExpression';\r\n\r\nlet readTypeOf;\r\n\r\nconst makePrefixSequenceMatcher = function ( symbol, fallthrough ) {\r\n\treturn function ( parser ) {\r\n\t\tlet expression;\r\n\r\n\t\tif ( expression = fallthrough( parser ) ) {\r\n\t\t\treturn expression;\r\n\t\t}\r\n\r\n\t\tif ( !parser.matchString( symbol ) ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tparser.allowWhitespace();\r\n\r\n\t\texpression = readExpression( parser );\r\n\t\tif ( !expression ) {\r\n\t\t\tparser.error( expectedExpression );\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ts: symbol,\r\n\t\t\to: expression,\r\n\t\t\tt: PREFIX_OPERATOR\r\n\t\t};\r\n\t};\r\n};\r\n\r\n// create all prefix sequence matchers, return readTypeOf\r\n(function() {\r\n\tlet i, len, matcher, fallthrough;\r\n\r\n\tconst prefixOperators = '! ~ + - typeof'.split( ' ' );\r\n\r\n\tfallthrough = readMemberOrInvocation;\r\n\tfor ( i = 0, len = prefixOperators.length; i < len; i += 1 ) {\r\n\t\tmatcher = makePrefixSequenceMatcher( prefixOperators[i], fallthrough );\r\n\t\tfallthrough = matcher;\r\n\t}\r\n\r\n\t// typeof operator is higher precedence than multiplication, so provides the\r\n\t// fallthrough for the multiplication sequence matcher we're about to create\r\n\t// (we're skipping void and delete)\r\n\treadTypeOf = fallthrough;\r\n}());\r\n\r\nexport default readTypeOf;\r\n","import escapeRegExp from '../../../utils/escapeRegExp';\r\n\r\nconst regExpCache = {};\r\n\r\nexport default function ( haystack, needles ) {\r\n\treturn haystack.search( regExpCache[needles.join()] || ( regExpCache[needles.join()] = new RegExp( needles.map( escapeRegExp ).join( '|' ) ) ) );\r\n}\r\n","export const expectedExpression = 'Expected a JavaScript expression';\r\nexport const expectedParen = 'Expected closing paren';\r\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\r\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\r\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\r\n\r\n// Match one escape sequence, including the backslash.\r\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\r\n\r\n// Match one ES5 line continuation (backslash + line terminator).\r\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\r\n\r\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\r\nexport default function ( okQuote ) {\r\n\treturn function ( parser ) {\r\n\t\tlet literal = '\"';\r\n\t\tlet done = false;\r\n\t\tlet next;\r\n\r\n\t\twhile ( !done ) {\r\n\t\t\tnext = ( parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) ||\r\n\t\t\t\tparser.matchString( okQuote ) );\r\n\t\t\tif ( next ) {\r\n\t\t\t\tif ( next === `\"` ) {\r\n\t\t\t\t\tliteral += `\\\\\"`;\r\n\t\t\t\t} else if ( next === `\\\\'` ) {\r\n\t\t\t\t\tliteral += `'`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tliteral += next;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tnext = parser.matchPattern( lineContinuationPattern );\r\n\t\t\t\tif ( next ) {\r\n\t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\r\n\t\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt(1).toString(16) ).slice( -4 );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdone = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tliteral += '\"';\r\n\r\n\t\t// use JSON.parse to interpret escapes\r\n\t\treturn JSON.parse( literal );\r\n\t};\r\n}\r\n","import { STRING_LITERAL } from '../../../../../config/types';\r\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\r\n\r\nconst singleMatcher = makeQuotedStringMatcher( `\"` );\r\nconst doubleMatcher = makeQuotedStringMatcher( `'` );\r\n\r\nexport default function ( parser ) {\r\n\tconst start = parser.pos;\r\n\tconst quote = parser.matchString( `'` ) || parser.matchString( `\"` );\r\n\r\n\tif ( quote ) {\r\n\t\tconst string = ( quote === `'` ? singleMatcher : doubleMatcher )( parser );\r\n\r\n\t\tif ( !parser.matchString( quote ) ) {\r\n\t\t\tparser.pos = start;\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tt: STRING_LITERAL,\r\n\t\t\tv: string\r\n\t\t};\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\r\nexport const spreadPattern = /^\\s*\\.{3}/;\r\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\r\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\r\n","import { OBJECT_LITERAL } from '../../../../../config/types';\r\nimport readKeyValuePairs from './objectLiteral/keyValuePairs';\r\n\r\nexport default function ( parser ) {\r\n\tconst start = parser.pos;\r\n\r\n\t// allow whitespace\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( '{' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst keyValuePairs = readKeyValuePairs( parser );\r\n\r\n\t// allow whitespace between final value and '}'\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( '}' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn {\r\n\t\tt: OBJECT_LITERAL,\r\n\t\tm: keyValuePairs\r\n\t};\r\n}\r\n","import { ARRAY_LITERAL } from '../../../../../config/types';\r\nimport readExpressionList from '../../shared/readExpressionList';\r\n\r\nexport default function ( parser ) {\r\n\tconst start = parser.pos;\r\n\r\n\t// allow whitespace before '['\r\n\tparser.allowWhitespace();\r\n\r\n\tif ( !parser.matchString( '[' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst expressionList = readExpressionList( parser, true );\r\n\r\n\tif ( !parser.matchString( ']' ) ) {\r\n\t\tparser.pos = start;\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn {\r\n\t\tt: ARRAY_LITERAL,\r\n\t\tm: expressionList\r\n\t};\r\n}\r\n","import readLiteral from './primary/readLiteral';\r\nimport readReference from './primary/readReference';\r\nimport readBracketedExpression from './primary/readBracketedExpression';\r\n\r\nexport default function ( parser ) {\r\n\treturn readLiteral( parser )\r\n\t\t|| readReference( parser )\r\n\t\t|| readBracketedExpression( parser );\r\n}\r\n","import { MEMBER, INVOCATION } from '../../../config/types';\r\nimport readPrimary from './readPrimary';\r\nimport readExpressionList from './shared/readExpressionList';\r\nimport readRefinement from './shared/readRefinement';\r\nimport { expectedParen } from './shared/errors';\r\n\r\nexport default function ( parser ) {\r\n\tlet expression = readPrimary( parser );\r\n\r\n\tif ( !expression ) return null;\r\n\r\n\twhile ( expression ) {\r\n\t\tconst refinement = readRefinement( parser );\r\n\t\tif ( refinement ) {\r\n\t\t\texpression = {\r\n\t\t\t\tt: MEMBER,\r\n\t\t\t\tx: expression,\r\n\t\t\t\tr: refinement\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\telse if ( parser.matchString( '(' ) ) {\r\n\t\t\tparser.allowWhitespace();\r\n\t\t\tconst expressionList = readExpressionList( parser, true );\r\n\r\n\t\t\tparser.allowWhitespace();\r\n\r\n\t\t\tif ( !parser.matchString( ')' ) ) {\r\n\t\t\t\tparser.error( expectedParen );\r\n\t\t\t}\r\n\r\n\t\t\texpression = {\r\n\t\t\t\tt: INVOCATION,\r\n\t\t\t\tx: expression\r\n\t\t\t};\r\n\r\n\t\t\tif ( expressionList ) expression.o = expressionList;\r\n\t\t}\r\n\r\n\t\telse {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\treturn expression;\r\n}\r\n","import { INFIX_OPERATOR } from '../../../config/types';\r\nimport readTypeof from './readTypeof';\r\n\r\nlet readLogicalOr;\r\n\r\nconst makeInfixSequenceMatcher = function ( symbol, fallthrough ) {\r\n\treturn function ( parser ) {\r\n\t\t// > and / have to be quoted\r\n\t\tif ( parser.inUnquotedAttribute && ( symbol === '>' || symbol === '/' ) ) return fallthrough( parser );\r\n\r\n\t\tlet start, left, right;\r\n\r\n\t\tleft = fallthrough( parser );\r\n\t\tif ( !left ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// Loop to handle left-recursion in a case like `a * b * c` and produce\r\n\t\t// left association, i.e. `(a * b) * c`.  The matcher can't call itself\r\n\t\t// to parse `left` because that would be infinite regress.\r\n\t\twhile ( true ) {\r\n\t\t\tstart = parser.pos;\r\n\r\n\t\t\tparser.allowWhitespace();\r\n\r\n\t\t\tif ( !parser.matchString( symbol ) ) {\r\n\t\t\t\tparser.pos = start;\r\n\t\t\t\treturn left;\r\n\t\t\t}\r\n\r\n\t\t\t// special case - in operator must not be followed by [a-zA-Z_$0-9]\r\n\t\t\tif ( symbol === 'in' && /[a-zA-Z_$0-9]/.test( parser.remaining().charAt( 0 ) ) ) {\r\n\t\t\t\tparser.pos = start;\r\n\t\t\t\treturn left;\r\n\t\t\t}\r\n\r\n\t\t\tparser.allowWhitespace();\r\n\r\n\t\t\t// right operand must also consist of only higher-precedence operators\r\n\t\t\tright = fallthrough( parser );\r\n\t\t\tif ( !right ) {\r\n\t\t\t\tparser.pos = start;\r\n\t\t\t\treturn left;\r\n\t\t\t}\r\n\r\n\t\t\tleft = {\r\n\t\t\t\tt: INFIX_OPERATOR,\r\n\t\t\t\ts: symbol,\r\n\t\t\t\to: [ left, right ]\r\n\t\t\t};\r\n\r\n\t\t\t// Loop back around.  If we don't see another occurrence of the symbol,\r\n\t\t\t// we'll return left.\r\n\t\t}\r\n\t};\r\n};\r\n\r\n// create all infix sequence matchers, and return readLogicalOr\r\n(function() {\r\n\tlet i, len, matcher, fallthrough;\r\n\r\n\t// All the infix operators on order of precedence (source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)\r\n\t// Each sequence matcher will initially fall through to its higher precedence\r\n\t// neighbour, and only attempt to match if one of the higher precedence operators\r\n\t// (or, ultimately, a literal, reference, or bracketed expression) already matched\r\n\tconst infixOperators = '* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||'.split( ' ' );\r\n\r\n\t// A typeof operator is higher precedence than multiplication\r\n\tfallthrough = readTypeof;\r\n\tfor ( i = 0, len = infixOperators.length; i < len; i += 1 ) {\r\n\t\tmatcher = makeInfixSequenceMatcher( infixOperators[i], fallthrough );\r\n\t\tfallthrough = matcher;\r\n\t}\r\n\r\n\t// Logical OR is the fallthrough for the conditional matcher\r\n\treadLogicalOr = fallthrough;\r\n}());\r\n\r\nexport default readLogicalOr;\r\n","import { SECTION_EACH, SECTION_IF, SECTION_IF_WITH, SECTION_UNLESS } from '../../../config/types';\r\n\r\nexport default {\r\n\teach:    SECTION_EACH,\r\n\tif:      SECTION_IF,\r\n\twith:    SECTION_IF_WITH,\r\n\tunless:  SECTION_UNLESS\r\n};\r\n","import { lastItem } from '../../utils/array';\r\n\r\nexport default function ( items, leadingPattern, trailingPattern ) {\r\n\tlet item;\r\n\r\n\tif ( leadingPattern ) {\r\n\t\titem = items[0];\r\n\t\tif ( typeof item === 'string' ) {\r\n\t\t\titem = item.replace( leadingPattern, '' );\r\n\r\n\t\t\tif ( !item ) {\r\n\t\t\t\titems.shift();\r\n\t\t\t} else {\r\n\t\t\t\titems[0] = item;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif ( trailingPattern ) {\r\n\t\titem = lastItem( items );\r\n\t\tif ( typeof item === 'string' ) {\r\n\t\t\titem = item.replace( trailingPattern, '' );\r\n\r\n\t\t\tif ( !item ) {\r\n\t\t\t\titems.pop();\r\n\t\t\t} else {\r\n\t\t\t\titems[ items.length - 1 ] = item;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","const registryNames = [\r\n\t'adaptors',\r\n\t'components',\r\n\t'computed',\r\n\t'decorators',\r\n\t'easing',\r\n\t'events',\r\n\t'interpolators',\r\n\t'partials',\r\n\t'transitions'\r\n];\r\n\r\nclass Registry {\r\n\tconstructor ( name, useDefaults ) {\r\n\t\tthis.name = name;\r\n\t\tthis.useDefaults = useDefaults;\r\n\t}\r\n\r\n\textend ( Parent, proto, options ) {\r\n\t\tthis.configure(\r\n\t\t\tthis.useDefaults ? Parent.defaults : Parent,\r\n\t\t\tthis.useDefaults ? proto : proto.constructor,\r\n\t\t\toptions );\r\n\t}\r\n\r\n\tinit () {\r\n\t\t// noop\r\n\t}\r\n\r\n\tconfigure ( Parent, target, options ) {\r\n\t\tconst name = this.name;\r\n\t\tconst option = options[ name ];\r\n\r\n\t\tconst registry = Object.create( Parent[name] );\r\n\r\n\t\tfor ( const key in option ) {\r\n\t\t\tregistry[ key ] = option[ key ];\r\n\t\t}\r\n\r\n\t\ttarget[ name ] = registry;\r\n\t}\r\n\r\n\treset ( ractive ) {\r\n\t\tconst registry = ractive[ this.name ];\r\n\t\tlet changed = false;\r\n\r\n\t\tObject.keys( registry ).forEach( key => {\r\n\t\t\tconst item = registry[ key ];\r\n\r\n\t\t\tif ( item._fn ) {\r\n\t\t\t\tif ( item._fn.isOwner ) {\r\n\t\t\t\t\tregistry[key] = item._fn;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdelete registry[key];\r\n\t\t\t\t}\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn changed;\r\n\t}\r\n}\r\n\r\nconst registries = registryNames.map( name => new Registry( name, name === 'computed' ) );\r\n\r\nexport default registries;\r\n","import { createDocumentFragment } from '../../../utils/dom';\r\nimport noop from '../../../utils/noop';\r\n\r\nexport default class Item {\r\n\tconstructor ( options ) {\r\n\t\tthis.parentFragment = options.parentFragment;\r\n\t\tthis.ractive = options.parentFragment.ractive;\r\n\r\n\t\tthis.template = options.template;\r\n\t\tthis.index = options.index;\r\n\t\tthis.type = options.template.t;\r\n\r\n\t\tthis.dirty = false;\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.dirty = true;\r\n\t\t\tthis.parentFragment.bubble();\r\n\t\t}\r\n\t}\r\n\r\n\tdestroyed () {\r\n\t\tif ( this.fragment ) this.fragment.destroyed();\r\n\t}\r\n\r\n\tfind () {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfindComponent () {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfindNextNode () {\r\n\t\treturn this.parentFragment.findNextNode( this );\r\n\t}\r\n\r\n\tshuffled () {\r\n\t\tif ( this.fragment ) this.fragment.shuffled();\r\n\t}\r\n\r\n\tvalueOf () {\r\n\t\treturn this.toString();\r\n\t}\r\n}\r\n\r\nItem.prototype.findAll = noop;\r\nItem.prototype.findAllComponents = noop;\r\n\r\nexport class ContainerItem extends Item {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\t}\r\n\r\n\tdetach () {\r\n\t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\r\n\t}\r\n\r\n\tfind ( selector ) {\r\n\t\tif ( this.fragment ) {\r\n\t\t\treturn this.fragment.find( selector );\r\n\t\t}\r\n\t}\r\n\r\n\tfindAll ( selector, options ) {\r\n\t\tif ( this.fragment ) {\r\n\t\t\tthis.fragment.findAll( selector, options );\r\n\t\t}\r\n\t}\r\n\r\n\tfindComponent ( name ) {\r\n\t\tif ( this.fragment ) {\r\n\t\t\treturn this.fragment.findComponent( name );\r\n\t\t}\r\n\t}\r\n\r\n\tfindAllComponents ( name, options ) {\r\n\t\tif ( this.fragment ) {\r\n\t\t\tthis.fragment.findAllComponents( name, options );\r\n\t\t}\r\n\t}\r\n\r\n\tfirstNode ( skipParent ) {\r\n\t\treturn this.fragment && this.fragment.firstNode( skipParent );\r\n\t}\r\n\r\n\ttoString ( escape ) {\r\n\t\treturn this.fragment ? this.fragment.toString( escape ) : '';\r\n\t}\r\n}\r\n","import { capture } from '../global/capture';\r\nimport Model from './Model';\r\nimport { handleChange, mark, marked } from '../shared/methodCallers';\r\n\r\nexport default class ComputationChild extends Model {\r\n\tconstructor ( parent, key ) {\r\n\t\tsuper( parent, key );\r\n\r\n\t\tthis.isReadonly = !this.root.ractive.syncComputedChildren;\r\n\t\tthis.dirty = true;\r\n\t}\r\n\r\n\tapplyValue ( value ) {\r\n\t\tsuper.applyValue( value );\r\n\r\n\t\tif ( !this.isReadonly ) {\r\n\t\t\tlet source = this.parent;\r\n\t\t\t// computed models don't have a shuffle method\r\n\t\t\twhile ( source && source.shuffle ) {\r\n\t\t\t\tsource = source.parent;\r\n\t\t\t}\r\n\r\n\t\t\tif ( source ) {\r\n\t\t\t\tsource.dependencies.forEach( mark );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget ( shouldCapture ) {\r\n\t\tif ( shouldCapture ) capture( this );\r\n\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\t\t\tconst parentValue = this.parent.get();\r\n\t\t\tthis.value = parentValue ? parentValue[ this.key ] : undefined;\r\n\t\t}\r\n\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tthis.dirty = true;\r\n\r\n\t\tif ( this.boundValue ) this.boundValue = null;\r\n\r\n\t\tthis.links.forEach( marked );\r\n\t\tthis.deps.forEach( handleChange );\r\n\t\tthis.children.forEach( handleChange );\r\n\t}\r\n\r\n\tjoinKey ( key ) {\r\n\t\tif ( key === undefined || key === '' ) return this;\r\n\r\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\r\n\t\t\tconst child = new ComputationChild( this, key );\r\n\t\t\tthis.children.push( child );\r\n\t\t\tthis.childByKey[ key ] = child;\r\n\t\t}\r\n\r\n\t\treturn this.childByKey[ key ];\r\n\t}\r\n}\r\n","/* global console */\r\n/* eslint no-console:\"off\" */\r\n\r\nimport { capture, startCapturing, stopCapturing } from '../global/capture';\r\nimport { warnIfDebug } from '../utils/log';\r\nimport Model from './Model';\r\nimport { maybeBind } from './ModelBase';\r\nimport ComputationChild from './ComputationChild';\r\nimport { hasConsole } from '../config/environment';\r\nimport { isEqual } from '../utils/is';\r\n\r\nexport default class Computation extends Model {\r\n\tconstructor ( viewmodel, signature, key ) {\r\n\t\tsuper( null, null );\r\n\r\n\t\tthis.root = this.parent = viewmodel;\r\n\t\tthis.signature = signature;\r\n\r\n\t\tthis.key = key; // not actually used, but helps with debugging\r\n\t\tthis.isExpression = key && key[0] === '@';\r\n\r\n\t\tthis.isReadonly = !this.signature.setter;\r\n\r\n\t\tthis.context = viewmodel.computationContext;\r\n\r\n\t\tthis.dependencies = [];\r\n\r\n\t\tthis.children = [];\r\n\t\tthis.childByKey = {};\r\n\r\n\t\tthis.deps = [];\r\n\r\n\t\tthis.dirty = true;\r\n\r\n\t\t// TODO: is there a less hackish way to do this?\r\n\t\tthis.shuffle = undefined;\r\n\t}\r\n\r\n\tget ( shouldCapture ) {\r\n\t\tif ( shouldCapture ) capture( this );\r\n\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\t\t\tconst old = this.value;\r\n\t\t\tthis.value = this.getValue();\r\n\t\t\tif ( !isEqual( old, this.value ) ) this.notifyUpstream();\r\n\t\t\tif ( this.wrapper ) this.newWrapperValue = this.value;\r\n\t\t\tthis.adapt();\r\n\t\t}\r\n\r\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\r\n\t\treturn maybeBind( this, shouldCapture && this.wrapper ? this.wrapperValue : this.value );\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\tstartCapturing();\r\n\t\tlet result;\r\n\r\n\t\ttry {\r\n\t\t\tresult = this.signature.getter.call( this.context );\r\n\t\t} catch ( err ) {\r\n\t\t\twarnIfDebug( `Failed to compute ${this.getKeypath()}: ${err.message || err}` );\r\n\r\n\t\t\t// TODO this is all well and good in Chrome, but...\r\n\t\t\t// ...also, should encapsulate this stuff better, and only\r\n\t\t\t// show it if Ractive.DEBUG\r\n\t\t\tif ( hasConsole ) {\r\n\t\t\t\tif ( console.groupCollapsed ) console.groupCollapsed( '%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;' );\r\n\t\t\t\tconst sig = this.signature;\r\n\t\t\t\tconsole.error( `${err.name}: ${err.message}\\n\\n${sig.getterString}${sig.getterUseStack ? '\\n\\n' + err.stack : ''}` );\r\n\t\t\t\tif ( console.groupCollapsed ) console.groupEnd();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst dependencies = stopCapturing();\r\n\t\tthis.setDependencies( dependencies );\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tmark () {\r\n\t\tthis.handleChange();\r\n\t}\r\n\r\n\trebind ( next, previous ) {\r\n\t\t// computations will grab all of their deps again automagically\r\n\t\tif ( next !== previous ) this.handleChange();\r\n\t}\r\n\r\n\tset ( value ) {\r\n\t\tif ( this.isReadonly ) {\r\n\t\t\tthrow new Error( `Cannot set read-only computed value '${this.key}'` );\r\n\t\t}\r\n\r\n\t\tthis.signature.setter( value );\r\n\t\tthis.mark();\r\n\t}\r\n\r\n\tsetDependencies ( dependencies ) {\r\n\t\t// unregister any soft dependencies we no longer have\r\n\t\tlet i = this.dependencies.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst model = this.dependencies[i];\r\n\t\t\tif ( !~dependencies.indexOf( model ) ) model.unregister( this );\r\n\t\t}\r\n\r\n\t\t// and add any new ones\r\n\t\ti = dependencies.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst model = dependencies[i];\r\n\t\t\tif ( !~this.dependencies.indexOf( model ) ) model.register( this );\r\n\t\t}\r\n\r\n\t\tthis.dependencies = dependencies;\r\n\t}\r\n\r\n\tteardown () {\r\n\t\tlet i = this.dependencies.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tif ( this.dependencies[i] ) this.dependencies[i].unregister( this );\r\n\t\t}\r\n\t\tif ( this.root.computations[this.key] === this ) delete this.root.computations[this.key];\r\n\t\tsuper.teardown();\r\n\t}\r\n}\r\n\r\nconst prototype = Computation.prototype;\r\nconst child = ComputationChild.prototype;\r\nprototype.handleChange = child.handleChange;\r\nprototype.joinKey = child.joinKey;\r\n","import Model from '../../model/Model';\r\nimport Computation from '../../model/Computation';\r\nimport getFunction from '../../shared/getFunction';\r\nimport resolveReference from './resolveReference';\r\nimport { removeFromArray } from '../../utils/array';\r\nimport { startCapturing, stopCapturing } from '../../global/capture';\r\nimport { warnIfDebug } from '../../utils/log';\r\nimport { rebindMatch } from '../../shared/rebind';\r\nimport noop from '../../utils/noop';\r\n\r\nexport default class ExpressionProxy extends Model {\r\n\tconstructor ( fragment, template ) {\r\n\t\tsuper( fragment.ractive.viewmodel, null );\r\n\r\n\t\tthis.fragment = fragment;\r\n\t\tthis.template = template;\r\n\r\n\t\tthis.isReadonly = true;\r\n\t\tthis.dirty = true;\r\n\r\n\t\tthis.fn = getFunction( template.s, template.r.length );\r\n\r\n\t\tthis.models = this.template.r.map( ref => {\r\n\t\t\treturn resolveReference( this.fragment, ref );\r\n\t\t});\r\n\t\tthis.dependencies = [];\r\n\r\n\t\tthis.shuffle = undefined;\r\n\r\n\t\tthis.bubble();\r\n\t}\r\n\r\n\tbubble ( actuallyChanged = true ) {\r\n\t\t// refresh the keypath\r\n\t\tthis.keypath = undefined;\r\n\r\n\t\tif ( actuallyChanged ) {\r\n\t\t\tthis.handleChange();\r\n\t\t}\r\n\t}\r\n\r\n\tgetKeypath () {\r\n\t\tif ( !this.template ) return '@undefined';\r\n\t\tif ( !this.keypath ) {\r\n\t\t\tthis.keypath = '@' + this.template.s.replace( /_(\\d+)/g, ( match, i ) => {\r\n\t\t\t\tif ( i >= this.models.length ) return match;\r\n\r\n\t\t\t\tconst model = this.models[i];\r\n\t\t\t\treturn model ? model.getKeypath() : '@undefined';\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.keypath;\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\tstartCapturing();\r\n\t\tlet result;\r\n\r\n\t\ttry {\r\n\t\t\tconst params = this.models.map( m => m ? m.get( true ) : undefined );\r\n\t\t\tresult = this.fn.apply( this.fragment.ractive, params );\r\n\t\t} catch ( err ) {\r\n\t\t\twarnIfDebug( `Failed to compute ${this.getKeypath()}: ${err.message || err}` );\r\n\t\t}\r\n\r\n\t\tconst dependencies = stopCapturing();\r\n\t\t// remove missing deps\r\n\t\tthis.dependencies.filter( d => !~dependencies.indexOf( d ) ).forEach( d => {\r\n\t\t\td.unregister( this );\r\n\t\t\tremoveFromArray( this.dependencies, d );\r\n\t\t});\r\n\t\t// register new deps\r\n\t\tdependencies.filter( d => !~this.dependencies.indexOf( d ) ).forEach( d => {\r\n\t\t\td.register( this );\r\n\t\t\tthis.dependencies.push( d );\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trebind ( next, previous, safe ) {\r\n\t\tconst idx = this.models.indexOf( previous );\r\n\r\n\t\tif ( ~idx ) {\r\n\t\t\tnext = rebindMatch( this.template.r[idx], next, previous );\r\n\t\t\tif ( next !== previous ) {\r\n\t\t\t\tprevious.unregister( this );\r\n\t\t\t\tthis.models.splice( idx, 1, next );\r\n\t\t\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.bubble( !safe );\r\n\t}\r\n\r\n\tretrieve () {\r\n\t\treturn this.get();\r\n\t}\r\n\r\n\tteardown () {\r\n\t\tthis.unbind();\r\n\t\tthis.fragment = undefined;\r\n\t\tif ( this.dependencies ) this.dependencies.forEach( d => d.unregister( this ) );\r\n\t\tsuper.teardown();\r\n\t}\r\n\r\n\tunreference () {\r\n\t\tsuper.unreference();\r\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\r\n\t}\r\n\r\n\tunregister( dep ) {\r\n\t\tsuper.unregister( dep );\r\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\r\n\t}\r\n}\r\n\r\nconst prototype = ExpressionProxy.prototype;\r\nconst computation = Computation.prototype;\r\nprototype.get = computation.get;\r\nprototype.handleChange = computation.handleChange;\r\nprototype.joinKey = computation.joinKey;\r\nprototype.mark = computation.mark;\r\nprototype.unbind = noop;\r\n","import Model from '../../model/Model';\r\nimport { findBoundValue } from '../../model/ModelBase';\r\nimport { REFERENCE } from '../../config/types';\r\nimport ExpressionProxy from './ExpressionProxy';\r\nimport resolveReference from './resolveReference';\r\nimport resolve from './resolve';\r\nimport { rebindMatch } from '../../shared/rebind';\r\nimport { handleChange, mark, marked } from '../../shared/methodCallers';\r\nimport { isEqual } from '../../utils/is';\r\nimport { escapeKey } from '../../shared/keypaths';\r\nimport noop from '../../utils/noop';\r\n\r\nclass ReferenceExpressionChild extends Model {\r\n\tconstructor ( parent, key ) {\r\n\t\tsuper ( parent, key );\r\n\t}\r\n\r\n\tapplyValue ( value ) {\r\n\t\tif ( isEqual( value, this.value ) ) return;\r\n\r\n\t\tlet parent = this.parent;\r\n\t\tconst keys = [ this.key ];\r\n\t\twhile ( parent ) {\r\n\t\t\tif ( parent.base ) {\r\n\t\t\t\tconst target = parent.model.joinAll( keys );\r\n\t\t\t\ttarget.applyValue( value );\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tkeys.unshift( parent.key );\r\n\r\n\t\t\tparent = parent.parent;\r\n\t\t}\r\n\t}\r\n\r\n\tjoinKey ( key ) {\r\n\t\tif ( key === undefined || key === '' ) return this;\r\n\r\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\r\n\t\t\tconst child = new ReferenceExpressionChild( this, key );\r\n\t\t\tthis.children.push( child );\r\n\t\t\tthis.childByKey[ key ] = child;\r\n\t\t}\r\n\r\n\t\treturn this.childByKey[ key ];\r\n\t}\r\n\r\n\tretrieve () {\r\n\t\tconst parent = this.parent.get();\r\n\t\treturn parent && parent[ this.key ];\r\n\t}\r\n}\r\n\r\nexport default class ReferenceExpressionProxy extends Model {\r\n\tconstructor ( fragment, template ) {\r\n\t\tsuper( null, null );\r\n\t\tthis.dirty = true;\r\n\t\tthis.root = fragment.ractive.viewmodel;\r\n\t\tthis.template = template;\r\n\r\n\t\tthis.base = resolve( fragment, template );\r\n\r\n\t\tconst intermediary = this.intermediary = {\r\n\t\t\thandleChange: () => this.handleChange(),\r\n\t\t\trebind: ( next, previous ) => {\r\n\t\t\t\tif ( previous === this.base ) {\r\n\t\t\t\t\tnext = rebindMatch( template, next, previous );\r\n\t\t\t\t\tif ( next !== this.base ) {\r\n\t\t\t\t\t\tthis.base.unregister( intermediary );\r\n\t\t\t\t\t\tthis.base = next;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst idx = this.members.indexOf( previous );\r\n\t\t\t\t\tif ( ~idx ) {\r\n\t\t\t\t\t\t// only direct references will rebind... expressions handle themselves\r\n\t\t\t\t\t\tnext = rebindMatch( template.m[idx].n, next, previous );\r\n\t\t\t\t\t\tif ( next !== this.members[idx] ) {\r\n\t\t\t\t\t\t\tthis.members.splice( idx, 1, next );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( next !== previous ) previous.unregister( intermediary );\r\n\t\t\t\tif ( next ) next.addShuffleTask( () => next.register( intermediary ) );\r\n\r\n\t\t\t\tthis.bubble();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.members = template.m.map( ( template ) => {\r\n\t\t\tif ( typeof template === 'string' ) {\r\n\t\t\t\treturn { get: () => template };\r\n\t\t\t}\r\n\r\n\t\t\tlet model;\r\n\r\n\t\t\tif ( template.t === REFERENCE ) {\r\n\t\t\t\tmodel = resolveReference( fragment, template.n );\r\n\t\t\t\tmodel.register( intermediary );\r\n\r\n\t\t\t\treturn model;\r\n\t\t\t}\r\n\r\n\t\t\tmodel = new ExpressionProxy( fragment, template );\r\n\t\t\tmodel.register( intermediary );\r\n\t\t\treturn model;\r\n\t\t});\r\n\r\n\t\tthis.bubble();\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.base ) return;\r\n\t\tif ( !this.dirty ) this.handleChange();\r\n\t}\r\n\r\n\tget ( shouldCapture ) {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.bubble();\r\n\r\n\t\t\tconst keys = this.members.map( m => escapeKey( String( m.get() ) ) );\r\n\t\t\tconst model = this.base.joinAll( keys );\r\n\r\n\t\t\tif ( model !== this.model ) {\r\n\t\t\t\tif ( this.model ) {\r\n\t\t\t\t\tthis.model.unregister( this );\r\n\t\t\t\t\tthis.model.unregisterTwowayBinding( this );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.model = model;\r\n\t\t\t\tthis.parent = model.parent;\r\n\t\t\t\tthis.model.register( this );\r\n\t\t\t\tthis.model.registerTwowayBinding( this );\r\n\r\n\t\t\t\tif ( this.keypathModel ) this.keypathModel.handleChange();\r\n\t\t\t}\r\n\r\n\t\t\tthis.value = this.model.get( shouldCapture );\r\n\t\t\tthis.dirty = false;\r\n\t\t\tthis.mark();\r\n\t\t\treturn this.value;\r\n\t\t} else {\r\n\t\t\treturn this.model ? this.model.get( shouldCapture ) : undefined;\r\n\t\t}\r\n\t}\r\n\r\n\t// indirect two-way bindings\r\n\tgetValue () {\r\n\t\tthis.value = this.model ? this.model.get() : undefined;\r\n\r\n\t\tlet i = this.bindings.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst value = this.bindings[i].getValue();\r\n\t\t\tif ( value !== this.value ) return value;\r\n\t\t}\r\n\r\n\t\t// check one-way bindings\r\n\t\tconst oneway = findBoundValue( this.deps );\r\n\t\tif ( oneway ) return oneway.value;\r\n\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\tgetKeypath () {\r\n\t\treturn this.model ? this.model.getKeypath() : '@undefined';\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tthis.dirty = true;\r\n\t\tthis.mark();\r\n\t}\r\n\r\n\tjoinKey ( key ) {\r\n\t\tif ( key === undefined || key === '' ) return this;\r\n\r\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\r\n\t\t\tconst child = new ReferenceExpressionChild( this, key );\r\n\t\t\tthis.children.push( child );\r\n\t\t\tthis.childByKey[ key ] = child;\r\n\t\t}\r\n\r\n\t\treturn this.childByKey[ key ];\r\n\t}\r\n\r\n\tmark () {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.deps.forEach( handleChange );\r\n\t\t}\r\n\r\n\t\tthis.links.forEach( marked );\r\n\t\tthis.children.forEach( mark );\r\n\t}\r\n\r\n\tretrieve () {\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\tset ( value ) {\r\n\t\tthis.model.set( value );\r\n\t}\r\n\r\n\tteardown () {\r\n\t\tif ( this.model ) {\r\n\t\t\tthis.model.unregister( this );\r\n\t\t\tthis.model.unregisterTwowayBinding( this );\r\n\t\t}\r\n\t\tif ( this.members ) {\r\n\t\t\tthis.members.forEach( m => m && m.unregister && m.unregister( this ) );\r\n\t\t}\r\n\t}\r\n\r\n\tunreference () {\r\n\t\tsuper.unreference();\r\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\r\n\t}\r\n\r\n\tunregister( dep ) {\r\n\t\tsuper.unregister( dep );\r\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\r\n\t}\r\n}\r\n\r\nReferenceExpressionProxy.prototype.rebind = noop;\r\n","export default function ( camelCaseStr ) {\r\n\treturn camelCaseStr.replace( /([A-Z])/g, ( match, $1 ) => {\r\n\t\treturn '-' + $1.toLowerCase();\r\n\t});\r\n}\r\n","export default {\r\n\t'accept-charset': 'acceptCharset',\r\n\taccesskey: 'accessKey',\r\n\tbgcolor: 'bgColor',\r\n\tclass: 'className',\r\n\tcodebase: 'codeBase',\r\n\tcolspan: 'colSpan',\r\n\tcontenteditable: 'contentEditable',\r\n\tdatetime: 'dateTime',\r\n\tdirname: 'dirName',\r\n\tfor: 'htmlFor',\r\n\t'http-equiv': 'httpEquiv',\r\n\tismap: 'isMap',\r\n\tmaxlength: 'maxLength',\r\n\tnovalidate: 'noValidate',\r\n\tpubdate: 'pubDate',\r\n\treadonly: 'readOnly',\r\n\trowspan: 'rowSpan',\r\n\ttabindex: 'tabIndex',\r\n\tusemap: 'useMap'\r\n};\r\n","import { findInViewHierarchy } from '../../../shared/registry';\r\nimport findElement from '../shared/findElement';\r\nimport { warnOnce } from '../../../utils/log';\r\nimport { missingPlugin } from '../../../config/errors';\r\nimport noop from '../../../utils/noop';\r\nimport runloop from '../../../global/runloop';\r\nimport { rebindMatch } from '../../../shared/rebind';\r\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\r\n\r\nconst missingDecorator = {\r\n\tupdate: noop,\r\n\tteardown: noop\r\n};\r\n\r\nexport default class Decorator {\r\n\tconstructor ( options ) {\r\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\r\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\r\n\t\tthis.parentFragment = this.owner.parentFragment;\r\n\t\tthis.ractive = this.owner.ractive;\r\n\t\tconst template = this.template = options.template;\r\n\r\n\t\tthis.name = template.n;\r\n\r\n\t\tthis.node = null;\r\n\t\tthis.intermediary = null;\r\n\r\n\t\tthis.element.decorators.push( this );\r\n\t}\r\n\r\n\tbind () {\r\n\t\tsetupArgsFn( this, this.template, this.parentFragment, { register: true } );\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.dirty = true;\r\n\t\t\tthis.owner.bubble();\r\n\t\t}\r\n\t}\r\n\r\n\tdestroyed () {\r\n\t\tif ( this.intermediary ) this.intermediary.teardown();\r\n\t\tthis.shouldDestroy = true;\r\n\t}\r\n\r\n\thandleChange () { this.bubble(); }\r\n\r\n\trebind ( next, previous, safe ) {\r\n\t\tconst idx = this.models.indexOf( previous );\r\n\t\tif ( !~idx ) return;\r\n\r\n\t\tnext = rebindMatch( this.template.f.r[ idx ], next, previous );\r\n\t\tif ( next === previous ) return;\r\n\r\n\t\tprevious.unregister( this );\r\n\t\tthis.models.splice( idx, 1, next );\r\n\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\r\n\r\n\t\tif ( !safe ) this.bubble();\r\n\t}\r\n\r\n\trender () {\r\n\t\trunloop.scheduleTask( () => {\r\n\t\t\tconst fn = findInViewHierarchy( 'decorators', this.ractive, this.name );\r\n\r\n\t\t\tif ( !fn ) {\r\n\t\t\t\twarnOnce( missingPlugin( this.name, 'decorator' ) );\r\n\t\t\t\tthis.intermediary = missingDecorator;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.node = this.element.node;\r\n\r\n\t\t\tlet args;\r\n\t\t\tif ( this.fn ) {\r\n\t\t\t\targs = this.models.map( model => {\r\n\t\t\t\t\tif ( !model ) return undefined;\r\n\r\n\t\t\t\t\treturn model.get();\r\n\t\t\t\t});\r\n\t\t\t\targs = this.fn.apply( this.ractive, args );\r\n\t\t\t}\r\n\r\n\t\t\tthis.intermediary = fn.apply( this.ractive, [ this.node ].concat( args ) );\r\n\r\n\t\t\tif ( !this.intermediary || !this.intermediary.teardown ) {\r\n\t\t\t\tthrow new Error( `The '${this.name}' decorator must return an object with a teardown method` );\r\n\t\t\t}\r\n\r\n\t\t\t// watch out for decorators that cause their host element to be unrendered\r\n\t\t\tif ( this.shouldDestroy ) this.destroyed();\r\n\t\t}, true );\r\n\t\tthis.rendered = true;\r\n\t}\r\n\r\n\ttoString () { return ''; }\r\n\r\n\tunbind () {\r\n\t\tteardownArgsFn( this, this.template );\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tif ( ( !shouldDestroy || this.element.rendered ) && this.intermediary ) this.intermediary.teardown();\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( !this.dirty ) return;\r\n\r\n\t\tthis.dirty = false;\r\n\r\n\t\tif ( this.intermediary ) {\r\n\t\t\tif ( !this.intermediary.update ) {\r\n\t\t\t\tthis.unrender();\r\n\t\t\t\tthis.render();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst args = this.models.map( model => model && model.get() );\r\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.fn.apply( this.ractive, args ) );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import Item from './shared/Item';\r\nimport noop from '../../utils/noop';\r\n\r\nexport default class Doctype extends Item {\r\n\ttoString () {\r\n\t\treturn '<!DOCTYPE' + this.template.a + '>';\r\n\t}\r\n}\r\n\r\nconst proto = Doctype.prototype;\r\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\r\n","import runloop from '../../../../global/runloop';\r\nimport { warnOnceIfDebug } from '../../../../utils/log';\r\nimport findElement from '../../shared/findElement';\r\nimport noop from '../../../../utils/noop';\r\n\r\nexport default class Binding {\r\n\tconstructor ( element, name = 'value' ) {\r\n\t\tthis.element = element;\r\n\t\tthis.ractive = element.ractive;\r\n\t\tthis.attribute = element.attributeByName[ name ];\r\n\r\n\t\tconst interpolator = this.attribute.interpolator;\r\n\t\tinterpolator.twowayBinding = this;\r\n\r\n\t\tconst model = interpolator.model;\r\n\r\n\t\tif ( model.isReadonly ) {\r\n\t\t\tconst keypath = model.getKeypath().replace( /^@/, '' );\r\n\t\t\twarnOnceIfDebug( `Cannot use two-way binding on <${element.name}> element: ${keypath} is read-only. To suppress this warning use <${element.name} twoway='false'...>`, { ractive: this.ractive });\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.attribute.isTwoway = true;\r\n\t\tthis.model = model;\r\n\r\n\t\t// initialise value, if it's undefined\r\n\t\tlet value = model.get();\r\n\t\tthis.wasUndefined = value === undefined;\r\n\r\n\t\tif ( value === undefined && this.getInitialValue ) {\r\n\t\t\tvalue = this.getInitialValue();\r\n\t\t\tmodel.set( value );\r\n\t\t}\r\n\t\tthis.lastVal( true, value );\r\n\r\n\t\tconst parentForm = findElement( this.element, false, 'form' );\r\n\t\tif ( parentForm ) {\r\n\t\t\tthis.resetValue = value;\r\n\t\t\tparentForm.formBindings.push( this );\r\n\t\t}\r\n\t}\r\n\r\n\tbind () {\r\n\t\tthis.model.registerTwowayBinding( this );\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tconst value = this.getValue();\r\n\t\tif ( this.lastVal() === value ) return;\r\n\r\n\t\trunloop.start( this.root );\r\n\t\tthis.attribute.locked = true;\r\n\t\tthis.model.set( value );\r\n\t\tthis.lastVal( true, value );\r\n\r\n\t\t// if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\r\n\t\tif ( this.model.get() !== value ) this.attribute.locked = false;\r\n\t\telse runloop.scheduleTask( () => this.attribute.locked = false );\r\n\r\n\t\trunloop.end();\r\n\t}\r\n\r\n\tlastVal ( setting, value ) {\r\n\t\tif ( setting ) this.lastValue = value;\r\n\t\telse return this.lastValue;\r\n\t}\r\n\r\n\trebind ( next, previous ) {\r\n\t\tif ( this.model && this.model === previous ) previous.unregisterTwowayBinding( this );\r\n\t\tif ( next ) {\r\n\t\t\tthis.model = next;\r\n\t\t\trunloop.scheduleTask( () => next.registerTwowayBinding( this ) );\r\n\t\t}\r\n\t}\r\n\r\n\trender () {\r\n\t\tthis.node = this.element.node;\r\n\t\tthis.node._ractive.binding = this;\r\n\t\tthis.rendered = true; // TODO is this used anywhere?\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tthis.model.set( node.value );\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tthis.model.unregisterTwowayBinding( this );\r\n\t}\r\n}\r\n\r\nBinding.prototype.unrender = noop;\r\n","import Binding from './Binding';\r\nimport handleDomEvent from './handleDomEvent';\r\n\r\nexport default class CheckboxBinding extends Binding {\r\n\tconstructor ( element ) {\r\n\t\tsuper( element, 'checked' );\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\r\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\r\n\r\n\t\tif ( this.node.attachEvent ) {\r\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\r\n\t\t}\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\r\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\r\n\t}\r\n\r\n\tgetInitialValue () {\r\n\t\treturn !!this.element.getAttribute( 'checked' );\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\treturn this.node.checked;\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tthis.model.set( node.checked );\r\n\t}\r\n}\r\n","import Binding from './Binding';\r\nimport handleDomEvent from './handleDomEvent';\r\n\r\nexport default class ContentEditableBinding extends Binding {\r\n\tgetInitialValue () {\r\n\t\treturn this.element.fragment ? this.element.fragment.toString() : '';\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\treturn this.element.node.innerHTML;\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\r\n\t\tconst node = this.node;\r\n\r\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\r\n\t\tnode.addEventListener( 'blur', handleDomEvent, false );\r\n\r\n\t\tif ( !this.ractive.lazy ) {\r\n\t\t\tnode.addEventListener( 'input', handleDomEvent, false );\r\n\r\n\t\t\tif ( node.attachEvent ) {\r\n\t\t\t\tnode.addEventListener( 'keyup', handleDomEvent, false );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tthis.model.set( node.innerHTML );\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tconst node = this.node;\r\n\r\n\t\tnode.removeEventListener( 'blur', handleDomEvent, false );\r\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\r\n\t\tnode.removeEventListener( 'input', handleDomEvent, false );\r\n\t\tnode.removeEventListener( 'keyup', handleDomEvent, false );\r\n\t}\r\n}\r\n","import GenericBinding from './GenericBinding';\r\n\r\nexport default class FileBinding extends GenericBinding {\r\n\tgetInitialValue () {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\treturn this.node.files;\r\n\t}\r\n\r\n\trender () {\r\n\t\tthis.element.lazy = false;\r\n\t\tsuper.render();\r\n\t}\r\n\r\n\tsetFromNode( node ) {\r\n\t\tthis.model.set( node.files );\r\n\t}\r\n}\r\n\r\n","import Binding from './Binding';\r\nimport handleDomEvent from './handleDomEvent';\r\nimport { arrayContentsMatch } from '../../../../utils/array';\r\nimport getSelectedOptions from '../../../../utils/getSelectedOptions';\r\n\r\nexport default class MultipleSelectBinding extends Binding {\r\n\tgetInitialValue () {\r\n\t\treturn this.element.options\r\n\t\t\t.filter( option => option.getAttribute( 'selected' ) )\r\n\t\t\t.map( option => option.getAttribute( 'value' ) );\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\tconst options = this.element.node.options;\r\n\t\tconst len = options.length;\r\n\r\n\t\tconst selectedValues = [];\r\n\r\n\t\tfor ( let i = 0; i < len; i += 1 ) {\r\n\t\t\tconst option = options[i];\r\n\r\n\t\t\tif ( option.selected ) {\r\n\t\t\t\tconst optionValue = option._ractive ? option._ractive.value : option.value;\r\n\t\t\t\tselectedValues.push( optionValue );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn selectedValues;\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tconst attribute = this.attribute;\r\n\t\tconst previousValue = attribute.getValue();\r\n\r\n\t\tconst value = this.getValue();\r\n\r\n\t\tif ( previousValue === undefined || !arrayContentsMatch( value, previousValue ) ) {\r\n\t\t\tsuper.handleChange();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\r\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\r\n\r\n\t\tif ( this.model.get() === undefined ) {\r\n\t\t\t// get value from DOM, if possible\r\n\t\t\tthis.handleChange();\r\n\t\t}\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tconst selectedOptions = getSelectedOptions( node );\r\n\t\tlet i = selectedOptions.length;\r\n\t\tconst result = new Array( i );\r\n\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst option = selectedOptions[i];\r\n\t\t\tresult[i] = option._ractive ? option._ractive.value : option.value;\r\n\t\t}\r\n\r\n\t\tthis.model.set( result );\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\r\n\t}\r\n}\r\n","import GenericBinding from './GenericBinding';\r\n\r\nexport default class NumericBinding extends GenericBinding {\r\n\tgetInitialValue () {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\tconst value = parseFloat( this.node.value );\r\n\t\treturn isNaN( value ) ? undefined : value;\r\n\t}\r\n\r\n\tsetFromNode( node ) {\r\n\t\tconst value = parseFloat( node.value );\r\n\t\tif ( !isNaN( value ) ) this.model.set( value );\r\n\t}\r\n}\r\n","import runloop from '../../../../global/runloop';\r\nimport Binding from './Binding';\r\nimport handleDomEvent from './handleDomEvent';\r\nimport getSelectedOptions from '../../../../utils/getSelectedOptions';\r\n\r\nexport default class SingleSelectBinding extends Binding {\r\n\tforceUpdate () {\r\n\t\tconst value = this.getValue();\r\n\r\n\t\tif ( value !== undefined ) {\r\n\t\t\tthis.attribute.locked = true;\r\n\t\t\trunloop.scheduleTask( () => this.attribute.locked = false );\r\n\t\t\tthis.model.set( value );\r\n\t\t}\r\n\t}\r\n\r\n\tgetInitialValue () {\r\n\t\tif ( this.element.getAttribute( 'value' ) !== undefined ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst options = this.element.options;\r\n\t\tconst len = options.length;\r\n\r\n\t\tif ( !len ) return;\r\n\r\n\t\tlet value;\r\n\t\tlet optionWasSelected;\r\n\t\tlet i = len;\r\n\r\n\t\t// take the final selected option...\r\n\t\twhile ( i-- ) {\r\n\t\t\tconst option = options[i];\r\n\r\n\t\t\tif ( option.getAttribute( 'selected' ) ) {\r\n\t\t\t\tif ( !option.getAttribute( 'disabled' ) ) {\r\n\t\t\t\t\tvalue = option.getAttribute( 'value' );\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptionWasSelected = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// or the first non-disabled option, if none are selected\r\n\t\tif ( !optionWasSelected ) {\r\n\t\t\twhile ( ++i < len ) {\r\n\t\t\t\tif ( !options[i].getAttribute( 'disabled' ) ) {\r\n\t\t\t\t\tvalue = options[i].getAttribute( 'value' );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// This is an optimisation (aka hack) that allows us to forgo some\r\n\t\t// other more expensive work\r\n\t\t// TODO does it still work? seems at odds with new architecture\r\n\t\tif ( value !== undefined ) {\r\n\t\t\tthis.element.attributeByName.value.value = value;\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\tgetValue () {\r\n\t\tconst options = this.node.options;\r\n\t\tconst len = options.length;\r\n\r\n\t\tlet i;\r\n\t\tfor ( i = 0; i < len; i += 1 ) {\r\n\t\t\tconst option = options[i];\r\n\r\n\t\t\tif ( options[i].selected && !options[i].disabled ) {\r\n\t\t\t\treturn option._ractive ? option._ractive.value : option.value;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender () {\r\n\t\tsuper.render();\r\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\r\n\t}\r\n\r\n\tsetFromNode ( node ) {\r\n\t\tconst option = getSelectedOptions( node )[0];\r\n\t\tthis.model.set( option._ractive ? option._ractive.value : option.value );\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\r\n\t}\r\n}\r\n","import { fatal } from '../../../utils/log';\n\nclass DOMEvent {\n\tconstructor ( name, owner, delegate ) {\n\t\tif ( name.indexOf( '*' ) !== -1 ) {\n\t\t\tfatal( `Only component proxy-events may contain \"*\" wildcards, <${owner.name} on-${name}=\"...\"/> is not valid` );\n\t\t}\n\n\t\tthis.name = name;\n\t\tthis.owner = owner;\n\t\tthis.delegate = delegate;\n\t\tthis.node = null;\n\t\tthis.handler = null;\n\t}\n\n\tlisten ( directive ) {\n\t\tconst node = this.node = this.owner.node;\n\t\tconst name = this.name;\n\n\t\t// this is probably a custom event fired from a decorator or manually\n\t\tif ( !( `on${name}` in node ) ) return;\n\n\t\tnode.addEventListener( name, this.handler = function( event ) {\n\t\t\tdirective.fire({\n\t\t\t\tnode,\n\t\t\t\toriginal: event,\n\t\t\t\tevent,\n\t\t\t\tname\n\t\t\t});\n\t\t}, this.delegate );\n\t}\n\n\tunlisten () {\n\t\tif ( this.handler ) this.node.removeEventListener( this.name, this.handler, false );\n\t}\n}\n\nclass CustomEvent {\n\tconstructor ( eventPlugin, owner, name ) {\n\t\tthis.eventPlugin = eventPlugin;\n\t\tthis.owner = owner;\n\t\tthis.name = name;\n\t\tthis.handler = null;\n\t}\n\n\tlisten ( directive ) {\n\t\tconst node = this.owner.node;\n\n\t\tthis.handler = this.eventPlugin( node, ( event = {} ) => {\n\t\t\tif ( event.original ) event.event = event.original;\n\t\t\telse event.original = event.event;\n\n\t\t\tevent.name = this.name;\n\t\t\tevent.node = event.node || node;\n\t\t\tdirective.fire( event );\n\t\t});\n\t}\n\n\tunlisten () {\n\t\tthis.handler.teardown();\n\t}\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\r\n\r\nexport default class RactiveEvent {\r\n\tconstructor ( component, name ) {\r\n\t\tthis.component = component;\r\n\t\tthis.name = name;\r\n\t\tthis.handler = null;\r\n\t}\r\n\r\n\tlisten ( directive ) {\r\n\t\tconst ractive = this.component.instance;\r\n\r\n\t\tthis.handler = ractive.on( this.name, ( ...args ) => {\r\n\t\t\t// watch for reproxy\r\n\t\t\tif ( args[0] instanceof Context ) {\r\n\t\t\t\tconst ctx = args.shift();\r\n\t\t\t\tctx.component = ractive;\r\n\t\t\t\tdirective.fire( ctx, args );\r\n\t\t\t} else {\r\n\t\t\t\tdirective.fire( {}, args );\r\n\t\t\t}\r\n\r\n\t\t\t// cancel bubbling\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\tunlisten () {\r\n\t\tthis.handler.cancel();\r\n\t}\r\n}\r\n","import { ANCHOR, COMPONENT } from '../../../config/types';\nimport fireEvent from '../../../events/fireEvent';\nimport { splitKeypath } from '../../../shared/keypaths';\nimport findElement from './findElement';\nimport { findInViewHierarchy } from '../../../shared/registry';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport runloop from '../../../global/runloop';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { warnOnceIfDebug } from '../../../utils/log';\nimport { addToArray, removeFromArray } from '../../../utils/array';\nimport noop from '../../../utils/noop';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport const DelegateProxy = {\n\tfire ( event, args = [] ) {\n\t\tif ( event && event.event ) {\n\t\t\tconst ev = event.event;\n\n\t\t\t// TODO if IE<9 needs to be supported here, could probably walk to the element with a ractive proxy with a delegates property\n\t\t\tconst end = ev.currentTarget;\n\t\t\tlet node = ev.target;\n\t\t\tconst name = event.name;\n\t\t\tlet bubble = true;\n\n\t\t\t// starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n\t\t\twhile ( bubble && node && node !== end ) {\n\t\t\t\tconst el = node._ractive && node._ractive.proxy;\n\n\t\t\t\tif ( el ) {\n\t\t\t\t\t// set up the context for the handler\n\t\t\t\t\tevent.node = el.node;\n\t\t\t\t\tevent.name = name;\n\n\t\t\t\t\tel.events.forEach( ev => {\n\t\t\t\t\t\tif ( ev.delegate && ~ev.template.n.indexOf( name ) ) {\n\t\t\t\t\t\t\tbubble = ev.fire( event, args ) !== false && bubble;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tnode = node.parentNode;\n\t\t\t}\n\n\t\t\treturn bubble;\n\t\t}\n\t}\n};\n\nexport default class EventDirective {\n\tconstructor ( options ) {\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment, true );\n\t\tthis.template = options.template;\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.ractive = options.parentFragment.ractive;\n\t\tconst delegate = this.delegate = this.ractive.delegate && options.parentFragment.delegate;\n\t\tthis.events = [];\n\n\t\tif ( this.element.type === COMPONENT || this.element.type === ANCHOR ) {\n\t\t\tthis.template.n.forEach( n => {\n\t\t\t\tthis.events.push( new RactiveEvent( this.element, n ) );\n\t\t\t});\n\t\t} else {\n\t\t\t// make sure the delegate element has a storag object\n\t\t\tif ( delegate && !delegate.delegates ) delegate.delegates = {};\n\n\t\t\tthis.template.n.forEach( n => {\n\t\t\t\tconst fn = findInViewHierarchy( 'events', this.ractive, n );\n\t\t\t\tif ( fn ) {\n\t\t\t\t\tthis.events.push( new CustomEvent( fn, this.element, n ) );\n\t\t\t\t} else {\n\t\t\t\t\tif ( delegate ) {\n\t\t\t\t\t\tif ( !delegate.delegates[n] ) {\n\t\t\t\t\t\t\tconst ev = new DOMEvent( n, delegate, true );\n\t\t\t\t\t\t\tdelegate.delegates[n] = ev;\n\t\t\t\t\t\t\t// if the element is already rendered, render the event too\n\t\t\t\t\t\t\tif ( delegate.rendered ) ev.listen( DelegateProxy );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.events.push( new DOMEvent( n, this.element ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// method calls\n\t\tthis.models = null;\n\t}\n\n\tbind () {\n\t\taddToArray( this.element.events, this );\n\n\t\tsetupArgsFn( this, this.template );\n\t\tif ( !this.fn ) this.action = this.template.f;\n\t}\n\n\tdestroyed () {\n\t\tthis.events.forEach( e => e.unlisten() );\n\t}\n\n\tfire ( event, args = [] ) {\n\t\tconst context = this.element.getContext( event );\n\n\t\tif ( this.fn ) {\n\t\t\tconst values = [];\n\n\t\t\tconst models = resolveArgs( this, this.template, this.parentFragment, {\n\t\t\t\tspecialRef ( ref ) {\n\t\t\t\t\tconst specialMatch = specialPattern.exec( ref );\n\t\t\t\t\tif ( specialMatch ) {\n\t\t\t\t\t\t// on-click=\"foo(event.node)\"\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tspecial: specialMatch[1],\n\t\t\t\t\t\t\tkeys: specialMatch[2] ? splitKeypath( specialMatch[2].substr(1) ) : []\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tconst dollarMatch = dollarArgsPattern.exec( ref );\n\t\t\t\t\tif ( dollarMatch ) {\n\t\t\t\t\t\t// on-click=\"foo($1)\"\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tspecial: 'arguments',\n\t\t\t\t\t\t\tkeys: [ dollarMatch[1] - 1 ].concat( dollarMatch[2] ? splitKeypath( dollarMatch[2].substr( 1 ) ) : [] )\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif ( models ) {\n\t\t\t\tmodels.forEach( model => {\n\t\t\t\t\tif ( !model ) return values.push( undefined );\n\n\t\t\t\t\tif ( model.special ) {\n\t\t\t\t\t\tconst which = model.special;\n\t\t\t\t\t\tlet obj;\n\n\t\t\t\t\t\tif ( which === '@node' ) {\n\t\t\t\t\t\t\tobj = this.element.node;\n\t\t\t\t\t\t} else if ( which === '@event' ) {\n\t\t\t\t\t\t\tobj = event && event.event;\n\t\t\t\t\t\t} else if ( which === 'event' ) {\n\t\t\t\t\t\t\twarnOnceIfDebug( `The event reference available to event directives is deprecated and should be replaced with @context and @event` );\n\t\t\t\t\t\t\tobj = context;\n\t\t\t\t\t\t} else if ( which === '@context' ) {\n\t\t\t\t\t\t\tobj = context;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj = args;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst keys = model.keys.slice();\n\n\t\t\t\t\t\twhile ( obj && keys.length ) obj = obj[ keys.shift() ];\n\t\t\t\t\t\treturn values.push( obj );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( model.wrapper ) {\n\t\t\t\t\t\treturn values.push( model.wrapperValue );\n\t\t\t\t\t}\n\n\t\t\t\t\tvalues.push( model.get() );\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// make event available as `this.event`\n\t\t\tconst ractive = this.ractive;\n\t\t\tconst oldEvent = ractive.event;\n\n\t\t\tractive.event = context;\n\t\t\tconst returned = this.fn.apply( ractive, values );\n\t\t\tlet result = returned.pop();\n\n\t\t\t// Auto prevent and stop if return is explicitly false\n\t\t\tif ( result === false ) {\n\t\t\t\tconst original = event ? event.original : undefined;\n\t\t\t\tif ( original ) {\n\t\t\t\t\toriginal.preventDefault && original.preventDefault();\n\t\t\t\t\toriginal.stopPropagation && original.stopPropagation();\n\t\t\t\t} else {\n\t\t\t\t\twarnOnceIfDebug( `handler '${this.template.n.join( ' ' )}' returned false, but there is no event available to cancel` );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// watch for proxy events\n\t\t\telse if ( !returned.length && Array.isArray( result ) && typeof result[0] === 'string' ) {\n\t\t\t\tresult = fireEvent( this.ractive, result.shift(), context, result );\n\t\t\t}\n\n\t\t\tractive.event = oldEvent;\n\n\t\t\treturn result;\n\t\t}\n\n\t\telse {\n\t\t\treturn fireEvent( this.ractive, this.action, context, args);\n\t\t}\n\t}\n\n\thandleChange () {}\n\n\trender () {\n\t\t// render events after everything else, so they fire after bindings\n\t\trunloop.scheduleTask( () => this.events.forEach( e => e.listen( this ), true ) );\n\t}\n\n\ttoString() { return ''; }\n\n\tunbind () {\n\t\tremoveFromArray( this.element.events, this );\n\t}\n\n\tunrender () {\n\t\tthis.events.forEach( e => e.unlisten() );\n\t}\n}\n\nEventDirective.prototype.update = noop;\n","import Item, { ContainerItem } from './Item';\r\nimport resolve from '../../resolvers/resolve';\r\nimport { rebindMatch } from '../../../shared/rebind';\r\n\r\nexport default class Mustache extends Item {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\r\n\t\tthis.parentFragment = options.parentFragment;\r\n\t\tthis.template = options.template;\r\n\t\tthis.index = options.index;\r\n\t\tif ( options.owner ) this.parent = options.owner;\r\n\r\n\t\tthis.isStatic = !!options.template.s;\r\n\r\n\t\tthis.model = null;\r\n\t\tthis.dirty = false;\r\n\t}\r\n\r\n\tbind () {\r\n\t\t// yield mustaches should resolve in container context\r\n\t\tconst start = this.containerFragment || this.parentFragment;\r\n\t\t// try to find a model for this view\r\n\t\tconst model = resolve( start, this.template );\r\n\r\n\t\tif ( model ) {\r\n\t\t\tconst value = model.get();\r\n\r\n\t\t\tif ( this.isStatic ) {\r\n\t\t\t\tthis.model = { get: () => value };\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tmodel.register( this );\r\n\t\t\tthis.model = model;\r\n\t\t}\r\n\t}\r\n\r\n\thandleChange () {\r\n\t\tthis.bubble();\r\n\t}\r\n\r\n\trebind ( next, previous, safe ) {\r\n\t\tnext = rebindMatch( this.template, next, previous, this.parentFragment );\r\n\t\tif ( next === this.model ) return false;\r\n\r\n\t\tif ( this.model ) {\r\n\t\t\tthis.model.unregister( this );\r\n\t\t}\r\n\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\r\n\t\tthis.model = next;\r\n\t\tif ( !safe ) this.handleChange();\r\n\t\treturn true;\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tif ( !this.isStatic ) {\r\n\t\t\tthis.model && this.model.unregister( this );\r\n\t\t\tthis.model = undefined;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class MustacheContainer extends ContainerItem {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\t}\r\n}\r\nconst proto = MustacheContainer.prototype;\r\nconst mustache = Mustache.prototype;\r\nproto.bind = mustache.bind;\r\nproto.handleChange = mustache.handleChange;\r\nproto.rebind = mustache.rebind;\r\nproto.unbind = mustache.unbind;\r\n","import progressiveText from './shared/progressiveText';\r\nimport { escapeHtml } from '../../utils/html';\r\nimport { safeToStringValue } from '../../utils/dom';\r\nimport Mustache from './shared/Mustache';\r\nimport { detachNode } from '../../utils/dom';\r\nimport { inAttributes } from './element/ConditionalAttribute';\r\n\r\nexport default class Interpolator extends Mustache {\r\n\tbubble () {\r\n\t\tif ( this.owner ) this.owner.bubble();\r\n\t\tsuper.bubble();\r\n\t}\r\n\r\n\tdetach () {\r\n\t\treturn detachNode( this.node );\r\n\t}\r\n\r\n\tfirstNode () {\r\n\t\treturn this.node;\r\n\t}\r\n\r\n\tgetString () {\r\n\t\treturn this.model ? safeToStringValue( this.model.get() ) : '';\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tif ( inAttributes() ) return;\r\n\t\tconst value = this.getString();\r\n\r\n\t\tthis.rendered = true;\r\n\r\n\t\tprogressiveText( this, target, occupants, value );\r\n\t}\r\n\r\n\ttoString ( escape ) {\r\n\t\tconst string = this.getString();\r\n\t\treturn escape ? escapeHtml( string ) : string;\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tif ( shouldDestroy ) this.detach();\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\t\t\tif ( this.rendered ) {\r\n\t\t\t\tthis.node.data = this.getString();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tvalueOf () {\r\n\t\treturn this.model ? this.model.get() : undefined;\r\n\t}\r\n}\r\n","import Element from '../../Element';\r\n\r\nexport default class Input extends Element {\r\n\trender ( target, occupants ) {\r\n\t\tsuper.render( target, occupants );\r\n\t\tthis.node.defaultValue = this.node.value;\r\n\t}\r\n\tcompare ( value, attrValue ) {\r\n\t\tconst comparator = this.getAttribute( 'value-comparator' );\r\n\t\tif ( comparator ) {\r\n\t\t\tif ( typeof comparator === 'function' ) {\r\n\t\t\t\treturn comparator( value, attrValue );\r\n\t\t\t}\r\n\t\t\tif (value && attrValue) {\r\n\t\t\t\treturn value[comparator] == attrValue[comparator];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn value == attrValue;\r\n\t}\r\n}\r\n","import Element from '../../Element';\r\nimport { removeFromArray } from '../../../../utils/array';\r\nimport findElement from '../../shared/findElement';\r\n\r\nexport default class Option extends Element {\r\n\tconstructor ( options ) {\r\n\t\tconst template = options.template;\r\n\t\tif ( !template.a ) template.a = {};\r\n\r\n\t\t// If the value attribute is missing, use the element's content,\r\n\t\t// as long as it isn't disabled\r\n\t\tif ( template.a.value === undefined && !( 'disabled' in template.a ) ) {\r\n\t\t\ttemplate.a.value = template.f || '';\r\n\t\t}\r\n\r\n\t\tsuper( options );\r\n\r\n\t\tthis.select = findElement( this.parent || this.parentFragment, false, 'select' );\r\n\t}\r\n\r\n\tbind () {\r\n\t\tif ( !this.select ) {\r\n\t\t\tsuper.bind();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If the select has a value, it overrides the `selected` attribute on\r\n\t\t// this option - so we delete the attribute\r\n\t\tconst selectedAttribute = this.attributeByName.selected;\r\n\t\tif ( selectedAttribute && this.select.getAttribute( 'value' ) !== undefined ) {\r\n\t\t\tconst index = this.attributes.indexOf( selectedAttribute );\r\n\t\t\tthis.attributes.splice( index, 1 );\r\n\t\t\tdelete this.attributeByName.selected;\r\n\t\t}\r\n\r\n\t\tsuper.bind();\r\n\t\tthis.select.options.push( this );\r\n\t}\r\n\r\n\tbubble () {\r\n\t\t// if we're using content as value, may need to update here\r\n\t\tconst value = this.getAttribute( 'value' );\r\n\t\tif ( this.node && this.node.value !== value ) {\r\n\t\t\tthis.node._ractive.value = value;\r\n\t\t}\r\n\t\tsuper.bubble();\r\n\t}\r\n\r\n\tgetAttribute ( name ) {\r\n\t\tconst attribute = this.attributeByName[ name ];\r\n\t\treturn attribute ? attribute.getValue() : name === 'value' && this.fragment ? this.fragment.valueOf() : undefined;\r\n\t}\r\n\r\n\tisSelected () {\r\n\t\tconst optionValue = this.getAttribute( 'value' );\r\n\r\n\t\tif ( optionValue === undefined || !this.select ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst selectValue = this.select.getAttribute( 'value' );\r\n\r\n\t\tif ( this.select.compare( selectValue, optionValue ) ) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif ( this.select.getAttribute( 'multiple' ) && Array.isArray( selectValue ) ) {\r\n\t\t\tlet i = selectValue.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tif ( this.select.compare( selectValue[i], optionValue ) ) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tsuper.render( target, occupants );\r\n\r\n\t\tif ( !this.attributeByName.value ) {\r\n\t\t\tthis.node._ractive.value = this.getAttribute( 'value' );\r\n\t\t}\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tsuper.unbind();\r\n\r\n\t\tif ( this.select ) {\r\n\t\t\tremoveFromArray( this.select.options, this );\r\n\t\t}\r\n\t}\r\n}\r\n","import Fragment from './Fragment';\r\nimport { createDocumentFragment } from '../utils/dom';\r\nimport { isObject } from '../utils/is';\r\nimport { findMap } from '../utils/array';\r\nimport { toEscapedString, toString, destroyed, shuffled, unbind, unrender, unrenderAndDestroy, update } from '../shared/methodCallers';\r\nimport findElement from './items/shared/findElement';\r\n\r\nexport default class RepeatedFragment {\r\n\tconstructor ( options ) {\r\n\t\tthis.parent = options.owner.parentFragment;\r\n\r\n\t\t// bit of a hack, so reference resolution works without another\r\n\t\t// layer of indirection\r\n\t\tthis.parentFragment = this;\r\n\t\tthis.owner = options.owner;\r\n\t\tthis.ractive = this.parent.ractive;\r\n\t\tthis.delegate = this.parent.delegate || findElement( options.owner );\r\n\t\t// delegation disabled by directive\r\n\t\tif ( this.delegate && this.delegate.delegate === false ) this.delegate = false;\r\n\r\n\t\t// encapsulated styles should be inherited until they get applied by an element\r\n\t\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\r\n\r\n\t\tthis.context = null;\r\n\t\tthis.rendered = false;\r\n\t\tthis.iterations = [];\r\n\r\n\t\tthis.template = options.template;\r\n\r\n\t\tthis.indexRef = options.indexRef;\r\n\t\tthis.keyRef = options.keyRef;\r\n\r\n\t\tthis.pendingNewIndices = null;\r\n\t\tthis.previousIterations = null;\r\n\r\n\t\t// track array versus object so updates of type rest\r\n\t\tthis.isArray = false;\r\n\t}\r\n\r\n\tbind ( context ) {\r\n\t\tthis.context = context;\r\n\t\tconst value = context.get();\r\n\r\n\t\t// {{#each array}}...\r\n\t\tif ( this.isArray = Array.isArray( value ) ) {\r\n\t\t\t// we can't use map, because of sparse arrays\r\n\t\t\tthis.iterations = [];\r\n\t\t\tconst max = value.length;\r\n\t\t\tfor ( let i = 0; i < max; i += 1 ) {\r\n\t\t\t\tthis.iterations[i] = this.createIteration( i, i );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// {{#each object}}...\r\n\t\telse if ( isObject( value ) ) {\r\n\t\t\tthis.isArray = false;\r\n\r\n\t\t\t// TODO this is a dreadful hack. There must be a neater way\r\n\t\t\tif ( this.indexRef ) {\r\n\t\t\t\tconst refs = this.indexRef.split( ',' );\r\n\t\t\t\tthis.keyRef = refs[0];\r\n\t\t\t\tthis.indexRef = refs[1];\r\n\t\t\t}\r\n\r\n\t\t\tthis.iterations = Object.keys( value ).map( ( key, index ) => {\r\n\t\t\t\treturn this.createIteration( key, index );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tbubble ( index ) {\r\n\t\tif  ( !this.bubbled ) this.bubbled = [];\r\n\t\tthis.bubbled.push( index );\r\n\r\n\t\tthis.owner.bubble();\r\n\t}\r\n\r\n\tcreateIteration ( key, index ) {\r\n\t\tconst fragment = new Fragment({\r\n\t\t\towner: this,\r\n\t\t\ttemplate: this.template\r\n\t\t});\r\n\r\n\t\tfragment.key = key;\r\n\t\tfragment.index = index;\r\n\t\tfragment.isIteration = true;\r\n\t\tfragment.delegate = this.delegate;\r\n\r\n\t\tconst model = this.context.joinKey( key );\r\n\r\n\t\t// set up an iteration alias if there is one\r\n\t\tif ( this.owner.template.z ) {\r\n\t\t\tfragment.aliases = {};\r\n\t\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\r\n\t\t}\r\n\r\n\t\treturn fragment.bind( model );\r\n\t}\r\n\r\n\tdestroyed () {\r\n\t\tthis.iterations.forEach( destroyed );\r\n\t}\r\n\r\n\tdetach () {\r\n\t\tconst docFrag = createDocumentFragment();\r\n\t\tthis.iterations.forEach( fragment => docFrag.appendChild( fragment.detach() ) );\r\n\t\treturn docFrag;\r\n\t}\r\n\r\n\tfind ( selector, options ) {\r\n\t\treturn findMap( this.iterations, i => i.find( selector, options ) );\r\n\t}\r\n\r\n\tfindAll ( selector, options ) {\r\n\t\treturn this.iterations.forEach( i => i.findAll( selector, options ) );\r\n\t}\r\n\r\n\tfindComponent ( name, options ) {\r\n\t\treturn findMap( this.iterations, i => i.findComponent( name, options ) );\r\n\t}\r\n\r\n\tfindAllComponents ( name, options ) {\r\n\t\treturn this.iterations.forEach( i => i.findAllComponents( name, options ) );\r\n\t}\r\n\r\n\tfindNextNode ( iteration ) {\r\n\t\tif ( iteration.index < this.iterations.length - 1 ) {\r\n\t\t\tfor ( let i = iteration.index + 1; i < this.iterations.length; i++ ) {\r\n\t\t\t\tconst node = this.iterations[ i ].firstNode( true );\r\n\t\t\t\tif ( node ) return node;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.owner.findNextNode();\r\n\t}\r\n\r\n\tfirstNode ( skipParent ) {\r\n\t\treturn this.iterations[0] ? this.iterations[0].firstNode( skipParent ) : null;\r\n\t}\r\n\r\n\trebind ( next ) {\r\n\t\tthis.context = next;\r\n\t\tthis.iterations.forEach( fragment => {\r\n\t\t\tconst model = next ? next.joinKey( fragment.key ) : undefined;\r\n\t\t\tfragment.context = model;\r\n\t\t\tif ( this.owner.template.z ) {\r\n\t\t\t\tfragment.aliases = {};\r\n\t\t\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\t// TODO use docFrag.cloneNode...\r\n\r\n\t\tconst xs = this.iterations;\r\n\t\tif ( xs ) {\r\n\t\t\tconst len = xs.length;\r\n\t\t\tfor ( let i = 0; i < len; i++ ) {\r\n\t\t\t\txs[i].render( target, occupants );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.rendered = true;\r\n\t}\r\n\r\n\tshuffle ( newIndices ) {\r\n\t\tif ( !this.pendingNewIndices ) this.previousIterations = this.iterations.slice();\r\n\r\n\t\tif ( !this.pendingNewIndices ) this.pendingNewIndices = [];\r\n\r\n\t\tthis.pendingNewIndices.push( newIndices );\r\n\r\n\t\tconst iterations = [];\r\n\r\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\r\n\t\t\tif ( newIndex === -1 ) return;\r\n\r\n\t\t\tconst fragment = this.iterations[ oldIndex ];\r\n\t\t\titerations[ newIndex ] = fragment;\r\n\r\n\t\t\tif ( newIndex !== oldIndex && fragment ) fragment.dirty = true;\r\n\t\t});\r\n\r\n\t\tthis.iterations = iterations;\r\n\r\n\t\tthis.bubble();\r\n\t}\r\n\r\n\tshuffled () {\r\n\t\tthis.iterations.forEach( shuffled );\r\n\t}\r\n\r\n\ttoString ( escape ) {\r\n\t\treturn this.iterations ?\r\n\t\t\tthis.iterations.map( escape ? toEscapedString : toString ).join( '' ) :\r\n\t\t\t'';\r\n\t}\r\n\r\n\tunbind () {\r\n\t\tthis.iterations.forEach( unbind );\r\n\t\treturn this;\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tthis.iterations.forEach( shouldDestroy ? unrenderAndDestroy : unrender );\r\n\t\tif ( this.pendingNewIndices && this.previousIterations ) {\r\n\t\t\tthis.previousIterations.forEach( fragment => {\r\n\t\t\t\tif ( fragment.rendered ) shouldDestroy ? unrenderAndDestroy( fragment ) : unrender( fragment );\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\t// TODO smart update\r\n\tupdate () {\r\n\t\t// skip dirty check, since this is basically just a facade\r\n\r\n\t\tif ( this.pendingNewIndices ) {\r\n\t\t\tthis.bubbled.length = 0;\r\n\t\t\tthis.updatePostShuffle();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( this.updating ) return;\r\n\t\tthis.updating = true;\r\n\r\n\t\tconst value = this.context.get();\r\n\t\tconst wasArray = this.isArray;\r\n\r\n\t\tlet toRemove;\r\n\t\tlet oldKeys;\r\n\t\tlet reset = true;\r\n\t\tlet i;\r\n\r\n\t\tif ( this.isArray = Array.isArray( value ) ) {\r\n\t\t\tif ( wasArray ) {\r\n\t\t\t\treset = false;\r\n\t\t\t\tif ( this.iterations.length > value.length ) {\r\n\t\t\t\t\ttoRemove = this.iterations.splice( value.length );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if ( isObject( value ) && !wasArray ) {\r\n\t\t\treset = false;\r\n\t\t\ttoRemove = [];\r\n\t\t\toldKeys = {};\r\n\t\t\ti = this.iterations.length;\r\n\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tconst fragment = this.iterations[i];\r\n\t\t\t\tif ( fragment.key in value ) {\r\n\t\t\t\t\toldKeys[ fragment.key ] = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.iterations.splice( i, 1 );\r\n\t\t\t\t\ttoRemove.push( fragment );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( reset ) {\r\n\t\t\ttoRemove = this.iterations;\r\n\t\t\tthis.iterations = [];\r\n\t\t}\r\n\r\n\t\tif ( toRemove ) {\r\n\t\t\ttoRemove.forEach( fragment => {\r\n\t\t\t\tfragment.unbind();\r\n\t\t\t\tfragment.unrender( true );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// update the remaining ones\r\n\t\tif ( !reset && this.isArray && this.bubbled && this.bubbled.length ) {\r\n\t\t\tthis.bubbled.forEach( i => this.iterations[i] && this.iterations[i].update() );\r\n\t\t} else {\r\n\t\t\tthis.iterations.forEach( update );\r\n\t\t}\r\n\r\n\t\tif ( this.bubbled ) this.bubbled.length = 0;\r\n\r\n\t\t// add new iterations\r\n\t\tconst newLength = Array.isArray( value ) ?\r\n\t\t\tvalue.length :\r\n\t\t\tisObject( value ) ?\r\n\t\t\t\tObject.keys( value ).length :\r\n\t\t\t\t0;\r\n\r\n\t\tlet docFrag;\r\n\t\tlet fragment;\r\n\r\n\t\tif ( newLength > this.iterations.length ) {\r\n\t\t\tdocFrag = this.rendered ? createDocumentFragment() : null;\r\n\t\t\ti = this.iterations.length;\r\n\r\n\t\t\tif ( Array.isArray( value ) ) {\r\n\t\t\t\twhile ( i < value.length ) {\r\n\t\t\t\t\tfragment = this.createIteration( i, i );\r\n\r\n\t\t\t\t\tthis.iterations.push( fragment );\r\n\t\t\t\t\tif ( this.rendered ) fragment.render( docFrag );\r\n\r\n\t\t\t\t\ti += 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\telse if ( isObject( value ) ) {\r\n\t\t\t\t// TODO this is a dreadful hack. There must be a neater way\r\n\t\t\t\tif ( this.indexRef && !this.keyRef ) {\r\n\t\t\t\t\tconst refs = this.indexRef.split( ',' );\r\n\t\t\t\t\tthis.keyRef = refs[0];\r\n\t\t\t\t\tthis.indexRef = refs[1];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tObject.keys( value ).forEach( key => {\r\n\t\t\t\t\tif ( !oldKeys || !( key in oldKeys ) ) {\r\n\t\t\t\t\t\tfragment = this.createIteration( key, i );\r\n\r\n\t\t\t\t\t\tthis.iterations.push( fragment );\r\n\t\t\t\t\t\tif ( this.rendered ) fragment.render( docFrag );\r\n\r\n\t\t\t\t\t\ti += 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.rendered ) {\r\n\t\t\t\tconst parentNode = this.parent.findParentNode();\r\n\t\t\t\tconst anchor = this.parent.findNextNode( this.owner );\r\n\r\n\t\t\t\tparentNode.insertBefore( docFrag, anchor );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.updating = false;\r\n\t}\r\n\r\n\tupdatePostShuffle () {\r\n\t\tconst newIndices = this.pendingNewIndices[ 0 ];\r\n\r\n\t\t// map first shuffle through\r\n\t\tthis.pendingNewIndices.slice( 1 ).forEach( indices => {\r\n\t\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\r\n\t\t\t\tnewIndices[ oldIndex ] = indices[ newIndex ];\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\r\n\t\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\r\n\t\t// but it seems to work for now\r\n\t\tconst len = this.context.get().length;\r\n\t\tconst oldLen = this.previousIterations.length;\r\n\t\tconst removed = {};\r\n\t\tlet i;\r\n\r\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\r\n\t\t\tconst fragment = this.previousIterations[ oldIndex ];\r\n\t\t\tthis.previousIterations[ oldIndex ] = null;\r\n\r\n\t\t\tif ( newIndex === -1 ) {\r\n\t\t\t\tremoved[ oldIndex ] = fragment;\r\n\t\t\t} else if ( fragment.index !== newIndex ) {\r\n\t\t\t\tconst model = this.context.joinKey( newIndex );\r\n\t\t\t\tfragment.index = fragment.key = newIndex;\r\n\t\t\t\tfragment.context = model;\r\n\t\t\t\tif ( this.owner.template.z ) {\r\n\t\t\t\t\tfragment.aliases = {};\r\n\t\t\t\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// if the array was spliced outside of ractive, sometimes there are leftover fragments not in the newIndices\r\n\t\tthis.previousIterations.forEach( ( frag, i ) => {\r\n\t\t\tif ( frag ) removed[ i ] = frag;\r\n\t\t});\r\n\r\n\t\t// create new/move existing iterations\r\n\t\tconst docFrag = this.rendered ? createDocumentFragment() : null;\r\n\t\tconst parentNode = this.rendered ? this.parent.findParentNode() : null;\r\n\r\n\t\tconst contiguous = 'startIndex' in newIndices;\r\n\t\ti = contiguous ? newIndices.startIndex : 0;\r\n\r\n\t\tfor ( i; i < len; i++ ) {\r\n\t\t\tconst frag = this.iterations[i];\r\n\r\n\t\t\tif ( frag && contiguous ) {\r\n\t\t\t\t// attach any built-up iterations\r\n\t\t\t\tif ( this.rendered ) {\r\n\t\t\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\r\n\t\t\t\t\tif ( docFrag.childNodes.length  ) parentNode.insertBefore( docFrag, frag.firstNode() );\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif ( !frag ) this.iterations[i] = this.createIteration( i, i );\r\n\r\n\t\t\tif ( this.rendered ) {\r\n\t\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\r\n\r\n\t\t\t\tif ( frag ) docFrag.appendChild( frag.detach() );\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.iterations[i].render( docFrag );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// append any leftovers\r\n\t\tif ( this.rendered ) {\r\n\t\t\tfor ( i = len; i < oldLen; i++ ) {\r\n\t\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\r\n\t\t\t}\r\n\r\n\t\t\tif ( docFrag.childNodes.length ) {\r\n\t\t\t\tparentNode.insertBefore( docFrag, this.owner.findNextNode() );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// trigger removal on old nodes\r\n\t\tObject.keys( removed ).forEach( k => removed[k].unbind().unrender( true ) );\r\n\r\n\t\tthis.iterations.forEach( update );\r\n\r\n\t\tthis.pendingNewIndices = null;\r\n\r\n\t\tthis.shuffled();\r\n\t}\r\n}\r\n","import Element from '../../Element';\nimport { toArray } from '../../../../utils/array';\nimport getSelectedOptions from '../../../../utils/getSelectedOptions';\n\nexport default class Select extends Element {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t\tthis.options = [];\n\t}\n\n\tfoundNode ( node ) {\n\t\tif ( this.binding ) {\n\t\t\tconst selectedOptions = getSelectedOptions( node );\n\n\t\t\tif ( selectedOptions.length > 0 ) {\n\t\t\t\tthis.selectedOptions = selectedOptions;\n\t\t\t}\n\t\t}\n\t}\n\n\trender ( target, occupants ) {\n\t\tsuper.render( target, occupants );\n\t\tthis.sync();\n\n\t\tconst node = this.node;\n\n\t\tlet i = node.options.length;\n\t\twhile ( i-- ) {\n\t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\tsync () {\n\t\tconst selectNode = this.node;\n\n\t\tif ( !selectNode ) return;\n\n\t\tconst options = toArray( selectNode.options );\n\n\t\tif ( this.selectedOptions ) {\n\t\t\toptions.forEach( o => {\n\t\t\t\tif ( this.selectedOptions.indexOf( o ) >= 0 ) o.selected = true;\n\t\t\t\telse o.selected = false;\n\t\t\t});\n\t\t\tthis.binding.setFromNode( selectNode );\n\t\t\tdelete this.selectedOptions;\n\t\t\treturn;\n\t\t}\n\n\t\tconst selectValue = this.getAttribute( 'value' );\n\t\tconst isMultiple = this.getAttribute( 'multiple' );\n\t\tconst array = isMultiple && Array.isArray( selectValue );\n\n\t\t// If the <select> has a specified value, that should override\n\t\t// these options\n\t\tif ( selectValue !== undefined ) {\n\t\t\tlet optionWasSelected;\n\n\t\t\toptions.forEach( o => {\n\t\t\t\tconst optionValue = o._ractive ? o._ractive.value : o.value;\n\t\t\t\tconst shouldSelect = isMultiple ?\n\t\t\t\t\tarray && this.valueContains( selectValue, optionValue ) :\n\t\t\t\t\tthis.compare( selectValue, optionValue );\n\n\t\t\t\tif ( shouldSelect ) {\n\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t}\n\n\t\t\t\to.selected = shouldSelect;\n\t\t\t});\n\n\t\t\tif ( !optionWasSelected && !isMultiple ) {\n\t\t\t\tif ( this.binding ) {\n\t\t\t\t\tthis.binding.forceUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise the value should be initialised according to which\n\t\t// <option> element is selected, if twoway binding is in effect\n\t\telse if ( this.binding ) {\n\t\t\tthis.binding.forceUpdate();\n\t\t}\n\t}\n\tvalueContains ( selectValue, optionValue ) {\n\t\tlet i = selectValue.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this.compare( optionValue, selectValue[i] ) ) return true;\n\t\t}\n\t}\n\tcompare (optionValue, selectValue) {\n\t\tconst comparator = this.getAttribute( 'value-comparator' );\n\t\tif ( comparator ) {\n\t\t\tif (typeof comparator === 'function') {\n\t\t\t\treturn comparator( selectValue, optionValue );\n\t\t\t}\n\t\t\tif ( selectValue && optionValue ) {\n\t\t\t\treturn selectValue[comparator] == optionValue[comparator];\n\t\t\t}\n\t\t}\n\t\treturn selectValue == optionValue;\n\t}\n\tupdate () {\n\t\tconst dirty = this.dirty;\n\t\tsuper.update();\n\t\tif ( dirty ) {\n\t\t\tthis.sync();\n\t\t}\n\t}\n}\n","import { ATTRIBUTE } from '../../../../config/types';\r\nimport Input from './Input';\r\nimport { isBindable } from '../binding/selectBinding';\r\nimport runloop from '../../../../global/runloop';\r\nimport createItem from '../../createItem';\r\nimport Fragment from '../../../Fragment';\r\n\r\nexport default class Textarea extends Input {\r\n\tconstructor( options ) {\r\n\t\tconst template = options.template;\r\n\r\n\t\toptions.deferContent = true;\r\n\r\n\t\tsuper( options );\r\n\r\n\t\t// check for single interpolator binding\r\n\t\tif ( !this.attributeByName.value ) {\r\n\t\t\tif ( template.f && isBindable( { template } ) ) {\r\n\t\t\t\tthis.attributes.push( createItem( {\r\n\t\t\t\t\towner: this,\r\n\t\t\t\t\ttemplate: { t: ATTRIBUTE, f: template.f, n: 'value' },\r\n\t\t\t\t\tparentFragment: this.parentFragment\r\n\t\t\t\t} ) );\r\n\t\t\t} else {\r\n\t\t\t\tthis.fragment = new Fragment({ owner: this, cssIds: null, template: template.f });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tbubble () {\r\n\t\tif ( !this.dirty ) {\r\n\t\t\tthis.dirty = true;\r\n\r\n\t\t\tif ( this.rendered && !this.binding && this.fragment ) {\r\n\t\t\t\trunloop.scheduleTask( () => {\r\n\t\t\t\t\tthis.dirty = false;\r\n\t\t\t\t\tthis.node.value = this.fragment.toString();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.parentFragment.bubble(); // default behaviour\r\n\t\t}\r\n\t}\r\n}\r\n","import progressiveText from './shared/progressiveText';\r\nimport { TEXT } from '../../config/types';\r\nimport { escapeHtml } from '../../utils/html';\r\nimport Item from './shared/Item';\r\nimport { detachNode } from '../../utils/dom';\r\nimport { inAttributes } from './element/ConditionalAttribute';\r\nimport noop from '../../utils/noop';\r\n\r\nexport default class Text extends Item {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\t\tthis.type = TEXT;\r\n\t}\r\n\r\n\tdetach () {\r\n\t\treturn detachNode( this.node );\r\n\t}\r\n\r\n\tfirstNode () {\r\n\t\treturn this.node;\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tif ( inAttributes() ) return;\r\n\t\tthis.rendered = true;\r\n\r\n\t\tprogressiveText( this, target, occupants, this.template );\r\n\t}\r\n\r\n\ttoString ( escape ) {\r\n\t\treturn escape ? escapeHtml( this.template ) : this.template;\r\n\t}\r\n\r\n\tunrender ( shouldDestroy ) {\r\n\t\tif ( this.rendered && shouldDestroy ) this.detach();\r\n\t\tthis.rendered = false;\r\n\t}\r\n\r\n\tvalueOf () {\r\n\t\treturn this.template;\r\n\t}\r\n}\r\n\r\nconst proto = Text.prototype;\r\nproto.bind = proto.unbind = proto.update = noop;\r\n","export default function ( hyphenatedStr ) {\r\n\treturn hyphenatedStr.replace( /-([a-zA-Z])/g, ( match, $1 ) => {\r\n\t\treturn $1.toUpperCase();\r\n\t});\r\n}\r\n","import { isClient, vendors } from '../../../../config/environment';\r\nimport { createElement } from '../../../../utils/dom';\r\nimport camelizeHyphenated from '../../../../utils/camelizeHyphenated.js';\r\n\r\nlet prefix;\r\n\r\nif ( !isClient ) {\r\n\tprefix = null;\r\n} else {\r\n\tconst prefixCache = {};\r\n\tconst testStyle = createElement( 'div' ).style;\r\n\r\n\tprefix = function ( prop ) {\r\n\t\tprop = camelizeHyphenated( prop );\r\n\r\n\t\tif ( !prefixCache[ prop ] ) {\r\n\t\t\tif ( testStyle[ prop ] !== undefined ) {\r\n\t\t\t\tprefixCache[ prop ] = prop;\r\n\t\t\t}\r\n\r\n\t\t\telse {\r\n\t\t\t\t// test vendors...\r\n\t\t\t\tconst capped = prop.charAt( 0 ).toUpperCase() + prop.substring( 1 );\r\n\r\n\t\t\t\tlet i = vendors.length;\r\n\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\tconst vendor = vendors[i];\r\n\t\t\t\t\tif ( testStyle[ vendor + capped ] !== undefined ) {\r\n\t\t\t\t\t\tprefixCache[ prop ] = vendor + capped;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn prefixCache[ prop ];\r\n\t};\r\n}\r\n\r\nexport default prefix;\r\n","import { vendors } from '../../../../config/environment';\r\n\r\nconst unprefixPattern = new RegExp( '^-(?:' + vendors.join( '|' ) + ')-' );\r\n\r\nexport default function ( prop ) {\r\n\treturn prop.replace( unprefixPattern, '' );\r\n}\r\n","import { missingPlugin } from '../../../../config/errors';\r\nimport { isClient } from '../../../../config/environment';\r\nimport { warnIfDebug, warnOnceIfDebug } from '../../../../utils/log';\r\nimport { createElement } from '../../../../utils/dom';\r\nimport camelizeHyphenated from '../../../../utils/camelizeHyphenated.js';\r\nimport interpolate from '../../../../shared/interpolate';\r\nimport Ticker from '../../../../shared/Ticker';\r\nimport prefix from './prefix';\r\nimport unprefix from './unprefix';\r\nimport hyphenate from './hyphenate';\r\n\r\nlet createTransitions;\r\n\r\nif ( !isClient ) {\r\n\tcreateTransitions = null;\r\n} else {\r\n\tconst testStyle = createElement( 'div' ).style;\r\n\tconst linear = x => x;\r\n\r\n\tconst canUseCssTransitions = {};\r\n\tconst cannotUseCssTransitions = {};\r\n\r\n\t// determine some facts about our environment\r\n\tlet TRANSITION;\r\n\tlet TRANSITIONEND;\r\n\tlet CSS_TRANSITIONS_ENABLED;\r\n\tlet TRANSITION_DURATION;\r\n\tlet TRANSITION_PROPERTY;\r\n\tlet TRANSITION_TIMING_FUNCTION;\r\n\r\n\tif ( testStyle.transition !== undefined ) {\r\n\t\tTRANSITION = 'transition';\r\n\t\tTRANSITIONEND = 'transitionend';\r\n\t\tCSS_TRANSITIONS_ENABLED = true;\r\n\t} else if ( testStyle.webkitTransition !== undefined ) {\r\n\t\tTRANSITION = 'webkitTransition';\r\n\t\tTRANSITIONEND = 'webkitTransitionEnd';\r\n\t\tCSS_TRANSITIONS_ENABLED = true;\r\n\t} else {\r\n\t\tCSS_TRANSITIONS_ENABLED = false;\r\n\t}\r\n\r\n\tif ( TRANSITION ) {\r\n\t\tTRANSITION_DURATION = TRANSITION + 'Duration';\r\n\t\tTRANSITION_PROPERTY = TRANSITION + 'Property';\r\n\t\tTRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\r\n\t}\r\n\r\n\tcreateTransitions = function ( t, to, options, changedProperties, resolve ) {\r\n\r\n\t\t// Wait a beat (otherwise the target styles will be applied immediately)\r\n\t\t// TODO use a fastdom-style mechanism?\r\n\t\tsetTimeout( () => {\r\n\t\t\tlet jsTransitionsComplete;\r\n\t\t\tlet cssTransitionsComplete;\r\n\t\t\tlet cssTimeout; // eslint-disable-line prefer-const\r\n\r\n\t\t\tfunction transitionDone () { clearTimeout( cssTimeout ); }\r\n\r\n\t\t\tfunction checkComplete () {\r\n\t\t\t\tif ( jsTransitionsComplete && cssTransitionsComplete ) {\r\n\t\t\t\t\tt.unregisterCompleteHandler( transitionDone );\r\n\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\r\n\t\t\t\t\tt.ractive.fire( t.name + ':end', t.node, t.isIntro );\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// this is used to keep track of which elements can use CSS to animate\r\n\t\t\t// which properties\r\n\t\t\tconst hashPrefix = ( t.node.namespaceURI || '' ) + t.node.tagName;\r\n\r\n\t\t\t// need to reset transition properties\r\n\t\t\tconst style = t.node.style;\r\n\t\t\tconst previous = {\r\n\t\t\t\tproperty: style[ TRANSITION_PROPERTY ],\r\n\t\t\t\ttiming: style[ TRANSITION_TIMING_FUNCTION ],\r\n\t\t\t\tduration: style[ TRANSITION_DURATION ]\r\n\t\t\t};\r\n\r\n\t\t\tstyle[ TRANSITION_PROPERTY ] = changedProperties.map( prefix ).map( hyphenate ).join( ',' );\r\n\t\t\tconst easingName = hyphenate( options.easing || 'linear' );\r\n\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = easingName;\r\n\t\t\tconst cssTiming = style[ TRANSITION_TIMING_FUNCTION ] === easingName;\r\n\t\t\tstyle[ TRANSITION_DURATION ] = ( options.duration / 1000 ) + 's';\r\n\r\n\t\t\tfunction transitionEndHandler ( event ) {\r\n\t\t\t\tconst index = changedProperties.indexOf( camelizeHyphenated( unprefix( event.propertyName ) ) );\r\n\r\n\t\t\t\tif ( index !== -1 ) {\r\n\t\t\t\t\tchangedProperties.splice( index, 1 );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( changedProperties.length ) {\r\n\t\t\t\t\t// still transitioning...\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tclearTimeout( cssTimeout );\r\n\t\t\t\tcssTransitionsDone();\r\n\t\t\t}\r\n\r\n\t\t\tfunction cssTransitionsDone () {\r\n\t\t\t\tstyle[ TRANSITION_PROPERTY ] = previous.property;\r\n\t\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = previous.duration;\r\n\t\t\t\tstyle[ TRANSITION_DURATION ] = previous.timing;\r\n\r\n\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\r\n\r\n\t\t\t\tcssTransitionsComplete = true;\r\n\t\t\t\tcheckComplete();\r\n\t\t\t}\r\n\r\n\t\t\tt.node.addEventListener( TRANSITIONEND, transitionEndHandler, false );\r\n\r\n\t\t\t// safety net in case transitionend never fires\r\n\t\t\tcssTimeout = setTimeout( () => {\r\n\t\t\t\tchangedProperties = [];\r\n\t\t\t\tcssTransitionsDone();\r\n\t\t\t}, options.duration + ( options.delay || 0 ) + 50 );\r\n\t\t\tt.registerCompleteHandler( transitionDone );\r\n\r\n\t\t\tsetTimeout( () => {\r\n\t\t\t\tlet i = changedProperties.length;\r\n\t\t\t\tlet hash;\r\n\t\t\t\tlet originalValue;\r\n\t\t\t\tlet index;\r\n\t\t\t\tconst propertiesToTransitionInJs = [];\r\n\t\t\t\tlet prop;\r\n\t\t\t\tlet suffix;\r\n\t\t\t\tlet interpolator;\r\n\r\n\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\tprop = changedProperties[i];\r\n\t\t\t\t\thash = hashPrefix + prop;\r\n\r\n\t\t\t\t\tif ( cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[ hash ] ) {\r\n\t\t\t\t\t\tstyle[ prefix( prop ) ] = to[ prop ];\r\n\r\n\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\r\n\t\t\t\t\t\t// this tag/property combo, find out now\r\n\t\t\t\t\t\tif ( !canUseCssTransitions[ hash ] ) {\r\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\r\n\r\n\t\t\t\t\t\t\t// if this property is transitionable in this browser,\r\n\t\t\t\t\t\t\t// the current style will be different from the target style\r\n\t\t\t\t\t\t\tcanUseCssTransitions[ hash ] = ( t.getStyle( prop ) != to[ prop ] );\r\n\t\t\t\t\t\t\tcannotUseCssTransitions[ hash ] = !canUseCssTransitions[ hash ];\r\n\r\n\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\r\n\t\t\t\t\t\t\tif ( cannotUseCssTransitions[ hash ] ) {\r\n\t\t\t\t\t\t\t\tstyle[ prefix( prop ) ] = originalValue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( !cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[ hash ] ) {\r\n\t\t\t\t\t\t// we need to fall back to timer-based stuff\r\n\t\t\t\t\t\tif ( originalValue === undefined ) {\r\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\r\n\t\t\t\t\t\t// will get confused\r\n\t\t\t\t\t\tindex = changedProperties.indexOf( prop );\r\n\t\t\t\t\t\tif ( index === -1 ) {\r\n\t\t\t\t\t\t\twarnIfDebug( 'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\r\n\r\n\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec( to[ prop ] )[0];\r\n\t\t\t\t\t\tinterpolator = interpolate( parseFloat( originalValue ), parseFloat( to[ prop ] ) ) || ( () => to[ prop ] );\r\n\r\n\t\t\t\t\t\t// ...then kick off a timer-based transition\r\n\t\t\t\t\t\tpropertiesToTransitionInJs.push({\r\n\t\t\t\t\t\t\tname: prefix( prop ),\r\n\t\t\t\t\t\t\tinterpolator,\r\n\t\t\t\t\t\t\tsuffix\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// javascript transitions\r\n\t\t\t\tif ( propertiesToTransitionInJs.length ) {\r\n\t\t\t\t\tlet easing;\r\n\r\n\t\t\t\t\tif ( typeof options.easing === 'string' ) {\r\n\t\t\t\t\t\teasing = t.ractive.easing[ options.easing ];\r\n\r\n\t\t\t\t\t\tif ( !easing ) {\r\n\t\t\t\t\t\t\twarnOnceIfDebug( missingPlugin( options.easing, 'easing' ) );\r\n\t\t\t\t\t\t\teasing = linear;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if ( typeof options.easing === 'function' ) {\r\n\t\t\t\t\t\teasing = options.easing;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\teasing = linear;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnew Ticker({\r\n\t\t\t\t\t\tduration: options.duration,\r\n\t\t\t\t\t\teasing,\r\n\t\t\t\t\t\tstep ( pos ) {\r\n\t\t\t\t\t\t\tlet i = propertiesToTransitionInJs.length;\r\n\t\t\t\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\t\t\t\tconst prop = propertiesToTransitionInJs[i];\r\n\t\t\t\t\t\t\t\tt.node.style[ prop.name ] = prop.interpolator( pos ) + prop.suffix;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete () {\r\n\t\t\t\t\t\t\tjsTransitionsComplete = true;\r\n\t\t\t\t\t\t\tcheckComplete();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjsTransitionsComplete = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !changedProperties.length ) {\r\n\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\r\n\t\t\t\t\t// the fact that it will never fire\r\n\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\r\n\t\t\t\t\tcssTransitionsComplete = true;\r\n\t\t\t\t\tcheckComplete();\r\n\t\t\t\t}\r\n\t\t\t}, 0 );\r\n\t\t}, options.delay || 0 );\r\n\t};\r\n}\r\n\r\nexport default createTransitions;\r\n","import { vendors } from '../../../../config/environment';\r\n\r\nconst vendorPattern = new RegExp( '^(?:' + vendors.join( '|' ) + ')([A-Z])' );\r\n\r\nexport default function ( str ) {\r\n\tif ( !str ) return ''; // edge case\r\n\r\n\tif ( vendorPattern.test( str ) ) str = '-' + str;\r\n\r\n\treturn str.replace( /[A-Z]/g, match => '-' + match.toLowerCase() );\r\n}\r\n","import { createDocumentFragment, matches } from '../../utils/dom';\r\nimport Mustache from './shared/Mustache';\r\nimport insertHtml from './triple/insertHtml';\r\nimport { decodeCharacterReferences } from '../../utils/html';\r\nimport { detachNode } from '../../utils/dom';\r\nimport { inAttribute } from './element/Attribute';\r\n\r\nexport default class Triple extends Mustache {\r\n\tconstructor ( options ) {\r\n\t\tsuper( options );\r\n\t}\r\n\r\n\tdetach () {\r\n\t\tconst docFrag = createDocumentFragment();\r\n\t\tif ( this.nodes ) this.nodes.forEach( node => docFrag.appendChild( node ) );\r\n\t\treturn docFrag;\r\n\t}\r\n\r\n\tfind ( selector ) {\r\n\t\tconst len = this.nodes.length;\r\n\t\tlet i;\r\n\r\n\t\tfor ( i = 0; i < len; i += 1 ) {\r\n\t\t\tconst node = this.nodes[i];\r\n\r\n\t\t\tif ( node.nodeType !== 1 ) continue;\r\n\r\n\t\t\tif ( matches( node, selector ) ) return node;\r\n\r\n\t\t\tconst queryResult = node.querySelector( selector );\r\n\t\t\tif ( queryResult ) return queryResult;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfindAll ( selector, options ) {\r\n\t\tconst { result } = options;\r\n\t\tconst len = this.nodes.length;\r\n\t\tlet i;\r\n\r\n\t\tfor ( i = 0; i < len; i += 1 ) {\r\n\t\t\tconst node = this.nodes[i];\r\n\r\n\t\t\tif ( node.nodeType !== 1 ) continue;\r\n\r\n\t\t\tif ( matches( node, selector ) ) result.push( node );\r\n\r\n\t\t\tconst queryAllResult = node.querySelectorAll( selector );\r\n\t\t\tif ( queryAllResult ) {\r\n\t\t\t\tresult.push.apply( result, queryAllResult );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfindComponent () {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfirstNode () {\r\n\t\treturn this.rendered && this.nodes[0];\r\n\t}\r\n\r\n\trender ( target, occupants ) {\r\n\t\tconst parentNode = this.parentFragment.findParentNode();\r\n\r\n\t\tif ( !this.nodes ) {\r\n\t\t\tconst html = this.model ? this.model.get() : '';\r\n\t\t\tthis.nodes = insertHtml( html, this.parentFragment.findParentNode(), target );\r\n\t\t}\r\n\r\n\t\tlet nodes = this.nodes;\r\n\t\tlet anchor = this.parentFragment.findNextNode( this );\r\n\r\n\t\t// progressive enhancement\r\n\t\tif ( occupants ) {\r\n\t\t\tlet i = -1;\r\n\t\t\tlet next;\r\n\r\n\t\t\t// start with the first node that should be rendered\r\n\t\t\twhile ( occupants.length && ( next = this.nodes[ i + 1 ] ) ) {\r\n\t\t\t\tlet n;\r\n\t\t\t\t// look through the occupants until a matching node is found\r\n\t\t\t\twhile ( n = occupants.shift() ) {\r\n\t\t\t\t\tconst t = n.nodeType;\r\n\r\n\t\t\t\t\tif ( t === next.nodeType && ( ( t === 1 && n.outerHTML === next.outerHTML ) || ( ( t === 3 || t === 8 ) && n.nodeValue === next.nodeValue ) ) ) {\r\n\t\t\t\t\t\tthis.nodes.splice( ++i, 1, n ); // replace the generated node with the existing one\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget.removeChild( n ); // remove the non-matching existing node\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( i >= 0 ) {\r\n\t\t\t\t// update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\r\n\t\t\t\tnodes = this.nodes.slice( i );\r\n\t\t\t}\r\n\r\n\t\t\t// update the anchor to be the next occupant\r\n\t\t\tif ( occupants.length ) anchor = occupants[0];\r\n\t\t}\r\n\r\n\t\t// attach any remainging nodes to the parent\r\n\t\tif ( nodes.length ) {\r\n\t\t\tconst frag = createDocumentFragment();\r\n\t\t\tnodes.forEach( n => frag.appendChild( n ) );\r\n\r\n\t\t\tif ( anchor ) {\r\n\t\t\t\tanchor.parentNode.insertBefore( frag, anchor );\r\n\t\t\t} else {\r\n\t\t\t\tparentNode.appendChild( frag );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.rendered = true;\r\n\t}\r\n\r\n\ttoString () {\r\n\t\tlet value = this.model && this.model.get();\r\n\t\tvalue = value != null ? '' + value : '';\r\n\r\n\t\treturn inAttribute() ? decodeCharacterReferences( value ) : value;\r\n\t}\r\n\r\n\tunrender () {\r\n\t\tif ( this.nodes ) this.nodes.forEach( node => detachNode( node ) );\r\n\t\tthis.rendered = false;\r\n\t\tthis.nodes = null;\r\n\t}\r\n\r\n\tupdate () {\r\n\t\tif ( this.rendered && this.dirty ) {\r\n\t\t\tthis.dirty = false;\r\n\r\n\t\t\tthis.unrender();\r\n\t\t\tthis.render();\r\n\t\t} else {\r\n\t\t\t// make sure to reset the dirty flag even if not rendered\r\n\t\t\tthis.dirty = false;\r\n\t\t}\r\n\t}\r\n}\r\n","import makeArrayMethod from './shared/makeArrayMethod';\r\nexport default makeArrayMethod( 'reverse' ).path;\r\n","import makeArrayMethod from './shared/makeArrayMethod';\r\nexport default makeArrayMethod( 'shift' ).path;\r\n","import makeArrayMethod from './shared/makeArrayMethod';\r\nexport default makeArrayMethod( 'sort' ).path;\r\n","import makeArrayMethod from './shared/makeArrayMethod';\r\nexport default makeArrayMethod( 'splice' ).path;\r\n","import makeArrayMethod from './shared/makeArrayMethod';\r\nexport default makeArrayMethod( 'unshift' ).path;\r\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext, { getNodeInfo } from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\n\nexport default {\n\tadd,\n\tanimate,\n\tattachChild,\n\tdetach,\n\tdetachChild,\n\tfind,\n\tfindAll,\n\tfindAllComponents,\n\tfindComponent,\n\tfindContainer,\n\tfindParent,\n\tfire,\n\tget,\n\tgetContext,\n\tgetNodeInfo,\n\tinsert,\n\tlink,\n\tobserve,\n\tobserveOnce,\n\toff,\n\ton,\n\tonce,\n\tpop,\n\tpush,\n\treadLink,\n\trender,\n\treset,\n\tresetPartial,\n\tresetTemplate,\n\treverse,\n\tset,\n\tshift,\n\tsort,\n\tsplice,\n\tsubtract,\n\tteardown,\n\ttoggle,\n\ttoCSS,\n\ttoCss: toCSS,\n\ttoHTML,\n\ttoHtml: toHTML,\n\ttoText,\n\ttransition,\n\tunlink,\n\tunrender,\n\tunshift,\n\tupdate,\n\tupdateModel\n};\n","/* http://prismjs.com/download.html?themes=prism&languages=markup+css+clike+javascript+properties&plugins=line-highlight+line-numbers+file-highlight */\r\nvar _self = (typeof window !== 'undefined')\r\n\t? window   // if in browser\r\n\t: (\r\n\t\t(typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)\r\n\t\t? self // if in worker\r\n\t\t: {}   // if in node js\r\n\t);\r\n\r\n/**\r\n * Prism: Lightweight, robust, elegant syntax highlighting\r\n * MIT license http://www.opensource.org/licenses/mit-license.php/\r\n * @author Lea Verou http://lea.verou.me\r\n */\r\n\r\nvar Prism = (function(){\r\n\r\n// Private helper vars\r\nvar lang = /\\blang(?:uage)?-(\\w+)\\b/i;\r\nvar uniqueId = 0;\r\n\r\nvar _ = _self.Prism = {\r\n\tmanual: _self.Prism && _self.Prism.manual,\r\n\tutil: {\r\n\t\tencode: function (tokens) {\r\n\t\t\tif (tokens instanceof Token) {\r\n\t\t\t\treturn new Token(tokens.type, _.util.encode(tokens.content), tokens.alias);\r\n\t\t\t} else if (_.util.type(tokens) === 'Array') {\r\n\t\t\t\treturn tokens.map(_.util.encode);\r\n\t\t\t} else {\r\n\t\t\t\treturn tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\\u00a0/g, ' ');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttype: function (o) {\r\n\t\t\treturn Object.prototype.toString.call(o).match(/\\[object (\\w+)\\]/)[1];\r\n\t\t},\r\n\r\n\t\tobjId: function (obj) {\r\n\t\t\tif (!obj['__id']) {\r\n\t\t\t\tObject.defineProperty(obj, '__id', { value: ++uniqueId });\r\n\t\t\t}\r\n\t\t\treturn obj['__id'];\r\n\t\t},\r\n\r\n\t\t// Deep clone a language definition (e.g. to extend it)\r\n\t\tclone: function (o) {\r\n\t\t\tvar type = _.util.type(o);\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase 'Object':\r\n\t\t\t\t\tvar clone = {};\r\n\r\n\t\t\t\t\tfor (var key in o) {\r\n\t\t\t\t\t\tif (o.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\tclone[key] = _.util.clone(o[key]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn clone;\r\n\r\n\t\t\t\tcase 'Array':\r\n\t\t\t\t\t// Check for existence for IE8\r\n\t\t\t\t\treturn o.map && o.map(function(v) { return _.util.clone(v); });\r\n\t\t\t}\r\n\r\n\t\t\treturn o;\r\n\t\t}\r\n\t},\r\n\r\n\tlanguages: {\r\n\t\textend: function (id, redef) {\r\n\t\t\tvar lang = _.util.clone(_.languages[id]);\r\n\r\n\t\t\tfor (var key in redef) {\r\n\t\t\t\tlang[key] = redef[key];\r\n\t\t\t}\r\n\r\n\t\t\treturn lang;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Insert a token before another token in a language literal\r\n\t\t * As this needs to recreate the object (we cannot actually insert before keys in object literals),\r\n\t\t * we cannot just provide an object, we need anobject and a key.\r\n\t\t * @param inside The key (or language id) of the parent\r\n\t\t * @param before The key to insert before. If not provided, the function appends instead.\r\n\t\t * @param insert Object with the key/value pairs to insert\r\n\t\t * @param root The object that contains `inside`. If equal to Prism.languages, it can be omitted.\r\n\t\t */\r\n\t\tinsertBefore: function (inside, before, insert, root) {\r\n\t\t\troot = root || _.languages;\r\n\t\t\tvar grammar = root[inside];\r\n\r\n\t\t\tif (arguments.length == 2) {\r\n\t\t\t\tinsert = arguments[1];\r\n\r\n\t\t\t\tfor (var newToken in insert) {\r\n\t\t\t\t\tif (insert.hasOwnProperty(newToken)) {\r\n\t\t\t\t\t\tgrammar[newToken] = insert[newToken];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn grammar;\r\n\t\t\t}\r\n\r\n\t\t\tvar ret = {};\r\n\r\n\t\t\tfor (var token in grammar) {\r\n\r\n\t\t\t\tif (grammar.hasOwnProperty(token)) {\r\n\r\n\t\t\t\t\tif (token == before) {\r\n\r\n\t\t\t\t\t\tfor (var newToken in insert) {\r\n\r\n\t\t\t\t\t\t\tif (insert.hasOwnProperty(newToken)) {\r\n\t\t\t\t\t\t\t\tret[newToken] = insert[newToken];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tret[token] = grammar[token];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update references in other language definitions\r\n\t\t\t_.languages.DFS(_.languages, function(key, value) {\r\n\t\t\t\tif (value === root[inside] && key != inside) {\r\n\t\t\t\t\tthis[key] = ret;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn root[inside] = ret;\r\n\t\t},\r\n\r\n\t\t// Traverse a language definition with Depth First Search\r\n\t\tDFS: function(o, callback, type, visited) {\r\n\t\t\tvisited = visited || {};\r\n\t\t\tfor (var i in o) {\r\n\t\t\t\tif (o.hasOwnProperty(i)) {\r\n\t\t\t\t\tcallback.call(o, i, o[i], type || i);\r\n\r\n\t\t\t\t\tif (_.util.type(o[i]) === 'Object' && !visited[_.util.objId(o[i])]) {\r\n\t\t\t\t\t\tvisited[_.util.objId(o[i])] = true;\r\n\t\t\t\t\t\t_.languages.DFS(o[i], callback, null, visited);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (_.util.type(o[i]) === 'Array' && !visited[_.util.objId(o[i])]) {\r\n\t\t\t\t\t\tvisited[_.util.objId(o[i])] = true;\r\n\t\t\t\t\t\t_.languages.DFS(o[i], callback, i, visited);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tplugins: {},\r\n\r\n\thighlightAll: function(async, callback) {\r\n\t\tvar env = {\r\n\t\t\tcallback: callback,\r\n\t\t\tselector: 'code[class*=\"language-\"], [class*=\"language-\"] code, code[class*=\"lang-\"], [class*=\"lang-\"] code'\r\n\t\t};\r\n\r\n\t\t_.hooks.run(\"before-highlightall\", env);\r\n\r\n\t\tvar elements = env.elements || document.querySelectorAll(env.selector);\r\n\r\n\t\tfor (var i=0, element; element = elements[i++];) {\r\n\t\t\t_.highlightElement(element, async === true, env.callback);\r\n\t\t}\r\n\t},\r\n\r\n\thighlightElement: function(element, async, callback) {\r\n\t\t// Find language\r\n\t\tvar language, grammar, parent = element;\r\n\r\n\t\twhile (parent && !lang.test(parent.className)) {\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\r\n\t\tif (parent) {\r\n\t\t\tlanguage = (parent.className.match(lang) || [,''])[1].toLowerCase();\r\n\t\t\tgrammar = _.languages[language];\r\n\t\t}\r\n\r\n\t\t// Set language on the element, if not present\r\n\t\telement.className = element.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\r\n\r\n\t\t// Set language on the parent, for styling\r\n\t\tparent = element.parentNode;\r\n\r\n\t\tif (/pre/i.test(parent.nodeName)) {\r\n\t\t\tparent.className = parent.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\r\n\t\t}\r\n\r\n\t\tvar code = element.textContent;\r\n\r\n\t\tvar env = {\r\n\t\t\telement: element,\r\n\t\t\tlanguage: language,\r\n\t\t\tgrammar: grammar,\r\n\t\t\tcode: code\r\n\t\t};\r\n\r\n\t\t_.hooks.run('before-sanity-check', env);\r\n\r\n\t\tif (!env.code || !env.grammar) {\r\n\t\t\tif (env.code) {\r\n\t\t\t\tenv.element.textContent = env.code;\r\n\t\t\t}\r\n\t\t\t_.hooks.run('complete', env);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_.hooks.run('before-highlight', env);\r\n\r\n\t\tif (async && _self.Worker) {\r\n\t\t\tvar worker = new Worker(_.filename);\r\n\r\n\t\t\tworker.onmessage = function(evt) {\r\n\t\t\t\tenv.highlightedCode = evt.data;\r\n\r\n\t\t\t\t_.hooks.run('before-insert', env);\r\n\r\n\t\t\t\tenv.element.innerHTML = env.highlightedCode;\r\n\r\n\t\t\t\tcallback && callback.call(env.element);\r\n\t\t\t\t_.hooks.run('after-highlight', env);\r\n\t\t\t\t_.hooks.run('complete', env);\r\n\t\t\t};\r\n\r\n\t\t\tworker.postMessage(JSON.stringify({\r\n\t\t\t\tlanguage: env.language,\r\n\t\t\t\tcode: env.code,\r\n\t\t\t\timmediateClose: true\r\n\t\t\t}));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tenv.highlightedCode = _.highlight(env.code, env.grammar, env.language);\r\n\r\n\t\t\t_.hooks.run('before-insert', env);\r\n\r\n\t\t\tenv.element.innerHTML = env.highlightedCode;\r\n\r\n\t\t\tcallback && callback.call(element);\r\n\r\n\t\t\t_.hooks.run('after-highlight', env);\r\n\t\t\t_.hooks.run('complete', env);\r\n\t\t}\r\n\t},\r\n\r\n\thighlight: function (text, grammar, language) {\r\n\t\tvar tokens = _.tokenize(text, grammar);\r\n\t\treturn Token.stringify(_.util.encode(tokens), language);\r\n\t},\r\n\r\n\ttokenize: function(text, grammar, language) {\r\n\t\tvar Token = _.Token;\r\n\r\n\t\tvar strarr = [text];\r\n\r\n\t\tvar rest = grammar.rest;\r\n\r\n\t\tif (rest) {\r\n\t\t\tfor (var token in rest) {\r\n\t\t\t\tgrammar[token] = rest[token];\r\n\t\t\t}\r\n\r\n\t\t\tdelete grammar.rest;\r\n\t\t}\r\n\r\n\t\ttokenloop: for (var token in grammar) {\r\n\t\t\tif(!grammar.hasOwnProperty(token) || !grammar[token]) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar patterns = grammar[token];\r\n\t\t\tpatterns = (_.util.type(patterns) === \"Array\") ? patterns : [patterns];\r\n\r\n\t\t\tfor (var j = 0; j < patterns.length; ++j) {\r\n\t\t\t\tvar pattern = patterns[j],\r\n\t\t\t\t\tinside = pattern.inside,\r\n\t\t\t\t\tlookbehind = !!pattern.lookbehind,\r\n\t\t\t\t\tgreedy = !!pattern.greedy,\r\n\t\t\t\t\tlookbehindLength = 0,\r\n\t\t\t\t\talias = pattern.alias;\r\n\r\n\t\t\t\tif (greedy && !pattern.pattern.global) {\r\n\t\t\t\t\t// Without the global flag, lastIndex won't work\r\n\t\t\t\t\tvar flags = pattern.pattern.toString().match(/[imuy]*$/)[0];\r\n\t\t\t\t\tpattern.pattern = RegExp(pattern.pattern.source, flags + \"g\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpattern = pattern.pattern || pattern;\r\n\r\n\t\t\t\t// Don’t cache length as it changes during the loop\r\n\t\t\t\tfor (var i=0, pos = 0; i<strarr.length; pos += strarr[i].length, ++i) {\r\n\r\n\t\t\t\t\tvar str = strarr[i];\r\n\r\n\t\t\t\t\tif (strarr.length > text.length) {\r\n\t\t\t\t\t\t// Something went terribly wrong, ABORT, ABORT!\r\n\t\t\t\t\t\tbreak tokenloop;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (str instanceof Token) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpattern.lastIndex = 0;\r\n\r\n\t\t\t\t\tvar match = pattern.exec(str),\r\n\t\t\t\t\t    delNum = 1;\r\n\r\n\t\t\t\t\t// Greedy patterns can override/remove up to two previously matched tokens\r\n\t\t\t\t\tif (!match && greedy && i != strarr.length - 1) {\r\n\t\t\t\t\t\tpattern.lastIndex = pos;\r\n\t\t\t\t\t\tmatch = pattern.exec(text);\r\n\t\t\t\t\t\tif (!match) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar from = match.index + (lookbehind ? match[1].length : 0),\r\n\t\t\t\t\t\t    to = match.index + match[0].length,\r\n\t\t\t\t\t\t    k = i,\r\n\t\t\t\t\t\t    p = pos;\r\n\r\n\t\t\t\t\t\tfor (var len = strarr.length; k < len && p < to; ++k) {\r\n\t\t\t\t\t\t\tp += strarr[k].length;\r\n\t\t\t\t\t\t\t// Move the index i to the element in strarr that is closest to from\r\n\t\t\t\t\t\t\tif (from >= p) {\r\n\t\t\t\t\t\t\t\t++i;\r\n\t\t\t\t\t\t\t\tpos = p;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t * If strarr[i] is a Token, then the match starts inside another Token, which is invalid\r\n\t\t\t\t\t\t * If strarr[k - 1] is greedy we are in conflict with another greedy pattern\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tif (strarr[i] instanceof Token || strarr[k - 1].greedy) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Number of tokens to delete and replace with the new match\r\n\t\t\t\t\t\tdelNum = k - i;\r\n\t\t\t\t\t\tstr = text.slice(pos, p);\r\n\t\t\t\t\t\tmatch.index -= pos;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!match) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(lookbehind) {\r\n\t\t\t\t\t\tlookbehindLength = match[1].length;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar from = match.index + lookbehindLength,\r\n\t\t\t\t\t    match = match[0].slice(lookbehindLength),\r\n\t\t\t\t\t    to = from + match.length,\r\n\t\t\t\t\t    before = str.slice(0, from),\r\n\t\t\t\t\t    after = str.slice(to);\r\n\r\n\t\t\t\t\tvar args = [i, delNum];\r\n\r\n\t\t\t\t\tif (before) {\r\n\t\t\t\t\t\targs.push(before);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar wrapped = new Token(token, inside? _.tokenize(match, inside) : match, alias, match, greedy);\r\n\r\n\t\t\t\t\targs.push(wrapped);\r\n\r\n\t\t\t\t\tif (after) {\r\n\t\t\t\t\t\targs.push(after);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tArray.prototype.splice.apply(strarr, args);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn strarr;\r\n\t},\r\n\r\n\thooks: {\r\n\t\tall: {},\r\n\r\n\t\tadd: function (name, callback) {\r\n\t\t\tvar hooks = _.hooks.all;\r\n\r\n\t\t\thooks[name] = hooks[name] || [];\r\n\r\n\t\t\thooks[name].push(callback);\r\n\t\t},\r\n\r\n\t\trun: function (name, env) {\r\n\t\t\tvar callbacks = _.hooks.all[name];\r\n\r\n\t\t\tif (!callbacks || !callbacks.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i=0, callback; callback = callbacks[i++];) {\r\n\t\t\t\tcallback(env);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\nvar Token = _.Token = function(type, content, alias, matchedStr, greedy) {\r\n\tthis.type = type;\r\n\tthis.content = content;\r\n\tthis.alias = alias;\r\n\t// Copy of the full string this token was created from\r\n\tthis.length = (matchedStr || \"\").length|0;\r\n\tthis.greedy = !!greedy;\r\n};\r\n\r\nToken.stringify = function(o, language, parent) {\r\n\tif (typeof o == 'string') {\r\n\t\treturn o;\r\n\t}\r\n\r\n\tif (_.util.type(o) === 'Array') {\r\n\t\treturn o.map(function(element) {\r\n\t\t\treturn Token.stringify(element, language, o);\r\n\t\t}).join('');\r\n\t}\r\n\r\n\tvar env = {\r\n\t\ttype: o.type,\r\n\t\tcontent: Token.stringify(o.content, language, parent),\r\n\t\ttag: 'span',\r\n\t\tclasses: ['token', o.type],\r\n\t\tattributes: {},\r\n\t\tlanguage: language,\r\n\t\tparent: parent\r\n\t};\r\n\r\n\tif (env.type == 'comment') {\r\n\t\tenv.attributes['spellcheck'] = 'true';\r\n\t}\r\n\r\n\tif (o.alias) {\r\n\t\tvar aliases = _.util.type(o.alias) === 'Array' ? o.alias : [o.alias];\r\n\t\tArray.prototype.push.apply(env.classes, aliases);\r\n\t}\r\n\r\n\t_.hooks.run('wrap', env);\r\n\r\n\tvar attributes = Object.keys(env.attributes).map(function(name) {\r\n\t\treturn name + '=\"' + (env.attributes[name] || '').replace(/\"/g, '&quot;') + '\"';\r\n\t}).join(' ');\r\n\r\n\treturn '<' + env.tag + ' class=\"' + env.classes.join(' ') + '\"' + (attributes ? ' ' + attributes : '') + '>' + env.content + '</' + env.tag + '>';\r\n\r\n};\r\n\r\nif (!_self.document) {\r\n\tif (!_self.addEventListener) {\r\n\t\t// in Node.js\r\n\t\treturn _self.Prism;\r\n\t}\r\n \t// In worker\r\n\t_self.addEventListener('message', function(evt) {\r\n\t\tvar message = JSON.parse(evt.data),\r\n\t\t    lang = message.language,\r\n\t\t    code = message.code,\r\n\t\t    immediateClose = message.immediateClose;\r\n\r\n\t\t_self.postMessage(_.highlight(code, _.languages[lang], lang));\r\n\t\tif (immediateClose) {\r\n\t\t\t_self.close();\r\n\t\t}\r\n\t}, false);\r\n\r\n\treturn _self.Prism;\r\n}\r\n\r\n//Get current script and highlight\r\nvar script = document.currentScript || [].slice.call(document.getElementsByTagName(\"script\")).pop();\r\n\r\nif (script) {\r\n\t_.filename = script.src;\r\n\r\n\tif (document.addEventListener && !_.manual && !script.hasAttribute('data-manual')) {\r\n\t\tif(document.readyState !== \"loading\") {\r\n\t\t\tif (window.requestAnimationFrame) {\r\n\t\t\t\twindow.requestAnimationFrame(_.highlightAll);\r\n\t\t\t} else {\r\n\t\t\t\twindow.setTimeout(_.highlightAll, 16);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdocument.addEventListener('DOMContentLoaded', _.highlightAll);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nreturn _self.Prism;\r\n\r\n})();\r\n\r\nif (typeof module !== 'undefined' && module.exports) {\r\n\tmodule.exports = Prism;\r\n}\r\n\r\n// hack for components to work correctly in node.js\r\nif (typeof global !== 'undefined') {\r\n\tglobal.Prism = Prism;\r\n}\r\n;\r\nPrism.languages.markup = {\r\n\t'comment': /<!--[\\w\\W]*?-->/,\r\n\t'prolog': /<\\?[\\w\\W]+?\\?>/,\r\n\t'doctype': /<!DOCTYPE[\\w\\W]+?>/i,\r\n\t'cdata': /<!\\[CDATA\\[[\\w\\W]*?]]>/i,\r\n\t'tag': {\r\n\t\tpattern: /<\\/?(?!\\d)[^\\s>\\/=$<]+(?:\\s+[^\\s>\\/=]+(?:=(?:(\"|')(?:\\\\\\1|\\\\?(?!\\1)[\\w\\W])*\\1|[^\\s'\">=]+))?)*\\s*\\/?>/i,\r\n\t\tinside: {\r\n\t\t\t'tag': {\r\n\t\t\t\tpattern: /^<\\/?[^\\s>\\/]+/i,\r\n\t\t\t\tinside: {\r\n\t\t\t\t\t'punctuation': /^<\\/?/,\r\n\t\t\t\t\t'namespace': /^[^\\s>\\/:]+:/\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'attr-value': {\r\n\t\t\t\tpattern: /=(?:('|\")[\\w\\W]*?(\\1)|[^\\s>]+)/i,\r\n\t\t\t\tinside: {\r\n\t\t\t\t\t'punctuation': /[=>\"']/\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'punctuation': /\\/?>/,\r\n\t\t\t'attr-name': {\r\n\t\t\t\tpattern: /[^\\s>\\/]+/,\r\n\t\t\t\tinside: {\r\n\t\t\t\t\t'namespace': /^[^\\s>\\/:]+:/\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t},\r\n\t'entity': /&#?[\\da-z]{1,8};/i\r\n};\r\n\r\n// Plugin to make entity title show the real entity, idea by Roman Komarov\r\nPrism.hooks.add('wrap', function(env) {\r\n\r\n\tif (env.type === 'entity') {\r\n\t\tenv.attributes['title'] = env.content.replace(/&amp;/, '&');\r\n\t}\r\n});\r\n\r\nPrism.languages.xml = Prism.languages.markup;\r\nPrism.languages.html = Prism.languages.markup;\r\nPrism.languages.mathml = Prism.languages.markup;\r\nPrism.languages.svg = Prism.languages.markup;\r\n\r\nPrism.languages.css = {\r\n\t'comment': /\\/\\*[\\w\\W]*?\\*\\//,\r\n\t'atrule': {\r\n\t\tpattern: /@[\\w-]+?.*?(;|(?=\\s*\\{))/i,\r\n\t\tinside: {\r\n\t\t\t'rule': /@[\\w-]+/\r\n\t\t\t// See rest below\r\n\t\t}\r\n\t},\r\n\t'url': /url\\((?:([\"'])(\\\\(?:\\r\\n|[\\w\\W])|(?!\\1)[^\\\\\\r\\n])*\\1|.*?)\\)/i,\r\n\t'selector': /[^\\{\\}\\s][^\\{\\};]*?(?=\\s*\\{)/,\r\n\t'string': {\r\n\t\tpattern: /(\"|')(\\\\(?:\\r\\n|[\\w\\W])|(?!\\1)[^\\\\\\r\\n])*\\1/,\r\n\t\tgreedy: true\r\n\t},\r\n\t'property': /(\\b|\\B)[\\w-]+(?=\\s*:)/i,\r\n\t'important': /\\B!important\\b/i,\r\n\t'function': /[-a-z0-9]+(?=\\()/i,\r\n\t'punctuation': /[(){};:]/\r\n};\r\n\r\nPrism.languages.css['atrule'].inside.rest = Prism.util.clone(Prism.languages.css);\r\n\r\nif (Prism.languages.markup) {\r\n\tPrism.languages.insertBefore('markup', 'tag', {\r\n\t\t'style': {\r\n\t\t\tpattern: /(<style[\\w\\W]*?>)[\\w\\W]*?(?=<\\/style>)/i,\r\n\t\t\tlookbehind: true,\r\n\t\t\tinside: Prism.languages.css,\r\n\t\t\talias: 'language-css'\r\n\t\t}\r\n\t});\r\n\t\r\n\tPrism.languages.insertBefore('inside', 'attr-value', {\r\n\t\t'style-attr': {\r\n\t\t\tpattern: /\\s*style=(\"|').*?\\1/i,\r\n\t\t\tinside: {\r\n\t\t\t\t'attr-name': {\r\n\t\t\t\t\tpattern: /^\\s*style/i,\r\n\t\t\t\t\tinside: Prism.languages.markup.tag.inside\r\n\t\t\t\t},\r\n\t\t\t\t'punctuation': /^\\s*=\\s*['\"]|['\"]\\s*$/,\r\n\t\t\t\t'attr-value': {\r\n\t\t\t\t\tpattern: /.+/i,\r\n\t\t\t\t\tinside: Prism.languages.css\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\talias: 'language-css'\r\n\t\t}\r\n\t}, Prism.languages.markup.tag);\r\n};\r\nPrism.languages.clike = {\r\n\t'comment': [\r\n\t\t{\r\n\t\t\tpattern: /(^|[^\\\\])\\/\\*[\\w\\W]*?\\*\\//,\r\n\t\t\tlookbehind: true\r\n\t\t},\r\n\t\t{\r\n\t\t\tpattern: /(^|[^\\\\:])\\/\\/.*/,\r\n\t\t\tlookbehind: true\r\n\t\t}\r\n\t],\r\n\t'string': {\r\n\t\tpattern: /([\"'])(\\\\(?:\\r\\n|[\\s\\S])|(?!\\1)[^\\\\\\r\\n])*\\1/,\r\n\t\tgreedy: true\r\n\t},\r\n\t'class-name': {\r\n\t\tpattern: /((?:\\b(?:class|interface|extends|implements|trait|instanceof|new)\\s+)|(?:catch\\s+\\())[a-z0-9_\\.\\\\]+/i,\r\n\t\tlookbehind: true,\r\n\t\tinside: {\r\n\t\t\tpunctuation: /(\\.|\\\\)/\r\n\t\t}\r\n\t},\r\n\t'keyword': /\\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\\b/,\r\n\t'boolean': /\\b(true|false)\\b/,\r\n\t'function': /[a-z0-9_]+(?=\\()/i,\r\n\t'number': /\\b-?(?:0x[\\da-f]+|\\d*\\.?\\d+(?:e[+-]?\\d+)?)\\b/i,\r\n\t'operator': /--?|\\+\\+?|!=?=?|<=?|>=?|==?=?|&&?|\\|\\|?|\\?|\\*|\\/|~|\\^|%/,\r\n\t'punctuation': /[{}[\\];(),.:]/\r\n};\r\n\r\nPrism.languages.javascript = Prism.languages.extend('clike', {\r\n\t'keyword': /\\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\\b/,\r\n\t'number': /\\b-?(0x[\\dA-Fa-f]+|0b[01]+|0o[0-7]+|\\d*\\.?\\d+([Ee][+-]?\\d+)?|NaN|Infinity)\\b/,\r\n\t// Allow for all non-ASCII characters (See http://stackoverflow.com/a/2008444)\r\n\t'function': /[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*(?=\\()/i,\r\n\t'operator': /--?|\\+\\+?|!=?=?|<=?|>=?|==?=?|&&?|\\|\\|?|\\?|\\*\\*?|\\/|~|\\^|%|\\.{3}/\r\n});\r\n\r\nPrism.languages.insertBefore('javascript', 'keyword', {\r\n\t'regex': {\r\n\t\tpattern: /(^|[^/])\\/(?!\\/)(\\[.+?]|\\\\.|[^/\\\\\\r\\n])+\\/[gimyu]{0,5}(?=\\s*($|[\\r\\n,.;})]))/,\r\n\t\tlookbehind: true,\r\n\t\tgreedy: true\r\n\t}\r\n});\r\n\r\nPrism.languages.insertBefore('javascript', 'string', {\r\n\t'template-string': {\r\n\t\tpattern: /`(?:\\\\\\\\|\\\\?[^\\\\])*?`/,\r\n\t\tgreedy: true,\r\n\t\tinside: {\r\n\t\t\t'interpolation': {\r\n\t\t\t\tpattern: /\\$\\{[^}]+\\}/,\r\n\t\t\t\tinside: {\r\n\t\t\t\t\t'interpolation-punctuation': {\r\n\t\t\t\t\t\tpattern: /^\\$\\{|\\}$/,\r\n\t\t\t\t\t\talias: 'punctuation'\r\n\t\t\t\t\t},\r\n\t\t\t\t\trest: Prism.languages.javascript\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'string': /[\\s\\S]+/\r\n\t\t}\r\n\t}\r\n});\r\n\r\nif (Prism.languages.markup) {\r\n\tPrism.languages.insertBefore('markup', 'tag', {\r\n\t\t'script': {\r\n\t\t\tpattern: /(<script[\\w\\W]*?>)[\\w\\W]*?(?=<\\/script>)/i,\r\n\t\t\tlookbehind: true,\r\n\t\t\tinside: Prism.languages.javascript,\r\n\t\t\talias: 'language-javascript'\r\n\t\t}\r\n\t});\r\n}\r\n\r\nPrism.languages.js = Prism.languages.javascript;\r\nPrism.languages.properties = {\r\n\t'comment': /^[ \\t]*[#!].*$/m,\r\n\t'attr-value': {\r\n\t\tpattern: /(^[ \\t]*(?:\\\\(?:\\r\\n|[\\s\\S])|[^\\\\\\s:=])+?(?: *[=:] *| ))(?:\\\\(?:\\r\\n|[\\s\\S])|.)+/m,\r\n\t\tlookbehind: true\r\n\t},\r\n\t'attr-name': /^[ \\t]*(?:\\\\(?:\\r\\n|[\\s\\S])|[^\\\\\\s:=])+?(?= *[ =:]| )/m,\r\n\t'punctuation': /[=:]/\r\n};\r\n(function(){\r\n\r\nif (typeof self === 'undefined' || !self.Prism || !self.document || !document.querySelector) {\r\n\treturn;\r\n}\r\n\r\nfunction $$(expr, con) {\r\n\treturn Array.prototype.slice.call((con || document).querySelectorAll(expr));\r\n}\r\n\r\nfunction hasClass(element, className) {\r\n  className = \" \" + className + \" \";\r\n  return (\" \" + element.className + \" \").replace(/[\\n\\t]/g, \" \").indexOf(className) > -1\r\n}\r\n\r\n// Some browsers round the line-height, others don't.\r\n// We need to test for it to position the elements properly.\r\nvar isLineHeightRounded = (function() {\r\n\tvar res;\r\n\treturn function() {\r\n\t\tif(typeof res === 'undefined') {\r\n\t\t\tvar d = document.createElement('div');\r\n\t\t\td.style.fontSize = '13px';\r\n\t\t\td.style.lineHeight = '1.5';\r\n\t\t\td.style.padding = 0;\r\n\t\t\td.style.border = 0;\r\n\t\t\td.innerHTML = '&nbsp;<br />&nbsp;';\r\n\t\t\tdocument.body.appendChild(d);\r\n\t\t\t// Browsers that round the line-height should have offsetHeight === 38\r\n\t\t\t// The others should have 39.\r\n\t\t\tres = d.offsetHeight === 38;\r\n\t\t\tdocument.body.removeChild(d);\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n}());\r\n\r\nfunction highlightLines(pre, lines, classes) {\r\n\tvar ranges = lines.replace(/\\s+/g, '').split(','),\r\n\t    offset = +pre.getAttribute('data-line-offset') || 0;\r\n\r\n\tvar parseMethod = isLineHeightRounded() ? parseInt : parseFloat;\r\n\tvar lineHeight = parseMethod(getComputedStyle(pre).lineHeight);\r\n\r\n\tfor (var i=0, range; range = ranges[i++];) {\r\n\t\trange = range.split('-');\r\n\r\n\t\tvar start = +range[0],\r\n\t\t    end = +range[1] || start;\r\n\r\n\t\tvar line = document.createElement('div');\r\n\r\n\t\tline.textContent = Array(end - start + 2).join(' \\n');\r\n\t\tline.setAttribute('aria-hidden', 'true');\r\n\t\tline.className = (classes || '') + ' line-highlight';\r\n\r\n\t\t//if the line-numbers plugin is enabled, then there is no reason for this plugin to display the line numbers\r\n\t\tif(!hasClass(pre, 'line-numbers')) {\r\n\t\t\tline.setAttribute('data-start', start);\r\n\r\n\t\t\tif(end > start) {\r\n\t\t\t\tline.setAttribute('data-end', end);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tline.style.top = (start - offset - 1) * lineHeight + 'px';\r\n\r\n\t\t//allow this to play nicely with the line-numbers plugin\r\n\t\tif(hasClass(pre, 'line-numbers')) {\r\n\t\t\t//need to attack to pre as when line-numbers is enabled, the code tag is relatively which screws up the positioning\r\n\t\t\tpre.appendChild(line);\r\n\t\t} else {\r\n\t\t\t(pre.querySelector('code') || pre).appendChild(line);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction applyHash() {\r\n\tvar hash = location.hash.slice(1);\r\n\r\n\t// Remove pre-existing temporary lines\r\n\t$$('.temporary.line-highlight').forEach(function (line) {\r\n\t\tline.parentNode.removeChild(line);\r\n\t});\r\n\r\n\tvar range = (hash.match(/\\.([\\d,-]+)$/) || [,''])[1];\r\n\r\n\tif (!range || document.getElementById(hash)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar id = hash.slice(0, hash.lastIndexOf('.')),\r\n\t    pre = document.getElementById(id);\r\n\r\n\tif (!pre) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!pre.hasAttribute('data-line')) {\r\n\t\tpre.setAttribute('data-line', '');\r\n\t}\r\n\r\n\thighlightLines(pre, range, 'temporary ');\r\n\r\n\tdocument.querySelector('.temporary.line-highlight').scrollIntoView();\r\n}\r\n\r\nvar fakeTimer = 0; // Hack to limit the number of times applyHash() runs\r\n\r\nPrism.hooks.add('before-sanity-check', function(env) {\r\n\tvar pre = env.element.parentNode;\r\n\tvar lines = pre && pre.getAttribute('data-line');\r\n\r\n\tif (!pre || !lines || !/pre/i.test(pre.nodeName)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t/*\r\n\t * Cleanup for other plugins (e.g. autoloader).\r\n\t *\r\n\t * Sometimes <code> blocks are highlighted multiple times. It is necessary\r\n\t * to cleanup any left-over tags, because the whitespace inside of the <div>\r\n\t * tags change the content of the <code> tag.\r\n\t */\r\n\tvar num = 0;\r\n\t$$('.line-highlight', pre).forEach(function (line) {\r\n\t\tnum += line.textContent.length;\r\n\t\tline.parentNode.removeChild(line);\r\n\t});\r\n\r\n\t// Remove extra whitespace\r\n\tif (num && /^( \\n)+$/.test(env.code.slice(-num))) {\r\n\t\tenv.code = env.code.slice(0, -num);\r\n\t}\r\n});\r\n\r\nPrism.hooks.add('complete', function(env) {\r\n\tvar pre = env.element.parentNode;\r\n\tvar lines = pre && pre.getAttribute('data-line');\r\n\r\n\tif (!pre || !lines || !/pre/i.test(pre.nodeName)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tclearTimeout(fakeTimer);\r\n\r\n\thighlightLines(pre, lines);\r\n\r\n\tfakeTimer = setTimeout(applyHash, 1);\r\n});\r\n\r\nif(window.addEventListener) {\r\n\twindow.addEventListener('hashchange', applyHash);\r\n}\r\n\r\n})();\r\n\r\n(function() {\r\n\r\nif (typeof self === 'undefined' || !self.Prism || !self.document) {\r\n\treturn;\r\n}\r\n\r\nPrism.hooks.add('complete', function (env) {\r\n\tif (!env.code) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// works only for <code> wrapped inside <pre> (not inline)\r\n\tvar pre = env.element.parentNode;\r\n\tvar clsReg = /\\s*\\bline-numbers\\b\\s*/;\r\n\tif (\r\n\t\t!pre || !/pre/i.test(pre.nodeName) ||\r\n\t\t\t// Abort only if nor the <pre> nor the <code> have the class\r\n\t\t(!clsReg.test(pre.className) && !clsReg.test(env.element.className))\r\n\t) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (env.element.querySelector(\".line-numbers-rows\")) {\r\n\t\t// Abort if line numbers already exists\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (clsReg.test(env.element.className)) {\r\n\t\t// Remove the class \"line-numbers\" from the <code>\r\n\t\tenv.element.className = env.element.className.replace(clsReg, '');\r\n\t}\r\n\tif (!clsReg.test(pre.className)) {\r\n\t\t// Add the class \"line-numbers\" to the <pre>\r\n\t\tpre.className += ' line-numbers';\r\n\t}\r\n\r\n\tvar match = env.code.match(/\\n(?!$)/g);\r\n\tvar linesNum = match ? match.length + 1 : 1;\r\n\tvar lineNumbersWrapper;\r\n\r\n\tvar lines = new Array(linesNum + 1);\r\n\tlines = lines.join('<span></span>');\r\n\r\n\tlineNumbersWrapper = document.createElement('span');\r\n\tlineNumbersWrapper.setAttribute('aria-hidden', 'true');\r\n\tlineNumbersWrapper.className = 'line-numbers-rows';\r\n\tlineNumbersWrapper.innerHTML = lines;\r\n\r\n\tif (pre.hasAttribute('data-start')) {\r\n\t\tpre.style.counterReset = 'linenumber ' + (parseInt(pre.getAttribute('data-start'), 10) - 1);\r\n\t}\r\n\r\n\tenv.element.appendChild(lineNumbersWrapper);\r\n\r\n});\r\n\r\n}());\r\n(function () {\r\n\tif (typeof self === 'undefined' || !self.Prism || !self.document || !document.querySelector) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tself.Prism.fileHighlight = function() {\r\n\r\n\t\tvar Extensions = {\r\n\t\t\t'js': 'javascript',\r\n\t\t\t'py': 'python',\r\n\t\t\t'rb': 'ruby',\r\n\t\t\t'ps1': 'powershell',\r\n\t\t\t'psm1': 'powershell',\r\n\t\t\t'sh': 'bash',\r\n\t\t\t'bat': 'batch',\r\n\t\t\t'h': 'c',\r\n\t\t\t'tex': 'latex'\r\n\t\t};\r\n\r\n\t\tif(Array.prototype.forEach) { // Check to prevent error in IE8\r\n\t\t\tArray.prototype.slice.call(document.querySelectorAll('pre[data-src]')).forEach(function (pre) {\r\n\t\t\t\tvar src = pre.getAttribute('data-src');\r\n\r\n\t\t\t\tvar language, parent = pre;\r\n\t\t\t\tvar lang = /\\blang(?:uage)?-(?!\\*)(\\w+)\\b/i;\r\n\t\t\t\twhile (parent && !lang.test(parent.className)) {\r\n\t\t\t\t\tparent = parent.parentNode;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\tlanguage = (pre.className.match(lang) || [, ''])[1];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!language) {\r\n\t\t\t\t\tvar extension = (src.match(/\\.(\\w+)$/) || [, ''])[1];\r\n\t\t\t\t\tlanguage = Extensions[extension] || extension;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar code = document.createElement('code');\r\n\t\t\t\tcode.className = 'language-' + language;\r\n\r\n\t\t\t\tpre.textContent = '';\r\n\r\n\t\t\t\tcode.textContent = 'Loading…';\r\n\r\n\t\t\t\tpre.appendChild(code);\r\n\r\n\t\t\t\tvar xhr = new XMLHttpRequest();\r\n\r\n\t\t\t\txhr.open('GET', src, true);\r\n\r\n\t\t\t\txhr.onreadystatechange = function () {\r\n\t\t\t\t\tif (xhr.readyState == 4) {\r\n\r\n\t\t\t\t\t\tif (xhr.status < 400 && xhr.responseText) {\r\n\t\t\t\t\t\t\tcode.textContent = xhr.responseText;\r\n\r\n\t\t\t\t\t\t\tPrism.highlightElement(code);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (xhr.status >= 400) {\r\n\t\t\t\t\t\t\tcode.textContent = '✖ Error ' + xhr.status + ' while fetching file: ' + xhr.statusText;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tcode.textContent = '✖ Error: File does not exist or is empty';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\txhr.send(null);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//document.addEventListener('DOMContentLoaded', self.Prism.fileHighlight);\r\n\r\n})();\r\n\r\n","import journey from \"lib/journey/journey.js\";\r\nimport template from \"./home.html\";\r\nimport Ractive from \"Ractive.js\";\r\n\r\nvar home = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = new Ractive( {\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template,\r\n\r\n\t\t\tstart: function () {\r\n\t\t\t\tjourney.goto( \"#basic?b=2#a=b\" );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n\r\n};\r\n\r\nexport default home;\r\n","\timport journey from \"lib/journey/journey\";\r\n\timport template from \"./basic.html\";\r\n\timport Ractive from \"Ractive.js\";\r\n\r\n\tvar basic = {\r\n\t\r\n\t\tenter: function(route, prevRoute, options) {\r\n\t\t\t/*%injectPath%*/\r\n\t\t\troute.view = new Ractive({\r\n\t\t\t\tel: options.target,\r\n\t\t\t\ttemplate: template,\r\n\t\t\t\tloadView: function () {\r\n\t\t\t\t\tvar random = new Date().getMilliseconds();\r\n\t\t\t\t\tjourney.goto(\"/basic?random=\" + random);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\tleave: function ( route, nextRoute, options ) {\r\n\t\t\treturn route.view.teardown();\r\n\t\t}\r\n\t};\r\n\t\r\n\texport default basic;\r\n\t\r\n\r\n","let session = {\n\n\tnavArgs: {}\n};\n\nexport default session;","import journey from \"lib/journey/journey\";\nimport Ractive from \"Ractive.js\";\nimport template from \"./nav.html\";\nimport session from \"./session.js\";\n\nvar nav = {\n\n\tenter: function ( route, prevRoute, options ) {\n\t\t/*%injectPath%*/\n\t\t\n\t\troute.view = new Ractive( {\n\t\t\tel: options.target,\n\t\t\ttemplate: template,\n\t\t\tgotoNewView: function () {\n\n\t\t\t\tvar args = { 'myArray': [ 'one', 'two', 'three' ] };\n\t\t\t\tsession.navArgs =  args;\n\t\t\t\tjourney.goto( \"/navTargetParams/1?name=Bob\" );\n\t\t\t}\n\t\t} );\n\n\t},\n\n\tleave: function ( route, nextRoute ) {\n\t\troute.view.teardown();\n\t}\n};\n\nfunction createView() {\n\n\tvar view = new template( {\n\t\tdata: {\n\t\t\texample1: \"js/app/views/nav/nav1-example.js\",\n\t\t\texample2: \"\"\n\t\t},\n\t\tgotoTargetWithParams: function ( routeName ) {\n\t\t\t// Navigate to the route specified\n\t\t\tvar params = { 'id': 1, 'name': 'Bob' };\n\t\t\tvar args = { 'myargs': [ 'one', 'two', 'three' ] };\n\t\t\tkudu.go( { ctrl: navTargetWithParams, routeParams: params, args: args } );\n\n\t\t\t// Cancel the click event by returning false, otherwise the link function would execute ie. follow the link href\n\t\t\treturn false;\n\t\t}\n\t} );\n\n\treturn view;\n}\n\nexport default nav;\n","import journey from \"lib/journey/journey\";\r\nimport template from \"./navTarget.html\";\r\nimport Ractive from \"Ractive.js\";\r\n\r\nvar navTarget = {\r\n\t\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\t\r\n\t\troute.view = new Ractive({\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template\r\n\t\t});\r\n\t},\r\n\t\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t\t\r\n\t}\r\n};\r\n\r\nexport default navTarget\r\n\r\n\r\n","import journey from \"lib/journey/journey\";\r\nimport template from \"./navTargetParams.html\";\r\nimport Ractive from \"Ractive.js\";\r\nimport session from \"./session.js\";\r\n\r\nvar navTargetParams = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\r\n\t\troute.view = new Ractive( {\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template,\r\n\t\t\tdata: {\r\n\t\t\t\tparams: route.params,\r\n\t\t\t\targs: session.navArgs,\r\n\t\t\t\tquery: route.query\r\n\t\t\t},\r\n\t\t\tstart: function ( ) {\r\n\t\t\t\tjourney.goto( \"/basic\", { x: \"1234\" } );\r\n\t\t\t}\r\n\t\t} );\r\n\t},\r\n\tleave: function ( route, nextRoute ) {\r\n\t\troute.view.teardown( );\r\n\t}\r\n};\r\n\r\nfunction createView( params, args ) {\r\n\r\n\tvar view = new template( {\r\n\t\tdata: {\r\n\t\t\targs: args,\r\n\t\t\tparams: params\r\n\t\t}\r\n\t} );\r\n\treturn view;\r\n}\r\n\r\nexport default navTargetParams;","import template from  \"./not-found\";\r\nimport Ractive from \"Ractive.js\";\r\n\r\nvar notFound = {\r\n\r\n\tenter: function (route, prevRoute, options) {\r\n\t\t/*%injectPath%*/\r\n\t\t\r\n\t\troute.view = new Ractive({\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t},\r\n\t\r\n\tleave: function (route, nextRoute, options) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\nexport default notFound;\r\n\r\n","import journey from \"lib/journey/journey\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./redirect.html\";\r\n\r\nvar redirect = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\t\r\n\t\tif ( route.query.typeId == null ) {\r\n\t\t\tjourney.goto( \"/redirectTarget\" );\r\n\t\t\treturn;\r\n\r\n\t\t} else {\r\n\r\n\t\t\troute.view = new Ractive( {\r\n\t\t\t\tel: options.target,\r\n\t\t\t\ttemplate: template\r\n\t\t\t} );\r\n\t\t}\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\tif ( route.view == null ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nexport default redirect;\r\n","import journey from \"lib/journey/journey\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./redirectTarget.html\";\r\n\r\nvar redirectTarget = {\r\n\t\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\t\r\n\t\troute.view = new Ractive( {\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template\r\n\t\t} );\r\n\t},\r\n\t\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nexport default redirectTarget\r\n","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./basicForm.html\";\r\n\r\nvar basicForm = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = new Ractive( {\r\n\r\n\t\t\tel: options.target,\r\n\r\n\t\t\ttemplate: template,\r\n\r\n\t\t\tdata: {\r\n\t\t\t\tcheck: true\r\n\t\t\t},\r\n\r\n\t\t\tsubmit: function () {\r\n\t\t\t\t$( '.bs-callout-info' ).removeClass( 'hidden' );\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\r\n\t\t\tresetData: function () {\r\n\t\t\t\t$( '.bs-callout-info' ).addClass( 'hidden' );\r\n\t\t\t}\r\n\t\t} );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nexport default basicForm\r\n","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./basicPartial.html\";\r\nimport helloPartial from \"./partial.html\";\r\n\r\nvar basicPartial = {\r\n\t\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = new Ractive( {\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template,\r\n\t\t\tpartials: {hello: helloPartial}\r\n\t\t} );\r\n\t},\r\n\t\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nexport default basicPartial;\r\n\r\n","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./grid.html\";\r\n\r\nvar data = {\r\n\trows: [\r\n\t\t{ name: \"Bob\", age: 20, id: 11 },\r\n\t\t{ name: \"Steve\", age: 30, id: 12 },\r\n\t\t{ name: \"James\", age: 40, id: 13 },\r\n\t\t{ name: \"Henry\", age: 50, id: 14 }\r\n\t]\r\n};\r\nvar component = Ractive.extend( {\r\n\ttemplate: template,\r\n\tonrender: function () {\r\n\r\n\t\t// public.remove and public.add are public events that subscribers can listen to,\r\n\t\t// even the grid component itself\r\n\r\n\t\t// Here we subscribe to the remove event\r\n\t\tthis.on( \"public.remove\", function ( ctx, id, index ) {\r\n\t\t\tvar row = data.rows[index];\r\n\t\t\t// The component can listen on the public remove event\r\n\t\t\tconsole.log( \"[component] on('public.remove') invoked with arguments:\", row );\r\n\t\t\tthis.splice( \"rows\", index, 1 );\r\n\t\t} );\r\n\t},\r\n\r\n\t// Unlike subscribing to the remove event, we declare an 'add' method\r\n\t// for the template to call and then 'fire' the public.addRow event\r\n\taddRow: function ( row ) {\r\n\t\tconsole.log( \"[component] add(row) method invoked wih arguments:\", row );\r\n\t\tthis.push( \"rows\", row );\r\n\t\tconsole.log( \"[component] firing 'public.add' event for subscribers, with arguments:\", row );\r\n\t\t// Fire event for listeners to act upon\r\n\t\tthis.fire( \"public.addRow\", row );\r\n\t},\r\n\tdata: function () {\r\n\t\treturn data;\r\n\t}\r\n} );\r\n\r\nexport default component;\r\n","import journey from \"lib/journey/journey.js\";\r\nimport Ractive from \"Ractive.js\";\r\nimport template from \"./basicTransition.html\";\r\nimport fade from \"lib/fade.js\";\r\n\r\nvar basicTransition = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = new Ractive( {\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template, loadView: function () {\r\n\t\t\t\tjourney.goto( \"/basicTransition\", { forceReload: true } );\r\n\t\t\t},\r\n\t\t\ttransitions: {\r\n\t\t\t\tfade: fade\r\n\t\t\t}\r\n\t\t} );\r\n\t},\r\n\r\n\tleave: function ( route, nextRoute, options ) {\r\n\t\troute.view.teardown();\r\n\t}\r\n};\r\n\r\nexport default basicTransition;\r\n","import Ractive from \"Ractive.js\";\n\nvar sortableDecorator = (function ( global, factory ) {\n\n\t'use strict';\n\n\t// Common JS (i.e. browserify) environment\n\tif ( typeof module !== 'undefined' && module.exports && typeof require === 'function' ) {\n\t\tfactory( require( 'ractive' ) );\n\t}\n\n\t// AMD?\n\telse if ( typeof define === 'function' && define.amd ) {\n\t\tdefine([ 'ractive' ], factory );\n\t}\n\n\t// browser global\n\telse if ( Ractive ) {\n\t\tfactory( Ractive );\n\t}\n\n\telse {\n\t\tthrow new Error( 'Could not find Ractive! It must be loaded before the Ractive-decorators-sortable plugin' );\n\t}\n\n}( typeof window !== 'undefined' ? window : this, function ( Ractive ) {\n\n\t'use strict';\n\n\tvar sortable,\n\t\tsrc,\n\t\tdragstartHandler,\n\t\tdragenterHandler,\n\t\tremoveTargetClass,\n\t\tpreventDefault,\n\t\terrorMessage;\n\n\tsortable = function ( node ) {\n\t\tnode.draggable = true;\n\n\t\tnode.addEventListener( 'dragstart', dragstartHandler, false );\n\t\tnode.addEventListener( 'dragenter', dragenterHandler, false );\n\t\tnode.addEventListener( 'dragleave', removeTargetClass, false );\n\t\tnode.addEventListener( 'drop', removeTargetClass, false );\n\n\t\t// necessary to prevent animation where ghost element returns\n\t\t// to its (old) home\n\t\tnode.addEventListener( 'dragover', preventDefault, false );\n\n\t\treturn {\n\t\t\tteardown: function () {\n\t\t\t\tnode.removeEventListener( 'dragstart', dragstartHandler, false );\n\t\t\t\tnode.removeEventListener( 'dragenter', dragenterHandler, false );\n\t\t\t\tnode.removeEventListener( 'dragleave', removeTargetClass, false );\n\t\t\t\tnode.removeEventListener( 'drop', removeTargetClass, false );\n\t\t\t\tnode.removeEventListener( 'dragover', preventDefault, false );\n\t\t\t}\n\t\t};\n\t};\n\n\tsortable.targetClass = 'droptarget';\n\n\terrorMessage = 'The sortable decorator only works with elements that correspond to array members';\n\n\tdragstartHandler = function ( event ) {\n\t\tvar context = Ractive.getContext( this );\n\t\tsrc = context;\n\t\t\n\t\t// this decorator only works with array members!\n\t\tif ( !Array.isArray( context.get( '../' ) ) ) {\n\t\t\tthrow new Error( errorMessage );\n\t\t}\n\n\t\tevent.dataTransfer.setData( 'text', '' ); // enables dragging\n\t};\n\n\tdragenterHandler = function ( event ) {\n\t\tvar dest = Ractive.getContext( this );\n\t\t\n\t\tevent.dataTransfer.dropEffect = 'none';\n\n\t\t// If we strayed into someone else's territory, abort\n\t\tif ( dest.ractive.root !== src.ractive.root ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !Array.isArray( dest.get( '../' ) ) ) {\n\t\t\tthrow new Error( errorMessage );\n\t\t}\n\n\t\t// if we're dealing with a different array, abort\n\t\tif ( dest.get( '../' ) !== src.get( '../' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar srcIdx = src.get( '@index' ), destIdx = dest.get( '@index' );\n\t\tconsole.log(\"WTF\", destIdx)\n\t\t\n\t\tthis.classList.add( sortable.targetClass );\n\t\tevent.dataTransfer.dropEffect = 'move';\n\n\t\t// swizzle the array and tell ractive to update\n\t\tvar array = src.get( '../' );\n\t\t\t\n\t\tlet removedItem = array.splice( srcIdx, 1 )[0];\n\t\tarray.splice( destIdx, 0, removedItem );\n\t\tsrc.update( '../' );\n\t\t\n\t\t// dest is the new src\n\t\tsrc = dest;\n\t};\n\n\tremoveTargetClass = function () {\n\t\tthis.classList.remove( sortable.targetClass );\n\t};\n\n\tpreventDefault = function ( event ) { event.preventDefault(); };\n\n\tRactive.decorators.sortable = sortable;\n\n\treturn sortable;\n\n}));\n\n// Common JS (i.e. browserify) environment\nif ( typeof module !== 'undefined' && module.exports) {\n\tmodule.exports = sortableDecorator;\n}\n","import journey from \"lib/journey/journey.js\";\r\nimport template from \"./sortable.html\";\r\nimport Ractive from \"Ractive.js\";\r\nimport \"lib/ractive-decorators-sortable.js\";\r\n\r\nvar sortable = {\r\n\r\n\tenter: function ( route, prevRoute, options ) {\r\n\t\t/*%injectPath%*/\r\n\t\troute.view = new Ractive( {\r\n\t\t\tel: options.target,\r\n\t\t\ttemplate: template,\r\n\t\t\tdata: {\r\n\t\t\t\tlist: [\r\n\t\t\t\t\t{ name: 'Firefox', icon: 'firefox_64x64.png' },\r\n\t\t\t\t\t{ name: 'Chrome', icon: 'chrome_64x64.png' },\r\n\t\t\t\t\t{ name: 'Safari', icon: 'safari_64x64.png' },\r\n\t\t\t\t\t{ name: 'Opera', icon: 'opera_64x64.png' },\r\n\t\t\t\t\t{ name: 'Maxthon', icon: 'maxthon_64x64.png' },\r\n\t\t\t\t\t{ name: 'Internet Explorer', icon: 'ie10_64x64.png' }\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t} );\r\n\t},\r\n\tleave: function ( route, nextRoute ) {\r\n\t\troute.view.teardown( );\r\n\t}\r\n};\r\nexport default sortable;\r\n","import journey from \"lib/journey/journey.js\";\t\r\nimport home from \"../views/home/home.js\";\r\nimport basic from \"../views/basics/controller/basic.js\";\r\nimport methods from \"../views/basics/methods/methods.js\";\r\nimport binding from \"../views/basics/binding/binding.js\";\r\nimport nav from \"../views/nav/nav.js\";\r\nimport navTarget from \"../views/nav/navTarget.js\";\r\nimport navTargetWithParams from \"../views/nav/navTargetParams.js\";\r\nimport notFound from \"../views/notfound/notFound.js\";\r\nimport redirect from \"../views/nav/redirect/redirect.js\";\r\nimport redirectTarget from \"../views/nav/redirect/redirectTarget.js\";\r\nimport basicForm from \"../views/forms/basic/basicForm.js\";\r\nimport validatingForm from \"../views/forms/validate/validatingForm.js\";\r\nimport events from \"../views/lifecycle/events/events.js\";\r\nimport basicAjax from \"../views/ajax/basic/basicAjax.js\";\r\nimport upload from \"../views/ajax/upload/upload.js\";\r\nimport basicPartial from \"../views/partial/basic/basicPartial.js\";\r\nimport basicComp from \"../views/comp/basic/basicComp.js\";\r\nimport multipleComp from \"../views/comp/multiple/multipleComp.js\";\r\nimport pubSubComp from \"../views/comp/pubsub/compPubSub.js\";\r\nimport basicTransition from \"../views/transition/basic/basicTransition.js\";\r\nimport sortable from \"../views/decorator/sortable.js\";\r\n\r\njourney.add(\"/home\", home);\r\njourney.add(\"/basic\", basic);\r\njourney.add(\"/methods\", methods);\r\njourney.add(\"/binding\", binding);\r\njourney.add(\"/navTargetParams/:id\", navTargetWithParams);\t\r\njourney.add(\"/navTarget\", navTarget);\r\njourney.add(\"/redirect\", redirect);\r\njourney.add(\"/redirectTarget\", redirectTarget);\r\njourney.add(\"/nav\", nav);\r\njourney.add(\"/\", home);\r\njourney.add(\"/notFound\", notFound);\r\njourney.add(\"/basicForm\", basicForm);\r\njourney.add(\"/validatingForm\", validatingForm);\r\njourney.add(\"/events\", events);\r\njourney.add(\"/basicAjax\", basicAjax);\r\njourney.add(\"/upload\", upload);\r\njourney.add(\"/basicPartial\", basicPartial);\r\njourney.add(\"/basicComp\", basicComp);\r\njourney.add(\"/multipleComp\", multipleComp);\r\njourney.add(\"/pubSubComp\", pubSubComp);\r\njourney.add(\"/pubSubComp\", pubSubComp);\r\njourney.add(\"/basicTransition\", basicTransition);\r\njourney.add(\"/sortable\", sortable);\r\n\r\n\r\n///export default routes;","(function() {\r\n  var AjaxMonitor, Bar, DocumentMonitor, ElementMonitor, ElementTracker, EventLagMonitor, Evented, Events, NoTargetError, Pace, RequestIntercept, SOURCE_KEYS, Scaler, SocketRequestTracker, XHRRequestTracker, animation, avgAmplitude, bar, cancelAnimation, cancelAnimationFrame, defaultOptions, extend, extendNative, getFromDOM, getIntercept, handlePushState, ignoreStack, init, now, options, requestAnimationFrame, result, runAnimation, scalers, shouldIgnoreURL, shouldTrack, source, sources, uniScaler, _WebSocket, _XDomainRequest, _XMLHttpRequest, _i, _intercept, _len, _pushState, _ref, _ref1, _replaceState,\r\n    __slice = [].slice,\r\n    __hasProp = {}.hasOwnProperty,\r\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\r\n    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\r\n\r\n  defaultOptions = {\r\n    catchupTime: 100,\r\n    initialRate: .03,\r\n    minTime: 250,\r\n    ghostTime: 100,\r\n    maxProgressPerFrame: 20,\r\n    easeFactor: 1.25,\r\n    startOnPageLoad: true,\r\n    restartOnPushState: true,\r\n    restartOnRequestAfter: 500,\r\n    target: 'body',\r\n    elements: {\r\n      checkInterval: 100,\r\n      selectors: ['body']\r\n    },\r\n    eventLag: {\r\n      minSamples: 10,\r\n      sampleCount: 3,\r\n      lagThreshold: 3\r\n    },\r\n    ajax: {\r\n      trackMethods: ['GET'],\r\n      trackWebSockets: true,\r\n      ignoreURLs: []\r\n    }\r\n  };\r\n\r\n  now = function() {\r\n    var _ref;\r\n    return (_ref = typeof performance !== \"undefined\" && performance !== null ? typeof performance.now === \"function\" ? performance.now() : void 0 : void 0) != null ? _ref : +(new Date);\r\n  };\r\n\r\n  requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;\r\n\r\n  cancelAnimationFrame = window.cancelAnimationFrame || window.mozCancelAnimationFrame;\r\n\r\n  if (requestAnimationFrame == null) {\r\n    requestAnimationFrame = function(fn) {\r\n      return setTimeout(fn, 50);\r\n    };\r\n    cancelAnimationFrame = function(id) {\r\n      return clearTimeout(id);\r\n    };\r\n  }\r\n\r\n  runAnimation = function(fn) {\r\n    var last, tick;\r\n    last = now();\r\n    tick = function() {\r\n      var diff;\r\n      diff = now() - last;\r\n      if (diff >= 33) {\r\n        last = now();\r\n        return fn(diff, function() {\r\n          return requestAnimationFrame(tick);\r\n        });\r\n      } else {\r\n        return setTimeout(tick, 33 - diff);\r\n      }\r\n    };\r\n    return tick();\r\n  };\r\n\r\n  result = function() {\r\n    var args, key, obj;\r\n    obj = arguments[0], key = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];\r\n    if (typeof obj[key] === 'function') {\r\n      return obj[key].apply(obj, args);\r\n    } else {\r\n      return obj[key];\r\n    }\r\n  };\r\n\r\n  extend = function() {\r\n    var key, out, source, sources, val, _i, _len;\r\n    out = arguments[0], sources = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\r\n    for (_i = 0, _len = sources.length; _i < _len; _i++) {\r\n      source = sources[_i];\r\n      if (source) {\r\n        for (key in source) {\r\n          if (!__hasProp.call(source, key)) continue;\r\n          val = source[key];\r\n          if ((out[key] != null) && typeof out[key] === 'object' && (val != null) && typeof val === 'object') {\r\n            extend(out[key], val);\r\n          } else {\r\n            out[key] = val;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return out;\r\n  };\r\n\r\n  avgAmplitude = function(arr) {\r\n    var count, sum, v, _i, _len;\r\n    sum = count = 0;\r\n    for (_i = 0, _len = arr.length; _i < _len; _i++) {\r\n      v = arr[_i];\r\n      sum += Math.abs(v);\r\n      count++;\r\n    }\r\n    return sum / count;\r\n  };\r\n\r\n  getFromDOM = function(key, json) {\r\n    var data, e, el;\r\n    if (key == null) {\r\n      key = 'options';\r\n    }\r\n    if (json == null) {\r\n      json = true;\r\n    }\r\n    el = document.querySelector(\"[data-pace-\" + key + \"]\");\r\n    if (!el) {\r\n      return;\r\n    }\r\n    data = el.getAttribute(\"data-pace-\" + key);\r\n    if (!json) {\r\n      return data;\r\n    }\r\n    try {\r\n      return JSON.parse(data);\r\n    } catch (_error) {\r\n      e = _error;\r\n      return typeof console !== \"undefined\" && console !== null ? console.error(\"Error parsing inline pace options\", e) : void 0;\r\n    }\r\n  };\r\n\r\n  Evented = (function() {\r\n    function Evented() {}\r\n\r\n    Evented.prototype.on = function(event, handler, ctx, once) {\r\n      var _base;\r\n      if (once == null) {\r\n        once = false;\r\n      }\r\n      if (this.bindings == null) {\r\n        this.bindings = {};\r\n      }\r\n      if ((_base = this.bindings)[event] == null) {\r\n        _base[event] = [];\r\n      }\r\n      return this.bindings[event].push({\r\n        handler: handler,\r\n        ctx: ctx,\r\n        once: once\r\n      });\r\n    };\r\n\r\n    Evented.prototype.once = function(event, handler, ctx) {\r\n      return this.on(event, handler, ctx, true);\r\n    };\r\n\r\n    Evented.prototype.off = function(event, handler) {\r\n      var i, _ref, _results;\r\n      if (((_ref = this.bindings) != null ? _ref[event] : void 0) == null) {\r\n        return;\r\n      }\r\n      if (handler == null) {\r\n        return delete this.bindings[event];\r\n      } else {\r\n        i = 0;\r\n        _results = [];\r\n        while (i < this.bindings[event].length) {\r\n          if (this.bindings[event][i].handler === handler) {\r\n            _results.push(this.bindings[event].splice(i, 1));\r\n          } else {\r\n            _results.push(i++);\r\n          }\r\n        }\r\n        return _results;\r\n      }\r\n    };\r\n\r\n    Evented.prototype.trigger = function() {\r\n      var args, ctx, event, handler, i, once, _ref, _ref1, _results;\r\n      event = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\r\n      if ((_ref = this.bindings) != null ? _ref[event] : void 0) {\r\n        i = 0;\r\n        _results = [];\r\n        while (i < this.bindings[event].length) {\r\n          _ref1 = this.bindings[event][i], handler = _ref1.handler, ctx = _ref1.ctx, once = _ref1.once;\r\n          handler.apply(ctx != null ? ctx : this, args);\r\n          if (once) {\r\n            _results.push(this.bindings[event].splice(i, 1));\r\n          } else {\r\n            _results.push(i++);\r\n          }\r\n        }\r\n        return _results;\r\n      }\r\n    };\r\n\r\n    return Evented;\r\n\r\n  })();\r\n\r\n  Pace = window.Pace || {};\r\n\r\n  window.Pace = Pace;\r\n\r\n  extend(Pace, Evented.prototype);\r\n\r\n  options = Pace.options = extend({}, defaultOptions, window.paceOptions, getFromDOM());\r\n\r\n  _ref = ['ajax', 'document', 'eventLag', 'elements'];\r\n  for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n    source = _ref[_i];\r\n    if (options[source] === true) {\r\n      options[source] = defaultOptions[source];\r\n    }\r\n  }\r\n\r\n  NoTargetError = (function(_super) {\r\n    __extends(NoTargetError, _super);\r\n\r\n    function NoTargetError() {\r\n      _ref1 = NoTargetError.__super__.constructor.apply(this, arguments);\r\n      return _ref1;\r\n    }\r\n\r\n    return NoTargetError;\r\n\r\n  })(Error);\r\n\r\n  Bar = (function() {\r\n    function Bar() {\r\n      this.progress = 0;\r\n    }\r\n\r\n    Bar.prototype.getElement = function() {\r\n      var targetElement;\r\n      if (this.el == null) {\r\n        targetElement = document.querySelector(options.target);\r\n        if (!targetElement) {\r\n          throw new NoTargetError;\r\n        }\r\n        this.el = document.createElement('div');\r\n        this.el.className = \"pace pace-active\";\r\n        document.body.className = document.body.className.replace(/pace-done/g, '');\r\n        document.body.className += ' pace-running';\r\n        this.el.innerHTML = '<div class=\"pace-progress\">\\n  <div class=\"pace-progress-inner\"></div>\\n</div>\\n<div class=\"pace-activity\"></div>';\r\n        if (targetElement.firstChild != null) {\r\n          targetElement.insertBefore(this.el, targetElement.firstChild);\r\n        } else {\r\n          targetElement.appendChild(this.el);\r\n        }\r\n      }\r\n      return this.el;\r\n    };\r\n\r\n    Bar.prototype.finish = function() {\r\n      var el;\r\n      el = this.getElement();\r\n      el.className = el.className.replace('pace-active', '');\r\n      el.className += ' pace-inactive';\r\n      document.body.className = document.body.className.replace('pace-running', '');\r\n      return document.body.className += ' pace-done';\r\n    };\r\n\r\n    Bar.prototype.update = function(prog) {\r\n      this.progress = prog;\r\n      return this.render();\r\n    };\r\n\r\n    Bar.prototype.destroy = function() {\r\n      try {\r\n        this.getElement().parentNode.removeChild(this.getElement());\r\n      } catch (_error) {\r\n        NoTargetError = _error;\r\n      }\r\n      return this.el = void 0;\r\n    };\r\n\r\n    Bar.prototype.render = function() {\r\n      var el, key, progressStr, transform, _j, _len1, _ref2;\r\n      if (document.querySelector(options.target) == null) {\r\n        return false;\r\n      }\r\n      el = this.getElement();\r\n      transform = \"translate3d(\" + this.progress + \"%, 0, 0)\";\r\n      _ref2 = ['webkitTransform', 'msTransform', 'transform'];\r\n      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {\r\n        key = _ref2[_j];\r\n        el.children[0].style[key] = transform;\r\n      }\r\n      if (!this.lastRenderedProgress || this.lastRenderedProgress | 0 !== this.progress | 0) {\r\n        el.children[0].setAttribute('data-progress-text', \"\" + (this.progress | 0) + \"%\");\r\n        if (this.progress >= 100) {\r\n          progressStr = '99';\r\n        } else {\r\n          progressStr = this.progress < 10 ? \"0\" : \"\";\r\n          progressStr += this.progress | 0;\r\n        }\r\n        el.children[0].setAttribute('data-progress', \"\" + progressStr);\r\n      }\r\n      return this.lastRenderedProgress = this.progress;\r\n    };\r\n\r\n    Bar.prototype.done = function() {\r\n      return this.progress >= 100;\r\n    };\r\n\r\n    return Bar;\r\n\r\n  })();\r\n\r\n  Events = (function() {\r\n    function Events() {\r\n      this.bindings = {};\r\n    }\r\n\r\n    Events.prototype.trigger = function(name, val) {\r\n      var binding, _j, _len1, _ref2, _results;\r\n      if (this.bindings[name] != null) {\r\n        _ref2 = this.bindings[name];\r\n        _results = [];\r\n        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {\r\n          binding = _ref2[_j];\r\n          _results.push(binding.call(this, val));\r\n        }\r\n        return _results;\r\n      }\r\n    };\r\n\r\n    Events.prototype.on = function(name, fn) {\r\n      var _base;\r\n      if ((_base = this.bindings)[name] == null) {\r\n        _base[name] = [];\r\n      }\r\n      return this.bindings[name].push(fn);\r\n    };\r\n\r\n    return Events;\r\n\r\n  })();\r\n\r\n  _XMLHttpRequest = window.XMLHttpRequest;\r\n\r\n  _XDomainRequest = window.XDomainRequest;\r\n\r\n  _WebSocket = window.WebSocket;\r\n\r\n  extendNative = function(to, from) {\r\n    var e, key, _results;\r\n    _results = [];\r\n    for (key in from.prototype) {\r\n      try {\r\n        if ((to[key] == null) && typeof from[key] !== 'function') {\r\n          if (typeof Object.defineProperty === 'function') {\r\n            _results.push(Object.defineProperty(to, key, {\r\n              get: function() {\r\n                return from.prototype[key];\r\n              },\r\n              configurable: true,\r\n              enumerable: true\r\n            }));\r\n          } else {\r\n            _results.push(to[key] = from.prototype[key]);\r\n          }\r\n        } else {\r\n          _results.push(void 0);\r\n        }\r\n      } catch (_error) {\r\n        e = _error;\r\n      }\r\n    }\r\n    return _results;\r\n  };\r\n\r\n  ignoreStack = [];\r\n\r\n  Pace.ignore = function() {\r\n    var args, fn, ret;\r\n    fn = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\r\n    ignoreStack.unshift('ignore');\r\n    ret = fn.apply(null, args);\r\n    ignoreStack.shift();\r\n    return ret;\r\n  };\r\n\r\n  Pace.track = function() {\r\n    var args, fn, ret;\r\n    fn = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\r\n    ignoreStack.unshift('track');\r\n    ret = fn.apply(null, args);\r\n    ignoreStack.shift();\r\n    return ret;\r\n  };\r\n\r\n  shouldTrack = function(method) {\r\n    var _ref2;\r\n    if (method == null) {\r\n      method = 'GET';\r\n    }\r\n    if (ignoreStack[0] === 'track') {\r\n      return 'force';\r\n    }\r\n    if (!ignoreStack.length && options.ajax) {\r\n      if (method === 'socket' && options.ajax.trackWebSockets) {\r\n        return true;\r\n      } else if (_ref2 = method.toUpperCase(), __indexOf.call(options.ajax.trackMethods, _ref2) >= 0) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  RequestIntercept = (function(_super) {\r\n    __extends(RequestIntercept, _super);\r\n\r\n    function RequestIntercept() {\r\n      var monitorXHR,\r\n        _this = this;\r\n      RequestIntercept.__super__.constructor.apply(this, arguments);\r\n      monitorXHR = function(req) {\r\n        var _open;\r\n        _open = req.open;\r\n        return req.open = function(type, url, async) {\r\n          if (shouldTrack(type)) {\r\n            _this.trigger('request', {\r\n              type: type,\r\n              url: url,\r\n              request: req\r\n            });\r\n          }\r\n          return _open.apply(req, arguments);\r\n        };\r\n      };\r\n      window.XMLHttpRequest = function(flags) {\r\n        var req;\r\n        req = new _XMLHttpRequest(flags);\r\n        monitorXHR(req);\r\n        return req;\r\n      };\r\n      try {\r\n        extendNative(window.XMLHttpRequest, _XMLHttpRequest);\r\n      } catch (_error) {}\r\n      if (_XDomainRequest != null) {\r\n        window.XDomainRequest = function() {\r\n          var req;\r\n          req = new _XDomainRequest;\r\n          monitorXHR(req);\r\n          return req;\r\n        };\r\n        try {\r\n          extendNative(window.XDomainRequest, _XDomainRequest);\r\n        } catch (_error) {}\r\n      }\r\n      if ((_WebSocket != null) && options.ajax.trackWebSockets) {\r\n        window.WebSocket = function(url, protocols) {\r\n          var req;\r\n          if (protocols != null) {\r\n            req = new _WebSocket(url, protocols);\r\n          } else {\r\n            req = new _WebSocket(url);\r\n          }\r\n          if (shouldTrack('socket')) {\r\n            _this.trigger('request', {\r\n              type: 'socket',\r\n              url: url,\r\n              protocols: protocols,\r\n              request: req\r\n            });\r\n          }\r\n          return req;\r\n        };\r\n        try {\r\n          extendNative(window.WebSocket, _WebSocket);\r\n        } catch (_error) {}\r\n      }\r\n    }\r\n\r\n    return RequestIntercept;\r\n\r\n  })(Events);\r\n\r\n  _intercept = null;\r\n\r\n  getIntercept = function() {\r\n    if (_intercept == null) {\r\n      _intercept = new RequestIntercept;\r\n    }\r\n    return _intercept;\r\n  };\r\n\r\n  shouldIgnoreURL = function(url) {\r\n    var pattern, _j, _len1, _ref2;\r\n    _ref2 = options.ajax.ignoreURLs;\r\n    for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {\r\n      pattern = _ref2[_j];\r\n      if (typeof pattern === 'string') {\r\n        if (url.indexOf(pattern) !== -1) {\r\n          return true;\r\n        }\r\n      } else {\r\n        if (pattern.test(url)) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  getIntercept().on('request', function(_arg) {\r\n    var after, args, request, type, url;\r\n    type = _arg.type, request = _arg.request, url = _arg.url;\r\n    if (shouldIgnoreURL(url)) {\r\n      return;\r\n    }\r\n    if (!Pace.running && (options.restartOnRequestAfter !== false || shouldTrack(type) === 'force')) {\r\n      args = arguments;\r\n      after = options.restartOnRequestAfter || 0;\r\n      if (typeof after === 'boolean') {\r\n        after = 0;\r\n      }\r\n      return setTimeout(function() {\r\n        var stillActive, _j, _len1, _ref2, _ref3, _results;\r\n        if (type === 'socket') {\r\n          stillActive = request.readyState < 2;\r\n        } else {\r\n          stillActive = (0 < (_ref2 = request.readyState) && _ref2 < 4);\r\n        }\r\n        if (stillActive) {\r\n          Pace.restart();\r\n          _ref3 = Pace.sources;\r\n          _results = [];\r\n          for (_j = 0, _len1 = _ref3.length; _j < _len1; _j++) {\r\n            source = _ref3[_j];\r\n            if (source instanceof AjaxMonitor) {\r\n              source.watch.apply(source, args);\r\n              break;\r\n            } else {\r\n              _results.push(void 0);\r\n            }\r\n          }\r\n          return _results;\r\n        }\r\n      }, after);\r\n    }\r\n  });\r\n\r\n  AjaxMonitor = (function() {\r\n    function AjaxMonitor() {\r\n      var _this = this;\r\n      this.elements = [];\r\n      getIntercept().on('request', function() {\r\n        return _this.watch.apply(_this, arguments);\r\n      });\r\n    }\r\n\r\n    AjaxMonitor.prototype.watch = function(_arg) {\r\n      var request, tracker, type, url;\r\n      type = _arg.type, request = _arg.request, url = _arg.url;\r\n      if (shouldIgnoreURL(url)) {\r\n        return;\r\n      }\r\n      if (type === 'socket') {\r\n        tracker = new SocketRequestTracker(request);\r\n      } else {\r\n        tracker = new XHRRequestTracker(request);\r\n      }\r\n      return this.elements.push(tracker);\r\n    };\r\n\r\n    return AjaxMonitor;\r\n\r\n  })();\r\n\r\n  XHRRequestTracker = (function() {\r\n    function XHRRequestTracker(request) {\r\n      var event, size, _j, _len1, _onreadystatechange, _ref2,\r\n        _this = this;\r\n      this.progress = 0;\r\n      if (window.ProgressEvent != null) {\r\n        size = null;\r\n        request.addEventListener('progress', function(evt) {\r\n          if (evt.lengthComputable) {\r\n            return _this.progress = 100 * evt.loaded / evt.total;\r\n          } else {\r\n            return _this.progress = _this.progress + (100 - _this.progress) / 2;\r\n          }\r\n        }, false);\r\n        _ref2 = ['load', 'abort', 'timeout', 'error'];\r\n        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {\r\n          event = _ref2[_j];\r\n          request.addEventListener(event, function() {\r\n            return _this.progress = 100;\r\n          }, false);\r\n        }\r\n      } else {\r\n        _onreadystatechange = request.onreadystatechange;\r\n        request.onreadystatechange = function() {\r\n          var _ref3;\r\n          if ((_ref3 = request.readyState) === 0 || _ref3 === 4) {\r\n            _this.progress = 100;\r\n          } else if (request.readyState === 3) {\r\n            _this.progress = 50;\r\n          }\r\n          return typeof _onreadystatechange === \"function\" ? _onreadystatechange.apply(null, arguments) : void 0;\r\n        };\r\n      }\r\n    }\r\n\r\n    return XHRRequestTracker;\r\n\r\n  })();\r\n\r\n  SocketRequestTracker = (function() {\r\n    function SocketRequestTracker(request) {\r\n      var event, _j, _len1, _ref2,\r\n        _this = this;\r\n      this.progress = 0;\r\n      _ref2 = ['error', 'open'];\r\n      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {\r\n        event = _ref2[_j];\r\n        request.addEventListener(event, function() {\r\n          return _this.progress = 100;\r\n        }, false);\r\n      }\r\n    }\r\n\r\n    return SocketRequestTracker;\r\n\r\n  })();\r\n\r\n  ElementMonitor = (function() {\r\n    function ElementMonitor(options) {\r\n      var selector, _j, _len1, _ref2;\r\n      if (options == null) {\r\n        options = {};\r\n      }\r\n      this.elements = [];\r\n      if (options.selectors == null) {\r\n        options.selectors = [];\r\n      }\r\n      _ref2 = options.selectors;\r\n      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {\r\n        selector = _ref2[_j];\r\n        this.elements.push(new ElementTracker(selector));\r\n      }\r\n    }\r\n\r\n    return ElementMonitor;\r\n\r\n  })();\r\n\r\n  ElementTracker = (function() {\r\n    function ElementTracker(selector) {\r\n      this.selector = selector;\r\n      this.progress = 0;\r\n      this.check();\r\n    }\r\n\r\n    ElementTracker.prototype.check = function() {\r\n      var _this = this;\r\n      if (document.querySelector(this.selector)) {\r\n        return this.done();\r\n      } else {\r\n        return setTimeout((function() {\r\n          return _this.check();\r\n        }), options.elements.checkInterval);\r\n      }\r\n    };\r\n\r\n    ElementTracker.prototype.done = function() {\r\n      return this.progress = 100;\r\n    };\r\n\r\n    return ElementTracker;\r\n\r\n  })();\r\n\r\n  DocumentMonitor = (function() {\r\n    DocumentMonitor.prototype.states = {\r\n      loading: 0,\r\n      interactive: 50,\r\n      complete: 100\r\n    };\r\n\r\n    function DocumentMonitor() {\r\n      var _onreadystatechange, _ref2,\r\n        _this = this;\r\n      this.progress = (_ref2 = this.states[document.readyState]) != null ? _ref2 : 100;\r\n      _onreadystatechange = document.onreadystatechange;\r\n      document.onreadystatechange = function() {\r\n        if (_this.states[document.readyState] != null) {\r\n          _this.progress = _this.states[document.readyState];\r\n        }\r\n        return typeof _onreadystatechange === \"function\" ? _onreadystatechange.apply(null, arguments) : void 0;\r\n      };\r\n    }\r\n\r\n    return DocumentMonitor;\r\n\r\n  })();\r\n\r\n  EventLagMonitor = (function() {\r\n    function EventLagMonitor() {\r\n      var avg, interval, last, points, samples,\r\n        _this = this;\r\n      this.progress = 0;\r\n      avg = 0;\r\n      samples = [];\r\n      points = 0;\r\n      last = now();\r\n      interval = setInterval(function() {\r\n        var diff;\r\n        diff = now() - last - 50;\r\n        last = now();\r\n        samples.push(diff);\r\n        if (samples.length > options.eventLag.sampleCount) {\r\n          samples.shift();\r\n        }\r\n        avg = avgAmplitude(samples);\r\n        if (++points >= options.eventLag.minSamples && avg < options.eventLag.lagThreshold) {\r\n          _this.progress = 100;\r\n          return clearInterval(interval);\r\n        } else {\r\n          return _this.progress = 100 * (3 / (avg + 3));\r\n        }\r\n      }, 50);\r\n    }\r\n\r\n    return EventLagMonitor;\r\n\r\n  })();\r\n\r\n  Scaler = (function() {\r\n    function Scaler(source) {\r\n      this.source = source;\r\n      this.last = this.sinceLastUpdate = 0;\r\n      this.rate = options.initialRate;\r\n      this.catchup = 0;\r\n      this.progress = this.lastProgress = 0;\r\n      if (this.source != null) {\r\n        this.progress = result(this.source, 'progress');\r\n      }\r\n    }\r\n\r\n    Scaler.prototype.tick = function(frameTime, val) {\r\n      var scaling;\r\n      if (val == null) {\r\n        val = result(this.source, 'progress');\r\n      }\r\n      if (val >= 100) {\r\n        this.done = true;\r\n      }\r\n      if (val === this.last) {\r\n        this.sinceLastUpdate += frameTime;\r\n      } else {\r\n        if (this.sinceLastUpdate) {\r\n          this.rate = (val - this.last) / this.sinceLastUpdate;\r\n        }\r\n        this.catchup = (val - this.progress) / options.catchupTime;\r\n        this.sinceLastUpdate = 0;\r\n        this.last = val;\r\n      }\r\n      if (val > this.progress) {\r\n        this.progress += this.catchup * frameTime;\r\n      }\r\n      scaling = 1 - Math.pow(this.progress / 100, options.easeFactor);\r\n      this.progress += scaling * this.rate * frameTime;\r\n      this.progress = Math.min(this.lastProgress + options.maxProgressPerFrame, this.progress);\r\n      this.progress = Math.max(0, this.progress);\r\n      this.progress = Math.min(100, this.progress);\r\n      this.lastProgress = this.progress;\r\n      return this.progress;\r\n    };\r\n\r\n    return Scaler;\r\n\r\n  })();\r\n\r\n  sources = null;\r\n\r\n  scalers = null;\r\n\r\n  bar = null;\r\n\r\n  uniScaler = null;\r\n\r\n  animation = null;\r\n\r\n  cancelAnimation = null;\r\n\r\n  Pace.running = false;\r\n\r\n  handlePushState = function() {\r\n    if (options.restartOnPushState) {\r\n      return Pace.restart();\r\n    }\r\n  };\r\n\r\n  if (window.history.pushState != null) {\r\n    _pushState = window.history.pushState;\r\n    window.history.pushState = function() {\r\n      handlePushState();\r\n      return _pushState.apply(window.history, arguments);\r\n    };\r\n  }\r\n\r\n  if (window.history.replaceState != null) {\r\n    _replaceState = window.history.replaceState;\r\n    window.history.replaceState = function() {\r\n      handlePushState();\r\n      return _replaceState.apply(window.history, arguments);\r\n    };\r\n  }\r\n\r\n  SOURCE_KEYS = {\r\n    ajax: AjaxMonitor,\r\n    elements: ElementMonitor,\r\n    document: DocumentMonitor,\r\n    eventLag: EventLagMonitor\r\n  };\r\n\r\n  (init = function() {\r\n    var type, _j, _k, _len1, _len2, _ref2, _ref3, _ref4;\r\n    Pace.sources = sources = [];\r\n    _ref2 = ['ajax', 'elements', 'document', 'eventLag'];\r\n    for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {\r\n      type = _ref2[_j];\r\n      if (options[type] !== false) {\r\n        sources.push(new SOURCE_KEYS[type](options[type]));\r\n      }\r\n    }\r\n    _ref4 = (_ref3 = options.extraSources) != null ? _ref3 : [];\r\n    for (_k = 0, _len2 = _ref4.length; _k < _len2; _k++) {\r\n      source = _ref4[_k];\r\n      sources.push(new source(options));\r\n    }\r\n    Pace.bar = bar = new Bar;\r\n    scalers = [];\r\n    return uniScaler = new Scaler;\r\n  })();\r\n\r\n  Pace.stop = function() {\r\n    Pace.trigger('stop');\r\n    Pace.running = false;\r\n    bar.destroy();\r\n    cancelAnimation = true;\r\n    if (animation != null) {\r\n      if (typeof cancelAnimationFrame === \"function\") {\r\n        cancelAnimationFrame(animation);\r\n      }\r\n      animation = null;\r\n    }\r\n    return init();\r\n  };\r\n\r\n  Pace.restart = function() {\r\n    Pace.trigger('restart');\r\n    Pace.stop();\r\n    return Pace.start();\r\n  };\r\n\r\n  Pace.go = function() {\r\n    var start;\r\n    Pace.running = true;\r\n    bar.render();\r\n    start = now();\r\n    cancelAnimation = false;\r\n    return animation = runAnimation(function(frameTime, enqueueNextFrame) {\r\n      var avg, count, done, element, elements, i, j, remaining, scaler, scalerList, sum, _j, _k, _len1, _len2, _ref2;\r\n      remaining = 100 - bar.progress;\r\n      count = sum = 0;\r\n      done = true;\r\n      for (i = _j = 0, _len1 = sources.length; _j < _len1; i = ++_j) {\r\n        source = sources[i];\r\n        scalerList = scalers[i] != null ? scalers[i] : scalers[i] = [];\r\n        elements = (_ref2 = source.elements) != null ? _ref2 : [source];\r\n        for (j = _k = 0, _len2 = elements.length; _k < _len2; j = ++_k) {\r\n          element = elements[j];\r\n          scaler = scalerList[j] != null ? scalerList[j] : scalerList[j] = new Scaler(element);\r\n          done &= scaler.done;\r\n          if (scaler.done) {\r\n            continue;\r\n          }\r\n          count++;\r\n          sum += scaler.tick(frameTime);\r\n        }\r\n      }\r\n      avg = sum / count;\r\n      bar.update(uniScaler.tick(frameTime, avg));\r\n      if (bar.done() || done || cancelAnimation) {\r\n        bar.update(100);\r\n        Pace.trigger('done');\r\n        return setTimeout(function() {\r\n          bar.finish();\r\n          Pace.running = false;\r\n          return Pace.trigger('hide');\r\n        }, Math.max(options.ghostTime, Math.max(options.minTime - (now() - start), 0)));\r\n      } else {\r\n        return enqueueNextFrame();\r\n      }\r\n    });\r\n  };\r\n\r\n  Pace.start = function(_options) {\r\n    extend(options, _options);\r\n    Pace.running = true;\r\n    try {\r\n      bar.render();\r\n    } catch (_error) {\r\n      NoTargetError = _error;\r\n    }\r\n    if (!document.querySelector('.pace')) {\r\n      return setTimeout(Pace.start, 50);\r\n    } else {\r\n      Pace.trigger('start');\r\n      return Pace.go();\r\n    }\r\n  };\r\n\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(['pace'], function() {\r\n      return Pace;\r\n    });\r\n  } else if (typeof exports === 'object') {\r\n    module.exports = Pace;\r\n  } else {\r\n    if (options.startOnPageLoad) {\r\n      Pace.start();\r\n    }\r\n  }\r\n\r\n}).call(this);","import journey from \"lib/journey/journey.js\";\r\nimport \"lib/pace.js\";\r\nimport template from \"./menu.html\";\r\nimport Ractive from \"Ractive.js\";\r\nimport sidePanel from \"../panel/side-panel/sidePanel.js\";\r\nimport menuSlider from \"./menuSlider.js\";\r\n\r\nlet sidePanelObj;\r\n\r\nvar menu = {\r\n\r\n\tinit: function ( options ) {\r\n\r\n\t\t// Create menu view instance\r\n\t\tnew Ractive( {\r\n\t\t\tel: options.target,\r\n\r\n\t\t\ttemplate: template,\r\n\r\n\t\t\tgotoEvents: function ( e ) {\r\n\t\t\t\tjourney.goto( \"/events\" );\r\n\t\t\t\te.preventDefault();\r\n\t\t\t},\r\n\r\n\t\t\tshowJavascript: function ( routeName ) {\r\n\r\n\t\t\t\tsidePanelObj.show( {\r\n\t\t\t\t\text: \"js\"\r\n\t\t\t\t} );\r\n\t\t\t\t// Cancel the click event by returning false, otherwise the link function would execute ie. follow the link href\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\r\n\t\t\tshowHtml: function ( routeName ) {\r\n\t\t\t\tsidePanelObj.show( {\r\n\t\t\t\t\text: \"html\"\r\n\r\n\t\t\t\t} );\r\n\t\t\t\t// Cancel the click event by returning false, otherwise the link function would execute ie. follow the link href\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\t// Create sidePanel instance\r\n\r\n\t\tsidePanelObj = sidePanel( '#side-panel' );\r\n\r\n\t\t// Add highlighting slider to menu\r\n\t\tmenuSlider.init( { fallbackMenu: options.fallbackMenu } );\r\n\r\n\t\tPace.stop();\r\n\r\n\t\tjourney.on( \"entered\", () => {\r\n\t\t\tPace.stop();\r\n\t\t} );\r\n\t},\r\n\r\n\tupdateSlider: selector => {\r\n\t\tlet $li = $( selector );\r\n\t\tmenuSlider.updateSlider( $li );\r\n\t}\r\n};\r\n\r\nexport default menu;\r\n","/*!\r\n * Bootstrap v3.3.7 (http://getbootstrap.com)\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under the MIT license\r\n */\r\n\r\nif (typeof jQuery === 'undefined') {\r\n  throw new Error('Bootstrap\\'s JavaScript requires jQuery')\r\n}\r\n\r\n+function ($) {\r\n  'use strict';\r\n  var version = $.fn.jquery.split(' ')[0].split('.')\r\n  if ((version[0] < 2 && version[1] < 9) || (version[0] == 1 && version[1] == 9 && version[2] < 1) || (version[0] > 3)) {\r\n    throw new Error('Bootstrap\\'s JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4')\r\n  }\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: transition.js v3.3.7\r\n * http://getbootstrap.com/javascript/#transitions\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)\r\n  // ============================================================\r\n\r\n  function transitionEnd() {\r\n    var el = document.createElement('bootstrap')\r\n\r\n    var transEndEventNames = {\r\n      WebkitTransition : 'webkitTransitionEnd',\r\n      MozTransition    : 'transitionend',\r\n      OTransition      : 'oTransitionEnd otransitionend',\r\n      transition       : 'transitionend'\r\n    }\r\n\r\n    for (var name in transEndEventNames) {\r\n      if (el.style[name] !== undefined) {\r\n        return { end: transEndEventNames[name] }\r\n      }\r\n    }\r\n\r\n    return false // explicit for ie8 (  ._.)\r\n  }\r\n\r\n  // http://blog.alexmaccaw.com/css-transitions\r\n  $.fn.emulateTransitionEnd = function (duration) {\r\n    var called = false\r\n    var $el = this\r\n    $(this).one('bsTransitionEnd', function () { called = true })\r\n    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }\r\n    setTimeout(callback, duration)\r\n    return this\r\n  }\r\n\r\n  $(function () {\r\n    $.support.transition = transitionEnd()\r\n\r\n    if (!$.support.transition) return\r\n\r\n    $.event.special.bsTransitionEnd = {\r\n      bindType: $.support.transition.end,\r\n      delegateType: $.support.transition.end,\r\n      handle: function (e) {\r\n        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)\r\n      }\r\n    }\r\n  })\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: alert.js v3.3.7\r\n * http://getbootstrap.com/javascript/#alerts\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // ALERT CLASS DEFINITION\r\n  // ======================\r\n\r\n  var dismiss = '[data-dismiss=\"alert\"]'\r\n  var Alert   = function (el) {\r\n    $(el).on('click', dismiss, this.close)\r\n  }\r\n\r\n  Alert.VERSION = '3.3.7'\r\n\r\n  Alert.TRANSITION_DURATION = 150\r\n\r\n  Alert.prototype.close = function (e) {\r\n    var $this    = $(this)\r\n    var selector = $this.attr('data-target')\r\n\r\n    if (!selector) {\r\n      selector = $this.attr('href')\r\n      selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\r\n    }\r\n\r\n    var $parent = $(selector === '#' ? [] : selector)\r\n\r\n    if (e) e.preventDefault()\r\n\r\n    if (!$parent.length) {\r\n      $parent = $this.closest('.alert')\r\n    }\r\n\r\n    $parent.trigger(e = $.Event('close.bs.alert'))\r\n\r\n    if (e.isDefaultPrevented()) return\r\n\r\n    $parent.removeClass('in')\r\n\r\n    function removeElement() {\r\n      // detach from parent, fire event then clean up data\r\n      $parent.detach().trigger('closed.bs.alert').remove()\r\n    }\r\n\r\n    $.support.transition && $parent.hasClass('fade') ?\r\n      $parent\r\n        .one('bsTransitionEnd', removeElement)\r\n        .emulateTransitionEnd(Alert.TRANSITION_DURATION) :\r\n      removeElement()\r\n  }\r\n\r\n\r\n  // ALERT PLUGIN DEFINITION\r\n  // =======================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this = $(this)\r\n      var data  = $this.data('bs.alert')\r\n\r\n      if (!data) $this.data('bs.alert', (data = new Alert(this)))\r\n      if (typeof option == 'string') data[option].call($this)\r\n    })\r\n  }\r\n\r\n  var old = $.fn.alert\r\n\r\n  $.fn.alert             = Plugin\r\n  $.fn.alert.Constructor = Alert\r\n\r\n\r\n  // ALERT NO CONFLICT\r\n  // =================\r\n\r\n  $.fn.alert.noConflict = function () {\r\n    $.fn.alert = old\r\n    return this\r\n  }\r\n\r\n\r\n  // ALERT DATA-API\r\n  // ==============\r\n\r\n  $(document).on('click.bs.alert.data-api', dismiss, Alert.prototype.close)\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: button.js v3.3.7\r\n * http://getbootstrap.com/javascript/#buttons\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // BUTTON PUBLIC CLASS DEFINITION\r\n  // ==============================\r\n\r\n  var Button = function (element, options) {\r\n    this.$element  = $(element)\r\n    this.options   = $.extend({}, Button.DEFAULTS, options)\r\n    this.isLoading = false\r\n  }\r\n\r\n  Button.VERSION  = '3.3.7'\r\n\r\n  Button.DEFAULTS = {\r\n    loadingText: 'loading...'\r\n  }\r\n\r\n  Button.prototype.setState = function (state) {\r\n    var d    = 'disabled'\r\n    var $el  = this.$element\r\n    var val  = $el.is('input') ? 'val' : 'html'\r\n    var data = $el.data()\r\n\r\n    state += 'Text'\r\n\r\n    if (data.resetText == null) $el.data('resetText', $el[val]())\r\n\r\n    // push to event loop to allow forms to submit\r\n    setTimeout($.proxy(function () {\r\n      $el[val](data[state] == null ? this.options[state] : data[state])\r\n\r\n      if (state == 'loadingText') {\r\n        this.isLoading = true\r\n        $el.addClass(d).attr(d, d).prop(d, true)\r\n      } else if (this.isLoading) {\r\n        this.isLoading = false\r\n        $el.removeClass(d).removeAttr(d).prop(d, false)\r\n      }\r\n    }, this), 0)\r\n  }\r\n\r\n  Button.prototype.toggle = function () {\r\n    var changed = true\r\n    var $parent = this.$element.closest('[data-toggle=\"buttons\"]')\r\n\r\n    if ($parent.length) {\r\n      var $input = this.$element.find('input')\r\n      if ($input.prop('type') == 'radio') {\r\n        if ($input.prop('checked')) changed = false\r\n        $parent.find('.active').removeClass('active')\r\n        this.$element.addClass('active')\r\n      } else if ($input.prop('type') == 'checkbox') {\r\n        if (($input.prop('checked')) !== this.$element.hasClass('active')) changed = false\r\n        this.$element.toggleClass('active')\r\n      }\r\n      $input.prop('checked', this.$element.hasClass('active'))\r\n      if (changed) $input.trigger('change')\r\n    } else {\r\n      this.$element.attr('aria-pressed', !this.$element.hasClass('active'))\r\n      this.$element.toggleClass('active')\r\n    }\r\n  }\r\n\r\n\r\n  // BUTTON PLUGIN DEFINITION\r\n  // ========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.button')\r\n      var options = typeof option == 'object' && option\r\n\r\n      if (!data) $this.data('bs.button', (data = new Button(this, options)))\r\n\r\n      if (option == 'toggle') data.toggle()\r\n      else if (option) data.setState(option)\r\n    })\r\n  }\r\n\r\n  var old = $.fn.button\r\n\r\n  $.fn.button             = Plugin\r\n  $.fn.button.Constructor = Button\r\n\r\n\r\n  // BUTTON NO CONFLICT\r\n  // ==================\r\n\r\n  $.fn.button.noConflict = function () {\r\n    $.fn.button = old\r\n    return this\r\n  }\r\n\r\n\r\n  // BUTTON DATA-API\r\n  // ===============\r\n\r\n  $(document)\r\n    .on('click.bs.button.data-api', '[data-toggle^=\"button\"]', function (e) {\r\n      var $btn = $(e.target).closest('.btn')\r\n      Plugin.call($btn, 'toggle')\r\n      if (!($(e.target).is('input[type=\"radio\"], input[type=\"checkbox\"]'))) {\r\n        // Prevent double click on radios, and the double selections (so cancellation) on checkboxes\r\n        e.preventDefault()\r\n        // The target component still receive the focus\r\n        if ($btn.is('input,button')) $btn.trigger('focus')\r\n        else $btn.find('input:visible,button:visible').first().trigger('focus')\r\n      }\r\n    })\r\n    .on('focus.bs.button.data-api blur.bs.button.data-api', '[data-toggle^=\"button\"]', function (e) {\r\n      $(e.target).closest('.btn').toggleClass('focus', /^focus(in)?$/.test(e.type))\r\n    })\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: carousel.js v3.3.7\r\n * http://getbootstrap.com/javascript/#carousel\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // CAROUSEL CLASS DEFINITION\r\n  // =========================\r\n\r\n  var Carousel = function (element, options) {\r\n    this.$element    = $(element)\r\n    this.$indicators = this.$element.find('.carousel-indicators')\r\n    this.options     = options\r\n    this.paused      = null\r\n    this.sliding     = null\r\n    this.interval    = null\r\n    this.$active     = null\r\n    this.$items      = null\r\n\r\n    this.options.keyboard && this.$element.on('keydown.bs.carousel', $.proxy(this.keydown, this))\r\n\r\n    this.options.pause == 'hover' && !('ontouchstart' in document.documentElement) && this.$element\r\n      .on('mouseenter.bs.carousel', $.proxy(this.pause, this))\r\n      .on('mouseleave.bs.carousel', $.proxy(this.cycle, this))\r\n  }\r\n\r\n  Carousel.VERSION  = '3.3.7'\r\n\r\n  Carousel.TRANSITION_DURATION = 600\r\n\r\n  Carousel.DEFAULTS = {\r\n    interval: 5000,\r\n    pause: 'hover',\r\n    wrap: true,\r\n    keyboard: true\r\n  }\r\n\r\n  Carousel.prototype.keydown = function (e) {\r\n    if (/input|textarea/i.test(e.target.tagName)) return\r\n    switch (e.which) {\r\n      case 37: this.prev(); break\r\n      case 39: this.next(); break\r\n      default: return\r\n    }\r\n\r\n    e.preventDefault()\r\n  }\r\n\r\n  Carousel.prototype.cycle = function (e) {\r\n    e || (this.paused = false)\r\n\r\n    this.interval && clearInterval(this.interval)\r\n\r\n    this.options.interval\r\n      && !this.paused\r\n      && (this.interval = setInterval($.proxy(this.next, this), this.options.interval))\r\n\r\n    return this\r\n  }\r\n\r\n  Carousel.prototype.getItemIndex = function (item) {\r\n    this.$items = item.parent().children('.item')\r\n    return this.$items.index(item || this.$active)\r\n  }\r\n\r\n  Carousel.prototype.getItemForDirection = function (direction, active) {\r\n    var activeIndex = this.getItemIndex(active)\r\n    var willWrap = (direction == 'prev' && activeIndex === 0)\r\n                || (direction == 'next' && activeIndex == (this.$items.length - 1))\r\n    if (willWrap && !this.options.wrap) return active\r\n    var delta = direction == 'prev' ? -1 : 1\r\n    var itemIndex = (activeIndex + delta) % this.$items.length\r\n    return this.$items.eq(itemIndex)\r\n  }\r\n\r\n  Carousel.prototype.to = function (pos) {\r\n    var that        = this\r\n    var activeIndex = this.getItemIndex(this.$active = this.$element.find('.item.active'))\r\n\r\n    if (pos > (this.$items.length - 1) || pos < 0) return\r\n\r\n    if (this.sliding)       return this.$element.one('slid.bs.carousel', function () { that.to(pos) }) // yes, \"slid\"\r\n    if (activeIndex == pos) return this.pause().cycle()\r\n\r\n    return this.slide(pos > activeIndex ? 'next' : 'prev', this.$items.eq(pos))\r\n  }\r\n\r\n  Carousel.prototype.pause = function (e) {\r\n    e || (this.paused = true)\r\n\r\n    if (this.$element.find('.next, .prev').length && $.support.transition) {\r\n      this.$element.trigger($.support.transition.end)\r\n      this.cycle(true)\r\n    }\r\n\r\n    this.interval = clearInterval(this.interval)\r\n\r\n    return this\r\n  }\r\n\r\n  Carousel.prototype.next = function () {\r\n    if (this.sliding) return\r\n    return this.slide('next')\r\n  }\r\n\r\n  Carousel.prototype.prev = function () {\r\n    if (this.sliding) return\r\n    return this.slide('prev')\r\n  }\r\n\r\n  Carousel.prototype.slide = function (type, next) {\r\n    var $active   = this.$element.find('.item.active')\r\n    var $next     = next || this.getItemForDirection(type, $active)\r\n    var isCycling = this.interval\r\n    var direction = type == 'next' ? 'left' : 'right'\r\n    var that      = this\r\n\r\n    if ($next.hasClass('active')) return (this.sliding = false)\r\n\r\n    var relatedTarget = $next[0]\r\n    var slideEvent = $.Event('slide.bs.carousel', {\r\n      relatedTarget: relatedTarget,\r\n      direction: direction\r\n    })\r\n    this.$element.trigger(slideEvent)\r\n    if (slideEvent.isDefaultPrevented()) return\r\n\r\n    this.sliding = true\r\n\r\n    isCycling && this.pause()\r\n\r\n    if (this.$indicators.length) {\r\n      this.$indicators.find('.active').removeClass('active')\r\n      var $nextIndicator = $(this.$indicators.children()[this.getItemIndex($next)])\r\n      $nextIndicator && $nextIndicator.addClass('active')\r\n    }\r\n\r\n    var slidEvent = $.Event('slid.bs.carousel', { relatedTarget: relatedTarget, direction: direction }) // yes, \"slid\"\r\n    if ($.support.transition && this.$element.hasClass('slide')) {\r\n      $next.addClass(type)\r\n      $next[0].offsetWidth // force reflow\r\n      $active.addClass(direction)\r\n      $next.addClass(direction)\r\n      $active\r\n        .one('bsTransitionEnd', function () {\r\n          $next.removeClass([type, direction].join(' ')).addClass('active')\r\n          $active.removeClass(['active', direction].join(' '))\r\n          that.sliding = false\r\n          setTimeout(function () {\r\n            that.$element.trigger(slidEvent)\r\n          }, 0)\r\n        })\r\n        .emulateTransitionEnd(Carousel.TRANSITION_DURATION)\r\n    } else {\r\n      $active.removeClass('active')\r\n      $next.addClass('active')\r\n      this.sliding = false\r\n      this.$element.trigger(slidEvent)\r\n    }\r\n\r\n    isCycling && this.cycle()\r\n\r\n    return this\r\n  }\r\n\r\n\r\n  // CAROUSEL PLUGIN DEFINITION\r\n  // ==========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.carousel')\r\n      var options = $.extend({}, Carousel.DEFAULTS, $this.data(), typeof option == 'object' && option)\r\n      var action  = typeof option == 'string' ? option : options.slide\r\n\r\n      if (!data) $this.data('bs.carousel', (data = new Carousel(this, options)))\r\n      if (typeof option == 'number') data.to(option)\r\n      else if (action) data[action]()\r\n      else if (options.interval) data.pause().cycle()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.carousel\r\n\r\n  $.fn.carousel             = Plugin\r\n  $.fn.carousel.Constructor = Carousel\r\n\r\n\r\n  // CAROUSEL NO CONFLICT\r\n  // ====================\r\n\r\n  $.fn.carousel.noConflict = function () {\r\n    $.fn.carousel = old\r\n    return this\r\n  }\r\n\r\n\r\n  // CAROUSEL DATA-API\r\n  // =================\r\n\r\n  var clickHandler = function (e) {\r\n    var href\r\n    var $this   = $(this)\r\n    var $target = $($this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '')) // strip for ie7\r\n    if (!$target.hasClass('carousel')) return\r\n    var options = $.extend({}, $target.data(), $this.data())\r\n    var slideIndex = $this.attr('data-slide-to')\r\n    if (slideIndex) options.interval = false\r\n\r\n    Plugin.call($target, options)\r\n\r\n    if (slideIndex) {\r\n      $target.data('bs.carousel').to(slideIndex)\r\n    }\r\n\r\n    e.preventDefault()\r\n  }\r\n\r\n  $(document)\r\n    .on('click.bs.carousel.data-api', '[data-slide]', clickHandler)\r\n    .on('click.bs.carousel.data-api', '[data-slide-to]', clickHandler)\r\n\r\n  $(window).on('load', function () {\r\n    $('[data-ride=\"carousel\"]').each(function () {\r\n      var $carousel = $(this)\r\n      Plugin.call($carousel, $carousel.data())\r\n    })\r\n  })\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: collapse.js v3.3.7\r\n * http://getbootstrap.com/javascript/#collapse\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n/* jshint latedef: false */\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // COLLAPSE PUBLIC CLASS DEFINITION\r\n  // ================================\r\n\r\n  var Collapse = function (element, options) {\r\n    this.$element      = $(element)\r\n    this.options       = $.extend({}, Collapse.DEFAULTS, options)\r\n    this.$trigger      = $('[data-toggle=\"collapse\"][href=\"#' + element.id + '\"],' +\r\n                           '[data-toggle=\"collapse\"][data-target=\"#' + element.id + '\"]')\r\n    this.transitioning = null\r\n\r\n    if (this.options.parent) {\r\n      this.$parent = this.getParent()\r\n    } else {\r\n      this.addAriaAndCollapsedClass(this.$element, this.$trigger)\r\n    }\r\n\r\n    if (this.options.toggle) this.toggle()\r\n  }\r\n\r\n  Collapse.VERSION  = '3.3.7'\r\n\r\n  Collapse.TRANSITION_DURATION = 350\r\n\r\n  Collapse.DEFAULTS = {\r\n    toggle: true\r\n  }\r\n\r\n  Collapse.prototype.dimension = function () {\r\n    var hasWidth = this.$element.hasClass('width')\r\n    return hasWidth ? 'width' : 'height'\r\n  }\r\n\r\n  Collapse.prototype.show = function () {\r\n    if (this.transitioning || this.$element.hasClass('in')) return\r\n\r\n    var activesData\r\n    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')\r\n\r\n    if (actives && actives.length) {\r\n      activesData = actives.data('bs.collapse')\r\n      if (activesData && activesData.transitioning) return\r\n    }\r\n\r\n    var startEvent = $.Event('show.bs.collapse')\r\n    this.$element.trigger(startEvent)\r\n    if (startEvent.isDefaultPrevented()) return\r\n\r\n    if (actives && actives.length) {\r\n      Plugin.call(actives, 'hide')\r\n      activesData || actives.data('bs.collapse', null)\r\n    }\r\n\r\n    var dimension = this.dimension()\r\n\r\n    this.$element\r\n      .removeClass('collapse')\r\n      .addClass('collapsing')[dimension](0)\r\n      .attr('aria-expanded', true)\r\n\r\n    this.$trigger\r\n      .removeClass('collapsed')\r\n      .attr('aria-expanded', true)\r\n\r\n    this.transitioning = 1\r\n\r\n    var complete = function () {\r\n      this.$element\r\n        .removeClass('collapsing')\r\n        .addClass('collapse in')[dimension]('')\r\n      this.transitioning = 0\r\n      this.$element\r\n        .trigger('shown.bs.collapse')\r\n    }\r\n\r\n    if (!$.support.transition) return complete.call(this)\r\n\r\n    var scrollSize = $.camelCase(['scroll', dimension].join('-'))\r\n\r\n    this.$element\r\n      .one('bsTransitionEnd', $.proxy(complete, this))\r\n      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])\r\n  }\r\n\r\n  Collapse.prototype.hide = function () {\r\n    if (this.transitioning || !this.$element.hasClass('in')) return\r\n\r\n    var startEvent = $.Event('hide.bs.collapse')\r\n    this.$element.trigger(startEvent)\r\n    if (startEvent.isDefaultPrevented()) return\r\n\r\n    var dimension = this.dimension()\r\n\r\n    this.$element[dimension](this.$element[dimension]())[0].offsetHeight\r\n\r\n    this.$element\r\n      .addClass('collapsing')\r\n      .removeClass('collapse in')\r\n      .attr('aria-expanded', false)\r\n\r\n    this.$trigger\r\n      .addClass('collapsed')\r\n      .attr('aria-expanded', false)\r\n\r\n    this.transitioning = 1\r\n\r\n    var complete = function () {\r\n      this.transitioning = 0\r\n      this.$element\r\n        .removeClass('collapsing')\r\n        .addClass('collapse')\r\n        .trigger('hidden.bs.collapse')\r\n    }\r\n\r\n    if (!$.support.transition) return complete.call(this)\r\n\r\n    this.$element\r\n      [dimension](0)\r\n      .one('bsTransitionEnd', $.proxy(complete, this))\r\n      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)\r\n  }\r\n\r\n  Collapse.prototype.toggle = function () {\r\n    this[this.$element.hasClass('in') ? 'hide' : 'show']()\r\n  }\r\n\r\n  Collapse.prototype.getParent = function () {\r\n    return $(this.options.parent)\r\n      .find('[data-toggle=\"collapse\"][data-parent=\"' + this.options.parent + '\"]')\r\n      .each($.proxy(function (i, element) {\r\n        var $element = $(element)\r\n        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)\r\n      }, this))\r\n      .end()\r\n  }\r\n\r\n  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {\r\n    var isOpen = $element.hasClass('in')\r\n\r\n    $element.attr('aria-expanded', isOpen)\r\n    $trigger\r\n      .toggleClass('collapsed', !isOpen)\r\n      .attr('aria-expanded', isOpen)\r\n  }\r\n\r\n  function getTargetFromTrigger($trigger) {\r\n    var href\r\n    var target = $trigger.attr('data-target')\r\n      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '') // strip for ie7\r\n\r\n    return $(target)\r\n  }\r\n\r\n\r\n  // COLLAPSE PLUGIN DEFINITION\r\n  // ==========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.collapse')\r\n      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)\r\n\r\n      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false\r\n      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.collapse\r\n\r\n  $.fn.collapse             = Plugin\r\n  $.fn.collapse.Constructor = Collapse\r\n\r\n\r\n  // COLLAPSE NO CONFLICT\r\n  // ====================\r\n\r\n  $.fn.collapse.noConflict = function () {\r\n    $.fn.collapse = old\r\n    return this\r\n  }\r\n\r\n\r\n  // COLLAPSE DATA-API\r\n  // =================\r\n\r\n  $(document).on('click.bs.collapse.data-api', '[data-toggle=\"collapse\"]', function (e) {\r\n    var $this   = $(this)\r\n\r\n    if (!$this.attr('data-target')) e.preventDefault()\r\n\r\n    var $target = getTargetFromTrigger($this)\r\n    var data    = $target.data('bs.collapse')\r\n    var option  = data ? 'toggle' : $this.data()\r\n\r\n    Plugin.call($target, option)\r\n  })\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: dropdown.js v3.3.7\r\n * http://getbootstrap.com/javascript/#dropdowns\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // DROPDOWN CLASS DEFINITION\r\n  // =========================\r\n\r\n  var backdrop = '.dropdown-backdrop'\r\n  var toggle   = '[data-toggle=\"dropdown\"]'\r\n  var Dropdown = function (element) {\r\n    $(element).on('click.bs.dropdown', this.toggle)\r\n  }\r\n\r\n  Dropdown.VERSION = '3.3.7'\r\n\r\n  function getParent($this) {\r\n    var selector = $this.attr('data-target')\r\n\r\n    if (!selector) {\r\n      selector = $this.attr('href')\r\n      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\r\n    }\r\n\r\n    var $parent = selector && $(selector)\r\n\r\n    return $parent && $parent.length ? $parent : $this.parent()\r\n  }\r\n\r\n  function clearMenus(e) {\r\n    if (e && e.which === 3) return\r\n    $(backdrop).remove()\r\n    $(toggle).each(function () {\r\n      var $this         = $(this)\r\n      var $parent       = getParent($this)\r\n      var relatedTarget = { relatedTarget: this }\r\n\r\n      if (!$parent.hasClass('open')) return\r\n\r\n      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return\r\n\r\n      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))\r\n\r\n      if (e.isDefaultPrevented()) return\r\n\r\n      $this.attr('aria-expanded', 'false')\r\n      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))\r\n    })\r\n  }\r\n\r\n  Dropdown.prototype.toggle = function (e) {\r\n    var $this = $(this)\r\n\r\n    if ($this.is('.disabled, :disabled')) return\r\n\r\n    var $parent  = getParent($this)\r\n    var isActive = $parent.hasClass('open')\r\n\r\n    clearMenus()\r\n\r\n    if (!isActive) {\r\n      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {\r\n        // if mobile we use a backdrop because click events don't delegate\r\n        $(document.createElement('div'))\r\n          .addClass('dropdown-backdrop')\r\n          .insertAfter($(this))\r\n          .on('click', clearMenus)\r\n      }\r\n\r\n      var relatedTarget = { relatedTarget: this }\r\n      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))\r\n\r\n      if (e.isDefaultPrevented()) return\r\n\r\n      $this\r\n        .trigger('focus')\r\n        .attr('aria-expanded', 'true')\r\n\r\n      $parent\r\n        .toggleClass('open')\r\n        .trigger($.Event('shown.bs.dropdown', relatedTarget))\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  Dropdown.prototype.keydown = function (e) {\r\n    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return\r\n\r\n    var $this = $(this)\r\n\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n\r\n    if ($this.is('.disabled, :disabled')) return\r\n\r\n    var $parent  = getParent($this)\r\n    var isActive = $parent.hasClass('open')\r\n\r\n    if (!isActive && e.which != 27 || isActive && e.which == 27) {\r\n      if (e.which == 27) $parent.find(toggle).trigger('focus')\r\n      return $this.trigger('click')\r\n    }\r\n\r\n    var desc = ' li:not(.disabled):visible a'\r\n    var $items = $parent.find('.dropdown-menu' + desc)\r\n\r\n    if (!$items.length) return\r\n\r\n    var index = $items.index(e.target)\r\n\r\n    if (e.which == 38 && index > 0)                 index--         // up\r\n    if (e.which == 40 && index < $items.length - 1) index++         // down\r\n    if (!~index)                                    index = 0\r\n\r\n    $items.eq(index).trigger('focus')\r\n  }\r\n\r\n\r\n  // DROPDOWN PLUGIN DEFINITION\r\n  // ==========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this = $(this)\r\n      var data  = $this.data('bs.dropdown')\r\n\r\n      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))\r\n      if (typeof option == 'string') data[option].call($this)\r\n    })\r\n  }\r\n\r\n  var old = $.fn.dropdown\r\n\r\n  $.fn.dropdown             = Plugin\r\n  $.fn.dropdown.Constructor = Dropdown\r\n\r\n\r\n  // DROPDOWN NO CONFLICT\r\n  // ====================\r\n\r\n  $.fn.dropdown.noConflict = function () {\r\n    $.fn.dropdown = old\r\n    return this\r\n  }\r\n\r\n\r\n  // APPLY TO STANDARD DROPDOWN ELEMENTS\r\n  // ===================================\r\n\r\n  $(document)\r\n    .on('click.bs.dropdown.data-api', clearMenus)\r\n    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })\r\n    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)\r\n    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)\r\n    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: modal.js v3.3.7\r\n * http://getbootstrap.com/javascript/#modals\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // MODAL CLASS DEFINITION\r\n  // ======================\r\n\r\n  var Modal = function (element, options) {\r\n    this.options             = options\r\n    this.$body               = $(document.body)\r\n    this.$element            = $(element)\r\n    this.$dialog             = this.$element.find('.modal-dialog')\r\n    this.$backdrop           = null\r\n    this.isShown             = null\r\n    this.originalBodyPad     = null\r\n    this.scrollbarWidth      = 0\r\n    this.ignoreBackdropClick = false\r\n\r\n    if (this.options.remote) {\r\n      this.$element\r\n        .find('.modal-content')\r\n        .load(this.options.remote, $.proxy(function () {\r\n          this.$element.trigger('loaded.bs.modal')\r\n        }, this))\r\n    }\r\n  }\r\n\r\n  Modal.VERSION  = '3.3.7'\r\n\r\n  Modal.TRANSITION_DURATION = 300\r\n  Modal.BACKDROP_TRANSITION_DURATION = 150\r\n\r\n  Modal.DEFAULTS = {\r\n    backdrop: true,\r\n    keyboard: true,\r\n    show: true\r\n  }\r\n\r\n  Modal.prototype.toggle = function (_relatedTarget) {\r\n    return this.isShown ? this.hide() : this.show(_relatedTarget)\r\n  }\r\n\r\n  Modal.prototype.show = function (_relatedTarget) {\r\n    var that = this\r\n    var e    = $.Event('show.bs.modal', { relatedTarget: _relatedTarget })\r\n\r\n    this.$element.trigger(e)\r\n\r\n    if (this.isShown || e.isDefaultPrevented()) return\r\n\r\n    this.isShown = true\r\n\r\n    this.checkScrollbar()\r\n    this.setScrollbar()\r\n    this.$body.addClass('modal-open')\r\n\r\n    this.escape()\r\n    this.resize()\r\n\r\n    this.$element.on('click.dismiss.bs.modal', '[data-dismiss=\"modal\"]', $.proxy(this.hide, this))\r\n\r\n    this.$dialog.on('mousedown.dismiss.bs.modal', function () {\r\n      that.$element.one('mouseup.dismiss.bs.modal', function (e) {\r\n        if ($(e.target).is(that.$element)) that.ignoreBackdropClick = true\r\n      })\r\n    })\r\n\r\n    this.backdrop(function () {\r\n      var transition = $.support.transition && that.$element.hasClass('fade')\r\n\r\n      if (!that.$element.parent().length) {\r\n        that.$element.appendTo(that.$body) // don't move modals dom position\r\n      }\r\n\r\n      that.$element\r\n        .show()\r\n        .scrollTop(0)\r\n\r\n      that.adjustDialog()\r\n\r\n      if (transition) {\r\n        that.$element[0].offsetWidth // force reflow\r\n      }\r\n\r\n      that.$element.addClass('in')\r\n\r\n      that.enforceFocus()\r\n\r\n      var e = $.Event('shown.bs.modal', { relatedTarget: _relatedTarget })\r\n\r\n      transition ?\r\n        that.$dialog // wait for modal to slide in\r\n          .one('bsTransitionEnd', function () {\r\n            that.$element.trigger('focus').trigger(e)\r\n          })\r\n          .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\r\n        that.$element.trigger('focus').trigger(e)\r\n    })\r\n  }\r\n\r\n  Modal.prototype.hide = function (e) {\r\n    if (e) e.preventDefault()\r\n\r\n    e = $.Event('hide.bs.modal')\r\n\r\n    this.$element.trigger(e)\r\n\r\n    if (!this.isShown || e.isDefaultPrevented()) return\r\n\r\n    this.isShown = false\r\n\r\n    this.escape()\r\n    this.resize()\r\n\r\n    $(document).off('focusin.bs.modal')\r\n\r\n    this.$element\r\n      .removeClass('in')\r\n      .off('click.dismiss.bs.modal')\r\n      .off('mouseup.dismiss.bs.modal')\r\n\r\n    this.$dialog.off('mousedown.dismiss.bs.modal')\r\n\r\n    $.support.transition && this.$element.hasClass('fade') ?\r\n      this.$element\r\n        .one('bsTransitionEnd', $.proxy(this.hideModal, this))\r\n        .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\r\n      this.hideModal()\r\n  }\r\n\r\n  Modal.prototype.enforceFocus = function () {\r\n    $(document)\r\n      .off('focusin.bs.modal') // guard against infinite focus loop\r\n      .on('focusin.bs.modal', $.proxy(function (e) {\r\n        if (document !== e.target &&\r\n            this.$element[0] !== e.target &&\r\n            !this.$element.has(e.target).length) {\r\n          this.$element.trigger('focus')\r\n        }\r\n      }, this))\r\n  }\r\n\r\n  Modal.prototype.escape = function () {\r\n    if (this.isShown && this.options.keyboard) {\r\n      this.$element.on('keydown.dismiss.bs.modal', $.proxy(function (e) {\r\n        e.which == 27 && this.hide()\r\n      }, this))\r\n    } else if (!this.isShown) {\r\n      this.$element.off('keydown.dismiss.bs.modal')\r\n    }\r\n  }\r\n\r\n  Modal.prototype.resize = function () {\r\n    if (this.isShown) {\r\n      $(window).on('resize.bs.modal', $.proxy(this.handleUpdate, this))\r\n    } else {\r\n      $(window).off('resize.bs.modal')\r\n    }\r\n  }\r\n\r\n  Modal.prototype.hideModal = function () {\r\n    var that = this\r\n    this.$element.hide()\r\n    this.backdrop(function () {\r\n      that.$body.removeClass('modal-open')\r\n      that.resetAdjustments()\r\n      that.resetScrollbar()\r\n      that.$element.trigger('hidden.bs.modal')\r\n    })\r\n  }\r\n\r\n  Modal.prototype.removeBackdrop = function () {\r\n    this.$backdrop && this.$backdrop.remove()\r\n    this.$backdrop = null\r\n  }\r\n\r\n  Modal.prototype.backdrop = function (callback) {\r\n    var that = this\r\n    var animate = this.$element.hasClass('fade') ? 'fade' : ''\r\n\r\n    if (this.isShown && this.options.backdrop) {\r\n      var doAnimate = $.support.transition && animate\r\n\r\n      this.$backdrop = $(document.createElement('div'))\r\n        .addClass('modal-backdrop ' + animate)\r\n        .appendTo(this.$body)\r\n\r\n      this.$element.on('click.dismiss.bs.modal', $.proxy(function (e) {\r\n        if (this.ignoreBackdropClick) {\r\n          this.ignoreBackdropClick = false\r\n          return\r\n        }\r\n        if (e.target !== e.currentTarget) return\r\n        this.options.backdrop == 'static'\r\n          ? this.$element[0].focus()\r\n          : this.hide()\r\n      }, this))\r\n\r\n      if (doAnimate) this.$backdrop[0].offsetWidth // force reflow\r\n\r\n      this.$backdrop.addClass('in')\r\n\r\n      if (!callback) return\r\n\r\n      doAnimate ?\r\n        this.$backdrop\r\n          .one('bsTransitionEnd', callback)\r\n          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\r\n        callback()\r\n\r\n    } else if (!this.isShown && this.$backdrop) {\r\n      this.$backdrop.removeClass('in')\r\n\r\n      var callbackRemove = function () {\r\n        that.removeBackdrop()\r\n        callback && callback()\r\n      }\r\n      $.support.transition && this.$element.hasClass('fade') ?\r\n        this.$backdrop\r\n          .one('bsTransitionEnd', callbackRemove)\r\n          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\r\n        callbackRemove()\r\n\r\n    } else if (callback) {\r\n      callback()\r\n    }\r\n  }\r\n\r\n  // these following methods are used to handle overflowing modals\r\n\r\n  Modal.prototype.handleUpdate = function () {\r\n    this.adjustDialog()\r\n  }\r\n\r\n  Modal.prototype.adjustDialog = function () {\r\n    var modalIsOverflowing = this.$element[0].scrollHeight > document.documentElement.clientHeight\r\n\r\n    this.$element.css({\r\n      paddingLeft:  !this.bodyIsOverflowing && modalIsOverflowing ? this.scrollbarWidth : '',\r\n      paddingRight: this.bodyIsOverflowing && !modalIsOverflowing ? this.scrollbarWidth : ''\r\n    })\r\n  }\r\n\r\n  Modal.prototype.resetAdjustments = function () {\r\n    this.$element.css({\r\n      paddingLeft: '',\r\n      paddingRight: ''\r\n    })\r\n  }\r\n\r\n  Modal.prototype.checkScrollbar = function () {\r\n    var fullWindowWidth = window.innerWidth\r\n    if (!fullWindowWidth) { // workaround for missing window.innerWidth in IE8\r\n      var documentElementRect = document.documentElement.getBoundingClientRect()\r\n      fullWindowWidth = documentElementRect.right - Math.abs(documentElementRect.left)\r\n    }\r\n    this.bodyIsOverflowing = document.body.clientWidth < fullWindowWidth\r\n    this.scrollbarWidth = this.measureScrollbar()\r\n  }\r\n\r\n  Modal.prototype.setScrollbar = function () {\r\n    var bodyPad = parseInt((this.$body.css('padding-right') || 0), 10)\r\n    this.originalBodyPad = document.body.style.paddingRight || ''\r\n    if (this.bodyIsOverflowing) this.$body.css('padding-right', bodyPad + this.scrollbarWidth)\r\n  }\r\n\r\n  Modal.prototype.resetScrollbar = function () {\r\n    this.$body.css('padding-right', this.originalBodyPad)\r\n  }\r\n\r\n  Modal.prototype.measureScrollbar = function () { // thx walsh\r\n    var scrollDiv = document.createElement('div')\r\n    scrollDiv.className = 'modal-scrollbar-measure'\r\n    this.$body.append(scrollDiv)\r\n    var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth\r\n    this.$body[0].removeChild(scrollDiv)\r\n    return scrollbarWidth\r\n  }\r\n\r\n\r\n  // MODAL PLUGIN DEFINITION\r\n  // =======================\r\n\r\n  function Plugin(option, _relatedTarget) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.modal')\r\n      var options = $.extend({}, Modal.DEFAULTS, $this.data(), typeof option == 'object' && option)\r\n\r\n      if (!data) $this.data('bs.modal', (data = new Modal(this, options)))\r\n      if (typeof option == 'string') data[option](_relatedTarget)\r\n      else if (options.show) data.show(_relatedTarget)\r\n    })\r\n  }\r\n\r\n  var old = $.fn.modal\r\n\r\n  $.fn.modal             = Plugin\r\n  $.fn.modal.Constructor = Modal\r\n\r\n\r\n  // MODAL NO CONFLICT\r\n  // =================\r\n\r\n  $.fn.modal.noConflict = function () {\r\n    $.fn.modal = old\r\n    return this\r\n  }\r\n\r\n\r\n  // MODAL DATA-API\r\n  // ==============\r\n\r\n  $(document).on('click.bs.modal.data-api', '[data-toggle=\"modal\"]', function (e) {\r\n    var $this   = $(this)\r\n    var href    = $this.attr('href')\r\n    var $target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\\s]+$)/, ''))) // strip for ie7\r\n    var option  = $target.data('bs.modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data())\r\n\r\n    if ($this.is('a')) e.preventDefault()\r\n\r\n    $target.one('show.bs.modal', function (showEvent) {\r\n      if (showEvent.isDefaultPrevented()) return // only register focus restorer if modal will actually get shown\r\n      $target.one('hidden.bs.modal', function () {\r\n        $this.is(':visible') && $this.trigger('focus')\r\n      })\r\n    })\r\n    Plugin.call($target, option, this)\r\n  })\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: tooltip.js v3.3.7\r\n * http://getbootstrap.com/javascript/#tooltip\r\n * Inspired by the original jQuery.tipsy by Jason Frame\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // TOOLTIP PUBLIC CLASS DEFINITION\r\n  // ===============================\r\n\r\n  var Tooltip = function (element, options) {\r\n    this.type       = null\r\n    this.options    = null\r\n    this.enabled    = null\r\n    this.timeout    = null\r\n    this.hoverState = null\r\n    this.$element   = null\r\n    this.inState    = null\r\n\r\n    this.init('tooltip', element, options)\r\n  }\r\n\r\n  Tooltip.VERSION  = '3.3.7'\r\n\r\n  Tooltip.TRANSITION_DURATION = 150\r\n\r\n  Tooltip.DEFAULTS = {\r\n    animation: true,\r\n    placement: 'top',\r\n    selector: false,\r\n    template: '<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',\r\n    trigger: 'hover focus',\r\n    title: '',\r\n    delay: 0,\r\n    html: false,\r\n    container: false,\r\n    viewport: {\r\n      selector: 'body',\r\n      padding: 0\r\n    }\r\n  }\r\n\r\n  Tooltip.prototype.init = function (type, element, options) {\r\n    this.enabled   = true\r\n    this.type      = type\r\n    this.$element  = $(element)\r\n    this.options   = this.getOptions(options)\r\n    this.$viewport = this.options.viewport && $($.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : (this.options.viewport.selector || this.options.viewport))\r\n    this.inState   = { click: false, hover: false, focus: false }\r\n\r\n    if (this.$element[0] instanceof document.constructor && !this.options.selector) {\r\n      throw new Error('`selector` option must be specified when initializing ' + this.type + ' on the window.document object!')\r\n    }\r\n\r\n    var triggers = this.options.trigger.split(' ')\r\n\r\n    for (var i = triggers.length; i--;) {\r\n      var trigger = triggers[i]\r\n\r\n      if (trigger == 'click') {\r\n        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))\r\n      } else if (trigger != 'manual') {\r\n        var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'\r\n        var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'\r\n\r\n        this.$element.on(eventIn  + '.' + this.type, this.options.selector, $.proxy(this.enter, this))\r\n        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))\r\n      }\r\n    }\r\n\r\n    this.options.selector ?\r\n      (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :\r\n      this.fixTitle()\r\n  }\r\n\r\n  Tooltip.prototype.getDefaults = function () {\r\n    return Tooltip.DEFAULTS\r\n  }\r\n\r\n  Tooltip.prototype.getOptions = function (options) {\r\n    options = $.extend({}, this.getDefaults(), this.$element.data(), options)\r\n\r\n    if (options.delay && typeof options.delay == 'number') {\r\n      options.delay = {\r\n        show: options.delay,\r\n        hide: options.delay\r\n      }\r\n    }\r\n\r\n    return options\r\n  }\r\n\r\n  Tooltip.prototype.getDelegateOptions = function () {\r\n    var options  = {}\r\n    var defaults = this.getDefaults()\r\n\r\n    this._options && $.each(this._options, function (key, value) {\r\n      if (defaults[key] != value) options[key] = value\r\n    })\r\n\r\n    return options\r\n  }\r\n\r\n  Tooltip.prototype.enter = function (obj) {\r\n    var self = obj instanceof this.constructor ?\r\n      obj : $(obj.currentTarget).data('bs.' + this.type)\r\n\r\n    if (!self) {\r\n      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\r\n      $(obj.currentTarget).data('bs.' + this.type, self)\r\n    }\r\n\r\n    if (obj instanceof $.Event) {\r\n      self.inState[obj.type == 'focusin' ? 'focus' : 'hover'] = true\r\n    }\r\n\r\n    if (self.tip().hasClass('in') || self.hoverState == 'in') {\r\n      self.hoverState = 'in'\r\n      return\r\n    }\r\n\r\n    clearTimeout(self.timeout)\r\n\r\n    self.hoverState = 'in'\r\n\r\n    if (!self.options.delay || !self.options.delay.show) return self.show()\r\n\r\n    self.timeout = setTimeout(function () {\r\n      if (self.hoverState == 'in') self.show()\r\n    }, self.options.delay.show)\r\n  }\r\n\r\n  Tooltip.prototype.isInStateTrue = function () {\r\n    for (var key in this.inState) {\r\n      if (this.inState[key]) return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  Tooltip.prototype.leave = function (obj) {\r\n    var self = obj instanceof this.constructor ?\r\n      obj : $(obj.currentTarget).data('bs.' + this.type)\r\n\r\n    if (!self) {\r\n      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\r\n      $(obj.currentTarget).data('bs.' + this.type, self)\r\n    }\r\n\r\n    if (obj instanceof $.Event) {\r\n      self.inState[obj.type == 'focusout' ? 'focus' : 'hover'] = false\r\n    }\r\n\r\n    if (self.isInStateTrue()) return\r\n\r\n    clearTimeout(self.timeout)\r\n\r\n    self.hoverState = 'out'\r\n\r\n    if (!self.options.delay || !self.options.delay.hide) return self.hide()\r\n\r\n    self.timeout = setTimeout(function () {\r\n      if (self.hoverState == 'out') self.hide()\r\n    }, self.options.delay.hide)\r\n  }\r\n\r\n  Tooltip.prototype.show = function () {\r\n    var e = $.Event('show.bs.' + this.type)\r\n\r\n    if (this.hasContent() && this.enabled) {\r\n      this.$element.trigger(e)\r\n\r\n      var inDom = $.contains(this.$element[0].ownerDocument.documentElement, this.$element[0])\r\n      if (e.isDefaultPrevented() || !inDom) return\r\n      var that = this\r\n\r\n      var $tip = this.tip()\r\n\r\n      var tipId = this.getUID(this.type)\r\n\r\n      this.setContent()\r\n      $tip.attr('id', tipId)\r\n      this.$element.attr('aria-describedby', tipId)\r\n\r\n      if (this.options.animation) $tip.addClass('fade')\r\n\r\n      var placement = typeof this.options.placement == 'function' ?\r\n        this.options.placement.call(this, $tip[0], this.$element[0]) :\r\n        this.options.placement\r\n\r\n      var autoToken = /\\s?auto?\\s?/i\r\n      var autoPlace = autoToken.test(placement)\r\n      if (autoPlace) placement = placement.replace(autoToken, '') || 'top'\r\n\r\n      $tip\r\n        .detach()\r\n        .css({ top: 0, left: 0, display: 'block' })\r\n        .addClass(placement)\r\n        .data('bs.' + this.type, this)\r\n\r\n      this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)\r\n      this.$element.trigger('inserted.bs.' + this.type)\r\n\r\n      var pos          = this.getPosition()\r\n      var actualWidth  = $tip[0].offsetWidth\r\n      var actualHeight = $tip[0].offsetHeight\r\n\r\n      if (autoPlace) {\r\n        var orgPlacement = placement\r\n        var viewportDim = this.getPosition(this.$viewport)\r\n\r\n        placement = placement == 'bottom' && pos.bottom + actualHeight > viewportDim.bottom ? 'top'    :\r\n                    placement == 'top'    && pos.top    - actualHeight < viewportDim.top    ? 'bottom' :\r\n                    placement == 'right'  && pos.right  + actualWidth  > viewportDim.width  ? 'left'   :\r\n                    placement == 'left'   && pos.left   - actualWidth  < viewportDim.left   ? 'right'  :\r\n                    placement\r\n\r\n        $tip\r\n          .removeClass(orgPlacement)\r\n          .addClass(placement)\r\n      }\r\n\r\n      var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)\r\n\r\n      this.applyPlacement(calculatedOffset, placement)\r\n\r\n      var complete = function () {\r\n        var prevHoverState = that.hoverState\r\n        that.$element.trigger('shown.bs.' + that.type)\r\n        that.hoverState = null\r\n\r\n        if (prevHoverState == 'out') that.leave(that)\r\n      }\r\n\r\n      $.support.transition && this.$tip.hasClass('fade') ?\r\n        $tip\r\n          .one('bsTransitionEnd', complete)\r\n          .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\r\n        complete()\r\n    }\r\n  }\r\n\r\n  Tooltip.prototype.applyPlacement = function (offset, placement) {\r\n    var $tip   = this.tip()\r\n    var width  = $tip[0].offsetWidth\r\n    var height = $tip[0].offsetHeight\r\n\r\n    // manually read margins because getBoundingClientRect includes difference\r\n    var marginTop = parseInt($tip.css('margin-top'), 10)\r\n    var marginLeft = parseInt($tip.css('margin-left'), 10)\r\n\r\n    // we must check for NaN for ie 8/9\r\n    if (isNaN(marginTop))  marginTop  = 0\r\n    if (isNaN(marginLeft)) marginLeft = 0\r\n\r\n    offset.top  += marginTop\r\n    offset.left += marginLeft\r\n\r\n    // $.fn.offset doesn't round pixel values\r\n    // so we use setOffset directly with our own function B-0\r\n    $.offset.setOffset($tip[0], $.extend({\r\n      using: function (props) {\r\n        $tip.css({\r\n          top: Math.round(props.top),\r\n          left: Math.round(props.left)\r\n        })\r\n      }\r\n    }, offset), 0)\r\n\r\n    $tip.addClass('in')\r\n\r\n    // check to see if placing tip in new offset caused the tip to resize itself\r\n    var actualWidth  = $tip[0].offsetWidth\r\n    var actualHeight = $tip[0].offsetHeight\r\n\r\n    if (placement == 'top' && actualHeight != height) {\r\n      offset.top = offset.top + height - actualHeight\r\n    }\r\n\r\n    var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)\r\n\r\n    if (delta.left) offset.left += delta.left\r\n    else offset.top += delta.top\r\n\r\n    var isVertical          = /top|bottom/.test(placement)\r\n    var arrowDelta          = isVertical ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight\r\n    var arrowOffsetPosition = isVertical ? 'offsetWidth' : 'offsetHeight'\r\n\r\n    $tip.offset(offset)\r\n    this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], isVertical)\r\n  }\r\n\r\n  Tooltip.prototype.replaceArrow = function (delta, dimension, isVertical) {\r\n    this.arrow()\r\n      .css(isVertical ? 'left' : 'top', 50 * (1 - delta / dimension) + '%')\r\n      .css(isVertical ? 'top' : 'left', '')\r\n  }\r\n\r\n  Tooltip.prototype.setContent = function () {\r\n    var $tip  = this.tip()\r\n    var title = this.getTitle()\r\n\r\n    $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)\r\n    $tip.removeClass('fade in top bottom left right')\r\n  }\r\n\r\n  Tooltip.prototype.hide = function (callback) {\r\n    var that = this\r\n    var $tip = $(this.$tip)\r\n    var e    = $.Event('hide.bs.' + this.type)\r\n\r\n    function complete() {\r\n      if (that.hoverState != 'in') $tip.detach()\r\n      if (that.$element) { // TODO: Check whether guarding this code with this `if` is really necessary.\r\n        that.$element\r\n          .removeAttr('aria-describedby')\r\n          .trigger('hidden.bs.' + that.type)\r\n      }\r\n      callback && callback()\r\n    }\r\n\r\n    this.$element.trigger(e)\r\n\r\n    if (e.isDefaultPrevented()) return\r\n\r\n    $tip.removeClass('in')\r\n\r\n    $.support.transition && $tip.hasClass('fade') ?\r\n      $tip\r\n        .one('bsTransitionEnd', complete)\r\n        .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\r\n      complete()\r\n\r\n    this.hoverState = null\r\n\r\n    return this\r\n  }\r\n\r\n  Tooltip.prototype.fixTitle = function () {\r\n    var $e = this.$element\r\n    if ($e.attr('title') || typeof $e.attr('data-original-title') != 'string') {\r\n      $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')\r\n    }\r\n  }\r\n\r\n  Tooltip.prototype.hasContent = function () {\r\n    return this.getTitle()\r\n  }\r\n\r\n  Tooltip.prototype.getPosition = function ($element) {\r\n    $element   = $element || this.$element\r\n\r\n    var el     = $element[0]\r\n    var isBody = el.tagName == 'BODY'\r\n\r\n    var elRect    = el.getBoundingClientRect()\r\n    if (elRect.width == null) {\r\n      // width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093\r\n      elRect = $.extend({}, elRect, { width: elRect.right - elRect.left, height: elRect.bottom - elRect.top })\r\n    }\r\n    var isSvg = window.SVGElement && el instanceof window.SVGElement\r\n    // Avoid using $.offset() on SVGs since it gives incorrect results in jQuery 3.\r\n    // See https://github.com/twbs/bootstrap/issues/20280\r\n    var elOffset  = isBody ? { top: 0, left: 0 } : (isSvg ? null : $element.offset())\r\n    var scroll    = { scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop() }\r\n    var outerDims = isBody ? { width: $(window).width(), height: $(window).height() } : null\r\n\r\n    return $.extend({}, elRect, scroll, outerDims, elOffset)\r\n  }\r\n\r\n  Tooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {\r\n    return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2 } :\r\n           placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2 } :\r\n           placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :\r\n        /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width }\r\n\r\n  }\r\n\r\n  Tooltip.prototype.getViewportAdjustedDelta = function (placement, pos, actualWidth, actualHeight) {\r\n    var delta = { top: 0, left: 0 }\r\n    if (!this.$viewport) return delta\r\n\r\n    var viewportPadding = this.options.viewport && this.options.viewport.padding || 0\r\n    var viewportDimensions = this.getPosition(this.$viewport)\r\n\r\n    if (/right|left/.test(placement)) {\r\n      var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll\r\n      var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight\r\n      if (topEdgeOffset < viewportDimensions.top) { // top overflow\r\n        delta.top = viewportDimensions.top - topEdgeOffset\r\n      } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow\r\n        delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset\r\n      }\r\n    } else {\r\n      var leftEdgeOffset  = pos.left - viewportPadding\r\n      var rightEdgeOffset = pos.left + viewportPadding + actualWidth\r\n      if (leftEdgeOffset < viewportDimensions.left) { // left overflow\r\n        delta.left = viewportDimensions.left - leftEdgeOffset\r\n      } else if (rightEdgeOffset > viewportDimensions.right) { // right overflow\r\n        delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset\r\n      }\r\n    }\r\n\r\n    return delta\r\n  }\r\n\r\n  Tooltip.prototype.getTitle = function () {\r\n    var title\r\n    var $e = this.$element\r\n    var o  = this.options\r\n\r\n    title = $e.attr('data-original-title')\r\n      || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)\r\n\r\n    return title\r\n  }\r\n\r\n  Tooltip.prototype.getUID = function (prefix) {\r\n    do prefix += ~~(Math.random() * 1000000)\r\n    while (document.getElementById(prefix))\r\n    return prefix\r\n  }\r\n\r\n  Tooltip.prototype.tip = function () {\r\n    if (!this.$tip) {\r\n      this.$tip = $(this.options.template)\r\n      if (this.$tip.length != 1) {\r\n        throw new Error(this.type + ' `template` option must consist of exactly 1 top-level element!')\r\n      }\r\n    }\r\n    return this.$tip\r\n  }\r\n\r\n  Tooltip.prototype.arrow = function () {\r\n    return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))\r\n  }\r\n\r\n  Tooltip.prototype.enable = function () {\r\n    this.enabled = true\r\n  }\r\n\r\n  Tooltip.prototype.disable = function () {\r\n    this.enabled = false\r\n  }\r\n\r\n  Tooltip.prototype.toggleEnabled = function () {\r\n    this.enabled = !this.enabled\r\n  }\r\n\r\n  Tooltip.prototype.toggle = function (e) {\r\n    var self = this\r\n    if (e) {\r\n      self = $(e.currentTarget).data('bs.' + this.type)\r\n      if (!self) {\r\n        self = new this.constructor(e.currentTarget, this.getDelegateOptions())\r\n        $(e.currentTarget).data('bs.' + this.type, self)\r\n      }\r\n    }\r\n\r\n    if (e) {\r\n      self.inState.click = !self.inState.click\r\n      if (self.isInStateTrue()) self.enter(self)\r\n      else self.leave(self)\r\n    } else {\r\n      self.tip().hasClass('in') ? self.leave(self) : self.enter(self)\r\n    }\r\n  }\r\n\r\n  Tooltip.prototype.destroy = function () {\r\n    var that = this\r\n    clearTimeout(this.timeout)\r\n    this.hide(function () {\r\n      that.$element.off('.' + that.type).removeData('bs.' + that.type)\r\n      if (that.$tip) {\r\n        that.$tip.detach()\r\n      }\r\n      that.$tip = null\r\n      that.$arrow = null\r\n      that.$viewport = null\r\n      that.$element = null\r\n    })\r\n  }\r\n\r\n\r\n  // TOOLTIP PLUGIN DEFINITION\r\n  // =========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.tooltip')\r\n      var options = typeof option == 'object' && option\r\n\r\n      if (!data && /destroy|hide/.test(option)) return\r\n      if (!data) $this.data('bs.tooltip', (data = new Tooltip(this, options)))\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.tooltip\r\n\r\n  $.fn.tooltip             = Plugin\r\n  $.fn.tooltip.Constructor = Tooltip\r\n\r\n\r\n  // TOOLTIP NO CONFLICT\r\n  // ===================\r\n\r\n  $.fn.tooltip.noConflict = function () {\r\n    $.fn.tooltip = old\r\n    return this\r\n  }\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: popover.js v3.3.7\r\n * http://getbootstrap.com/javascript/#popovers\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // POPOVER PUBLIC CLASS DEFINITION\r\n  // ===============================\r\n\r\n  var Popover = function (element, options) {\r\n    this.init('popover', element, options)\r\n  }\r\n\r\n  if (!$.fn.tooltip) throw new Error('Popover requires tooltip.js')\r\n\r\n  Popover.VERSION  = '3.3.7'\r\n\r\n  Popover.DEFAULTS = $.extend({}, $.fn.tooltip.Constructor.DEFAULTS, {\r\n    placement: 'right',\r\n    trigger: 'click',\r\n    content: '',\r\n    template: '<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'\r\n  })\r\n\r\n\r\n  // NOTE: POPOVER EXTENDS tooltip.js\r\n  // ================================\r\n\r\n  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype)\r\n\r\n  Popover.prototype.constructor = Popover\r\n\r\n  Popover.prototype.getDefaults = function () {\r\n    return Popover.DEFAULTS\r\n  }\r\n\r\n  Popover.prototype.setContent = function () {\r\n    var $tip    = this.tip()\r\n    var title   = this.getTitle()\r\n    var content = this.getContent()\r\n\r\n    $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)\r\n    $tip.find('.popover-content').children().detach().end()[ // we use append for html objects to maintain js events\r\n      this.options.html ? (typeof content == 'string' ? 'html' : 'append') : 'text'\r\n    ](content)\r\n\r\n    $tip.removeClass('fade top bottom left right in')\r\n\r\n    // IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do\r\n    // this manually by checking the contents.\r\n    if (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide()\r\n  }\r\n\r\n  Popover.prototype.hasContent = function () {\r\n    return this.getTitle() || this.getContent()\r\n  }\r\n\r\n  Popover.prototype.getContent = function () {\r\n    var $e = this.$element\r\n    var o  = this.options\r\n\r\n    return $e.attr('data-content')\r\n      || (typeof o.content == 'function' ?\r\n            o.content.call($e[0]) :\r\n            o.content)\r\n  }\r\n\r\n  Popover.prototype.arrow = function () {\r\n    return (this.$arrow = this.$arrow || this.tip().find('.arrow'))\r\n  }\r\n\r\n\r\n  // POPOVER PLUGIN DEFINITION\r\n  // =========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.popover')\r\n      var options = typeof option == 'object' && option\r\n\r\n      if (!data && /destroy|hide/.test(option)) return\r\n      if (!data) $this.data('bs.popover', (data = new Popover(this, options)))\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.popover\r\n\r\n  $.fn.popover             = Plugin\r\n  $.fn.popover.Constructor = Popover\r\n\r\n\r\n  // POPOVER NO CONFLICT\r\n  // ===================\r\n\r\n  $.fn.popover.noConflict = function () {\r\n    $.fn.popover = old\r\n    return this\r\n  }\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: scrollspy.js v3.3.7\r\n * http://getbootstrap.com/javascript/#scrollspy\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // SCROLLSPY CLASS DEFINITION\r\n  // ==========================\r\n\r\n  function ScrollSpy(element, options) {\r\n    this.$body          = $(document.body)\r\n    this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)\r\n    this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)\r\n    this.selector       = (this.options.target || '') + ' .nav li > a'\r\n    this.offsets        = []\r\n    this.targets        = []\r\n    this.activeTarget   = null\r\n    this.scrollHeight   = 0\r\n\r\n    this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))\r\n    this.refresh()\r\n    this.process()\r\n  }\r\n\r\n  ScrollSpy.VERSION  = '3.3.7'\r\n\r\n  ScrollSpy.DEFAULTS = {\r\n    offset: 10\r\n  }\r\n\r\n  ScrollSpy.prototype.getScrollHeight = function () {\r\n    return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)\r\n  }\r\n\r\n  ScrollSpy.prototype.refresh = function () {\r\n    var that          = this\r\n    var offsetMethod  = 'offset'\r\n    var offsetBase    = 0\r\n\r\n    this.offsets      = []\r\n    this.targets      = []\r\n    this.scrollHeight = this.getScrollHeight()\r\n\r\n    if (!$.isWindow(this.$scrollElement[0])) {\r\n      offsetMethod = 'position'\r\n      offsetBase   = this.$scrollElement.scrollTop()\r\n    }\r\n\r\n    this.$body\r\n      .find(this.selector)\r\n      .map(function () {\r\n        var $el   = $(this)\r\n        var href  = $el.data('target') || $el.attr('href')\r\n        var $href = /^#./.test(href) && $(href)\r\n\r\n        return ($href\r\n          && $href.length\r\n          && $href.is(':visible')\r\n          && [[$href[offsetMethod]().top + offsetBase, href]]) || null\r\n      })\r\n      .sort(function (a, b) { return a[0] - b[0] })\r\n      .each(function () {\r\n        that.offsets.push(this[0])\r\n        that.targets.push(this[1])\r\n      })\r\n  }\r\n\r\n  ScrollSpy.prototype.process = function () {\r\n    var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset\r\n    var scrollHeight = this.getScrollHeight()\r\n    var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()\r\n    var offsets      = this.offsets\r\n    var targets      = this.targets\r\n    var activeTarget = this.activeTarget\r\n    var i\r\n\r\n    if (this.scrollHeight != scrollHeight) {\r\n      this.refresh()\r\n    }\r\n\r\n    if (scrollTop >= maxScroll) {\r\n      return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)\r\n    }\r\n\r\n    if (activeTarget && scrollTop < offsets[0]) {\r\n      this.activeTarget = null\r\n      return this.clear()\r\n    }\r\n\r\n    for (i = offsets.length; i--;) {\r\n      activeTarget != targets[i]\r\n        && scrollTop >= offsets[i]\r\n        && (offsets[i + 1] === undefined || scrollTop < offsets[i + 1])\r\n        && this.activate(targets[i])\r\n    }\r\n  }\r\n\r\n  ScrollSpy.prototype.activate = function (target) {\r\n    this.activeTarget = target\r\n\r\n    this.clear()\r\n\r\n    var selector = this.selector +\r\n      '[data-target=\"' + target + '\"],' +\r\n      this.selector + '[href=\"' + target + '\"]'\r\n\r\n    var active = $(selector)\r\n      .parents('li')\r\n      .addClass('active')\r\n\r\n    if (active.parent('.dropdown-menu').length) {\r\n      active = active\r\n        .closest('li.dropdown')\r\n        .addClass('active')\r\n    }\r\n\r\n    active.trigger('activate.bs.scrollspy')\r\n  }\r\n\r\n  ScrollSpy.prototype.clear = function () {\r\n    $(this.selector)\r\n      .parentsUntil(this.options.target, '.active')\r\n      .removeClass('active')\r\n  }\r\n\r\n\r\n  // SCROLLSPY PLUGIN DEFINITION\r\n  // ===========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.scrollspy')\r\n      var options = typeof option == 'object' && option\r\n\r\n      if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.scrollspy\r\n\r\n  $.fn.scrollspy             = Plugin\r\n  $.fn.scrollspy.Constructor = ScrollSpy\r\n\r\n\r\n  // SCROLLSPY NO CONFLICT\r\n  // =====================\r\n\r\n  $.fn.scrollspy.noConflict = function () {\r\n    $.fn.scrollspy = old\r\n    return this\r\n  }\r\n\r\n\r\n  // SCROLLSPY DATA-API\r\n  // ==================\r\n\r\n  $(window).on('load.bs.scrollspy.data-api', function () {\r\n    $('[data-spy=\"scroll\"]').each(function () {\r\n      var $spy = $(this)\r\n      Plugin.call($spy, $spy.data())\r\n    })\r\n  })\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: tab.js v3.3.7\r\n * http://getbootstrap.com/javascript/#tabs\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // TAB CLASS DEFINITION\r\n  // ====================\r\n\r\n  var Tab = function (element) {\r\n    // jscs:disable requireDollarBeforejQueryAssignment\r\n    this.element = $(element)\r\n    // jscs:enable requireDollarBeforejQueryAssignment\r\n  }\r\n\r\n  Tab.VERSION = '3.3.7'\r\n\r\n  Tab.TRANSITION_DURATION = 150\r\n\r\n  Tab.prototype.show = function () {\r\n    var $this    = this.element\r\n    var $ul      = $this.closest('ul:not(.dropdown-menu)')\r\n    var selector = $this.data('target')\r\n\r\n    if (!selector) {\r\n      selector = $this.attr('href')\r\n      selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\r\n    }\r\n\r\n    if ($this.parent('li').hasClass('active')) return\r\n\r\n    var $previous = $ul.find('.active:last a')\r\n    var hideEvent = $.Event('hide.bs.tab', {\r\n      relatedTarget: $this[0]\r\n    })\r\n    var showEvent = $.Event('show.bs.tab', {\r\n      relatedTarget: $previous[0]\r\n    })\r\n\r\n    $previous.trigger(hideEvent)\r\n    $this.trigger(showEvent)\r\n\r\n    if (showEvent.isDefaultPrevented() || hideEvent.isDefaultPrevented()) return\r\n\r\n    var $target = $(selector)\r\n\r\n    this.activate($this.closest('li'), $ul)\r\n    this.activate($target, $target.parent(), function () {\r\n      $previous.trigger({\r\n        type: 'hidden.bs.tab',\r\n        relatedTarget: $this[0]\r\n      })\r\n      $this.trigger({\r\n        type: 'shown.bs.tab',\r\n        relatedTarget: $previous[0]\r\n      })\r\n    })\r\n  }\r\n\r\n  Tab.prototype.activate = function (element, container, callback) {\r\n    var $active    = container.find('> .active')\r\n    var transition = callback\r\n      && $.support.transition\r\n      && ($active.length && $active.hasClass('fade') || !!container.find('> .fade').length)\r\n\r\n    function next() {\r\n      $active\r\n        .removeClass('active')\r\n        .find('> .dropdown-menu > .active')\r\n          .removeClass('active')\r\n        .end()\r\n        .find('[data-toggle=\"tab\"]')\r\n          .attr('aria-expanded', false)\r\n\r\n      element\r\n        .addClass('active')\r\n        .find('[data-toggle=\"tab\"]')\r\n          .attr('aria-expanded', true)\r\n\r\n      if (transition) {\r\n        element[0].offsetWidth // reflow for transition\r\n        element.addClass('in')\r\n      } else {\r\n        element.removeClass('fade')\r\n      }\r\n\r\n      if (element.parent('.dropdown-menu').length) {\r\n        element\r\n          .closest('li.dropdown')\r\n            .addClass('active')\r\n          .end()\r\n          .find('[data-toggle=\"tab\"]')\r\n            .attr('aria-expanded', true)\r\n      }\r\n\r\n      callback && callback()\r\n    }\r\n\r\n    $active.length && transition ?\r\n      $active\r\n        .one('bsTransitionEnd', next)\r\n        .emulateTransitionEnd(Tab.TRANSITION_DURATION) :\r\n      next()\r\n\r\n    $active.removeClass('in')\r\n  }\r\n\r\n\r\n  // TAB PLUGIN DEFINITION\r\n  // =====================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this = $(this)\r\n      var data  = $this.data('bs.tab')\r\n\r\n      if (!data) $this.data('bs.tab', (data = new Tab(this)))\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.tab\r\n\r\n  $.fn.tab             = Plugin\r\n  $.fn.tab.Constructor = Tab\r\n\r\n\r\n  // TAB NO CONFLICT\r\n  // ===============\r\n\r\n  $.fn.tab.noConflict = function () {\r\n    $.fn.tab = old\r\n    return this\r\n  }\r\n\r\n\r\n  // TAB DATA-API\r\n  // ============\r\n\r\n  var clickHandler = function (e) {\r\n    e.preventDefault()\r\n    Plugin.call($(this), 'show')\r\n  }\r\n\r\n  $(document)\r\n    .on('click.bs.tab.data-api', '[data-toggle=\"tab\"]', clickHandler)\r\n    .on('click.bs.tab.data-api', '[data-toggle=\"pill\"]', clickHandler)\r\n\r\n}(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: affix.js v3.3.7\r\n * http://getbootstrap.com/javascript/#affix\r\n * ========================================================================\r\n * Copyright 2011-2016 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n+function ($) {\r\n  'use strict';\r\n\r\n  // AFFIX CLASS DEFINITION\r\n  // ======================\r\n\r\n  var Affix = function (element, options) {\r\n    this.options = $.extend({}, Affix.DEFAULTS, options)\r\n\r\n    this.$target = $(this.options.target)\r\n      .on('scroll.bs.affix.data-api', $.proxy(this.checkPosition, this))\r\n      .on('click.bs.affix.data-api',  $.proxy(this.checkPositionWithEventLoop, this))\r\n\r\n    this.$element     = $(element)\r\n    this.affixed      = null\r\n    this.unpin        = null\r\n    this.pinnedOffset = null\r\n\r\n    this.checkPosition()\r\n  }\r\n\r\n  Affix.VERSION  = '3.3.7'\r\n\r\n  Affix.RESET    = 'affix affix-top affix-bottom'\r\n\r\n  Affix.DEFAULTS = {\r\n    offset: 0,\r\n    target: window\r\n  }\r\n\r\n  Affix.prototype.getState = function (scrollHeight, height, offsetTop, offsetBottom) {\r\n    var scrollTop    = this.$target.scrollTop()\r\n    var position     = this.$element.offset()\r\n    var targetHeight = this.$target.height()\r\n\r\n    if (offsetTop != null && this.affixed == 'top') return scrollTop < offsetTop ? 'top' : false\r\n\r\n    if (this.affixed == 'bottom') {\r\n      if (offsetTop != null) return (scrollTop + this.unpin <= position.top) ? false : 'bottom'\r\n      return (scrollTop + targetHeight <= scrollHeight - offsetBottom) ? false : 'bottom'\r\n    }\r\n\r\n    var initializing   = this.affixed == null\r\n    var colliderTop    = initializing ? scrollTop : position.top\r\n    var colliderHeight = initializing ? targetHeight : height\r\n\r\n    if (offsetTop != null && scrollTop <= offsetTop) return 'top'\r\n    if (offsetBottom != null && (colliderTop + colliderHeight >= scrollHeight - offsetBottom)) return 'bottom'\r\n\r\n    return false\r\n  }\r\n\r\n  Affix.prototype.getPinnedOffset = function () {\r\n    if (this.pinnedOffset) return this.pinnedOffset\r\n    this.$element.removeClass(Affix.RESET).addClass('affix')\r\n    var scrollTop = this.$target.scrollTop()\r\n    var position  = this.$element.offset()\r\n    return (this.pinnedOffset = position.top - scrollTop)\r\n  }\r\n\r\n  Affix.prototype.checkPositionWithEventLoop = function () {\r\n    setTimeout($.proxy(this.checkPosition, this), 1)\r\n  }\r\n\r\n  Affix.prototype.checkPosition = function () {\r\n    if (!this.$element.is(':visible')) return\r\n\r\n    var height       = this.$element.height()\r\n    var offset       = this.options.offset\r\n    var offsetTop    = offset.top\r\n    var offsetBottom = offset.bottom\r\n    var scrollHeight = Math.max($(document).height(), $(document.body).height())\r\n\r\n    if (typeof offset != 'object')         offsetBottom = offsetTop = offset\r\n    if (typeof offsetTop == 'function')    offsetTop    = offset.top(this.$element)\r\n    if (typeof offsetBottom == 'function') offsetBottom = offset.bottom(this.$element)\r\n\r\n    var affix = this.getState(scrollHeight, height, offsetTop, offsetBottom)\r\n\r\n    if (this.affixed != affix) {\r\n      if (this.unpin != null) this.$element.css('top', '')\r\n\r\n      var affixType = 'affix' + (affix ? '-' + affix : '')\r\n      var e         = $.Event(affixType + '.bs.affix')\r\n\r\n      this.$element.trigger(e)\r\n\r\n      if (e.isDefaultPrevented()) return\r\n\r\n      this.affixed = affix\r\n      this.unpin = affix == 'bottom' ? this.getPinnedOffset() : null\r\n\r\n      this.$element\r\n        .removeClass(Affix.RESET)\r\n        .addClass(affixType)\r\n        .trigger(affixType.replace('affix', 'affixed') + '.bs.affix')\r\n    }\r\n\r\n    if (affix == 'bottom') {\r\n      this.$element.offset({\r\n        top: scrollHeight - height - offsetBottom\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  // AFFIX PLUGIN DEFINITION\r\n  // =======================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this   = $(this)\r\n      var data    = $this.data('bs.affix')\r\n      var options = typeof option == 'object' && option\r\n\r\n      if (!data) $this.data('bs.affix', (data = new Affix(this, options)))\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.affix\r\n\r\n  $.fn.affix             = Plugin\r\n  $.fn.affix.Constructor = Affix\r\n\r\n\r\n  // AFFIX NO CONFLICT\r\n  // =================\r\n\r\n  $.fn.affix.noConflict = function () {\r\n    $.fn.affix = old\r\n    return this\r\n  }\r\n\r\n\r\n  // AFFIX DATA-API\r\n  // ==============\r\n\r\n  $(window).on('load', function () {\r\n    $('[data-spy=\"affix\"]').each(function () {\r\n      var $spy = $(this)\r\n      var data = $spy.data()\r\n\r\n      data.offset = data.offset || {}\r\n\r\n      if (data.offsetBottom != null) data.offset.bottom = data.offsetBottom\r\n      if (data.offsetTop    != null) data.offset.top    = data.offsetTop\r\n\r\n      Plugin.call($spy, data)\r\n    })\r\n  })\r\n\r\n}(jQuery);\r\n","import Ractive from \"Ractive.js\";\nimport journey from \"lib/journey/journey\";\n\njourney.on( \"routeAbuseStart\", function ( ) {\n\tRactive.defaults.transitionsEnabled = false;\n\tconsole.log( \"* Animation disabled\" );\n} );\njourney.on( \"routeAbuseEnd\", function ( ) {\n\tRactive.defaults.transitionsEnabled = true;\n\tconsole.log( \"** Renabling animations\" );\n} );\n","import journey from 'lib/journey/journey.js';\r\nimport Ractive from \"Ractive.js\";\r\nimport fade from \"lib/fade.js\";\r\nimport 'lib/prism.js';\r\nimport \"./config/routes.js\";\r\nimport menu from \"./menu/menu.js\";\r\nimport \"lib/bootstrap.js\";\r\nimport \"./animationMonitor.js\";\r\n\r\n//let contextPath = \"/build\";\r\n//let contextPath = \"/journey-examples/\";\r\nlet contextPath = \"\";\r\n\r\nmenu.init( { target: \"#menu\", fallbackMenu: \"#menu-home\" } );\r\n\r\nif (location.pathname == \"/\" || location.pathname == contextPath || location.pathname == \"\") {\r\n\t//history.replaceState(null, null, \"/home\"); // change url to /home as a default\r\n}\r\n\r\nRactive.transitions = {\r\n\tfade\r\n};\r\n\r\njourney.on( \"entered\", function ( options ) {\r\n\tPrism.highlightAll();\r\n} );\r\n\r\njourney.start( {\r\n\ttarget: \"#container\",\r\n\tdebug: Ractive.DEBUG = true,\r\n\tfallback: '/notFound',\r\n\tbase: contextPath,\r\n\tdefaultRoute: '/home',\r\n\tuseOnHashChange: false,\r\n\tuseHash: false,\r\n\thash: '#!'\r\n} );\r\n"],"names":["RouteData","ref","route","pathname","params","query","hash","scrollX","scrollY","this","isInitial","_route","Route","path","options","pathHelper","stripSlashOrHashPrefix","segments","split","enter","updateable","update","HANDLERS","forEach","handler","other","opts","let","value","roadtrip","Promise","resolve","segmentsMatch","a","b","length","i","toHash","link","href","getAttribute","prefixWithHash","which","event","window","button","sameOrigin","origin","location","protocol","hostname","port","indexOf","isSameRoute","routeA","routeB","dataA","dataB","deepEqual","isArray","const","aKeys","Object","keys","bKeys","key","hasOwnProperty","thing","toString","call","noop","getNewData","target","newData","newRoute","routes","exec","historyListener","url","util","stripBase","config","base","internalOptions","_target","hashChange","popState","fulfil","reject","popEvent","scroll","scrollHistory","state","uid","x","y","_goto","currentID","forceReloadRoute","forceReload","targetHref","prefixWithSlash","result","tempHref","fallback","_sameRoute","currentRoute","currentData","isTransitioning","promise","extend","all","leave","beforeenter","then","catch","e","replaceState","uniqueID","watchHistory","useOnHashChange","setHash","useHash","prefixWithBase","history","EventEmitter","indexOfListener","listeners","listener","alias","name","apply","arguments","buildParams","prefix","obj","traditional","add","Array","item","index","rbracket","test","type","prototype","replace","toLowerCase","resetWhenNormal","delay","resetRequest","clearTimeout","setTimeout","reset","raiseError","journeyUtils","logError","error","journey","emit","raiseEvent","args","events","UPDATE","UPDATED","BEFORE_ENTER","BEFORE_ENTER_COMPLETE","to","from","ENTER","ENTERED","LEAVE","LEFT","wrap","enhanceEvent","wrapper","that","slice","startOptions","err","gatherErrorOptions","message","wrapRoadtripGoto","_origGoto","goto","isEqual","isNumeric","isNaN","parseFloat","isFinite","isObject","isObjectLike","format","shift","fatal","Error","logIfDebug","Ractive","DEBUG","log","warn","printWarning","warnOnce","alreadyWarned","warnIfDebug","warnOnceIfDebug","findInViewHierarchy","registryName","ractive","instance","findInstance","isolated","parent","interpolate","interpol","missingPlugin","interpolators","number","array","object","snap","addToArray","push","arrayContains","c","arrayContentsMatch","ensureArray","undefined","lastItem","removeFromArray","member","splice","combine","res","arrays","concat","idx","toArray","arrayLike","findMap","fn","len","detach","element","_detachNodes","tm","detachNodes","check","ready","outros","outroChildren","outrosComplete","decrementOutros","intros","totalChildren","callback","notifiedTotal","decrementTotal","detachImmediate","manager","node","trans","queue","detachQueue","collectAllOutros","j","start","contains","_list","list","children","dispatch","observer","flushChanges","batch","immediateObservers","fragment","fragments","transitionManager","deferredObservers","tasks","escapeKey","escapeKeyPattern","normalise","refPattern","splitKeypath","keypath","match","splitPattern","substr","unescapeKey","unescapeKeyPattern","startCapturing","stack","captureGroup","stopCapturing","dependencies","pop","capture","model","bind","cancel","destroyed","handleChange","mark","marked","markedAll","render","shuffled","teardown","unbind","unrender","unrenderAndDestroy","toEscapedString","context","bound","fnBind","prop","maybeBind","shouldBind","isRoot","boundValue","_r_unbound","updateFromBindings","findBoundValue","owner","checked","fireShuffleTasks","stage","shuffleTasks","register","registerQueue","shuffle","newIndices","shuffling","childByKey","rebind","joinKey","keyModels","getKeyModel","upstream","source","links","l","deps","notifyUpstream","rebindMatch","template","next","previous","r","isKey","isKeypath","parts","last","findAlias","z","aliases","iterations","n","componentParent","tick","runloop","ticker","now","performance","tickers","end","requestAnimationFrame","running","prefixKeypath","prefixed","getPrefixer","rootKeypath","rootDot","prefixers","relativeKeypath","recreateArray","resolveReference","initialFragment","findContext","viewmodel","joinAll","frag","explicitContext","unshift","component","parentFragment","join","getRactiveModel","badReference","repeater","findRepeatingFragment","isIteration","GlobalModel","SharedModel","root","getKeypathModel","ContextModel","getContext","_data","has","createMapping","shouldWarn","warnAboutAmbiguity","keyRef","indexRef","createLink","implicit","resolveInstanceMembers","getRactiveContext","_fakeFragment","FakeFragment","assigns","ctx","extern","Context","create","assign","set","pairs","k","keep","deep","deepSet","get","comparator","getComparator","merge","gather","star","findMatches","build","sets","map","m","dest","deepOpts","option","comparators","d","pair","errorMessage","Ractive$add","getOptions","easing","linear","duration","complete","step","animate","noAnimation","interpolator","Ractive$animate","enqueue","_eventQueue","dequeue","variants","initial","initStars","bubbleStars","max","Math","pow","fireEvent","eventName","fireEventAs","_nsSubs","eventNames","initialFire","bubble","_subs","notifySubscribers","subscribers","originalEvent","stopEvent","off","preventDefault","stopPropagation","findAnchors","findAnchorsIn","isAnchor","items","updateAnchors","anchors","idxs","_children","byName","child","lastBound","removeChild","addChild","unrenderChild","meta","rendered","shouldDestroy","el","attachChild","constructor","findNextNode","nameOption","prepend","insertAt","external","@this.parent","@this.root","attachHook","fire","attached","addFragment","anchor","Ractive$detach","isDetached","__ractive_instances__","detachHook","detachChild","detached","Ractive$find","selector","find","remote","Ractive$findAll","findAll","Ractive$findAllComponents","findAllComponents","Ractive$findComponent","findComponent","Ractive$findContainer","container","findContainer","Ractive$findParent","findParent","getNewIndices","methodName","spliceArguments","getSpliceEquivalent","balance","removeStart","min","removeEnd","startIndex","touchedFrom","adapt","force","updateHook","Ractive$update","findElement","orComponent","ELEMENT","COMPONENT","ANCHOR","containerFragment","findModel","Ractive$fire","proto","forRactive","Ractive$get","document","instances","_ractive","proxy","getNodeInfo","staticContext","staticInfo","createDocumentFragment","doc","getElement","input","output","win","nodeType","getElementById","querySelector","detachNode","parentNode","safeToStringValue","safeAttributeString","string","Ractive$insert","insertBefore","fireInsertHook","insertHook","there","here","sourcePath","src","lastLink","isUpstream","old","negativeOne","observe","observers","silent","caller","keypaths","filter","createObserver","_observers","o","isSilenced","silence","resume","wildcardIndex","double","PatternObserver","ArrayObserver","Observer","observeOnce","onceOptions","Ractive$off","trim","notEmptyString","subs","entry","s","Ractive$on","Ractive$once","on","readLink","isLink","canonical","getKeypath","addCSS","styleDefinition","styleDefinitions","isDirty","applyCSS","useCssText","styleElement","styleSheet","cssText","getCSS","innerHTML","cssIds","style","id","reduce","styles","PREFIX","fillGaps","sources","toPairs","str","extractString","unit","transformSelector","selectorUnits","selectorUnitPattern","modifiers","transformed","appended","prepended","transformCss","css","dataAttr","dataRvcGuidPattern","cleanCss","reconstruct","selectorsPattern","$1","excludePattern","selectors","keyframesDeclarationPattern","s4","floor","random","substring","uuid","validate","data","parentValue","childValue","parentIsFn","childIsFn","fromProperties","callDataFunction","primary","secondary","fromExpression","body","Function","fromComputationString","bindTo","hasThis","functionBody","pattern","getFunction","functions","createFunction","addFunctions","exp","readDelimiterChange","parser","matchString","pos","allowWhitespace","opening","matchPattern","delimiterChangePattern","whitespacePattern","closing","readNumberLiteral","regexpPattern","t","REGEXP_LITERAL","v","escapeRegExp","decodeCharacterReferences","html","entityPattern","entity","code","htmlEntities","parseInt","codeToChar","validateCode","escapeHtml","amp","lessThan","greaterThan","controlCharacters","invalid","codePointSupport","numberPattern","NUMBER_LITERAL","readBooleanLiteral","remaining","BOOLEAN_LITERAL","getString","literal","JSON","parse","escapes","escapeChar","readTemplateStringLiteral","done","stringMiddlePattern","escapeSequencePattern","STRING_LITERAL","expr","readExpression","BRACKETED","lineContinuationPattern","charCodeAt","part","INFIX_OPERATOR","readKey","token","readStringLiteral","identifier","namePattern","readKeyValuePair","spread","refKey","nextChar","spreadPattern","KEY_VALUE_PAIR","REFERENCE","p","readKeyValuePairs","getKeyValuePair","keyValuePairs","readLiteral","readObjectLiteral","readArrayLiteral","readRegexpLiteral","readReference","global","reference","lastDotIndex","startPos","prefixPattern","relaxedNames","relaxedName","legalReference","actual","specials","inEvent","keywords","globals","GLOBAL","lastIndexOf","refLength","readBracketedExpression","expectedExpression","expectedParen","readRefinement","strictRefinement","REFINEMENT","getConditional","expression","readLogicalOr","ifTrue","ifFalse","CONDITIONAL","readConditional","readExpressionList","isSpread","expressions","readExpressionOrReference","expectedFollowers","flattenExpression","stringify","String","ARRAY_LITERAL","hasSpread","makeSpread","OBJECT_LITERAL","stringifyPair","PREFIX_OPERATOR","INVOCATION","count","MEMBER","refs","open","close","out","extractRefs","stringified","vars","refineExpression","mustache","referenceExpression","getReferenceExpression","rx","refinement","members","splitEvent","slashes","readAttribute","nearest","attributeNamePattern","tags","readAttributeValue","valueStart","startDepth","sectionDepth","readQuotedAttributeValue","readUnquotedAttributeValue","readUnquotedAttributeValueToken","text","unquotedAttributeValueTextPattern","haystack","needles","getLowestIndex","inAttribute","tokens","readMustache","quoteMark","readQuotedStringToken","readAttributeOrDirective","directive","attribute","directives","f","decoratorPattern","DECORATOR","readArguments","transitionPattern","TRANSITION","eventPattern","EVENT","readProxyEvent","reservedEventNames","boundPattern","ATTRIBUTE","INTERPOLATOR","sanitizeEventAttributes","onPattern","exclude","quote","proxyEvent","whitespace","required","single","spreadArgs","inUnquotedAttribute","inside","readMustacheOfType","inTag","tag","reader","sortMustacheTags","delimiterChangeToken","rewind","readers","isStatic","includeLinePositions","getLinePos","readTriple","triple","TRIPLE","readUnescaped","readAliases","readAlias","asRE","legalAlias","readPartial","partial","PARTIAL","YIELDER","readComment","COMMENT","readInterpolator","charAt","readClosing","CLOSING","readElse","elsePattern","ELSE","readElseIf","ELSEIF","readSection","section","hasElse","block","unlessBlock","closed","expectedClose","aliasOnly","SECTION","SECTION_UNLESS","standardDelimiters","handlebarsBlockPattern","handlebarsBlockCodes","ALIAS","indexRefPattern","extra","keyIndexRefPattern","SECTION_IF","read","READERS","readHtmlComment","textOnlyMode","OPEN_COMMENT","endIndex","CLOSE_COMMENT","content","comment","isString","isComment","DELIMCHANGE","isSection","INVERTED","cleanup","stripComments","preserveWhitespace","removeLeadingWhitespace","removeTrailingWhitespace","previousItem","nextItem","preserveWhitespaceInsideFragment","removeLeadingWhitespaceInsideFragment","removeTrailingWhitespaceInsideFragment","stripStandalones","trimWhitespace","leadingWhitespace","trailingWhitespace","isPreserveWhitespaceElement","preserveWhitespaceElements","leadingNewLine","trailingNewLine","contiguousWhitespace","readClosingTag","closingTagPattern","CLOSING_TAG","readElement","selfClosing","partials","hasPartials","closingTag","DOCTYPE","anchorPattern","tagNamePattern","validTagNameFollower","lowerCaseName","voidElementNames","elementStack","reverse","canContain","closingTagName","readAnchorClose","PARTIAL_READERS","sanitizeElements","disallowed","disallowedContents","readText","barrier","readPartialDefinitionSection","delimiters","partialDefinitionSectionPattern","INLINE_PARTIAL","readTemplate","TEMPLATE_VERSION","insertExpressions","isExpression","addTo","hasChildren","StandardParser","throwNoParse","method","instructions","TEMPLATE_INSTRUCTIONS","createFunctionFromString","COMPUTATION_INSTRUCTIONS","resetValue","_config","getDynamicTemplate","fromId","isParsed","getParseOptions","parseTemplate","parseAsString","parseFor","extendPartials","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_super","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","adaptors","configure","Parent","isStandardKey","append","enhance","registries","registry","adaptConfigurator","templateConfigurator","cssConfigurator","extendOtherMethods","isBlacklisted","RactiveProto","wrapPrototype","makeObj","ExpressionProxy","ReferenceExpressionProxy","resolveAliases","resolved","readStyle","rule","rules","readClass","space","getUpdateDelegate","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","binding","updateRadioValue","textTypes","updateValue","isTwoway","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","namespaceURI","updateClassName","updateInlineClass","isBoolean","updateBoolean","namespace","updateNamespacedAttribute","updateAttribute","getValue","selected","optionValue","locked","wasSelected","disabled","selectedIndex","wasChecked","compare","group","removeAttribute","setAttribute","valueAttribute","isChecked","props","prev","safe","setProperty","hyphenateCamel","cls","className","baseVal","attr","inlineClass","useProperty","propertyName","removeAttributeNS","setAttributeNS","inAttributes","attributes","doInAttributes","parseAttributes","isSvg","tagName","div","childNodes","notIn","needle","lookupNamespace","qualified","hasAttribute","namespaces","flag","current","recreateTwowayBinding","initLink","applyValue","_link","Missing","attachImplicits","attach","mdl","detachImplicits","unlink","getComputationSignature","signature","getter","setter","getterString","getterUseStack","setterString","construct","welcome","initialiseProperties","handleAttributes","delegate","constructHook","registryNames","_attributePartial","RootModel","getAdaptors","dataConfigurator","init","computed","compute","protoAdapt","lookup","adaptor","srcs","_guid","tpl","attrs","optional","mapAll","Ractive$teardown","torndown","getPromise","teardownHook","destructHook","renderItem","unrenderItem","nextNode","_partials","eventHandlers","callRender","findParentNode","occupants","checkAnchors","checking","setupArgsFn","models","resolveArgs","specialRef","teardownArgsFn","unregister","handleDomEvent","getBindingGroup","BindingGroup","bindings","handleBlur","handleDelay","timeout","getSelectedOptions","select","selectedOptions","getSiblings","siblings","isBindable","selectBinding","attributeByName","isBindableByValue","isBindableByContentEditable","contenteditable","ContentEditableBinding","isBindableByName","isBindableByChecked","RadioNameBinding","RadioBinding","CheckboxBinding","CheckboxNameBinding","FileBinding","NumericBinding","GenericBinding","MultipleSelectBinding","SingleSelectBinding","sortAttributes","left","right","toFront","inputIsCheckedRadio","nameAttr","stringifyAttribute","getNamespace","xmlns","svg","handleReset","formBindings","updateModel","progressiveText","nodeValue","splitText","createTextNode","appendChild","valueToken","childData","val","isReadonly","boundFragment","Fragment","valueOf","scheduleTask","getPartialTemplate","getPartialFromRegistry","noThrow","parsed","findParentPartial","isOwner","noRegistryFunctionReturn","findOwner","_fn","findConstructor","_Parent","parsePartial","isEmpty","getType","hasIndexRef","SECTION_EACH","SECTION_IF_WITH","docFrag","onChange","visible","hidden","onHide","onShow","resetStyle","nearestProp","rendering","unrendering","elementCache","createElement","getComponentConstructor","Component","components","createItem","Text","ComponentConstructor","specialElements","Element","Item","Mapping","Attribute","constructors","processItems","values","guid","counter","TEXT","placeholderId","newModel","wrapperValue","getChildQueue","hookQueue","childQueue","hook","initialise","userOptions","computations","computation","subscribe","configHook","initHook","begin","createFragment","DEBUG_PROMISES","cssId","once","renderHook","completeHook","Ractive$render","others","Ractive$reset","rerender","changes","shouldRerender","unrenderHook","resetTemplate","resetHook","collect","refName","forceResetTemplate","Ractive$resetTemplate","transitionsEnabled","Ractive$set","Ractive$subtract","Ractive$toggle","TypeError","badArguments","Ractive$toCSS","ids","Ractive$toHTML","toText","Ractive$transition","HTMLElement","transition","Transition","registerTransition","Ractive$unrender","Ractive$updateModel","cascade","extendOne","extendWith","Class","Target","Child","callsSuper","defineProperties","defaults","writable","configurable","extendClass","_on","_observe","joinKeys","splitKeypathI","fade","targetOpacity","processParams","DEFAULTS","isIntro","getStyle","setStyle","animateStyle","createView","console","testThis","original","testArgs","currentInstance","bool","resetData","_toConsumableArray","arr","arr2","setupParsley","parsley","$","form","showFormValidationFeedback","field","ok","isValid","toggleClass","startListening","ERROR","stopListening","BEFORE_ENTER_COMLETE","json","response","reload","view","msg","submit","submitForm","files","FormData","each","ajax","cache","dataType","processData","contentType","textStatus","jqXHR","errorThrown","activate","simple","comp","compA","compB","swap","grid","gridComponent","handleAdd","row","sidePanel","panel","handleBodyClick","show","getUrlPath","ext","Prism","fileHighlight","is","getCurrentRoute","setupMenuListener","viewName","getViewName","$li","getMenu","hasActiveMenu","menuSlider","updateSlider","updateMenu","initializeSlider","hasParent","updateChild","getParent","updateLeaf","removeClass","addClass","$parent","$leaf","slideToMenu","getActiveMenuLocation","loc","setupWindowResizeListener","resize","windowResizeTimeoutId","windowResized","matchMedia","matches","$activeMenu","offsetLeft","$navbar","navbarOffset","offset","top","width","bottom","height","closest","stripSearch","isUrl","getLocationAsRelativeUrl","search","useDefaultRoute","defaultRoute","getGotoPath","getInitialPath","relUrl","startsWith","_ignoreHashChange","supportHistory","pushState","shouldUseOnHashChange","addEventListener","hashchangeEventLisener","popstateEventLisener","hashEvent","setListener","invisible","QUERYPAIR_REGEX","segment","toMatch","queryPairs","decodeURIComponent","nextKey","HashChangeEvent","lastURL","URL","defineProperty","enumerable","searchString","position","endsWith","subjectString","lastIndex","matchFound","some","otherOptions","_locked","metaKey","ctrlKey","shiftKey","defaultPrevented","nodeName","process","getListeners","evt","_getEvents","RegExp","flattenListeners","flatListeners","getListenersAsObject","addListener","listenerIsWrapped","addOnceListener","defineEvent","defineEvents","evts","removeListener","removeEvent","addListeners","manipulateListeners","removeListeners","remove","multiple","_events","removeAllListeners","emitEvent","listenersMap","_getOnceReturnValue","trigger","setOnceReturnValue","_onceReturnValue","module","exports","eventer","origEmit","arg","mode","utils","isFunction","fadeIn","opacity","Date","fadeOut","param","encodeURIComponent","logWarn","info","logInfo","callstack","debug","roadtripUtils","getBase","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","sanitize","contextLines","parserTransforms","syncComputedChildren","twoway","lazy","noIntro","noOutro","nestedTransitions","noCssTransform","easeIn","easeOut","easeInOut","isClient","hasConsole","implementation","hasFeature","vendors","welcomeIntro","WELCOME_MESSAGE","hasGroup","groupCollapsed","groupEnd","delta","intermediate","properties","TransitionManager","starting","fulfilPromise","previousBatch","addFragmentToRoot","addObserver","defer","_manager","detachWhenReady","task","postRender","_batch","KeyModel","shouldCapture","dependant","registerLink","unregisterLink","unreference","KeypathModel","getChild","this$1","rebindChildren","dep","hasProp","early","ModelBase","patternObservers","addShuffleTask","addShuffleRegister","existingMatches","getValueChildren","skip","getVirtual","virtual","startPath","notify","notifiedUpstream","relinking","keypathModel","registerPatternObserver","registerTwowayBinding","unregisterPatternObserver","unregisterTwowayBinding","oneway","shufle","LinkModel","super","unwrap","rootLink","relinked","lnk","ln","Ticker","elapsed","eased","stop","abort","Model","rewrap","newWrapperValue","createBranch","__model","branch","retrieve","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","Hook","arrayProto","BINDING_FLAG","DELEGATE_FLAG","modelPush","makeArrayMethod","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","prototypeAccessors","decorators","intermediary","num","sharedSet","protoAnimate","raise","ev","drop","sort","subtract","toggle","protoUpdate","isBound","getBindingModel","getBindingPath","getBinding","setBinding","methodNames","unprefixed","makeFunction","mathml","xlink","xml","ns","createElementNS","toUpperCase","cloneNode","nodes","querySelectorAll","oldContext","dirty","oldValue","newValue","cancelled","resolver","strict","baseModel","baseKeypath","recursive","oldValues","newValues","changed","newKeys","wildcards","suffix","pending","sliced","inserted","deleted","hadIndex","newIndex","oldIndex","getElementsByTagName","additionalReplaceRules","hasCurly","textContent","ParseError","Parser","lineStart","lines","lineEnds","line","lineEnd","leftover","postProcess","converters","getContextMessage","lineNum","columnNum","contextUp","contextDown","numTabs","annotation","char","character","shortMessage","readTypeOf","regExpCache","booleanAttributes","quot","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","fromCodePoint","fromCharCode","okQuote","singleMatcher","makeQuotedStringMatcher","doubleMatcher","expressionList","readPrimary","makePrefixSequenceMatcher","symbol","fallthrough","matcher","prefixOperators","readMemberOrInvocation","makeInfixSequenceMatcher","infixOperators","readTypeof","no-delegation","if","with","unless","leadingLinebreak","trailingLinebreak","backOne","backTwo","lastSectionItem","leadingPattern","trailingPattern","li","dt","dd","rt","rp","optgroup","thead","tbody","tfoot","tr","td","th","STANDARD_READERS","readMustacheComment","TRIPLE_READERS","STATIC_READERS","defaultInterpolate","shared","isTriple","textarea","elements","eventAttributes","transforms","tlen","walk","parseOptions","Registry","useDefaults","custom","defaultKeys","order","ContainerItem","firstNode","skipParent","escape","ComputationChild","Computation","computationContext","sig","setDependencies","actuallyChanged","ReferenceExpressionChild","Alias","camelCaseStr","accept-charset","accesskey","bgcolor","class","codebase","colspan","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","ConditionalAttribute","updateDelegate","propertyNames","twowayBinding","lastVal","BindingFlag","RactiveModel","targetPath","ractiveModel","unescapedKey","_inlinePartials","leftovers","toHTML","missingDecorator","Decorator","Doctype","Binding","wasUndefined","getInitialValue","parentForm","setting","lastValue","setFromNode","attachEvent","removeEventListener","checkboxName","noInitialValue","existingValue","bindingValue","valueSoFar","selectValue","selectedValues","previousValue","nameAttributeBinding","forceUpdate","optionWasSelected","DOMEvent","listen","unlisten","CustomEvent","eventPlugin","RactiveEvent","specialPattern","dollarArgsPattern","DelegateProxy","currentTarget","EventDirective","delegates","action","specialMatch","special","dollarMatch","oldEvent","returned","endsWithSemi","isVoid","deferContent","createTwowayBinding","existing","foundNode","intro","shouldFire","isOutro","isSelected","unbinding","outro","Form","Mustache","MustacheContainer","Interpolator","Input","defaultValue","attrValue","true","false","null","specialsPattern","onlyWhitespace","JsonParser","placeholder","stringLiteral","parseJSON","Option","selectedAttribute","Partial","yielder","templateObj","named","setTemplate","partialTemplate","RepeatedFragment","pendingNewIndices","previousIterations","createIteration","bubbled","iteration","xs","updatePostShuffle","updating","toRemove","oldKeys","wasArray","newLength","indices","oldLen","removed","contiguous","Section","sectionType","templateSectionType","subordinate","sibling","nextSibling","isTruthy","siblingFalsey","lastType","newFragment","Select","sync","defaultSelected","selectNode","isMultiple","shouldSelect","valueContains","Textarea","hyphenatedStr","prefixCache","testStyle","camelizeHyphenated","capped","vendor","createTransitions","unprefixPattern","vendorPattern","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","canUseCssTransitions","cannotUseCssTransitions","webkitTransition","changedProperties","transitionDone","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","transitionEndHandler","unprefix","cssTransitionsDone","property","timing","hashPrefix","hyphenate","easingName","cssTiming","registerCompleteHandler","originalValue","propertiesToTransitionInJs","getComputedStyle","names","t0","t1","t2","onComplete","computedStyle","getParams","nested","completed","originalStyle","noReset","ieBug","ieBlacklist","TABLE","THEAD","TBODY","TR","SELECT","selectedOption","firstChild","Triple","queryResult","queryAllResult","insertHtml","outerHTML","doctype","dirtyValue","createItems","wasBound","wasRendered","HookQueue","inProcess","collection","insert","resetPartial","toCSS","toCss","toHtml","script","currentScript","VERSION","transitions","_self","WorkerGlobalScope","self","uniqueId","_","manual","encode","Token","objId","clone","languages","redef","before","grammar","newToken","ret","DFS","visited","plugins","highlightAll","async","env","hooks","run","highlightElement","language","Worker","worker","filename","onmessage","highlightedCode","postMessage","immediateClose","highlight","tokenize","strarr","rest","tokenloop","patterns","lookbehind","greedy","lookbehindLength","flags","delNum","after","wrapped","callbacks","matchedStr","classes","readyState","markup","prolog","cdata","punctuation","attr-value","attr-name","atrule","important","function","style-attr","clike","class-name","keyword","boolean","operator","javascript","regex","template-string","interpolation","interpolation-punctuation","js","$$","con","hasClass","highlightLines","pre","range","ranges","parseMethod","isLineHeightRounded","lineHeight","applyHash","scrollIntoView","fontSize","padding","border","offsetHeight","fakeTimer","clsReg","lineNumbersWrapper","linesNum","counterReset","Extensions","py","rb","ps1","psm1","sh","bat","h","tex","extension","xhr","XMLHttpRequest","onreadystatechange","status","responseText","statusText","send","home","prevRoute","nextRoute","basic","loadView","getMilliseconds","methods","session","navArgs","nav","gotoNewView","myArray","navTarget","navTargetParams","notFound","redirect","typeId","redirectTarget","basicForm","_slice","_slicedToArray","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","factory","require","define","amd","jQuery","parsleyAdaptedCallback","eventPrefix","InputEvent","_this14","isNativeEvent","isTrusted","fakeInputEvent","misbehaves","behavesOk","install","inputEventPatched","uninstall","globalID","pastWarnings","Utils__Utils","$element","specified","camelize","deserializeValue","checkAttr","_checkAttr","setAttr","dasherize","generateID","Number","chr","_window$console","_resetWarnings","trimString","date","_parsed$map","_parsed$map2","year","month","day","getFullYear","getMonth","getDate","_string","integer","regexp","_regexp","parseRequirement","requirementType","converter","converted","namespaceEvents","difference","elem","promises","when","objectCreate","_SubmitSelector","Utils__default","Defaults","inputs","excluded","priorityEnabled","uiEnabled","validationThreshold","focus","triggerAfterFailure","errorClass","successClass","classHandler","Field","errorsContainer","errorsWrapper","errorTemplate","Base","__id__","asyncSupport","_pipeAccordingToValidationResult","_this","pipe","Deferred","validationResult","actualizeOptions","domOptions","_resetOptions","initOptions","_listeners","listenTo","unsubscribe","unsubscribeTo","extraArg","asyncIsValid","whenValid","_findRelated","convertArrayRequirement","convertExtraOptionRequirement","requirementSpec","extraOptionReader","main","Validator","spec","requirementFirstArg","validateMultiple","validateDate","_isDateInput","validateNumber","validateString","parseRequirements","requirements","isPlainObject","priority","ValidatorRegistry","validators","catalog","__class__","locale","typeTesters","email","digits","alphanum","decimalPlaces","ValidatorRegistry__parseArguments","ValidatorRegistry__operatorToValidator","_len","requirementsAndInput","_key","ValidatorRegistry__comparisonOperator","addValidator","Parsley","setLocale","addCatalog","messages","addMessage","addMessages","nameMessageObject","arg1","arg2","_setValidator","updateValidator","removeValidator","validator","getErrorMessage","constraint","formatMessage","defaultMessage","en","parameters","notblank","_ref","_ref$step","_ref$base","tester","nb","decimals","toInt","round","minlength","requirement","mincheck","maxcheck","equalto","refOrValue","$reference","UI","diffResults","newResult","oldResult","added","kept","found","assert","_actualizeTriggers","_this2","onSubmitValidate","onSubmitButton","_focusedField","fields","noFocus","_destroyUI","_reflowUI","_buildUI","_ui","diff","lastValidationResult","_manageStatusClass","_manageErrorsMessages","_failedOnce","getErrorsMessages","_getErrorMessage","addError","_ref2","_ref2$updateClass","updateClass","_addError","_errorClass","updateError","_ref3","_ref3$updateClass","_updateError","removeError","_ref4","_ref4$updateClass","_removeError","hasConstraints","needsValidation","_successClass","_resetClass","errorsMessagesDisabled","_insertErrorWrapper","$errorsWrapper","_ref5","_ref6","customConstraintErrorMessage","$errorClassHandler","_manageClassHandler","errorsWrapperId","validationInformationVisible","$handler","_inputHolder","$errorsContainer","_this3","$toBind","_validateIfNeeded","_this4","debounce","_debounced","_resetUI","Form__statusMapping","rejected","_this5","$submitSource","_$submitSource","first","whenValidate","_trigger","stopImmediatePropagation","_submit","$synthetic","appendTo","Event","_arguments","_Utils__default$all$done$fail$always","_this6","_ref7","submitEvent","_refreshFields","_withoutReactualizingFormOptions","fail","always","_arguments2","_this7","_ref8","destroy","removeData","_bindFields","_this8","oldFields","fieldsMappedById","fieldInstance","Factory","oldActualizeOptions","Constraint","parsleyField","isDomConstraint","validatorSpec","_validatorRegistry","_parseRequirements","capitalize","_validator","requirementList","_this9","parsleyFormInstance","constraints","constraintsByName","_bindConstraints","parsley_field__statusMapping","_whenValid$always$done$fail$always","_this10","_ref9","refreshConstraints","_isInGroup","_refreshed","_isRequired","validateIfEmpty","inArray","_arguments3","_this11","_ref10","_ref10$force","groupedConstraints","_getGroupedConstraints","_validateConstraint","_this12","_handleWhitespace","addConstraint","removeConstraint","updateConstraint","_bindHtml5Constraints","trimValue","parsley_field","Multiple","addElement","$elements","fieldConstraints","_init","savedparsleyFormInstance","__version__","handleMultiple","parsleyMultipleInstance","_this13","$previouslyRelated","doNotStore","parsleyInstance","ParsleyExtend","vernums","jquery","version","psly","ParsleyConfig","Utils","ParsleyUtils","i18n","ParsleyValidator","_window$Parsley","ParsleyUI","doNotUpdateClass","autoBind","unsubscribeAll","_instance","instanceGiven","asyncValidators","default","addAsyncValidator","ajaxOptions","csr","remoteOptions","_remoteCache","handleXhr","validatingForm","oncomplete","onteardown","ondestruct","isListening","lifecycleEvents","updateView","onrender","basicAjax","getJSON","upload","basicPartial","hello","helloPartial","basicComp","multipleComp","rows","age","addRow","compPubSub","basicTransition","sortableDecorator","sortable","dragstartHandler","dragenterHandler","removeTargetClass","draggable","targetClass","dataTransfer","setData","dropEffect","srcIdx","destIdx","classList","removedItem","icon","navTargetWithParams","pubSubComp","AjaxMonitor","Bar","DocumentMonitor","ElementMonitor","ElementTracker","EventLagMonitor","Evented","Events","NoTargetError","Pace","RequestIntercept","SOURCE_KEYS","Scaler","SocketRequestTracker","XHRRequestTracker","animation","avgAmplitude","bar","cancelAnimation","cancelAnimationFrame","defaultOptions","extendNative","getFromDOM","getIntercept","handlePushState","ignoreStack","runAnimation","scalers","shouldIgnoreURL","shouldTrack","uniScaler","_WebSocket","_XDomainRequest","_XMLHttpRequest","_intercept","_pushState","_ref1","_replaceState","__slice","__hasProp","__extends","ctor","__super__","__indexOf","catchupTime","initialRate","minTime","ghostTime","maxProgressPerFrame","easeFactor","startOnPageLoad","restartOnPushState","restartOnRequestAfter","checkInterval","eventLag","minSamples","sampleCount","lagThreshold","trackMethods","trackWebSockets","ignoreURLs","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","mozCancelAnimationFrame","abs","_error","_base","_results","paceOptions","progress","targetElement","finish","prog","progressStr","transform","_j","_len1","lastRenderedProgress","XDomainRequest","WebSocket","ignore","track","monitorXHR","req","_open","request","protocols","_arg","restart","watch","tracker","_onreadystatechange","ProgressEvent","lengthComputable","loaded","total","states","loading","interactive","avg","interval","points","samples","setInterval","clearInterval","sinceLastUpdate","rate","catchup","lastProgress","frameTime","scaling","_k","_len2","extraSources","go","enqueueNextFrame","scaler","scalerList","_options","sidePanelObj","menu","gotoEvents","showJavascript","routeName","showHtml","fallbackMenu","transitionEnd","transEndEventNames","WebkitTransition","MozTransition","OTransition","emulateTransitionEnd","called","$el","one","support","bsTransitionEnd","bindType","delegateType","handle","handleObj","Plugin","$this","Alert","dismiss","removeElement","isDefaultPrevented","alert","Constructor","noConflict","Button","setState","isLoading","loadingText","resetText","removeAttr","$input","$btn","Carousel","slide","pause","cycle","$indicators","paused","sliding","$active","$items","keyboard","keydown","documentElement","getItemIndex","getItemForDirection","direction","active","activeIndex","itemIndex","eq","$next","isCycling","relatedTarget","slideEvent","$nextIndicator","slidEvent","offsetWidth","carousel","clickHandler","$target","slideIndex","$carousel","getTargetFromTrigger","$trigger","Collapse","transitioning","addAriaAndCollapsedClass","dimension","activesData","actives","startEvent","scrollSize","camelCase","hide","isOpen","collapse","clearMenus","backdrop","Dropdown","isActive","insertAfter","dropdown","_relatedTarget","Modal","$body","$dialog","$backdrop","isShown","originalBodyPad","scrollbarWidth","ignoreBackdropClick","load","BACKDROP_TRANSITION_DURATION","checkScrollbar","setScrollbar","scrollTop","adjustDialog","enforceFocus","hideModal","handleUpdate","resetAdjustments","resetScrollbar","removeBackdrop","doAnimate","callbackRemove","modalIsOverflowing","scrollHeight","clientHeight","paddingLeft","bodyIsOverflowing","paddingRight","fullWindowWidth","innerWidth","documentElementRect","getBoundingClientRect","clientWidth","measureScrollbar","bodyPad","scrollDiv","modal","showEvent","Tooltip","enabled","hoverState","inState","placement","title","viewport","$viewport","click","hover","triggers","eventIn","eventOut","fixTitle","getDefaults","getDelegateOptions","tip","isInStateTrue","hasContent","inDom","ownerDocument","$tip","tipId","getUID","setContent","autoToken","autoPlace","display","getPosition","actualWidth","actualHeight","orgPlacement","viewportDim","calculatedOffset","getCalculatedOffset","applyPlacement","prevHoverState","marginTop","marginLeft","setOffset","using","getViewportAdjustedDelta","isVertical","arrowDelta","arrowOffsetPosition","replaceArrow","arrow","getTitle","$e","isBody","elRect","SVGElement","elOffset","outerDims","viewportPadding","viewportDimensions","topEdgeOffset","bottomEdgeOffset","leftEdgeOffset","rightEdgeOffset","$arrow","enable","disable","toggleEnabled","tooltip","Popover","getContent","popover","ScrollSpy","$scrollElement","offsets","targets","activeTarget","refresh","getScrollHeight","offsetMethod","offsetBase","isWindow","$href","maxScroll","clear","parents","parentsUntil","scrollspy","$spy","Tab","$ul","$previous","hideEvent","tab","Affix","checkPosition","checkPositionWithEventLoop","affixed","unpin","pinnedOffset","RESET","getState","offsetTop","offsetBottom","targetHeight","initializing","colliderTop","colliderHeight","getPinnedOffset","affix","affixType"],"mappings":"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,MAAO,IAAKC,OAAQ,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,IAAK,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,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"}